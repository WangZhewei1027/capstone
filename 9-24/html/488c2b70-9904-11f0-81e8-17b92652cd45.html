<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Bubble Sort Visualization</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
      }
      canvas {
        border: 1px solid #333;
        margin: 20px;
      }
      button {
        margin: 10px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h1>Bubble Sort Visualization</h1>
    <canvas id="sortCanvas" width="800" height="400"></canvas>
    <br />
    <button id="startBtn">Start Sorting</button>
    <button id="resetBtn">Reset Array</button>

    <script>
      // Global variables
      const canvas = document.getElementById("sortCanvas");
      const ctx = canvas.getContext("2d");
      const arraySize = 50; // Number of elements in the array
      let array = [];
      let sortingInterval;
      let i = 0, j = 0; // Bubble sort indices

      // Initialize the array with random values
      function initArray() {
        array = [];
        for (let k = 0; k < arraySize; k++) {
          // Random values between 5 and canvas.height for visible bars
          array.push(Math.floor(Math.random() * (canvas.height - 5)) + 5);
        }
      }

      // Draw the array as bars on the canvas.
      // Optionally, highlight two indices (e.g., currently compared elements).
      function drawArray(highlight1, highlight2) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const barWidth = canvas.width / arraySize;
        for (let k = 0; k < arraySize; k++) {
          const barHeight = array[k];
          // Highlight bars being compared in red
          if (k === highlight1 || k === highlight2) {
            ctx.fillStyle = "red";
          } else {
            ctx.fillStyle = "blue";
          }
          // Draw the bar. Subtract 2 from barWidth for spacing.
          ctx.fillRect(k * barWidth, canvas.height - barHeight, barWidth - 2, barHeight);
        }
      }

      // Performs one step of the bubble sort algorithm.
      function bubbleSortStep() {
        if (i < array.length) {
          if (j < array.length - i - 1) {
            // Visualize the comparison: highlight indices j and j+1.
            drawArray(j, j + 1);
            if (array[j] > array[j + 1]) {
              // Swap elements if they are in the wrong order.
              const temp = array[j];
              array[j] = array[j + 1];
              array[j + 1] = temp;
            }
            j++;
          } else {
            // End of one full pass; reset inner loop index and increment outer loop.
            j = 0;
            i++;
          }
        } else {
          // Sorting complete: clear the interval and display the final sorted array.
          drawArray();
          clearInterval(sortingInterval);
          sortingInterval = null;
          document.getElementById("startBtn").disabled = false;
        }
      }

      // Start the sorting process.
      function startSorting() {
        if (sortingInterval) return; // Prevent multiple intervals
        document.getElementById("startBtn").disabled = true;
        i = 0;
        j = 0;
        sortingInterval = setInterval(bubbleSortStep, 50); // Adjust delay (ms) as needed
      }

      // Reset the array and redraw unsorted bars.
      function resetArray() {
        if (sortingInterval) {
          clearInterval(sortingInterval);
          sortingInterval = null;
        }
        initArray();
        drawArray();
        document.getElementById("startBtn").disabled = false;
        i = 0;
        j = 0;
      }

      // Initialize array and draw it when the page loads.
      window.onload = function () {
        initArray();
        drawArray();
      };

      // Attach event listeners to buttons.
      document.getElementById("startBtn").addEventListener("click", startSorting);
      document.getElementById("resetBtn").addEventListener("click", resetArray);
    </script>
  </body>
</html>