<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Radix Sort Visualization</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background: #f0f4f8;
  }
  h1 {
    text-align: center;
    color: #333;
  }
  #inputArea {
    max-width: 600px;
    margin: 0 auto 20px auto;
    display: flex;
    justify-content: center;
  }
  #arrayInput {
    width: 70%;
    padding: 8px;
    font-size: 16px;
  }
  button {
    padding: 8px 12px;
    margin-left: 10px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    background-color: #2a9df4;
    color: white;
    border-radius: 4px;
    transition: background-color 0.3s;
  }
  button:hover:not(:disabled) {
    background-color: #1b7fd1;
  }
  button:disabled {
    background-color: #a5c9f9;
    cursor: default;
  }
  #error {
    color: red;
    text-align: center;
    margin-bottom: 10px;
  }
  #arrayDisplay {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 30px;
  }
  .arrayItem {
    width: 40px;
    height: 40px;
    background-color: #81c784;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    border-radius: 5px;
    transition: background-color 0.4s, transform 0.3s;
    user-select: none;
  }
  .highlight {
    background-color: #f9a825 !important;
    transform: scale(1.2);
  }
  #bucketsContainer {
    max-width: 700px;
    margin: 0 auto;
  }
  .bucketRow {
    display: flex;
    justify-content: center;
    margin: 10px 0;
  }
  .bucket {
    background-color: #eceff1;
    border: 2px solid #90a4ae;
    border-radius: 8px;
    width: 60px;
    min-height: 60px;
    margin: 0 6px;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 20px;
    box-sizing: border-box;
  }
  .bucketLabel {
    position: absolute;
    top: 0;
    font-size: 18px;
    font-weight: 600;
    color: #607d8b;
  }
  .bucketContent {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 18px;
    gap: 4px;
    min-height: 30px;
  }
  #log {
    max-width: 700px;
    margin: 30px auto;
    background-color: #ffffffee;
    padding: 15px 20px;
    border-radius: 10px;
    height: 150px;
    overflow-y: auto;
    font-family: monospace;
    font-size: 14px;
    color: #333;
    box-shadow: 0 4px 8px rgb(0 0 0 / 0.1);
  }
  #log strong {
    color: #1565c0;
  }
  footer {
    text-align: center;
    margin-top: 40px;
    color: #666;
    font-size: 14px;
  }
  @media (max-width: 600px) {
    #inputArea {
      flex-direction: column;
      align-items: center;
    }
    #arrayInput {
      width: 90%;
      margin-bottom: 10px;
    }
    button {
      margin-left: 0;
    }
  }
</style>
</head>
<body>

<h1>Radix Sort Visualization</h1>

<div id="inputArea">
  <input type="text" id="arrayInput" placeholder="Enter integers separated by commas" aria-label="Array input" />
  <button id="startBtn">Start Radix Sort</button>
</div>

<div id="error" aria-live="polite"></div>

<div id="arrayDisplay" aria-live="polite" aria-label="Array visual display"></div>

<div id="bucketsContainer" aria-live="polite" aria-label="Buckets for each digit"></div>

<div id="log" aria-live="polite" aria-atomic="true"></div>

<footer>Demo by ChatGPT &mdash; Radix Sort Algorithm</footer>

<script>
(() => {
  const startBtn = document.getElementById('startBtn');
  const arrayInput = document.getElementById('arrayInput');
  const errorDiv = document.getElementById('error');
  const arrayDisplay = document.getElementById('arrayDisplay');
  const bucketsContainer = document.getElementById('bucketsContainer');
  const logDiv = document.getElementById('log');

  let originalArray = [];
  let workingArray = [];
  let maxDigits = 0;

  // Utility: sleep for animation pauses
  const sleep = ms => new Promise(r => setTimeout(r, ms));

  // Create visual blocks for the array
  function renderArray(arr, highlightIndices = []) {
    arrayDisplay.innerHTML = '';
    arr.forEach((num, i) => {
      const div = document.createElement('div');
      div.className = 'arrayItem';
      div.textContent = num;
      if (highlightIndices.includes(i)) {
        div.classList.add('highlight');
      }
      arrayDisplay.appendChild(div);
    });
  }

  // Create buckets (0-9)
  function renderBuckets(buckets) {
    bucketsContainer.innerHTML = '';
    const bucketRow = document.createElement('div');
    bucketRow.className = 'bucketRow';
    for (let i = 0; i <= 9; i++) {
      const bucket = document.createElement('div');
      bucket.className = 'bucket';
      bucket.setAttribute('aria-label', `Bucket ${i}`);
      const label = document.createElement('div');
      label.className = 'bucketLabel';
      label.textContent = i;
      const content = document.createElement('div');
      content.className = 'bucketContent';
      bucket.appendChild(label);
      bucket.appendChild(content);
      bucketRow.appendChild(bucket);
    }
    bucketsContainer.appendChild(bucketRow);

    // Place numbers in their buckets visually
    buckets.forEach((bucketArr, digit) => {
      const bucketDiv = bucketRow.children[digit].querySelector('.bucketContent');
      bucketArr.forEach(num => {
        const numDiv = document.createElement('div');
        numDiv.className = 'arrayItem';
        numDiv.style.width = '30px';
        numDiv.style.height = '30px';
        numDiv.style.fontSize = '0.8rem';
        numDiv.textContent = num;
        bucketDiv.appendChild(numDiv);
      });
    });
  }

  // Log messages with timestamp
  function log(message, strongPart = null) {
    const p = document.createElement('p');
    if (strongPart) {
      const bold = document.createElement('strong');
      bold.textContent = strongPart;
      p.appendChild(bold);
      p.appendChild(document.createTextNode(message));
    } else {
      p.textContent = message;
    }
    logDiv.appendChild(p);
    logDiv.scrollTop = logDiv.scrollHeight;
  }

  // Extract digit at place (0 = least significant digit)
  function getDigit(num, place) {
    return Math.floor(Math.abs(num) / Math.pow(10, place)) % 10;
  }

  // Find max number of digits in array
  function findMaxDigits(arr) {
    let max = 0;
    arr.forEach(num => {
      const digits = num.toString().replace('-', '').length;
      if (digits > max) max = digits;
    });
    return max;
  }

  // Validate input and parse
  function parseInput(input) {
    if (!input.trim()) return null;
    const parts = input.split(',').map(p => p.trim());
    const nums = [];
    for (let p of parts) {
      if (!/^[-]?\d+$/.test(p)) return null;
      const n = Number(p);
      nums.push(n);
    }
    return nums;
  }

  // Disable/enable controls
  function setControlsEnabled(enabled) {
    startBtn.disabled = !enabled;
    arrayInput.disabled = !enabled;
  }

  async function radixSort(arr) {
    setControlsEnabled(false);
    errorDiv.textContent = '';
    logDiv.innerHTML = '';
    renderArray(arr);
    log('Starting Radix Sort...');
    const maxDigitCount = findMaxDigits(arr);
    log(`Maximum digits in input: ${maxDigitCount}`);

    let array = arr.slice(); // Make copy
    for (let digitPlace = 0; digitPlace < maxDigitCount; digitPlace++) {
      log(`\nProcessing digit place: ${digitPlace} (0 = least significant digit)`);
      // Create buckets 0-9
      let buckets = Array.from({length: 10}, () => []);
      // Highlight current digit for each element visually
      for (let i = 0; i < array.length; i++) {
        renderArray(array, [i]);
        await sleep(200);
        const digit = getDigit(array[i], digitPlace);
        log(`Number ${array[i]} goes to bucket ${digit}`);
        buckets[digit].push(array[i]);
      }
      renderBuckets(buckets);
      await sleep(500);
      // Flatten buckets back into array
      array = buckets.flat();
      log('Concatenating buckets back into array...');
      renderArray(array);
      await sleep(700);
    }
    log('\nRadix Sort completed. Sorted array:');
    renderArray(array);
    log(array.join(', '));
    setControlsEnabled(true);
    return array;
  }

  startBtn.addEventListener('click', () => {
    const input = arrayInput.value;
    const nums = parseInput(input);
    if (!nums) {
      errorDiv.textContent = 'Invalid input! Please enter integers separated by commas.';
      return;
    }
    errorDiv.textContent = '';
    originalArray = nums;
    workingArray = nums.slice();
    radixSort(workingArray).catch(e => {
      errorDiv.textContent = 'An error occurred during sorting.';
      setControlsEnabled(true);
      console.error(e);
    });
  });

  // Prefill with example data
  arrayInput.value = '170, 45, 75, 90, 802, 24, 2, 66';
})();
</script>

</body>
</html>