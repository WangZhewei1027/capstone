<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Longest Common Subsequence (LCS) Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2rem;
    max-width: 700px;
  }
  h1 {
    text-align: center;
  }
  label {
    display: block;
    margin: 1rem 0 0.5rem;
    font-weight: bold;
  }
  input[type="text"] {
    width: 100%;
    padding: 0.4rem;
    font-size: 1.1rem;
  }
  button {
    margin-top: 1.2rem;
    padding: 0.6rem 1.2rem;
    font-size: 1.1rem;
    cursor: pointer;
  }
  #result {
    margin-top: 1.5rem;
    background: #f0f0f0;
    padding: 1rem;
    border-radius: 6px;
    white-space: pre-wrap;
    font-family: monospace;
  }
  table {
    border-collapse: collapse;
    margin-top: 1rem;
    width: 100%;
    overflow-x: auto;
  }
  td, th {
    border: 1px solid #aaa;
    padding: 4px 8px;
    text-align: center;
    font-family: monospace;
  }
  .highlight {
    background-color: #ffd54f;
  }
  .lcs-char {
    color: #2e7d32;
    font-weight: bold;
  }
  footer {
    margin-top: 3rem;
    font-size: 0.9rem;
    color: #555;
    text-align: center;
  }
  .helptext {
    font-size: 0.9rem;
    color: #666;
    margin-top: 0.3rem;
  }
</style>
</head>
<body>
<h1>Longest Common Subsequence (LCS) Calculator</h1>

<label for="str1">First String:</label>
<input type="text" id="str1" placeholder="Enter first string..." spellcheck="false" />

<label for="str2">Second String:</label>
<input type="text" id="str2" placeholder="Enter second string..." spellcheck="false" />

<button id="calculateBtn">Calculate LCS</button>

<div id="result"></div>

<footer>
  &copy; 2024 â€” LCS Demo by ChatGPT
</footer>

<script>
  // Compute the Length and DP table for LCS of s1 and s2
  function computeLCS(s1, s2) {
    const m = s1.length, n = s2.length;
    // DP table: dp[i][j] = length of LCS of s1[0..i-1] and s2[0..j-1]
    const dp = Array.from({length: m+1}, () => Array(n+1).fill(0));

    for(let i = 1; i <= m; i++) {
      for(let j = 1; j <= n; j++) {
        if(s1[i-1] === s2[j-1]) {
          dp[i][j] = dp[i-1][j-1] + 1;
        } else {
          dp[i][j] = Math.max(dp[i-1][j], dp[i][j-1]);
        }
      }
    }
    return dp;
  }

  // Reconstruct one LCS from dp table
  function reconstructLCS(dp, s1, s2) {
    let i = s1.length;
    let j = s2.length;
    let lcs = [];
    while(i > 0 && j > 0) {
      if(s1[i-1] === s2[j-1]) {
        lcs.push(s1[i-1]);
        i--;
        j--;
      } else if(dp[i-1][j] > dp[i][j-1]) {
        i--;
      } else {
        j--;
      }
    }
    return lcs.reverse().join('');
  }

  // Display the DP table as a HTML table, highlighting directions used in the LCS path
  function renderDPTable(dp, s1, s2, lcs) {
    const m = s1.length;
    const n = s2.length;
    const table = document.createElement('table');
    const thead = document.createElement('thead');
    const tbody = document.createElement('tbody');

    // Header row (top-left empty + chars of s2)
    const headerRow = document.createElement('tr');
    headerRow.appendChild(document.createElement('th')); // empty corner 
    headerRow.appendChild(document.createElement('th')); // empty corner for s1 row chars
    for(let j = 0; j < n; j++) {
      const th = document.createElement('th');
      th.textContent = s2[j];
      headerRow.appendChild(th);
    }
    thead.appendChild(headerRow);

    // First row empty (for i=0)
    const emptyRow = document.createElement('tr');
    emptyRow.appendChild(document.createElement('th')); // for row chars of s1
    emptyRow.appendChild(document.createElement('th'));
    for(let j = 0; j <= n; j++) {
      const td = document.createElement('td');
      td.textContent = dp[0][j];
      emptyRow.appendChild(td);
    }
    tbody.appendChild(emptyRow);

    // We will highlight the path of backtracking (LCS path)
    // Compute the path set
    let pathSet = new Set();
    // Backtrack to get path cells (i,j)
    let i = m, j = n;
    while(i > 0 && j > 0) {
      pathSet.add(`${i},${j}`);
      if(s1[i-1] === s2[j-1]) {
        i--; j--;
      } else if(dp[i-1][j] > dp[i][j-1]) {
        i--;
      } else {
        j--;
      }
    }

    // Rows for i=1 to m
    for(let i = 1; i <= m; i++) {
      const tr = document.createElement('tr');
      // s1 char column
      const th1 = document.createElement('th');
      th1.textContent = s1[i-1];
      tr.appendChild(th1);
      // empty left header (alignment)
      const th2 = document.createElement('th');
      th2.textContent = '';
      tr.appendChild(th2);
      // values dp[i][j], j=0..n
      for(let j = 0; j <= n; j++) {
        const td = document.createElement('td');
        td.textContent = dp[i][j];
        if(pathSet.has(`${i},${j}`)) {
          td.classList.add('highlight');
        }
        tr.appendChild(td);
      }
      tbody.appendChild(tr);
    }

    table.appendChild(thead);
    table.appendChild(tbody);
    return table;
  }

  // Highlight LCS characters within the original strings output
  function highlightLCSInStrings(s1, s2, lcs) {
    function markLCS(s, lcs) {
      let res = '';
      let lcsIdx = 0;
      for(let i=0; i<s.length; i++) {
        if(lcsIdx < lcs.length && s[i] === lcs[lcsIdx]) {
          res += `<span class="lcs-char">${s[i]}</span>`;
          lcsIdx++;
        } else {
          res += s[i];
        }
      }
      return res;
    }
    return {
      s1: markLCS(s1, lcs),
      s2: markLCS(s2, lcs)
    };
  }

  document.getElementById('calculateBtn').addEventListener('click', () => {
    const s1 = document.getElementById('str1').value;
    const s2 = document.getElementById('str2').value;
    const resultDiv = document.getElementById('result');
    resultDiv.innerHTML = '';

    if(s1.length === 0 || s2.length === 0) {
      resultDiv.textContent = 'Please enter both strings.';
      return;
    }

    // Compute DP table
    const dp = computeLCS(s1, s2);
    // Reconstruct LCS string
    const lcs = reconstructLCS(dp, s1, s2);

    // Highlight LCS characters in original strings
    const highlighted = highlightLCSInStrings(s1, s2, lcs);

    // Display results
    let html = '';
    html += `<strong>Length of LCS:</strong> ${lcs.length}\n\n`;
    html += `<strong>LCS:</strong> ${lcs.length > 0 ? lcs : '(none)'}\n\n`;
    html += `<strong>First String:</strong> <br>${highlighted.s1}\n\n`;
    html += `<strong>Second String:</strong> <br>${highlighted.s2}\n\n`;
    resultDiv.innerHTML = html;

    // Render the DP table with highlight path
    const table = renderDPTable(dp, s1, s2, lcs);
    resultDiv.appendChild(document.createElement('hr'));
    const tableTitle = document.createElement('p');
    tableTitle.innerHTML = '<em>DP Table showing lengths of LCS substrings. Highlighted cells show the path for one LCS.</em>';
    resultDiv.appendChild(tableTitle);
    resultDiv.appendChild(table);
  });
</script>
</body>
</html>