<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Linked List Visualization & Demo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f0f4f8;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 5px;
    }
    #container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      padding: 20px 30px 40px 30px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .controls {
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: center;
    }
    .controls > * {
      font-size: 16px;
    }
    input[type="number"] {
      width: 80px;
      padding: 6px 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
    }
    button {
      background-color: #007bff;
      border: none;
      color: white;
      padding: 8px 14px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s ease;
    }
    button:hover:not(:disabled) {
      background-color: #0056b3;
    }
    button:disabled {
      background-color: #7a9cc6;
      cursor: not-allowed;
    }
    #listContainer {
      margin-top: 30px;
      min-height: 80px;
      border: 2px solid #ddd;
      background: #fafafa;
      border-radius: 8px;
      padding: 20px;
      display: flex;
      align-items: center;
      overflow-x: auto;
      user-select: none;
    }
    .node {
      background-color: #3178c6;
      color: white;
      min-width: 50px;
      height: 50px;
      line-height: 50px;
      border-radius: 6px;
      margin-right: 30px;
      text-align: center;
      font-weight: 700;
      font-size: 18px;
      position: relative;
      flex-shrink: 0;
      box-shadow: 0 3px 8px rgba(31, 78, 121, 0.6);
    }
    .node::after {
      content: '';
      position: absolute;
      top: 50%;
      right: -30px;
      width: 24px;
      height: 2px;
      background-color: #3178c6;
      transform: translateY(-50%);
    }
    .node:last-child::after {
      content: 'null';
      color: #999;
      font-size: 12px;
      font-weight: 400;
      position: absolute;
      top: 50%;
      right: -55px;
      transform: translateY(-50%);
      background: transparent;
      width: auto;
      height: auto;
    }
    #log {
      margin-top: 30px;
      background: #222;
      color: #0f0;
      font-family: monospace;
      font-size: 14px;
      height: 130px;
      border-radius: 6px;
      padding: 10px;
      overflow-y: auto;
    }
    label {
      font-weight: 600;
    }
    @media (max-width: 600px) {
      body {
        margin: 10px;
      }
      #container {
        padding: 15px;
      }
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      button, input[type=number] {
        width: 100%;
      }
      .node {
        margin-right: 20px;
        min-width: 45px;
        height: 45px;
        line-height: 45px;
        font-size: 16px;
      }
      .node::after {
        right: -25px;
        width: 18px;
      }
      .node:last-child::after {
        right: -40px;
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <div id="container">
    <h1>Singly Linked List Demo & Visualization</h1>
    <div class="controls" aria-label="Linked List Controls">
      <label for="inputValue">Value:</label>
      <input type="number" id="inputValue" placeholder="Enter number" aria-describedby="inputHelp" />
      <button id="btnAddFront" title="Add node at the front">Add Front</button>
      <button id="btnAddBack" title="Add node at the end">Add Back</button>
      <button id="btnRemoveFront" title="Remove node from the front">Remove Front</button>
      <button id="btnRemoveBack" title="Remove node from the end">Remove Back</button>
      <label for="inputIndex" style="margin-left: 16px;">Index:</label>
      <input type="number" id="inputIndex" placeholder="0-based" min="0" />
      <button id="btnRemoveAt" title="Remove node at index">Remove At</button>
      <button id="btnInsertAt" title="Insert node at index">Insert At</button>
      <button id="btnClear" title="Clear the entire list" style="background-color:#d9534f;">Clear List</button>
    </div>
    <div id="listContainer" aria-live="polite" aria-label="Linked List visualization" tabindex="0">
      <!-- Nodes will appear here -->
    </div>
    <h2>Operations Log</h2>
    <pre id="log" role="log" aria-live="polite"></pre>
  </div>

  <script>
    // Singly Linked List Implementation and Visualization
    class Node {
      constructor(value) {
        this.value = value;
        this.next = null;
      }
    }

    class LinkedList {
      constructor() {
        this.head = null;
        this.size = 0;
      }

      addFront(value) {
        const newNode = new Node(value);
        newNode.next = this.head;
        this.head = newNode;
        this.size++;
      }

      addBack(value) {
        const newNode = new Node(value);
        if (!this.head) {
          this.head = newNode;
        } else {
          let current = this.head;
          while (current.next) {
            current = current.next;
          }
          current.next = newNode;
        }
        this.size++;
      }

      removeFront() {
        if (!this.head) return null;
        const removed = this.head;
        this.head = this.head.next;
        this.size--;
        return removed.value;
      }

      removeBack() {
        if (!this.head) return null;
        if (!this.head.next) {
          const val = this.head.value;
          this.head = null;
          this.size--;
          return val;
        }
        let current = this.head;
        while (current.next && current.next.next) {
          current = current.next;
        }
        const val = current.next.value;
        current.next = null;
        this.size--;
        return val;
      }

      removeAt(index) {
        if (index < 0 || index >= this.size) {
          return null;
        }
        if (index === 0) {
          return this.removeFront();
        }
        let current = this.head;
        let prev = null;
        let count = 0;
        while (count < index) {
          prev = current;
          current = current.next;
          count++;
        }
        prev.next = current.next;
        this.size--;
        return current.value;
      }

      insertAt(value, index) {
        if (index < 0 || index > this.size) {
          return false;
        }
        if (index === 0) {
          this.addFront(value);
          return true;
        }
        if (index === this.size) {
          this.addBack(value);
          return true;
        }
        let newNode = new Node(value);
        let current = this.head;
        let prev = null;
        let count = 0;
        while (count < index) {
          prev = current;
          current = current.next;
          count++;
        }
        newNode.next = current;
        prev.next = newNode;
        this.size++;
        return true;
      }

      toArray() {
        let arr = [];
        let current = this.head;
        while (current) {
          arr.push(current.value);
          current = current.next;
        }
        return arr;
      }

      clear() {
        this.head = null;
        this.size = 0;
      }
    }

    const linkedList = new LinkedList();

    // DOM Elements
    const inputValue = document.getElementById("inputValue");
    const inputIndex = document.getElementById("inputIndex");
    const btnAddFront = document.getElementById("btnAddFront");
    const btnAddBack = document.getElementById("btnAddBack");
    const btnRemoveFront = document.getElementById("btnRemoveFront");
    const btnRemoveBack = document.getElementById("btnRemoveBack");
    const btnRemoveAt = document.getElementById("btnRemoveAt");
    const btnInsertAt = document.getElementById("btnInsertAt");
    const btnClear = document.getElementById("btnClear");
    const listContainer = document.getElementById("listContainer");
    const log = document.getElementById("log");

    // Utility: Log messages
    function addLog(message) {
      const time = new Date().toLocaleTimeString();
      log.textContent += `[${time}] ${message}\n`;
      log.scrollTop = log.scrollHeight;
    }

    // Utility: Render the linked list nodes visually
    function renderList() {
      listContainer.innerHTML = '';
      if (linkedList.size === 0) {
        listContainer.textContent = 'List is empty (null)';
        return;
      }
      let current = linkedList.head;
      while (current) {
        const nodeDiv = document.createElement('div');
        nodeDiv.className = 'node';
        nodeDiv.textContent = current.value;
        listContainer.appendChild(nodeDiv);
        current = current.next;
      }
    }

    // Get integer from inputValue with validation
    function getInputNumber() {
      const val = inputValue.value.trim();
      if (val === '') {
        alert('Please enter a value first.');
        return null;
      }
      const num = Number(val);
      if (Number.isNaN(num)) {
        alert('Invalid number input.');
        return null;
      }
      return num;
    }

    // Get integer from inputIndex with validation and range check
    function getIndex(allowSize = false) {
      const val = inputIndex.value.trim();
      if (val === '') {
        alert('Please enter an index.');
        return null;
      }
      const num = Number(val);
      if (!Number.isInteger(num) || num < 0) {
        alert('Index must be an integer >= 0.');
        return null;
      }
      if (allowSize) {
        if (num > linkedList.size) {
          alert(`Index must be between 0 and ${linkedList.size}.`);
          return null;
        }
      } else {
        if (num >= linkedList.size) {
          alert(`Index must be between 0 and ${linkedList.size - 1}.`);
          return null;
        }
      }
      return num;
    }

    // Event handlers:
    btnAddFront.addEventListener('click', () => {
      const val = getInputNumber();
      if (val === null) return;
      linkedList.addFront(val);
      addLog(`Added ${val} at the front.`);
      renderList();
      inputValue.value = '';
    });

    btnAddBack.addEventListener('click', () => {
      const val = getInputNumber();
      if (val === null) return;
      linkedList.addBack(val);
      addLog(`Added ${val} at the back.`);
      renderList();
      inputValue.value = '';
    });

    btnRemoveFront.addEventListener('click', () => {
      if (linkedList.size === 0) {
        alert('List is already empty.');
        return;
      }
      const removed = linkedList.removeFront();
      addLog(`Removed ${removed} from the front.`);
      renderList();
    });

    btnRemoveBack.addEventListener('click', () => {
      if (linkedList.size === 0) {
        alert('List is already empty.');
        return;
      }
      const removed = linkedList.removeBack();
      addLog(`Removed ${removed} from the back.`);
      renderList();
    });

    btnRemoveAt.addEventListener('click', () => {
      if (linkedList.size === 0) {
        alert('List is empty.');
        return;
      }
      const idx = getIndex(false);
      if (idx === null) return;
      const removed = linkedList.removeAt(idx);
      if (removed === null) {
        alert('Invalid index.');
        return;
      }
      addLog(`Removed value ${removed} at index ${idx}.`);
      renderList();
      inputIndex.value = '';
    });

    btnInsertAt.addEventListener('click', () => {
      if (linkedList.size === 0 && inputIndex.value.trim() !== '0') {
        alert('List is empty, you can only insert at index 0.');
        return;
      }
      const val = getInputNumber();
      if (val === null) return;
      const idx = getIndex(true);
      if (idx === null) return;
      const success = linkedList.insertAt(val, idx);
      if (!success) {
        alert('Invalid index for insertion.');
        return;
      }
      addLog(`Inserted value ${val} at index ${idx}.`);
      renderList();
      inputValue.value = '';
      inputIndex.value = '';
    });

    btnClear.addEventListener('click', () => {
      if (linkedList.size === 0) {
        alert('List is already empty.');
        return;
      }
      if (!confirm('Are you sure you want to clear the entire list?')) {
        return;
      }
      linkedList.clear();
      addLog('Cleared the list.');
      renderList();
      inputValue.value = '';
      inputIndex.value = '';
    });

    // Initial render of empty
    renderList();
    addLog('Initialized empty linked list.');
  </script>
</body>
</html>