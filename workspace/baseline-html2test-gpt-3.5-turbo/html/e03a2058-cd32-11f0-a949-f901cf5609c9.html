<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Selection Sort Demo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f5f5f5;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      margin-bottom: 0.2em;
      color: #444;
    }
    #arrayContainer {
      margin: 20px 0;
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
      max-width: 600px;
    }
    .bar {
      background-color: #69a3ff;
      height: 40px;
      width: 40px;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-weight: bold;
      border-radius: 4px;
      user-select: none;
      transition: background-color 0.3s ease;
      position: relative;
    }
    .bar.current {
      background-color: #efa530;
    }
    .bar.min {
      background-color: #e84545;
    }
    .bar.sorted {
      background-color: #62c370;
    }
    #controls {
      margin-bottom: 15px;
    }
    button, input[type=number] {
      font-size: 1rem;
      padding: 8px 12px;
      margin: 0 5px 10px 0;
    }
    #speedLabel {
      margin-left: 8px;
      font-size: 0.9rem;
      vertical-align: middle;
    }
    #explanation {
      max-width: 620px;
      background: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      line-height: 1.5;
    }
    a {
      color: #2673e6;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <h1>Selection Sort Visualization</h1>
  <div id="controls">
    <label for="arraySize">Array size:</label>
    <input type="number" id="arraySize" min="5" max="50" value="15" />
    <button id="generateBtn">Generate New Array</button>
    <button id="sortBtn">Start Selection Sort</button>
    <label for="speedRange">Speed:</label>
    <input type="range" id="speedRange" min="100" max="2000" step="100" value="500" />
    <span id="speedLabel">500 ms</span>
  </div>
  <div id="arrayContainer"></div>
  <div id="explanation">
    <h2>What is Selection Sort?</h2>
    <p>
      Selection sort is a simple comparison-based sorting algorithm.
      It works by repeatedly selecting the minimum element from the unsorted portion of the array and swapping it with the first unsorted element.
    </p>
    <ol>
      <li>Start from the first element, consider it as the minimum.</li>
      <li>Check the rest of the array to find a smaller element.</li>
      <li>If found, update the minimum index.</li>
      <li>After checking the entire unsorted portion, swap the minimum element with the current element.</li>
      <li>Move to the next element and repeat until the array is sorted.</li>
    </ol>
    <p>This visualization highlights:</p>
    <ul>
      <li><span style="background:#efa530;color:white;padding:2px 6px;border-radius:3px;">Orange</span> bar: current element being considered.</li>
      <li><span style="background:#e84545;color:white;padding:2px 6px;border-radius:3px;">Red</span> bar: current minimum in the unsorted portion.</li>
      <li><span style="background:#62c370;color:white;padding:2px 6px;border-radius:3px;">Green</span> bars: already correctly placed sorted elements.</li>
    </ul>
    <p>Learn more on <a href="https://en.wikipedia.org/wiki/Selection_sort" target="_blank" rel="noopener noreferrer">Wikipedia</a>.</p>
  </div>

  <script>
    const arrayContainer = document.getElementById('arrayContainer');
    const generateBtn = document.getElementById('generateBtn');
    const sortBtn = document.getElementById('sortBtn');
    const arraySizeInput = document.getElementById('arraySize');
    const speedRange = document.getElementById('speedRange');
    const speedLabel = document.getElementById('speedLabel');

    let array = [];
    let bars = [];
    let sorting = false;

    function generateRandomArray(size) {
      const arr = [];
      for (let i = 0; i < size; i++) {
        arr.push(Math.floor(Math.random() * 100) + 1); // Values from 1 to 100
      }
      return arr;
    }

    function renderArray(arr) {
      arrayContainer.innerHTML = '';
      bars = [];
      arr.forEach(value => {
        const bar = document.createElement('div');
        bar.classList.add('bar');
        bar.style.height = `${value * 3}px`; // Scale height for better visuals
        bar.textContent = value;
        arrayContainer.appendChild(bar);
        bars.push(bar);
      });
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function selectionSort(arr) {
      sorting = true;
      const n = arr.length;

      for(let i = 0; i < n - 1; i++){
        let minIdx = i;
        updateColors(i, minIdx, n);

        for(let j = i + 1; j < n; j++){
          updateColors(i, minIdx, n, j);
          await sleep(speedRange.value);

          if(arr[j] < arr[minIdx]){
            minIdx = j;
            updateColors(i, minIdx, n, j);
            await sleep(speedRange.value);
          }
        }

        if(minIdx !== i){
          // Swap in array
          [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];

          // Swap in DOM text and height
          bars[i].style.height = `${arr[i] * 3}px`;
          bars[i].textContent = arr[i];
          bars[minIdx].style.height = `${arr[minIdx] * 3}px`;
          bars[minIdx].textContent = arr[minIdx];
        }

        updateColors(i+1, i+1, n);
        await sleep(speedRange.value);
      }

      // Mark last element as sorted
      updateColors(n, -1, n);

      sorting = false;
    }

    function updateColors(current, minIdx, total, checking = -1){
      // Reset all colors first
      for(let k=0; k < total; k++){
        bars[k].classList.remove('current', 'min', 'sorted');
        if(k < current){
          bars[k].classList.add('sorted');
        }
      }
      if(current < total)
        bars[current].classList.add('current');
      if(minIdx >= 0 && minIdx < total)
        bars[minIdx].classList.add('min');
      if(checking >= 0 && checking < total && checking !== current && checking !== minIdx)
        bars[checking].style.backgroundColor = '#f0b28a'; // lighter orange to show checking
      // Remove checking style from others not part of current/min
      for(let k = 0; k < total; k++){
        if(k !== checking && k !== minIdx && k !== current && k >= current){
          bars[k].style.backgroundColor = '#69a3ff';
        }
      }
    }

    generateBtn.addEventListener('click', () => {
      if(sorting) return;
      const size = parseInt(arraySizeInput.value);
      if(size < 5 || size > 50){
        alert("Please enter array size between 5 and 50.");
        return;
      }
      array = generateRandomArray(size);
      renderArray(array);
    });

    sortBtn.addEventListener('click', async () => {
      if(sorting) return;
      if(array.length === 0){
        alert("Generate an array first!");
        return;
      }
      sortBtn.disabled = true;
      generateBtn.disabled = true;
      arraySizeInput.disabled = true;
      speedRange.disabled = true;
      await selectionSort(array);
      sortBtn.disabled = false;
      generateBtn.disabled = false;
      arraySizeInput.disabled = false;
      speedRange.disabled = false;
    });

    speedRange.addEventListener('input', () => {
      speedLabel.textContent = speedRange.value + " ms";
    });

    // Initialize on load
    window.onload = () => {
      array = generateRandomArray(parseInt(arraySizeInput.value));
      renderArray(array);
    };
  </script>
</body>
</html>