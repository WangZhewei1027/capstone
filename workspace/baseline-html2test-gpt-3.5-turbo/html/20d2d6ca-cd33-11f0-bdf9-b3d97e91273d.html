<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Knapsack Problem Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 1em;
    background: #f0f4f8;
    color: #222;
  }
  h1 {
    text-align: center;
    margin-bottom: 0.2em;
  }
  #container {
    max-width: 900px;
    margin: 0 auto;
    background: white;
    padding: 1em 2em 2em 2em;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgb(0 0 0 / 0.1);
  }
  label {
    display: inline-block;
    margin: 0.3em 0 0.8em 0;
  }
  input[type="number"] {
    width: 80px;
    padding: 0.3em;
    margin-left: 0.5em;
  }
  input[type="text"] {
    width: 150px;
    padding: 0.3em;
    margin-left: 0.5em;
  }
  button {
    margin-top: 1em;
    padding: 0.5em 1.2em;
    font-size: 1em;
    cursor: pointer;
    border:none;
    border-radius: 4px;
    background-color: #0077cc;
    color: white;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #005fa3;
  }
  #itemsTable {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1em;
  }
  #itemsTable th,
  #itemsTable td {
    border: 1px solid #ccc;
    padding: 0.5em 0.7em;
    text-align: center;
  }
  #itemsTable th {
    background-color: #0077cc;
    color: white;
  }
  #result {
    margin-top: 1.5em;
    font-size: 1.1em;
    background: #e3f2fd;
    padding: 1em;
    border-radius: 6px;
    min-height: 4em;
  }
  #error {
    color: #b00020;
    margin-top: 0.5em;
    font-weight: bold;
  }
  #addItemSection {
    margin-top: 1em;
    border-top: 1px solid #ddd;
    padding-top: 1em;
  }
  @media (max-width:600px){
    input[type="number"], input[type="text"] {
      width: 100%;
      margin-left: 0;
      margin-bottom: 0.7em;
    }
    label {
      display: block;
    }
    button {
      width: 100%;
    }
  }
</style>
</head>
<body>
<div id="container">
  <h1>0/1 Knapsack Problem Solver</h1>
  <p>Enter the knapsack capacity and add items (weight and value). Then click "Solve" to find the optimal selection maximizing value without exceeding capacity.</p>

  <label>
    Knapsack Capacity:
    <input type="number" id="capacityInput" min="1" value="50" />
  </label>

  <table id="itemsTable">
    <thead>
      <tr>
        <th>#</th>
        <th>Item Name</th>
        <th>Weight</th>
        <th>Value</th>
        <th>Remove</th>
      </tr>
    </thead>
    <tbody id="itemsBody">
      <!-- Items go here -->
    </tbody>
  </table>

  <div id="addItemSection">
    <h3>Add Item</h3>
    <label>
      Name:
      <input type="text" id="itemNameInput" placeholder="Item Name" />
    </label>
    <label>
      Weight:
      <input type="number" id="itemWeightInput" min="1" />
    </label>
    <label>
      Value:
      <input type="number" id="itemValueInput" min="0" />
    </label>
    <button id="addItemBtn">Add Item</button>
    <div id="error"></div>
  </div>

  <button id="solveBtn">Solve</button>

  <div id="result"></div>
</div>

<script>
(() => {
  const capacityInput = document.getElementById('capacityInput');
  const itemsBody = document.getElementById('itemsBody');
  const addItemBtn = document.getElementById('addItemBtn');
  const solveBtn = document.getElementById('solveBtn');
  const resultDiv = document.getElementById('result');
  const errorDiv = document.getElementById('error');
  const itemNameInput = document.getElementById('itemNameInput');
  const itemWeightInput = document.getElementById('itemWeightInput');
  const itemValueInput = document.getElementById('itemValueInput');

  let items = [
    {name: 'Item 1', weight: 10, value: 60},
    {name: 'Item 2', weight: 20, value: 100},
    {name: 'Item 3', weight: 30, value: 120},
  ];

  function renderItems() {
    itemsBody.innerHTML = '';
    if (items.length === 0) {
      const tr = document.createElement('tr');
      const td = document.createElement('td');
      td.colSpan = 5;
      td.style.fontStyle = 'italic';
      td.textContent = 'No items added. Add items below.';
      tr.appendChild(td);
      itemsBody.appendChild(tr);
      return;
    }
    items.forEach((item, i) => {
      const tr = document.createElement('tr');

      const tdIndex = document.createElement('td');
      tdIndex.textContent = i + 1;

      const tdName = document.createElement('td');
      tdName.textContent = item.name;

      const tdWeight = document.createElement('td');
      tdWeight.textContent = item.weight;

      const tdValue = document.createElement('td');
      tdValue.textContent = item.value;

      const tdRemove = document.createElement('td');
      const removeBtn = document.createElement('button');
      removeBtn.textContent = 'âœ–';
      removeBtn.title = 'Remove item';
      removeBtn.style.cursor = 'pointer';
      removeBtn.style.background = 'transparent';
      removeBtn.style.border = 'none';
      removeBtn.style.color = '#b00020';
      removeBtn.style.fontSize = '1.2em';
      removeBtn.onclick = () => {
        items.splice(i, 1);
        renderItems();
        resultDiv.textContent = '';
        errorDiv.textContent = '';
      }
      tdRemove.appendChild(removeBtn);

      tr.append(tdIndex, tdName, tdWeight, tdValue, tdRemove);
      itemsBody.appendChild(tr);
    });
  }

  function validateInputs() {
    errorDiv.textContent = '';
    let valid = true;

    const capacity = Number(capacityInput.value);
    if (!capacity || capacity < 1 || !Number.isInteger(capacity)) {
      errorDiv.textContent = 'Knapsack capacity must be a positive integer.';
      valid = false;
    }

    for (let i = 0; i < items.length; i++) {
      const it = items[i];
      if (it.weight <= 0 || !Number.isInteger(it.weight)) {
        errorDiv.textContent = `Item #${i+1} weight must be a positive integer.`;
        valid = false;
        break;
      }
      if (it.value < 0 || !Number.isInteger(it.value)) {
        errorDiv.textContent = `Item #${i+1} value must be a non-negative integer.`;
        valid = false;
        break;
      }
      if (it.name.trim() === '') {
        errorDiv.textContent = `Item #${i+1} must have a name.`;
        valid = false;
        break;
      }
    }

    if (items.length === 0) {
      errorDiv.textContent = 'Please add at least one item.';
      valid = false;
    }

    return valid;
  }

  function knapsack01(capacity, weights, values) {
    // Classic DP solution for 0/1 knapsack
    // Returns { maxValue, selectedIndices }
    const n = weights.length;
    const dp = Array(n + 1).fill(null).map(() => Array(capacity + 1).fill(0));

    for (let i = 1; i <= n; i++) {
      const w = weights[i-1];
      const v = values[i-1];
      for (let c = 0; c <= capacity; c++) {
        if (w > c) {
          dp[i][c] = dp[i-1][c];
        } else {
          dp[i][c] = Math.max(dp[i-1][c], dp[i-1][c-w] + v);
        }
      }
    }

    // Backtracking to find which items are selected
    let maxValue = dp[n][capacity];
    let c = capacity;
    const selectedIndices = [];
    for (let i = n; i > 0 && maxValue > 0; i--) {
      if (maxValue !== dp[i-1][c]) {
        // item was selected
        selectedIndices.push(i-1);
        maxValue -= values[i-1];
        c -= weights[i-1];
      }
    }
    selectedIndices.reverse();

    return {
      maxValue: dp[n][capacity],
      selectedIndices: selectedIndices
    };
  }

  // Event listeners
  addItemBtn.onclick = () => {
    errorDiv.textContent = '';
    let name = itemNameInput.value.trim();
    let weight = Number(itemWeightInput.value);
    let value = Number(itemValueInput.value);

    if (name === '') {
      errorDiv.textContent = 'Item name cannot be empty.';
      return;
    }
    if (!weight || weight < 1 || !Number.isInteger(weight)) {
      errorDiv.textContent = 'Item weight must be a positive integer.';
      return;
    }
    if (value === '' || value < 0 || !Number.isInteger(value)) {
      errorDiv.textContent = 'Item value must be an integer 0 or greater.';
      return;
    }

    items.push({name, weight, value});
    renderItems();
    itemNameInput.value = '';
    itemWeightInput.value = '';
    itemValueInput.value = '';
    resultDiv.textContent = '';
  };

  solveBtn.onclick = () => {
    resultDiv.textContent = '';
    if (!validateInputs()) return;

    const capacity = Number(capacityInput.value);
    const weights = items.map(it => it.weight);
    const values = items.map(it => it.value);

    // To avoid UI blocking on large inputs, we could run in a worker or asynchronously,
    // but here, problem is small enough for demo.
    const startTime = performance.now();
    const solution = knapsack01(capacity, weights, values);
    const endTime = performance.now();

    if (solution.selectedIndices.length === 0) {
      resultDiv.textContent = `No items can be selected within the capacity of ${capacity}.`;
      return;
    }

    let totalWeight = 0;
    let totalValue = 0;
    let selectedItemsText = solution.selectedIndices.map(i => {
      const it = items[i];
      totalWeight += it.weight;
      totalValue += it.value;
      return `${it.name} (w:${it.weight}, v:${it.value})`;
    }).join(', ');

    resultDiv.innerHTML =
      `<strong>Optimal value: ${solution.maxValue}</strong><br>` +
      `<strong>Total weight used:</strong> ${totalWeight} / ${capacity}<br>` +
      `<strong>Selected items:</strong> ${selectedItemsText}<br>` +
      `<em>Computed in ${(endTime - startTime).toFixed(2)} ms</em>`;
  };

  // Initial render
  renderItems();
})();
</script>

</body>
</html>