<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Priority Queue Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2rem;
    max-width: 600px;
  }
  h1 {
    text-align: center;
  }
  label {
    display: block;
    margin-top: 1rem;
  }
  input[type="text"], input[type="number"] {
    padding: 0.4rem;
    font-size: 1rem;
    width: 100%;
    box-sizing: border-box;
    margin-top: 0.3rem;
  }
  button {
    margin-top: 1rem;
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    cursor: pointer;
  }
  .queue-display {
    margin-top: 2rem;
    border: 1px solid #ddd;
    padding: 1rem;
    background: #f9f9f9;
    min-height: 60px;
  }
  .queue-item {
    display: inline-block;
    background: #007bfd;
    color: white;
    padding: 0.4rem 0.8rem;
    margin: 0 0.3rem 0.3rem 0;
    border-radius: 4px;
  }
  .queue-item.low {
    background: #57a757;
  }
  .queue-item.medium {
    background: #f0ad4e;
  }
  .queue-item.high {
    background: #d9534f;
  }
  .log {
    margin-top: 2rem;
    border: 1px solid #ccc;
    background: #fff;
    padding: 1rem;
    height: 150px;
    overflow-y: auto;
    font-family: monospace;
    font-size: 0.9rem;
  }
</style>
</head>
<body>
<h1>Priority Queue Demo</h1>
<form id="enqueueForm">
  <label for="value">Value (string):</label>
  <input type="text" id="value" name="value" required placeholder="Enter item value" />
  
  <label for="priority">Priority (integer, lower = higher priority):</label>
  <input type="number" id="priority" name="priority" required min="0" value="0" />
  
  <button type="submit">Enqueue</button>
</form>

<button id="dequeueBtn" style="margin-top:1rem;">Dequeue</button>

<h2>Queue contents (from highest to lowest priority):</h2>
<div class="queue-display" id="queueDisplay">Queue is empty</div>

<h2>Action Log:</h2>
<div class="log" id="log"></div>

<script>
class PriorityQueue {
  constructor() {
    this._elements = [];
  }
  
  enqueue(value, priority) {
    const element = {value, priority};
    // Insert keeping priority order (lower priority value first)
    if (this.isEmpty()) {
      this._elements.push(element);
    } else {
      // Find correct spot to insert
      let added = false;
      for (let i = 0; i < this._elements.length; i++) {
        if (priority < this._elements[i].priority) {
          this._elements.splice(i, 0, element);
          added = true;
          break;
        }
      }
      if (!added) this._elements.push(element);
    }
  }

  dequeue() {
    if(this.isEmpty()) return null;
    return this._elements.shift();
  }

  peek() {
    if(this.isEmpty()) return null;
    return this._elements[0];
  }

  isEmpty() {
    return this._elements.length === 0;
  }

  size() {
    return this._elements.length;
  }

  toArray() {
    // Return copy to avoid external mutation
    return this._elements.slice();
  }
}

const pq = new PriorityQueue();
const enqueueForm = document.getElementById('enqueueForm');
const dequeueBtn = document.getElementById('dequeueBtn');
const queueDisplay = document.getElementById('queueDisplay');
const log = document.getElementById('log');

function priorityLabel(priority) {
  // Return a label class for visual color coding
  if(priority <= 1) return 'high';
  if(priority <= 4) return 'medium';
  return 'low';
}

function renderQueue() {
  const items = pq.toArray();
  if (items.length === 0) {
    queueDisplay.textContent = 'Queue is empty';
    return;
  }
  queueDisplay.innerHTML = '';
  items.forEach(el => {
    const div = document.createElement('span');
    div.textContent = `${el.value} (p:${el.priority})`;
    div.className = `queue-item ${priorityLabel(el.priority)}`;
    queueDisplay.appendChild(div);
  });
}

function logAction(text) {
  const now = new Date();
  const time = now.toLocaleTimeString();
  log.textContent = `[${time}] ${text}\n` + log.textContent;
}

enqueueForm.addEventListener('submit', e => {
  e.preventDefault();
  const value = enqueueForm.value.value.trim();
  const priority = parseInt(enqueueForm.priority.value, 10);
  if(value === '' || isNaN(priority)) {
    alert('Please provide valid value and priority.');
    return;
  }
  pq.enqueue(value, priority);
  renderQueue();
  logAction(`Enqueued "${value}" with priority ${priority}.`);
  enqueueForm.reset();
  enqueueForm.priority.value = 0;
  enqueueForm.value.focus();
});

dequeueBtn.addEventListener('click', () => {
  if(pq.isEmpty()) {
    alert('Queue is empty! Nothing to dequeue.');
    return;
  }
  const removed = pq.dequeue();
  renderQueue();
  logAction(`Dequeued "${removed.value}" with priority ${removed.priority}.`);
});

renderQueue();
</script>
</body>
</html>