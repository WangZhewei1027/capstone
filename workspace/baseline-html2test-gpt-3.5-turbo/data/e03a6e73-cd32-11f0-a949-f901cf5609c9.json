{
  "id": "e03a6e73-cd32-11f0-a949-f901cf5609c9",
  "timestamp": "2025-11-29T14:52:42.560Z",
  "type": "html-to-test",
  "htmlModel": "gpt-3.5-turbo",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Linear Regression",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<title>Linear Regression Demo</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 20px;\n    background: #f4f4f9;\n  }\n  h1 {\n    text-align: center;\n    margin-bottom: 5px;\n  }\n  #container {\n    max-width: 700px;\n    margin: 0 auto;\n    background: white;\n    padding: 20px;\n    border-radius: 8px;\n    box-shadow: 0 0 10px #ccc;\n  }\n  #canvasContainer {\n    position: relative;\n    margin-top: 20px;\n    border: 1px solid #ccc;\n    background: #fff;\n  }\n  canvas {\n    display: block;\n    margin: 0 auto;\n  }\n  #instructions {\n    margin-top: 0;\n    text-align: center;\n  }\n  button {\n    margin-top: 10px;\n    cursor: pointer;\n    background: #007bff;\n    border: none;\n    color: white;\n    padding: 10px 20px;\n    border-radius: 5px;\n    font-size: 1rem;\n  }\n  button:hover {\n    background: #0056b3;\n  }\n  #info {\n    margin-top: 15px;\n    font-weight: bold;\n    text-align: center;\n  }\n  #equation {\n    font-family: monospace;\n    font-size: 1.2em;\n    margin-top: 10px;\n    text-align: center;\n    color: #333;\n  }\n</style>\n</head>\n<body>\n<div id=\"container\">\n  <h1>Interactive Linear Regression Demo</h1>\n  <p id=\"instructions\">Click on the canvas to add data points. The blue line is the regression line fitted to the points.</p>\n  <div id=\"canvasContainer\">\n    <canvas id=\"plot\" width=\"700\" height=\"400\"></canvas>\n  </div>\n  <div id=\"equation\">y = ?x + ?</div>\n  <div id=\"info\"></div>\n  <button id=\"clearBtn\">Clear Points</button>\n</div>\n\n<script>\n// This demo lets user add points on a 700x400 canvas. We'll fit a linear regression line (y = mx + b)\n// to the points using least squares and update the line dynamically.\n\nconst canvas = document.getElementById(\"plot\");\nconst ctx = canvas.getContext(\"2d\");\nconst WIDTH = canvas.width;\nconst HEIGHT = canvas.height;\n\nlet points = []; // store points as {x, y} in data coordinates\n// Data coordinates will be normalized canvas coordinates with origin bottom-left, and range defined by min/max in input points.\n\nconst margin = 40;\n\n// Coordinate system:\n// We'll map canvas pixels [margin, WIDTH-margin] horizontally to x range\n// and [HEIGHT-margin, margin] vertically to y range (y axis flipped so larger y is upward)\n\n// When no points exist, we'll assume range 0-10 on both axes for display and example.\n\n// We'll store points in \"data coordinates\" that correspond to the plot range.\n\n// Helper to map data coords to canvas coords:\nfunction dataToCanvas(x, y, xMin, xMax, yMin, yMax) {\n  // x,y are data coords\n  // returns canvas pixel coords\n  let cx = margin + ((x - xMin) / (xMax - xMin)) * (WIDTH - 2 * margin);\n  // invert y axis to canvas coords\n  let cy = HEIGHT - margin - ((y - yMin) / (yMax - yMin)) * (HEIGHT - 2 * margin);\n  return { cx, cy };\n}\n\n// Helper to map canvas coords to data coords:\nfunction canvasToData(cx, cy, xMin, xMax, yMin, yMax) {\n  let x = xMin + ((cx - margin) / (WIDTH - 2 * margin)) * (xMax - xMin);\n  let y = yMin + ((HEIGHT - margin - cy) / (HEIGHT - 2 * margin)) * (yMax - yMin);\n  return { x, y };\n}\n\n// Regression function OLS (ordinary least squares) to compute slope and intercept\nfunction linearRegression(points) {\n  // points: array of {x,y}\n  const n = points.length;\n  if (n === 0) return null;\n  let sumX = 0,\n    sumY = 0,\n    sumXY = 0,\n    sumXX = 0;\n  for (const p of points) {\n    sumX += p.x;\n    sumY += p.y;\n    sumXY += p.x * p.y;\n    sumXX += p.x * p.x;\n  }\n  const meanX = sumX / n;\n  const meanY = sumY / n;\n  const denominator = sumXX - sumX * meanX;\n  if (denominator === 0) {\n    // Vertical or undefined slope, return slope 0 (horizontal) as fallback\n    return { m: 0, b: meanY };\n  }\n  const m = (sumXY - sumX * meanY) / denominator;\n  const b = meanY - m * meanX;\n  return { m, b };\n}\n\nfunction drawAxes(xMin, xMax, yMin, yMax) {\n  ctx.strokeStyle = \"#333\";\n  ctx.lineWidth = 1;\n  ctx.font = \"12px Arial\";\n  ctx.fillStyle = \"#333\";\n  ctx.textAlign = \"center\";\n  ctx.textBaseline = \"middle\";\n\n  // Draw X axis line\n  ctx.beginPath();\n  ctx.moveTo(margin, HEIGHT - margin);\n  ctx.lineTo(WIDTH - margin, HEIGHT - margin);\n  ctx.stroke();\n\n  // Draw Y axis line\n  ctx.beginPath();\n  ctx.moveTo(margin, HEIGHT - margin);\n  ctx.lineTo(margin, margin);\n  ctx.stroke();\n\n  // Draw ticks and labels\n  const nTicks = 10;\n  // X axis ticks\n  for(let i=0; i<=nTicks; i++) {\n    let xVal = xMin + (i/nTicks)*(xMax - xMin);\n    let cx = margin + (i/nTicks)*(WIDTH - 2*margin);\n    ctx.beginPath();\n    ctx.moveTo(cx, HEIGHT - margin);\n    ctx.lineTo(cx, HEIGHT - margin + 6);\n    ctx.stroke();\n    ctx.fillText(xVal.toFixed(2), cx, HEIGHT - margin + 18);\n  }\n\n  // Y axis ticks\n  ctx.textAlign = \"right\";\n  for(let i=0; i<=nTicks; i++) {\n    let yVal = yMin + (i/nTicks)*(yMax - yMin);\n    let cy = HEIGHT - margin - (i/nTicks)*(HEIGHT - 2*margin);\n    ctx.beginPath();\n    ctx.moveTo(margin, cy);\n    ctx.lineTo(margin - 6, cy);\n    ctx.stroke();\n    ctx.fillText(yVal.toFixed(2), margin - 8, cy);\n  }\n}\n\n// Draw points and regression line\nfunction draw() {\n  ctx.clearRect(0, 0, WIDTH, HEIGHT);\n\n  if (points.length === 0) {\n    // no data default ranges\n    drawAxes(0, 10, 0, 10);\n    ctx.fillStyle = \"#666\";\n    ctx.textAlign = \"center\";\n    ctx.fillText(\"Click on canvas to add data points\", WIDTH/2, HEIGHT/2);\n    document.getElementById(\"equation\").textContent = \"y = ?x + ?\";\n    document.getElementById(\"info\").textContent = \"\";\n    return;\n  }\n\n  // Determine range with margins for nice spacing\n  let xs = points.map(p => p.x);\n  let ys = points.map(p => p.y);\n  let xMin = Math.min(...xs);\n  let xMax = Math.max(...xs);\n  let yMin = Math.min(...ys);\n  let yMax = Math.max(...ys);\n\n  // Add 10% margin on each side\n  let xRange = xMax - xMin || 1; // avoid zero range\n  let yRange = yMax - yMin || 1;\n  xMin -= 0.1 * xRange;\n  xMax += 0.1 * xRange;\n  yMin -= 0.1 * yRange;\n  yMax += 0.1 * yRange;\n\n  drawAxes(xMin, xMax, yMin, yMax);\n\n  // Draw points\n  ctx.fillStyle = \"#d33\";\n  for (const p of points) {\n    const { cx, cy } = dataToCanvas(p.x, p.y, xMin, xMax, yMin, yMax);\n    ctx.beginPath();\n    ctx.arc(cx, cy, 6, 0, 2 * Math.PI);\n    ctx.fill();\n  }\n\n  // Compute and draw regression line\n  const reg = linearRegression(points);\n  if (reg) {\n    const { m, b } = reg;\n\n    // Line spans full x-range:\n    const x1 = xMin;\n    const y1 = m * x1 + b;\n    const x2 = xMax;\n    const y2 = m * x2 + b;\n\n    const p1 = dataToCanvas(x1, y1, xMin, xMax, yMin, yMax);\n    const p2 = dataToCanvas(x2, y2, xMin, xMax, yMin, yMax);\n\n    ctx.strokeStyle = \"#2978b5\"; // blue line\n    ctx.lineWidth = 3;\n    ctx.beginPath();\n    ctx.moveTo(p1.cx, p1.cy);\n    ctx.lineTo(p2.cx, p2.cy);\n    ctx.stroke();\n\n    // Display equation\n    let slopeStr = m.toFixed(3);\n    let interceptStr = b.toFixed(3);\n    document.getElementById(\"equation\").textContent = `y = ${slopeStr}x + ${interceptStr}`;\n\n    // Optional additional info - R²\n    const r2 = computeR2(points, m, b);\n    document.getElementById(\"info\").textContent = `R² (coefficient of determination): ${r2.toFixed(4)}`;\n  }\n}\n\n// Compute R² = 1 - SS_res / SS_tot\nfunction computeR2(points, m, b) {\n  let meanY = points.reduce((sum, p) => sum + p.y, 0) / points.length;\n  let ssTot = 0;\n  let ssRes = 0;\n  for(const p of points) {\n    let yPred = m * p.x + b;\n    ssTot += (p.y - meanY) ** 2;\n    ssRes += (p.y - yPred) ** 2;\n  }\n  if (ssTot === 0) return 1; // all points have same y\n  return 1 - ssRes / ssTot;\n}\n\n// Add point on canvas click\ncanvas.addEventListener(\"click\", (e) => {\n  // Get canvas rect and mouse pos\n  const rect = canvas.getBoundingClientRect();\n  const cx = e.clientX - rect.left;\n  const cy = e.clientY - rect.top;\n\n  // Need range for mapping back to data. Use current points range or default 0-10\n  let xMin = 0, xMax = 10, yMin = 0, yMax = 10;\n  if (points.length) {\n    let xs = points.map(p => p.x);\n    let ys = points.map(p => p.y);\n    xMin = Math.min(...xs);\n    xMax = Math.max(...xs);\n    yMin = Math.min(...ys);\n    yMax = Math.max(...ys);\n\n    let xRange = xMax - xMin || 1;\n    let yRange = yMax - yMin || 1;\n    xMin -= 0.1 * xRange;\n    xMax += 0.1 * xRange;\n    yMin -= 0.1 * yRange;\n    yMax += 0.1 * yRange;\n  }\n\n  const dataPt = canvasToData(cx, cy, xMin, xMax, yMin, yMax);\n\n  points.push(dataPt);\n  draw();\n});\n\n// Clear button\ndocument.getElementById(\"clearBtn\").addEventListener(\"click\", () => {\n  points = [];\n  draw();\n});\n\n// Initial draw\ndraw();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Linear Regression"
    }
  ],
  "topic": "Linear Regression",
  "hasFSM": false,
  "hasTest": true
}