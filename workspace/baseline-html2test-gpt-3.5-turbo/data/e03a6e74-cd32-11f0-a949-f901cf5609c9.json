{
  "id": "e03a6e74-cd32-11f0-a949-f901cf5609c9",
  "timestamp": "2025-11-29T14:52:22.671Z",
  "type": "html-to-test",
  "htmlModel": "gpt-3.5-turbo",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "K-Nearest Neighbors (KNN)",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<title>K-Nearest Neighbors (KNN) Demo</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 1em;\n    text-align: center;\n  }\n  canvas {\n    border: 1px solid #ccc;\n    cursor: crosshair;\n    margin-bottom: 1em;\n  }\n  #info {\n    margin-bottom: 1em;\n  }\n  #controls {\n    margin-bottom: 1em;\n  }\n  .btn {\n    padding: 0.5em 1em;\n    margin: 0 0.5em;\n    cursor: pointer;\n    border: 1px solid #444;\n    border-radius: 4px;\n  }\n  input[type=\"number\"] {\n    width: 3em;\n    font-size: 1em;\n    padding: 0.2em;\n    margin-left: 0.3em;\n  }\n  .legend {\n    display: inline-block;\n    margin: 0 1em;\n    font-size: 0.9em;\n  }\n  .color-box {\n    display: inline-block;\n    width: 15px;\n    height: 15px;\n    vertical-align: middle;\n    border: 1px solid #333;\n    margin-right: 0.3em;\n  }\n</style>\n</head>\n<body>\n<h1>K-Nearest Neighbors (KNN) Interactive Demo</h1>\n<p id=\"info\">Click on the canvas to add training points. Toggle classes below. Then click \"Classify Point\" and click anywhere to classify a new point.</p>\n\n<div id=\"controls\">\n  <button id=\"classA\" class=\"btn\" style=\"background:#e74c3c;color:#fff;\">Class A</button>\n  <button id=\"classB\" class=\"btn\" style=\"background:#3498db;color:#fff;\">Class B</button>\n  <button id=\"clear\" class=\"btn\">Clear Data</button>\n  <label for=\"kInput\">K =</label>\n  <input type=\"number\" id=\"kInput\" min=\"1\" max=\"15\" value=\"3\" />\n</div>\n\n<canvas id=\"canvas\" width=\"600\" height=\"400\"></canvas>\n\n<button id=\"classifyBtn\" class=\"btn\">Classify Point</button>\n<button id=\"resetBtn\" class=\"btn\" style=\"display:none;\">Back to Editing</button>\n\n<div style=\"margin-top:1em;\">\n  <span class=\"legend\"><span class=\"color-box\" style=\"background:#e74c3c;\"></span> Class A (Red)</span>\n  <span class=\"legend\"><span class=\"color-box\" style=\"background:#3498db;\"></span> Class B (Blue)</span>\n  <span class=\"legend\"><span class=\"color-box\" style=\"background:#27ae60;\"></span> Classified Point (Green)</span>\n</div>\n\n<script>\n(() => {\n  const canvas = document.getElementById('canvas');\n  const ctx = canvas.getContext('2d');\n\n  const classAButton = document.getElementById('classA');\n  const classBButton = document.getElementById('classB');\n  const clearButton = document.getElementById('clear');\n  const classifyButton = document.getElementById('classifyBtn');\n  const resetButton = document.getElementById('resetBtn');\n  const kInput = document.getElementById('kInput');\n  const info = document.getElementById('info');\n\n  const width = canvas.width;\n  const height = canvas.height;\n  const radius = 7;\n\n  let currentClass = 'A'; // 'A' or 'B'\n  let dataPoints = []; // {x, y, class: 'A' or 'B'}\n  let classifyMode = false;\n\n  function drawPoint(x, y, cls, highlight = false) {\n    ctx.beginPath();\n    ctx.arc(x, y, radius, 0, 2 * Math.PI);\n    let color;\n    if (cls === 'A') color = '#e74c3c'; // red\n    else if (cls === 'B') color = '#3498db'; // blue\n    else if (cls === 'classified') color = '#27ae60'; // green\n    else color = '#999';\n\n    ctx.fillStyle = color;\n    ctx.fill();\n\n    if (highlight) {\n      ctx.lineWidth = 3;\n      ctx.strokeStyle = '#000';\n      ctx.stroke();\n    } else {\n      ctx.lineWidth = 1;\n      ctx.strokeStyle = '#333';\n      ctx.stroke();\n    }\n  }\n\n  function redraw() {\n    ctx.clearRect(0, 0, width, height);\n    // draw all data points\n    dataPoints.forEach(p => {\n      drawPoint(p.x, p.y, p.class);\n    });\n  }\n\n  function distance(p1, p2) {\n    return Math.sqrt((p1.x - p2.x)**2 + (p1.y - p2.y)**2);\n  }\n\n  function knnClassify(point, k) {\n    if (dataPoints.length === 0) return null;\n\n    // Calculate distance to all points\n    let distances = dataPoints.map(p => ({\n      point: p,\n      dist: distance(p, point)\n    }));\n\n    // Sort by distance asc\n    distances.sort((a,b) => a.dist - b.dist);\n    // Take first k neighbors\n    const neighbors = distances.slice(0, k);\n\n    // Count votes per class\n    const votes = {};\n    neighbors.forEach(n => {\n      votes[n.point.class] = (votes[n.point.class] || 0) + 1;\n    });\n\n    // Find class with max votes\n    let maxVotes = 0;\n    let predictedClass = null;\n    for (const cls in votes) {\n      if (votes[cls] > maxVotes) {\n        maxVotes = votes[cls];\n        predictedClass = cls;\n      }\n    }\n    return { predictedClass, neighbors };\n  }\n\n  // Handle canvas clicks\n  canvas.addEventListener('click', (e) => {\n    const rect = canvas.getBoundingClientRect();\n    const cx = e.clientX - rect.left;\n    const cy = e.clientY - rect.top;\n\n    if (classifyMode) {\n      // Classify the clicked point with KNN, draw result\n      const k = Math.min(Math.max(parseInt(kInput.value) || 3, 1), dataPoints.length);\n      if (dataPoints.length === 0) {\n        info.textContent = 'Add training points before classification!';\n        return;\n      }\n      const result = knnClassify({x: cx, y: cy}, k);\n      redraw();\n\n      // Highlight neighbors\n      result.neighbors.forEach(n => {\n        drawPoint(n.point.x, n.point.y, n.point.class, true);\n      });\n\n      // Draw classified point\n      drawPoint(cx, cy, 'classified');\n\n      info.textContent = `Classified point as Class ${result.predictedClass}. (K = ${k})`;\n\n    } else {\n      // Add training point\n      dataPoints.push({ x: cx, y: cy, class: currentClass });\n      drawPoint(cx, cy, currentClass);\n      info.textContent = `Added point to Class ${currentClass}. Total points: ${dataPoints.length}`;\n    }\n  });\n\n  // Toggle class buttons\n  function setClass(newClass) {\n    currentClass = newClass;\n    if (newClass === 'A') {\n      classAButton.style.opacity = '1';\n      classBButton.style.opacity = '0.5';\n    } else {\n      classAButton.style.opacity = '0.5';\n      classBButton.style.opacity = '1';\n    }\n    info.textContent = `Current class to add: Class ${currentClass}`;\n  }\n\n  classAButton.addEventListener('click', () => setClass('A'));\n  classBButton.addEventListener('click', () => setClass('B'));\n\n  clearButton.addEventListener('click', () => {\n    dataPoints = [];\n    redraw();\n    info.textContent = 'All training data cleared.';\n  });\n\n  classifyButton.addEventListener('click', () => {\n    if (dataPoints.length === 0) {\n      info.textContent = 'Add training points first before classification!';\n      return;\n    }\n    classifyMode = true;\n    classifyButton.style.display = 'none';\n    resetButton.style.display = 'inline-block';\n    classAButton.disabled = true;\n    classBButton.disabled = true;\n    clearButton.disabled = true;\n    kInput.disabled = true;\n    info.textContent = 'Click anywhere on the canvas to classify a new point.';\n  });\n\n  resetButton.addEventListener('click', () => {\n    classifyMode = false;\n    classifyButton.style.display = 'inline-block';\n    resetButton.style.display = 'none';\n    classAButton.disabled = false;\n    classBButton.disabled = false;\n    clearButton.disabled = false;\n    kInput.disabled = false;\n    redraw();\n    info.textContent = `Back to editing mode. Current class to add: Class ${currentClass}`;\n  });\n\n  // Initialize\n  setClass('A');\n  redraw();\n\n})();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "K-Nearest Neighbors (KNN)"
    }
  ],
  "topic": "K-Nearest Neighbors (KNN)",
  "hasFSM": false,
  "hasTest": true
}