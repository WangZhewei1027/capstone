{
  "id": "20d2d6d1-cd33-11f0-bdf9-b3d97e91273d",
  "timestamp": "2025-11-29T14:54:21.213Z",
  "type": "html-to-test",
  "htmlModel": "gpt-3.5-turbo",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Linear Regression",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <title>Linear Regression Demo</title>\n  <style>\n    body {\n      font-family: Arial, sans-serif;\n      margin: 20px;\n      background: #f5f5f5;\n    }\n    h1 {\n      text-align: center;\n    }\n    #container {\n      max-width: 800px;\n      margin: 0 auto;\n      background: #fff;\n      padding: 20px;\n      border-radius: 8px;\n      box-shadow: 0 0 10px #ccc;\n    }\n    #plot {\n      border: 1px solid #ccc;\n      margin-top: 20px;\n      background: #fff;\n      cursor: crosshair;\n    }\n    #instructions {\n      margin-top: 0;\n      font-size: 14px;\n      color: #666;\n    }\n    #controls {\n      margin-top: 15px;\n      text-align: center;\n    }\n    button {\n      margin: 0 5px;\n      background: #007bff;\n      color: #fff;\n      border: none;\n      padding: 8px 16px;\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 14px;\n      transition: background-color 0.3s ease;\n    }\n    button:hover {\n      background: #0056b3;\n    }\n    #result {\n      margin-top: 15px;\n      font-weight: bold;\n      text-align: center;\n      font-size: 16px;\n    }\n    #equation {\n      margin-top: 5px;\n      text-align: center;\n      font-family: \"Courier New\", monospace;\n      background: #eee;\n      padding: 8px;\n      border-radius: 4px;\n      display: inline-block;\n      user-select: all;\n    }\n    #clearTip {\n      font-size: 12px;\n      color: #999;\n      text-align: center;\n      margin-top: 10px;\n      font-style: italic;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"container\">\n    <h1>Linear Regression Demo</h1>\n    <p id=\"instructions\">\n      Click on the graph below to add data points. The line of best fit (linear regression) will update automatically.\n    </p>\n    <canvas id=\"plot\" width=\"700\" height=\"400\" aria-label=\"Linear regression graph\" role=\"img\"></canvas>\n    <div id=\"controls\">\n      <button id=\"btnClear\">Clear Points</button>\n      <button id=\"btnRandom\">Add Random Points</button>\n    </div>\n    <div id=\"result\"></div>\n    <div id=\"equation\" title=\"Regression equation and details\"></div>\n    <div id=\"clearTip\">Tip: Click \"Clear Points\" to remove all points and start over.</div>\n  </div>\n\n  <script>\n    (function () {\n      const canvas = document.getElementById(\"plot\");\n      const ctx = canvas.getContext(\"2d\");\n      const width = canvas.width;\n      const height = canvas.height;\n      const margin = 50;\n      const btnClear = document.getElementById(\"btnClear\");\n      const btnRandom = document.getElementById(\"btnRandom\");\n      const resultDiv = document.getElementById(\"result\");\n      const equationDiv = document.getElementById(\"equation\");\n\n      // Data points: array of {x, y} in plot coordinate space (0 to 100)\n      let points = [];\n\n      // Coordinate range for plotting:\n      // We'll map x and y between 0 and 100 for convenience.\n      const plotRange = { minX: 0, maxX: 100, minY: 0, maxY: 100 };\n\n      // Converts plot coordinate (0-100) to canvas pixel coordinate\n      function plotToCanvas(x, y) {\n        let px = margin + ((x - plotRange.minX) / (plotRange.maxX - plotRange.minX)) * (width - 2 * margin);\n        let py = height - margin - ((y - plotRange.minY) / (plotRange.maxY - plotRange.minY)) * (height - 2 * margin);\n        return { px, py };\n      }\n\n      // Converts canvas pixel coordinate to plot coordinate (0-100)\n      function canvasToPlot(px, py) {\n        let x = ((px - margin) / (width - 2 * margin)) * (plotRange.maxX - plotRange.minX) + plotRange.minX;\n        let y = ((height - margin - py) / (height - 2 * margin)) * (plotRange.maxY - plotRange.minY) + plotRange.minY;\n        x = Math.min(Math.max(x, plotRange.minX), plotRange.maxX);\n        y = Math.min(Math.max(y, plotRange.minY), plotRange.maxY);\n        return { x, y };\n      }\n\n      // Draw axes and grid lines\n      function drawAxes() {\n        ctx.clearRect(0, 0, width, height);\n\n        ctx.strokeStyle = \"#888\";\n        ctx.lineWidth = 1;\n        ctx.font = \"12px Arial\";\n        ctx.fillStyle = \"#333\";\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n\n        // Draw grid lines and labels on X axis\n        const xStep = 10;\n        for (let x = plotRange.minX; x <= plotRange.maxX; x += xStep) {\n          const { px, py } = plotToCanvas(x, plotRange.minY);\n          ctx.beginPath();\n          ctx.moveTo(px, margin);\n          ctx.lineTo(px, height - margin);\n          ctx.strokeStyle = x === 0 || x === plotRange.maxX ? \"#444\" : \"#ddd\";\n          ctx.lineWidth = x === 0 || x === plotRange.maxX ? 2 : 1;\n          ctx.stroke();\n          ctx.fillStyle = \"#333\";\n          ctx.fillText(x.toFixed(0), px, height - margin + 15);\n        }\n\n        // Draw grid lines and labels on Y axis\n        const yStep = 10;\n        for (let y = plotRange.minY; y <= plotRange.maxY; y += yStep) {\n          const { px, py } = plotToCanvas(plotRange.minX, y);\n          ctx.beginPath();\n          ctx.moveTo(margin, py);\n          ctx.lineTo(width - margin, py);\n          ctx.strokeStyle = y === 0 || y === plotRange.maxY ? \"#444\" : \"#ddd\";\n          ctx.lineWidth = y === 0 || y === plotRange.maxY ? 2 : 1;\n          ctx.stroke();\n          ctx.fillStyle = \"#333\";\n          // Align right for Y labels\n          ctx.textAlign = \"right\";\n          ctx.fillText(y.toFixed(0), margin - 8, py);\n          ctx.textAlign = \"center\";\n        }\n\n        // Axis labels\n        ctx.fillStyle = \"#000\";\n        ctx.font = \"bold 14px Arial\";\n        ctx.fillText(\"X\", width / 2, height - 10);\n        ctx.save();\n        ctx.translate(10, height / 2);\n        ctx.rotate(-Math.PI / 2);\n        ctx.fillText(\"Y\", 0, 0);\n        ctx.restore();\n      }\n\n      // Draw points on the canvas\n      function drawPoints() {\n        ctx.fillStyle = \"#007bff\";\n        points.forEach(({ x, y }) => {\n          const { px, py } = plotToCanvas(x, y);\n          ctx.beginPath();\n          ctx.arc(px, py, 6, 0, 2 * Math.PI);\n          ctx.fill();\n          ctx.strokeStyle = \"#003d99\";\n          ctx.lineWidth = 1.5;\n          ctx.stroke();\n        });\n      }\n\n      // Calculate linear regression parameters: slope (m) and intercept (b)\n      // y = m*x + b\n      // Returns null if not enough points or zero variance in x\n      function linearRegression(data) {\n        if (data.length < 2) {\n          return null;\n        }\n        const n = data.length;\n        let sumX = 0,\n          sumY = 0,\n          sumXY = 0,\n          sumX2 = 0;\n        for (let i = 0; i < n; i++) {\n          let { x, y } = data[i];\n          sumX += x;\n          sumY += y;\n          sumXY += x * y;\n          sumX2 += x * x;\n        }\n        const denominator = n * sumX2 - sumX * sumX;\n        if (denominator === 0) {\n          return null;\n        }\n        const m = (n * sumXY - sumX * sumY) / denominator;\n        const b = (sumY - m * sumX) / n;\n\n        // Calculate R^2 (coefficient of determination)\n        let ssTot = 0,\n          ssRes = 0;\n        const meanY = sumY / n;\n        for (let i = 0; i < n; i++) {\n          let yi = data[i].y;\n          let xi = data[i].x;\n          let yPred = m * xi + b;\n          ssTot += (yi - meanY) * (yi - meanY);\n          ssRes += (yi - yPred) * (yi - yPred);\n        }\n        const r2 = 1 - ssRes / ssTot;\n\n        return { m, b, r2 };\n      }\n\n      // Draw the regression line on the plot\n      function drawRegressionLine(params) {\n        if (!params) return;\n        const { m, b } = params;\n\n        // y = m*x + b\n        // We draw line at minX and maxX\n        const x1 = plotRange.minX;\n        const y1 = m * x1 + b;\n        const x2 = plotRange.maxX;\n        const y2 = m * x2 + b;\n\n        // Clip y within plot range:\n        function clip(y) {\n          return Math.min(Math.max(y, plotRange.minY), plotRange.maxY);\n        }\n\n        ctx.strokeStyle = \"#e63946\";\n        ctx.lineWidth = 3;\n        ctx.beginPath();\n        let p1 = plotToCanvas(x1, clip(y1));\n        let p2 = plotToCanvas(x2, clip(y2));\n        ctx.moveTo(p1.px, p1.py);\n        ctx.lineTo(p2.px, p2.py);\n        ctx.stroke();\n      }\n\n      // Update all canvas drawing\n      function updateCanvas() {\n        drawAxes();\n        drawPoints();\n        let reg = linearRegression(points);\n        drawRegressionLine(reg);\n\n        if (reg) {\n          resultDiv.textContent = `Regression line calculated for ${points.length} point${points.length > 1 ? \"s\" : \"\"}`;\n          const { m, b, r2 } = reg;\n          // Format numbers nicely\n          const mStr = m.toFixed(3);\n          const bStr = b >= 0 ? \"+ \" + b.toFixed(3) : \"- \" + Math.abs(b).toFixed(3);\n          const r2Str = (r2 * 100).toFixed(2);\n          equationDiv.textContent = `y = ${mStr} × x ${bStr}\\nR² = ${r2Str}%`;\n        } else if (points.length === 1) {\n          resultDiv.textContent = \"Add at least one more point to compute regression line.\";\n          equationDiv.textContent = \"\";\n        } else {\n          resultDiv.textContent = \"Click on the graph to add data points.\";\n          equationDiv.textContent = \"\";\n        }\n      }\n\n      // Add a point where user clicked on canvas\n      canvas.addEventListener(\"click\", (e) => {\n        const rect = canvas.getBoundingClientRect();\n        const px = e.clientX - rect.left;\n        const py = e.clientY - rect.top;\n\n        // Ignore clicks outside plotting area\n        if (px < margin || px > width - margin || py < margin || py > height - margin) {\n          return;\n        }\n\n        const { x, y } = canvasToPlot(px, py);\n        points.push({ x, y });\n        updateCanvas();\n      });\n\n      // Clear points button\n      btnClear.addEventListener(\"click\", () => {\n        points = [];\n        updateCanvas();\n      });\n\n      // Add random points for demo\n      btnRandom.addEventListener(\"click\", () => {\n        const count = 10;\n        points = [];\n        // Generate random points roughly around y = 0.7x + 10 with noise\n        for (let i = 0; i < count; i++) {\n          let x = Math.random() * (plotRange.maxX - plotRange.minX) + plotRange.minX;\n          let noise = (Math.random() - 0.5) * 15;\n          let y = 0.7 * x + 10 + noise;\n          y = Math.min(Math.max(y, plotRange.minY), plotRange.maxY);\n          points.push({ x, y });\n        }\n        updateCanvas();\n      });\n\n      // Initialize\n      updateCanvas();\n    })();\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Linear Regression"
    }
  ],
  "topic": "Linear Regression",
  "hasFSM": false,
  "hasTest": true
}