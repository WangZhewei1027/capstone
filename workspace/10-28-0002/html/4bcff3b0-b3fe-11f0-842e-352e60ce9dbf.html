<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 24px;
        }
        h1 {
            text-align: center;
            margin-bottom: 24px;
        }
        #controls {
            text-align: center;
            margin-bottom: 24px;
        }
        .bar {
            display: inline-block;
            width: 20px;
            margin: 0 4px;
            background-color: teal;
            transition: height 0.3s, background-color 0.3s;
        }
        #bars {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 300px;
            margin-bottom: 24px;
        }
        #description {
            text-align: center;
        }
    </style>
</head>
<body>

<h1>Bubble Sort Visualization</h1>

<div id="controls">
    <input type="number" id="arraySize" value="10" min="2" max="30" />
    <button id="generateBtn">Generate New Array</button>
    <button id="sortBtn">Start Sort</button>
</div>

<div id="bars"></div>
<div id="description">
    <p>Watch how bubble sort works by clicking "Start Sort". The array will be sorted using the bubble sort algorithm.</p>
</div>

<script>
    const barsContainer = document.getElementById('bars');
    const sortBtn = document.getElementById('sortBtn');
    const generateBtn = document.getElementById('generateBtn');
    const arraySizeInput = document.getElementById('arraySize');
    let array = [];

    function generateArray() {
        const size = parseInt(arraySizeInput.value, 10);
        array = Array.from({ length: size }, () => Math.floor(Math.random() * 100) + 1);
        renderBars();
    }

    function renderBars() {
        barsContainer.innerHTML = '';
        array.forEach(value => {
            const bar = document.createElement('div');
            bar.className = 'bar';
            bar.style.height = `${value * 3}px`; // scale for visibility
            barsContainer.appendChild(bar);
        });
    }

    async function bubbleSort() {
        const bars = document.querySelectorAll('.bar');
        const n = array.length;
        for (let i = 0; i < n - 1; i++) {
            for (let j = 0; j < n - i - 1; j++) {
                // Compare elements
                bars[j].style.backgroundColor = 'red'; // Highlight current bar
                bars[j + 1].style.backgroundColor = 'red'; // Highlight next bar

                await new Promise(resolve => setTimeout(resolve, 300)); // Wait for 300ms

                if (array[j] > array[j + 1]) {
                    // Swap
                    [array[j], array[j + 1]] = [array[j + 1], array[j]];
                    renderBars();
                }
                // Reset the color after comparison
                bars[j].style.backgroundColor = 'teal';
                bars[j + 1].style.backgroundColor = 'teal'; 
            }
            // Mark the last element of the pass as sorted
            bars[n - i - 1].style.backgroundColor = 'green';
        }
        // Mark the first element as sorted
        bars[0].style.backgroundColor = 'green';
    }

    generateBtn.addEventListener('click', generateArray);
    sortBtn.addEventListener('click', bubbleSort);

    // Generate an initial array
    generateArray();
</script>



  <script id="fsm" type="application/json">
    {
  "topic": "bubble sort",
  "description": "Finite state machine for the Bubble Sort visualization application.",
  "states": [
    {
      "name": "idle",
      "onEnter": "generateArray",
      "onExit": null,
      "on": {
        "GENERATE_NEW_ARRAY": "array_generated",
        "START_SORT": "sorting"
      }
    },
    {
      "name": "array_generated",
      "onEnter": "renderBars",
      "onExit": null,
      "on": {
        "START_SORT": "sorting"
      }
    },
    {
      "name": "sorting",
      "onEnter": "bubbleSort",
      "onExit": null,
      "on": {
        "SORT_COMPLETE": "done"
      }
    },
    {
      "name": "done",
      "onEnter": null,
      "onExit": null,
      "on": {
        "GENERATE_NEW_ARRAY": "array_generated",
        "START_SORT": "sorting"
      }
    }
  ],
  "events": [
    "GENERATE_NEW_ARRAY",
    "START_SORT",
    "SORT_COMPLETE"
  ],
  "notes": "The FSM captures the states of the application during the bubble sort visualization process, including generating a new array, sorting the array, and completing the sort."
}
  </script>
</body>
</html>