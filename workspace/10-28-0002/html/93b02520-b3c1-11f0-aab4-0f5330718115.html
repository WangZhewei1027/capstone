<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Binary Search</title>
  <style>
    :root {
      --bg: #f7f9fc;
      --card: #ffffff;
      --text: #1c1f23;
      --muted: #6b7280;
      --accent: #2563eb;
      --ok: #16a34a;
      --warn: #ca8a04;
      --error: #dc2626;
      --border: #e5e7eb;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }
    .container {
      max-width: 860px;
      margin: 0 auto;
      padding: 24px;
    }
    header { margin-bottom: 16px; }
    h1 {
      margin: 0 0 8px;
      font-size: 28px;
      letter-spacing: -0.01em;
    }
    p.intro { margin: 0 0 16px; color: var(--muted); }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
      margin-bottom: 16px;
    }
    .row { display: grid; grid-template-columns: 1fr; gap: 12px; }
    @media (min-width: 720px) { .row.two { grid-template-columns: 2fr 1fr; } }
    label { font-weight: 600; display: block; margin-bottom: 6px; }
    input[type="text"], input[type="number"] {
      width: 100%;
      padding: 10px 12px;
      font-size: 16px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #fff;
      outline: none;
    }
    input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(37,99,235,0.15); }
    .btn {
      appearance: none;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      background: var(--accent);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
    }
    .btn.secondary { background: #eef2ff; color: #1e3a8a; }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .hint { font-size: 13px; color: var(--muted); margin-top: 6px; }
    .note { font-size: 14px; padding: 10px; border-radius: 8px; background: #fff7ed; border: 1px solid #fed7aa; color: #9a3412; margin-top: 10px; }
    .array-view {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding-top: 6px;
    }
    .cell {
      padding: 8px 10px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #fafafa;
      min-width: 42px;
      text-align: center;
      position: relative;
    }
    .cell .idx {
      position: absolute;
      top: -10px;
      right: 6px;
      font-size: 11px;
      color: var(--muted);
      background: #fff;
      padding: 0 4px;
      border-radius: 6px;
      border: 1px solid var(--border);
    }
    .cell.low { border-color: #60a5fa; background: #eff6ff; }
    .cell.mid { border-color: #fb923c; background: #fff7ed; }
    .cell.high { border-color: #fca5a5; background: #fef2f2; }
    .result {
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #f8fafc;
      font-weight: 600;
    }
    .result.ok { border-color: #bbf7d0; background: #f0fdf4; color: var(--ok); }
    .result.err { border-color: #fecaca; background: #fef2f2; color: var(--error); }
    .steps { margin: 0; padding-left: 18px; }
    .steps li { margin: 6px 0; }
    pre {
      background: #0b1220;
      color: #e5e7eb;
      padding: 12px;
      border-radius: 10px;
      overflow: auto;
      font-size: 13px;
    }
    footer { color: var(--muted); font-size: 13px; margin-top: 8px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Binary Search</h1>
      <p class="intro">Binary search finds a target in a sorted list by repeatedly halving the search range. Time complexity: O(log n).</p>
    </header>

    <section class="card">
      <div class="row two">
        <div>
          <label for="arr">Sorted numbers (comma-separated)</label>
          <input id="arr" type="text" value="1, 3, 4, 7, 9, 12, 15, 18, 21" placeholder="e.g., 2, 5, 8, 13, 21" />
          <div class="hint">Binary search requires ascending sorted order. Non-numeric entries are ignored.</div>
        </div>
        <div>
          <label for="target">Target</label>
          <input id="target" type="number" value="15" placeholder="e.g., 13" />
          <div class="hint">Enter the number you want to find.</div>
        </div>
      </div>
      <div style="margin-top: 12px; display: flex; gap: 8px;">
        <button class="btn" id="runBtn">Search</button>
        <button class="btn secondary" id="shuffleBtn" title="Randomize array">Randomize</button>
      </div>
      <div id="sortNote" class="note" style="display:none;"></div>
    </section>

    <section class="card">
      <label>Array view</label>
      <div id="arrayView" class="array-view"></div>
    </section>

    <section class="card">
      <label>Steps</label>
      <ul id="steps" class="steps"></ul>
      <div id="result" class="result" style="display:none; margin-top: 8px;"></div>
    </section>

    <section class="card">
      <label>Pseudocode</label>
      <pre><code>// Binary Search (iterative)
function binarySearch(arr, x):
    low = 0
    high = arr.length - 1

    while low &lt;= high:
        mid = floor((low + high) / 2)

        if arr[mid] == x:
            return mid

        if arr[mid] &lt; x:
            low = mid + 1
        else:
            high = mid - 1

    return -1</code></pre>
      <footer>Tip: Works on ascending sorted arrays. For strings, sort consistently and compare lexicographically.</footer>
    </section>
  </div>

  <script>
    const arrInput = document.getElementById('arr');
    const targetInput = document.getElementById('target');
    const runBtn = document.getElementById('runBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const arrayView = document.getElementById('arrayView');
    const stepsEl = document.getElementById('steps');
    const resultEl = document.getElementById('result');
    const sortNote = document.getElementById('sortNote');

    function parseArray(str) {
      return str
        .split(',')
        .map(s => parseFloat(s.trim()))
        .filter(n => Number.isFinite(n));
    }

    function isSortedAsc(arr) {
      for (let i = 1; i < arr.length; i++) {
        if (arr[i - 1] > arr[i]) return false;
      }
      return true;
    }

    function renderArray(arr, low = null, mid = null, high = null) {
      arrayView.innerHTML = '';
      arr.forEach((v, i) => {
        const cell = document.createElement('div');
        cell.className = 'cell' + (i === low ? ' low' : '') + (i === mid ? ' mid' : '') + (i === high ? ' high' : '');
        cell.textContent = String(v);
        const idx = document.createElement('span');
        idx.className = 'idx';
        idx.textContent = i;
        cell.appendChild(idx);
        arrayView.appendChild(cell);
      });
    }

    function binarySearchWithSteps(arr, target) {
      const steps = [];
      let low = 0;
      let high = arr.length - 1;
      while (low <= high) {
        const mid = Math.floor((low + high) / 2);
        const val = arr[mid];
        steps.push({
          low, mid, high,
          message: `low=${low}, mid=${mid}, high=${high}, compare arr[mid]=${val} with target=${target}`
        });
        if (val === target) {
          steps.push({ low, mid, high, message: `Found target at index ${mid}.` });
          return { index: mid, steps };
        }
        if (val < target) {
          low = mid + 1;
        } else {
          high = mid - 1;
        }
      }
      steps.push({ low, mid: null, high, message: 'Target not found.' });
      return { index: -1, steps };
    }

    function displaySteps(arr, steps) {
      stepsEl.innerHTML = '';
      steps.forEach((s, idx) => {
        const li = document.createElement('li');
        li.textContent = s.message;
        stepsEl.appendChild(li);
        // Highlight the last state
        if (idx === steps.length - 1) {
          renderArray(arr, s.low, s.mid, s.high);
        }
      });
    }

    function run() {
      sortNote.style.display = 'none';
      resultEl.style.display = 'none';
      stepsEl.innerHTML = '';
      arrayView.innerHTML = '';

      let arr = parseArray(arrInput.value);
      const target = parseFloat(targetInput.value);

      if (!Number.isFinite(target)) {
        resultEl.textContent = 'Please enter a valid numeric target.';
        resultEl.className = 'result err';
        resultEl.style.display = 'block';
        return;
      }
      if (arr.length === 0) {
        resultEl.textContent = 'Please provide at least one valid number.';
        resultEl.className = 'result err';
        resultEl.style.display = 'block';
        return;
      }

      let sorted = isSortedAsc(arr);
      if (!sorted) {
        const original = arr.slice();
        arr.sort((a, b) => a - b);
        sortNote.textContent = 'Note: Input was not sorted. It has been sorted ascending to apply binary search.';
        sortNote.style.display = 'block';
      }

      const { index, steps } = binarySearchWithSteps(arr, target);
      displaySteps(arr, steps);

      if (index >= 0) {
        resultEl.textContent = `Success: target ${target} found at index ${index}.`;
        resultEl.className = 'result ok';
      } else {
        resultEl.textContent = `Not found: target ${target} is not in the array.`;
        resultEl.className = 'result err';
      }
      resultEl.style.display = 'block';
    }

    function randomize() {
      const n = 9 + Math.floor(Math.random() * 6); // 9..14
      const base = [];
      let current = Math.floor(Math.random() * 10);
      for (let i = 0; i < n; i++) {
        current += 1 + Math.floor(Math.random() * 8);
        base.push(current);
      }
      arrInput.value = base.join(', ');
      targetInput.value = base[Math.floor(Math.random() * base.length)];
      sortNote.style.display = 'none';
      renderArray(parseArray(arrInput.value));
      stepsEl.innerHTML = '';
      resultEl.style.display = 'none';
    }

    runBtn.addEventListener('click', run);
    shuffleBtn.addEventListener('click', randomize);

    // Initial render
    renderArray(parseArray(arrInput.value));
  </script>
</body>
</html>