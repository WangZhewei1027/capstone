<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Longest Common Subsequence</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 24px; line-height: 1.5; }
    h1 { font-size: 1.4rem; margin-bottom: 12px; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; }
    .col { flex: 1 1 320px; min-width: 260px; }
    label { display: block; font-weight: 600; margin-bottom: 6px; }
    textarea { width: 100%; min-height: 120px; box-sizing: border-box; padding: 8px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .controls { display: flex; gap: 10px; margin-top: 12px; flex-wrap: wrap; }
    button { padding: 8px 14px; cursor: pointer; }
    .result { margin-top: 16px; padding: 12px; background: #f6f7f9; border-radius: 6px; }
    .stat { margin: 6px 0; }
    .small { color: #555; font-size: 0.9rem; }
    .error { color: #b00020; }
  </style>
</head>
<body>
  <h1>Longest Common Subsequence</h1>

  <div class="row">
    <div class="col">
      <label for="a">String A</label>
      <textarea id="a" placeholder="Enter first string">ABCBDAB</textarea>
    </div>
    <div class="col">
      <label for="b">String B</label>
      <textarea id="b" placeholder="Enter second string">BDCABA</textarea>
    </div>
  </div>

  <div class="controls">
    <button id="compute">Compute LCS</button>
    <button id="clear">Clear</button>
    <label class="small" style="display:flex; align-items:center; gap:6px;">
      <input type="checkbox" id="ignoreCase"> Ignore case
    </label>
  </div>

  <div id="result" class="result" aria-live="polite">
    <div class="stat small">Enter strings and click Compute LCS.</div>
  </div>

  <script>
    function lcs(a, b) {
      const n = a.length, m = b.length;
      const dp = Array(n + 1);
      for (let i = 0; i <= n; i++) dp[i] = new Array(m + 1).fill(0);

      for (let i = 1; i <= n; i++) {
        const ai = a[i - 1];
        for (let j = 1; j <= m; j++) {
          if (ai === b[j - 1]) {
            dp[i][j] = dp[i - 1][j - 1] + 1;
          } else {
            dp[i][j] = dp[i - 1][j] >= dp[i][j - 1] ? dp[i - 1][j] : dp[i][j - 1];
          }
        }
      }

      const length = dp[n][m];
      const chars = [];
      let i = n, j = m;
      while (i > 0 && j > 0) {
        if (a[i - 1] === b[j - 1]) {
          chars.push(a[i - 1]);
          i--; j--;
        } else if (dp[i - 1][j] >= dp[i][j - 1]) {
          i--;
        } else {
          j--;
        }
      }
      chars.reverse();
      return { length, sequence: chars.join("") };
    }

    function sanitizeText(s) {
      // Ensure string type and reasonable size
      return typeof s === "string" ? s : String(s ?? "");
    }

    const aEl = document.getElementById("a");
    const bEl = document.getElementById("b");
    const computeBtn = document.getElementById("compute");
    const clearBtn = document.getElementById("clear");
    const resultEl = document.getElementById("result");
    const ignoreCaseEl = document.getElementById("ignoreCase");

    computeBtn.addEventListener("click", () => {
      const rawA = sanitizeText(aEl.value);
      const rawB = sanitizeText(bEl.value);

      if (!rawA.length && !rawB.length) {
        resultEl.innerHTML = "";
        const msg = document.createElement("div");
        msg.className = "error";
        msg.textContent = "Please enter at least one non-empty string.";
        resultEl.appendChild(msg);
        return;
      }

      const start = performance.now();
      const a = ignoreCaseEl.checked ? rawA.toLowerCase() : rawA;
      const b = ignoreCaseEl.checked ? rawB.toLowerCase() : rawB;
      const { length, sequence } = lcs(a, b);
      const ms = Math.round(performance.now() - start);

      resultEl.innerHTML = "";

      const lenEl = document.createElement("div");
      lenEl.className = "stat";
      lenEl.textContent = "Length: " + length;
      resultEl.appendChild(lenEl);

      const seqWrap = document.createElement("div");
      seqWrap.className = "stat";
      const seqLabel = document.createElement("div");
      seqLabel.className = "small";
      seqLabel.textContent = "One LCS:";
      const seqEl = document.createElement("pre");
      seqEl.style.margin = "6px 0 0 0";
      seqEl.style.whiteSpace = "pre-wrap";
      seqEl.textContent = sequence;
      seqWrap.appendChild(seqLabel);
      seqWrap.appendChild(seqEl);
      resultEl.appendChild(seqWrap);

      const timeEl = document.createElement("div");
      timeEl.className = "small";
      timeEl.textContent = "Computed in " + ms + " ms";
      resultEl.appendChild(timeEl);
    });

    clearBtn.addEventListener("click", () => {
      aEl.value = "";
      bEl.value = "";
      resultEl.innerHTML = "";
      const msg = document.createElement("div");
      msg.className = "small";
      msg.textContent = "Inputs cleared.";
      resultEl.appendChild(msg);
      aEl.focus();
    });
  </script>
</body>
</html>