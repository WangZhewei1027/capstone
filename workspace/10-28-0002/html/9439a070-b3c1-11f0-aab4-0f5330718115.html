<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Radix Sort</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #fcfcfd;
      --text: #1b1f23;
      --muted: #6a737d;
      --primary: #2f62ff;
      --accent: #f3f4f6;
      --border: #e5e7eb;
      --good: #10b981;
      --warn: #ef4444;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
      line-height: 1.55;
    }
    .container {
      max-width: 860px;
      margin: 32px auto;
      padding: 0 16px;
    }
    header h1 {
      margin: 0 0 8px;
      font-size: 28px;
    }
    header p {
      margin: 0 0 16px;
      color: var(--muted);
    }
    .card {
      background: white;
      border: 1px solid var(--border);
      border-radius: 10px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
      padding: 16px;
      margin: 16px 0;
    }
    .controls {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    .controls .row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
    }
    button {
      appearance: none;
      border: 1px solid var(--border);
      background: white;
      color: var(--text);
      padding: 8px 12px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.15s ease, border-color 0.15s ease;
    }
    button.primary {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }
    button:hover { background: var(--accent); }
    button.primary:hover { filter: brightness(0.95); }
    .hint {
      font-size: 13px;
      color: var(--muted);
    }
    .error {
      color: var(--warn);
      font-weight: 600;
      margin-top: 8px;
    }
    .array-view {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    .chip {
      padding: 6px 10px;
      border: 1px solid var(--border);
      border-radius: 999px;
      background: #f9fafb;
      font-size: 13px;
    }
    .pass {
      border-top: 1px dashed var(--border);
      margin-top: 14px;
      padding-top: 14px;
    }
    .pass h3 {
      margin: 0 0 8px;
      font-size: 18px;
    }
    .buckets {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }
    @media (min-width: 680px) {
      .buckets { grid-template-columns: repeat(5, minmax(0, 1fr)); }
    }
    .bucket {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px;
    }
    .bucket-title {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }
    .small {
      font-size: 12px;
      color: var(--muted);
    }
    .result-title {
      margin-top: 8px;
      font-size: 14px;
      font-weight: 600;
    }
    code, pre {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    pre {
      margin: 0;
      padding: 12px;
      background: #0f172a;
      color: #e5e7eb;
      border-radius: 8px;
      overflow: auto;
      border: 1px solid #0b1020;
    }
    .footer {
      margin-top: 16px;
      color: var(--muted);
      font-size: 13px;
    }
    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #1e40af;
      border: 1px solid #c7d2fe;
      font-size: 12px;
      margin-left: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Radix Sort (LSD)</h1>
      <p>Stable non-comparative integer sorting that processes numbers digit by digit, starting from the least significant digit (base 10).</p>
    </header>

    <div class="card">
      <div class="controls">
        <label for="numbers">Numbers (non-negative integers). Separate with commas or spaces:</label>
        <input id="numbers" type="text" value="170, 45, 75, 90, 802, 24, 2, 66" placeholder="e.g., 170, 45, 75, 90, 802, 24, 2, 66">
        <div class="row">
          <button id="sortBtn" class="primary">Sort</button>
          <button id="randomBtn">Randomize</button>
          <button id="clearBtn">Clear</button>
          <span class="hint">Base: 10 <span class="badge">LSD</span></span>
        </div>
        <div id="error" class="error" style="display:none;"></div>
        <div>
          <div class="small">Input array</div>
          <div id="inputView" class="array-view"></div>
        </div>
      </div>
    </div>

    <div id="stepsCard" class="card" style="display:none;">
      <div id="steps"></div>
    </div>

    <div id="resultCard" class="card" style="display:none;">
      <div class="result-title">Sorted array</div>
      <div id="resultView" class="array-view"></div>
      <div class="footer">
        Complexity (base 10): O(d Ã— (n + 10)), where d is the number of digits of the largest number.
      </div>
    </div>

    <div class="card">
      <div class="result-title">JavaScript implementation (LSD, base 10)</div>
      <pre><code>function radixSortLSD(arr) {
  if (!arr.length) return arr.slice();
  const maxDigits = Math.max(...arr).toString().length;

  const getDigit = (num, place) => Math.floor(num / Math.pow(10, place)) % 10;

  let result = arr.slice();
  for (let place = 0; place &lt; maxDigits; place++) {
    const count = Array(10).fill(0);
    for (const num of result) count[getDigit(num, place)]++;

    // prefix sums
    for (let i = 1; i &lt; 10; i++) count[i] += count[i - 1];

    const out = Array(result.length);
    for (let i = result.length - 1; i &gt;= 0; i--) {
      const d = getDigit(result[i], place);
      out[--count[d]] = result[i];
    }
    result = out;
  }
  return result;
}</code></pre>
    </div>
  </div>

  <script>
    const inputEl = document.getElementById('numbers');
    const sortBtn = document.getElementById('sortBtn');
    const randomBtn = document.getElementById('randomBtn');
    const clearBtn = document.getElementById('clearBtn');
    const errorEl = document.getElementById('error');
    const inputView = document.getElementById('inputView');
    const stepsCard = document.getElementById('stepsCard');
    const stepsEl = document.getElementById('steps');
    const resultCard = document.getElementById('resultCard');
    const resultView = document.getElementById('resultView');

    function parseNumbers(text) {
      return text
        .split(/[\s,;]+/)
        .map(s => s.trim())
        .filter(s => s.length)
        .map(s => Number(s));
    }

    function showArray(container, arr) {
      container.innerHTML = '';
      if (!arr.length) {
        const none = document.createElement('div');
        none.className = 'small';
        none.textContent = '(empty)';
        container.appendChild(none);
        return;
      }
      for (const n of arr) {
        const chip = document.createElement('div');
        chip.className = 'chip';
        chip.textContent = String(n);
        container.appendChild(chip);
      }
    }

    function getDigit(num, place) {
      return Math.floor(num / Math.pow(10, place)) % 10;
    }

    function maxDigits(arr) {
      let max = 0;
      for (const n of arr) {
        const d = n === 0 ? 1 : Math.floor(Math.log10(n)) + 1;
        if (d > max) max = d;
      }
      return max;
    }

    function countingSortByDigit(arr, place, recordBuckets = false) {
      const count = Array(10).fill(0);
      const out = Array(arr.length);

      // Optional buckets for visualization (distribution in input order)
      const buckets = recordBuckets ? Array.from({ length: 10 }, () => []) : null;
      if (recordBuckets) {
        for (const num of arr) {
          const d = getDigit(num, place);
          buckets[d].push(num);
        }
      }

      for (const num of arr) count[getDigit(num, place)]++;
      for (let i = 1; i < 10; i++) count[i] += count[i - 1];
      for (let i = arr.length - 1; i >= 0; i--) {
        const d = getDigit(arr[i], place);
        out[--count[d]] = arr[i];
      }
      return { out, buckets };
    }

    function radixSortWithSteps(arr) {
      const dmax = maxDigits(arr);
      const steps = [];
      let current = arr.slice();

      for (let place = 0; place < dmax; place++) {
        const { out, buckets } = countingSortByDigit(current, place, true);
        steps.push({
          place,
          buckets,
          before: current.slice(),
          after: out.slice()
        });
        current = out;
      }
      return { sorted: current, steps };
    }

    function validateInput(nums) {
      if (!nums.length) return 'Please enter at least one number.';
      for (const n of nums) {
        if (!Number.isFinite(n) || !Number.isInteger(n)) {
          return 'All entries must be integers.';
        }
        if (n < 0) {
          return 'This demo handles non-negative integers only.';
        }
      }
      return null;
    }

    function renderSteps(steps) {
      stepsEl.innerHTML = '';
      for (const step of steps) {
        const pass = document.createElement('div');
        pass.className = 'pass';

        const h3 = document.createElement('h3');
        h3.textContent = `Pass ${step.place + 1} (digit 10^${step.place})`;
        pass.appendChild(h3);

        const beforeLabel = document.createElement('div');
        beforeLabel.className = 'small';
        beforeLabel.textContent = 'Before';
        pass.appendChild(beforeLabel);

        const beforeView = document.createElement('div');
        beforeView.className = 'array-view';
        showArray(beforeView, step.before);
        pass.appendChild(beforeView);

        const bucketsGrid = document.createElement('div');
        bucketsGrid.className = 'buckets';
        for (let d = 0; d < 10; d++) {
          const bucket = document.createElement('div');
          bucket.className = 'bucket';

          const title = document.createElement('div');
          title.className = 'bucket-title';
          title.textContent = `Bucket ${d}`;
          bucket.appendChild(title);

          const list = document.createElement('div');
          list.className = 'array-view';
          showArray(list, step.buckets[d]);
          bucket.appendChild(list);

          bucketsGrid.appendChild(bucket);
        }
        pass.appendChild(bucketsGrid);

        const afterLabel = document.createElement('div');
        afterLabel.className = 'small';
        afterLabel.textContent = 'After collecting';
        pass.appendChild(afterLabel);

        const afterView = document.createElement('div');
        afterView.className = 'array-view';
        showArray(afterView, step.after);
        pass.appendChild(afterView);

        stepsEl.appendChild(pass);
      }
    }

    function runSort() {
      const nums = parseNumbers(inputEl.value);
      const err = validateInput(nums);

      // Update input preview
      showArray(inputView, nums);

      if (err) {
        errorEl.textContent = err;
        errorEl.style.display = 'block';
        stepsCard.style.display = 'none';
        resultCard.style.display = 'none';
        return;
      } else {
        errorEl.style.display = 'none';
      }

      const { sorted, steps } = radixSortWithSteps(nums);
      renderSteps(steps);
      stepsCard.style.display = 'block';

      showArray(resultView, sorted);
      resultCard.style.display = 'block';
    }

    function fillRandom() {
      const size = 10;
      const arr = Array.from({ length: size }, () => Math.floor(Math.random() * 1000));
      inputEl.value = arr.join(', ');
      errorEl.style.display = 'none';
      showArray(inputView, arr);
      stepsCard.style.display = 'none';
      resultCard.style.display = 'none';
    }

    function clearAll() {
      inputEl.value = '';
      errorEl.style.display = 'none';
      inputView.innerHTML = '';
      stepsEl.innerHTML = '';
      stepsCard.style.display = 'none';
      resultCard.style.display = 'none';
    }

    // Initialize preview from default value
    showArray(inputView, parseNumbers(inputEl.value));

    sortBtn.addEventListener('click', runSort);
    randomBtn.addEventListener('click', fillRandom);
    clearBtn.addEventListener('click', clearAll);
    inputEl.addEventListener('input', () => {
      const nums = parseNumbers(inputEl.value);
      showArray(inputView, nums);
      errorEl.style.display = 'none';
      stepsCard.style.display = 'none';
      resultCard.style.display = 'none';
    });
  </script>
</body>
</html>