<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Insertion Sort</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #22c55e;
      --warn: #ef4444;
      --border: #1f2937;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(135deg, #0f172a 0%, #111827 100%);
      color: var(--text);
      line-height: 1.5;
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 24px;
    }
    .wrap {
      width: 100%;
      max-width: 840px;
      background: rgba(17, 24, 39, 0.8);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 12px;
      margin-bottom: 12px;
    }
    h1 {
      margin: 0;
      font-size: 1.5rem;
      letter-spacing: 0.2px;
    }
    .muted { color: var(--muted); font-size: 0.95rem; }
    label { display: block; margin-bottom: 8px; }
    .row {
      display: grid;
      grid-template-columns: 1fr auto auto auto;
      gap: 8px;
      align-items: center;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px 12px;
      color: var(--text);
      background: #0b1220;
      border: 1px solid var(--border);
      border-radius: 10px;
      outline: none;
    }
    input[type="text"]::placeholder { color: #6b7280; }
    button {
      padding: 10px 14px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: #0b1220;
      color: var(--text);
      cursor: pointer;
      transition: transform 0.05s ease, background 0.2s ease, border-color 0.2s ease;
    }
    button:hover { background: #0d1424; border-color: #233047; }
    button:active { transform: scale(0.98); }
    .primary { background: #13203a; border-color: #223252; }
    .accent { background: #0d1f16; border-color: #1c3d2f; }
    .error {
      margin-top: 10px;
      color: var(--warn);
      font-size: 0.95rem;
      min-height: 1.2em;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 16px;
    }
    .card {
      background: #0b1220;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
    }
    .card h3 { margin: 0 0 8px 0; font-size: 1rem; }
    .array {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .chip {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #223252;
      background: #0d1424;
      color: var(--text);
      font-weight: 500;
      min-width: 36px;
    }
    details {
      margin-top: 14px;
      background: #0b1220;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
    }
    details summary {
      cursor: pointer;
      font-weight: 600;
      outline: none;
    }
    .steps {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .step {
      padding: 8px;
      border-radius: 10px;
      border: 1px solid #1f2a3a;
      background: #0c1322;
    }
    .step .meta {
      font-size: 0.9rem;
      color: var(--muted);
      margin-bottom: 6px;
    }
    .inline-array { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    footer {
      margin-top: 16px;
      color: var(--muted);
      font-size: 0.9rem;
    }
    .badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid #243041;
      background: #0d1424;
      margin-left: 6px;
      font-size: 0.85rem;
      color: #93c5fd;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Insertion Sort <span class="badge">O(n²) average/worst • O(1) extra space • Stable</span></h1>
    </header>

    <p class="muted">Enter a list of numbers and see how insertion sort builds a sorted array by inserting each element into its correct position.</p>

    <label for="numbers">Numbers (comma or space separated)</label>
    <div class="row">
      <input id="numbers" type="text" placeholder="e.g. 8, 5, 2, 9, 3, 6" value="8, 5, 2, 9, 3, 6">
      <button id="btnSort" class="primary">Sort</button>
      <button id="btnSample">Random</button>
      <button id="btnClear" class="accent">Clear</button>
    </div>
    <div id="error" class="error"></div>

    <div class="grid">
      <div class="card">
        <h3>Original array</h3>
        <div id="original" class="array"></div>
      </div>
      <div class="card">
        <h3>Sorted array</h3>
        <div id="sorted" class="array"></div>
      </div>
    </div>

    <details id="detailsSteps">
      <summary>Show insertion steps</summary>
      <div id="steps" class="steps"></div>
    </details>

    <footer>
      Tip: Insertion sort is efficient for small or nearly-sorted arrays.
    </footer>
  </div>

  <script>
    const elInput = document.getElementById('numbers');
    const elError = document.getElementById('error');
    const elOriginal = document.getElementById('original');
    const elSorted = document.getElementById('sorted');
    const elSteps = document.getElementById('steps');
    const elDetails = document.getElementById('detailsSteps');
    document.getElementById('btnSort').addEventListener('click', handleSort);
    document.getElementById('btnClear').addEventListener('click', handleClear);
    document.getElementById('btnSample').addEventListener('click', handleRandom);

    function parseNumbers(text) {
      const tokens = text.trim().split(/[\s,]+/).filter(Boolean);
      if (tokens.length === 0) return { error: 'Please enter at least one number.' };
      const nums = [];
      for (const t of tokens) {
        const n = Number(t);
        if (!Number.isFinite(n)) {
          return { error: `“${t}” is not a valid number.` };
        }
        nums.push(n);
      }
      return { nums };
    }

    function renderArray(container, arr) {
      container.innerHTML = '';
      arr.forEach(n => {
        const chip = document.createElement('span');
        chip.className = 'chip';
        chip.textContent = formatNumber(n);
        container.appendChild(chip);
      });
      if (arr.length === 0) {
        const empty = document.createElement('span');
        empty.className = 'muted';
        empty.textContent = '—';
        container.appendChild(empty);
      }
    }

    function formatNumber(n) {
      return Math.abs(n) < 1e-6 ? '0' : (Number.isInteger(n) ? String(n) : n.toFixed(3).replace(/\.?0+$/,''));
    }

    function insertionSortWithSteps(arr) {
      const a = arr.slice();
      const steps = [];
      for (let i = 1; i < a.length; i++) {
        const key = a[i];
        let j = i - 1;
        steps.push({ action: 'start', i, j, key, array: a.slice() });
        while (j >= 0 && a[j] > key) {
          a[j + 1] = a[j];
          j--;
          steps.push({ action: 'shift', i, j, key, array: a.slice() });
        }
        a[j + 1] = key;
        steps.push({ action: 'insert', i, j, key, array: a.slice() });
      }
      return { sorted: a, steps };
    }

    function renderSteps(steps) {
      elSteps.innerHTML = '';
      steps.forEach((s, idx) => {
        const div = document.createElement('div');
        div.className = 'step';
        const meta = document.createElement('div');
        meta.className = 'meta';
        const actionText =
          s.action === 'start'  ? `Start pass i=${s.i} (key=${formatNumber(s.key)})`
        : s.action === 'shift'  ? `Shift: moved element right (j=${s.j + 1} ← ${s.j + 2})`
        : s.action === 'insert' ? `Insert key at position ${s.j + 1}`
        : 'Step';
        meta.textContent = `${idx + 1}. ${actionText}`;
        const arr = document.createElement('div');
        arr.className = 'inline-array';
        arr.textContent = `[ ${s.array.map(formatNumber).join(', ')} ]`;
        div.appendChild(meta);
        div.appendChild(arr);
        elSteps.appendChild(div);
      });
    }

    function handleSort() {
      clearError();
      const { nums, error } = parseNumbers(elInput.value);
      if (error) return showError(error);
      renderArray(elOriginal, nums);
      const { sorted, steps } = insertionSortWithSteps(nums);
      renderArray(elSorted, sorted);
      renderSteps(steps);
      if (steps.length > 0) elDetails.open = true;
    }

    function handleClear() {
      elInput.value = '';
      clearError();
      renderArray(elOriginal, []);
      renderArray(elSorted, []);
      elSteps.innerHTML = '';
      elDetails.open = false;
      elInput.focus();
    }

    function handleRandom() {
      const len = Math.floor(Math.random() * 6) + 6; // 6..11 items
      const arr = Array.from({ length: len }, () => Math.floor(Math.random() * 99) + 1);
      elInput.value = arr.join(', ');
      clearError();
      renderArray(elOriginal, []);
      renderArray(elSorted, []);
      elSteps.innerHTML = '';
      elDetails.open = false;
    }

    function showError(msg) { elError.textContent = msg; }
    function clearError() { elError.textContent = ''; }

    // Initial render
    (function init() {
      const { nums, error } = parseNumbers(elInput.value);
      if (!error) {
        renderArray(elOriginal, nums);
        const { sorted, steps } = insertionSortWithSteps(nums);
        renderArray(elSorted, sorted);
        renderSteps(steps);
      }
    })();
  </script>
</body>
</html>