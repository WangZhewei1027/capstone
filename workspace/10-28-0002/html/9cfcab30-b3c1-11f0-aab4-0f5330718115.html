<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Recursion</title>
  <style>
    :root {
      color-scheme: light dark;
    }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 2rem 1rem;
      max-width: 800px;
      margin-inline: auto;
    }
    h1 {
      margin: 0 0 0.5rem 0;
      font-size: 2rem;
    }
    p {
      margin: 0.5rem 0;
    }
    .card {
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 12px;
      padding: 1rem;
      margin-top: 1rem;
      background: rgba(0,0,0,0.03);
    }
    label, input, button {
      font-size: 1rem;
    }
    input[type="number"] {
      width: 6rem;
      padding: 0.35rem 0.5rem;
      margin-right: 0.5rem;
    }
    button {
      padding: 0.4rem 0.8rem;
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,0.2);
      background: #ececec;
      cursor: pointer;
    }
    button:hover {
      filter: brightness(0.98);
    }
    .row {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 0.5rem;
    }
    .result {
      margin-top: 0.75rem;
      font-weight: 600;
    }
    .error {
      color: #b00020;
      margin-top: 0.5rem;
    }
    pre {
      padding: 0.75rem;
      border-radius: 10px;
      background: rgba(0,0,0,0.06);
      overflow: auto;
      margin-top: 0.75rem;
      white-space: pre-wrap;
    }
    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    small {
      color: rgba(0,0,0,0.7);
    }
  </style>
</head>
<body>
  <h1>Recursion</h1>
  <p>Recursion is a technique where a function solves a problem by calling itself on smaller versions of the same problem, until a base case stops the calls.</p>
  <p><em>Recursive joke:</em> To understand recursion, you must first understand recursion.</p>

  <div class="card" aria-labelledby="example-title">
    <h2 id="example-title" style="margin-top:0">Interactive example: factorial(n)</h2>
    <p>
      Factorial is defined recursively as:
      <code>factorial(0) = 1</code> and <code>factorial(n) = n × factorial(n − 1)</code> for <code>n ≥ 1</code>.
    </p>

    <div class="row" role="group" aria-label="Factorial input">
      <label for="n">Enter n (0–20):</label>
      <input id="n" type="number" min="0" max="20" value="5" />
      <button id="compute">Compute</button>
      <button id="clear" title="Clear logs">Clear</button>
    </div>

    <div class="result" id="result" aria-live="polite"></div>
    <div class="error" id="error" role="alert" aria-live="assertive"></div>
    <pre id="logs" aria-label="Recursion steps"></pre>

    <details style="margin-top:0.75rem">
      <summary>See the recursive function</summary>
      <pre><code>function factorial(n):
  if n is 0 or 1:
    return 1          // base case
  return n * factorial(n - 1)  // recursive step</code></pre>
    </details>
    <small>Tip: Try n = 0, 1, 5, 10, or 15 and watch the call stack unfold.</small>
  </div>

  <script>
    function factorial(n, logs) {
      logs.push("→ factorial(" + n + ")");
      if (n === 0 || n === 1) {
        logs.push("  Base case: factorial(" + n + ") = 1");
        return 1;
      }
      logs.push("  Compute: " + n + " × factorial(" + (n - 1) + ")");
      const sub = factorial(n - 1, logs);
      const res = n * sub;
      logs.push("  Return: " + n + " × " + sub + " = " + res);
      return res;
    }

    function formatNumber(n) {
      return n.toLocaleString(undefined, { maximumFractionDigits: 0 });
    }

    const nInput = document.getElementById("n");
    const computeBtn = document.getElementById("compute");
    const clearBtn = document.getElementById("clear");
    const resultEl = document.getElementById("result");
    const errorEl = document.getElementById("error");
    const logsEl = document.getElementById("logs");

    function compute() {
      errorEl.textContent = "";
      logsEl.textContent = "";
      resultEl.textContent = "";

      const raw = nInput.value;
      const n = Number(raw);

      if (!Number.isFinite(n) || !Number.isInteger(n)) {
        errorEl.textContent = "Please enter a whole number.";
        return;
      }
      if (n < 0) {
        errorEl.textContent = "n must be ≥ 0.";
        return;
      }
      if (n > 20) {
        errorEl.textContent = "n is too large for this demo (max 20).";
        return;
      }

      const logs = [];
      const value = factorial(n, logs);
      resultEl.textContent = "factorial(" + n + ") = " + formatNumber(value);
      logsEl.textContent = logs.join("\n");
    }

    function clearLogs() {
      errorEl.textContent = "";
      logsEl.textContent = "";
      resultEl.textContent = "";
    }

    computeBtn.addEventListener("click", compute);
    clearBtn.addEventListener("click", clearLogs);

    // Compute initial example on load
    compute();
  </script>
</body>
</html>