<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Priority Queue Demo</title>
  <style>
    :root {
      --bg: #f7f7fb;
      --fg: #222;
      --muted: #666;
      --accent: #2a7ade;
      --accent-2: #00a37a;
      --border: #ddd;
      --danger: #d64545;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--fg);
      line-height: 1.5;
      padding: 24px;
    }
    main {
      max-width: 820px;
      margin: 0 auto;
      background: white;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.06);
    }
    h1 {
      margin: 0 0 8px;
      font-size: 28px;
    }
    p.description {
      margin: 0 0 16px;
      color: var(--muted);
    }
    .controls {
      display: grid;
      grid-template-columns: 1fr 120px 160px;
      gap: 10px;
      align-items: end;
      margin: 16px 0;
    }
    label {
      font-size: 13px;
      color: var(--muted);
      display: block;
      margin-bottom: 6px;
    }
    input, select, button {
      font: inherit;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #fff;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(42, 122, 222, 0.15);
    }
    button {
      cursor: pointer;
      border: 1px solid var(--accent);
      color: white;
      background: var(--accent);
    }
    button.secondary {
      border-color: #999;
      background: #f3f3f7;
      color: #222;
    }
    button.danger {
      border-color: var(--danger);
      background: var(--danger);
      color: white;
    }
    .row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      margin-bottom: 12px;
    }
    .status {
      font-size: 13px;
      color: var(--muted);
      min-height: 18px;
    }
    .queue {
      margin-top: 10px;
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
    }
    .queue-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #fafafa;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
      font-size: 14px;
    }
    .list {
      list-style: none;
      margin: 0;
      padding: 0;
    }
    .item {
      display: grid;
      grid-template-columns: 1fr 120px 90px;
      gap: 10px;
      align-items: center;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
    }
    .item:last-child { border-bottom: none; }
    .priority {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef5ff;
      color: #0b5bd3;
      font-weight: 600;
      font-size: 12px;
      text-align: center;
    }
    .empty {
      padding: 16px;
      text-align: center;
      color: var(--muted);
    }
    .actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin: 12px 0 0;
    }
    .small {
      padding: 8px 10px;
      font-size: 14px;
      border-radius: 6px;
    }
    .footer {
      margin-top: 18px;
      font-size: 13px;
      color: var(--muted);
    }
    .hint {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
    }
    .badge {
      font-size: 12px;
      background: #f0faf7;
      color: var(--accent-2);
      border: 1px solid #cde8de;
      border-radius: 999px;
      padding: 2px 8px;
    }
  </style>
</head>
<body>
  <main>
    <h1>Priority Queue</h1>
    <p class="description">
      A priority queue stores items with a priority and always removes the item with the “highest” priority first.
      Use the form below to add items and experiment with min-heap or max-heap ordering.
    </p>

    <div class="row">
      <div>
        <label for="heapType">Ordering</label>
        <select id="heapType" aria-label="Priority ordering">
          <option value="max">High numbers first (max-heap)</option>
          <option value="min">Low numbers first (min-heap)</option>
        </select>
        <div class="hint">Change how priorities are compared.</div>
      </div>
      <div>
        <label for="valueInput">Item</label>
        <input id="valueInput" placeholder="e.g., Print job A" />
      </div>
      <div>
        <label for="priorityInput">Priority (number)</label>
        <input id="priorityInput" type="number" step="1" inputmode="numeric" placeholder="e.g., 5" />
      </div>
    </div>

    <div class="controls">
      <div>
        <button id="addBtn">Add to queue</button>
      </div>
      <div>
        <button id="peekBtn" class="secondary">Peek</button>
      </div>
      <div>
        <button id="popBtn" class="secondary">Pop highest priority</button>
      </div>
    </div>

    <div class="status" id="status" aria-live="polite"></div>

    <section class="queue" aria-label="Current priority queue">
      <div class="queue-header">
        <div>
          Queue (<span id="size">0</span> items)
        </div>
        <div class="badge" id="modeBadge">Max-heap</div>
      </div>
      <ul class="list" id="list"></ul>
      <div class="actions" style="padding: 10px 12px;">
        <button id="sampleBtn" class="small secondary">Add sample items</button>
        <button id="shuffleBtn" class="small secondary">Randomize priorities</button>
        <button id="clearBtn" class="small danger">Clear queue</button>
      </div>
    </section>

    <div class="footer">
      Tip: In a max-heap, larger numbers have higher priority. In a min-heap, smaller numbers come out first.
    </div>
  </main>

  <script>
    // Simple array-backed priority queue (stable by insertion index)
    class PriorityQueue {
      constructor(isMax = true) {
        this.isMax = isMax;
        this.items = [];
        this._counter = 0; // for stability
      }
      setMode(isMax) {
        this.isMax = isMax;
        this._resort();
      }
      _compare(a, b) {
        if (this.isMax) {
          if (b.priority !== a.priority) return b.priority - a.priority;
        } else {
          if (a.priority !== b.priority) return a.priority - b.priority;
        }
        // Stable: earlier inserted comes first when priorities tie
        return a.index - b.index;
      }
      _resort() {
        this.items.sort((a, b) => this._compare(a, b));
      }
      enqueue(value, priority) {
        this.items.push({ value, priority, index: this._counter++ });
        this._resort();
      }
      dequeue() {
        return this.items.shift() || null;
      }
      peek() {
        return this.items[0] || null;
      }
      size() {
        return this.items.length;
      }
      clear() {
        this.items = [];
      }
    }

    const pq = new PriorityQueue(true);
    const els = {
      heapType: document.getElementById('heapType'),
      value: document.getElementById('valueInput'),
      priority: document.getElementById('priorityInput'),
      addBtn: document.getElementById('addBtn'),
      peekBtn: document.getElementById('peekBtn'),
      popBtn: document.getElementById('popBtn'),
      clearBtn: document.getElementById('clearBtn'),
      sampleBtn: document.getElementById('sampleBtn'),
      shuffleBtn: document.getElementById('shuffleBtn'),
      list: document.getElementById('list'),
      status: document.getElementById('status'),
      size: document.getElementById('size'),
      modeBadge: document.getElementById('modeBadge'),
    };

    function updateModeBadge() {
      els.modeBadge.textContent = pq.isMax ? 'Max-heap' : 'Min-heap';
    }

    function render() {
      els.size.textContent = pq.size();
      els.list.innerHTML = '';
      if (pq.size() === 0) {
        const empty = document.createElement('div');
        empty.className = 'empty';
        empty.textContent = 'Queue is empty. Add items to get started.';
        els.list.appendChild(empty);
        return;
      }
      pq.items.forEach((item, idx) => {
        const li = document.createElement('li');
        li.className = 'item';
        const value = document.createElement('div');
        value.textContent = item.value;
        const prio = document.createElement('div');
        prio.innerHTML = 'Priority: <span class="priority">' + item.priority + '</span>';
        const remove = document.createElement('div');
        const btn = document.createElement('button');
        btn.className = 'small danger';
        btn.textContent = 'Remove';
        btn.addEventListener('click', () => {
          pq.items.splice(idx, 1);
          render();
          announce('Removed item "' + item.value + '"');
        });
        remove.appendChild(btn);
        li.appendChild(value);
        li.appendChild(prio);
        li.appendChild(remove);
        els.list.appendChild(li);
      });
    }

    function announce(msg) {
      els.status.textContent = msg;
    }

    function addItem() {
      const value = (els.value.value || '').trim();
      const prioRaw = els.priority.value;
      const priority = Number(prioRaw);
      if (!value) {
        announce('Please enter an item name.');
        els.value.focus();
        return;
      }
      if (!Number.isFinite(priority)) {
        announce('Please enter a valid numeric priority.');
        els.priority.focus();
        return;
      }
      pq.enqueue(value, priority);
      render();
      announce('Added "' + value + '" with priority ' + priority + '.');
      els.value.value = '';
      els.priority.value = '';
      els.value.focus();
    }

    function peekItem() {
      const top = pq.peek();
      if (!top) {
        announce('Queue is empty.');
        return;
      }
      announce('Peek: "' + top.value + '" (priority ' + top.priority + ').');
    }

    function popItem() {
      const removed = pq.dequeue();
      if (!removed) {
        announce('Queue is empty.');
        return;
      }
      render();
      announce('Popped "' + removed.value + '" (priority ' + removed.priority + ').');
    }

    function clearQueue() {
      pq.clear();
      render();
      announce('Queue cleared.');
    }

    function addSamples() {
      const samples = [
        { value: 'Print job A', priority: 3 },
        { value: 'System alert', priority: 9 },
        { value: 'Email sync', priority: 5 },
        { value: 'Backup task', priority: 2 },
        { value: 'User request', priority: 7 },
      ];
      samples.forEach(s => pq.enqueue(s.value, s.priority));
      render();
      announce('Added sample items.');
    }

    function shufflePriorities() {
      if (pq.size() === 0) {
        announce('Queue is empty.');
        return;
      }
      pq.items.forEach(item => {
        item.priority = Math.floor(Math.random() * 10); // 0..9
      });
      pq._resort();
      render();
      announce('Randomized priorities.');
    }

    // Events
    els.addBtn.addEventListener('click', addItem);
    els.peekBtn.addEventListener('click', peekItem);
    els.popBtn.addEventListener('click', popItem);
    els.clearBtn.addEventListener('click', clearQueue);
    els.sampleBtn.addEventListener('click', addSamples);
    els.shuffleBtn.addEventListener('click', shufflePriorities);

    els.heapType.addEventListener('change', (e) => {
      const mode = e.target.value;
      const isMax = mode === 'max';
      pq.setMode(isMax);
      updateModeBadge();
      render();
      announce((isMax ? 'Max' : 'Min') + '-heap ordering selected.');
    });

    // Submit on Enter in priority field
    [els.value, els.priority].forEach(input => {
      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          addItem();
        }
      });
    });

    // Initial render
    updateModeBadge();
    render();
  </script>
</body>
</html>