<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sliding Window</title>
  <style>
    :root {
      --bg: #ffffff;
      --text: #222;
      --muted: #666;
      --primary: #0069d9;
      --fixed-bg: #e7f3ff;
      --fixed-border: #2e86ff;
      --var-bg: #ffecec;
      --var-border: #ff6b6b;
      --box: #e5e7eb;
      --border: #cfd4dc;
    }
    body {
      margin: 24px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: var(--bg);
      line-height: 1.5;
    }
    h1 {
      margin: 0 0 12px 0;
      font-size: 1.6rem;
    }
    p {
      margin: 8px 0;
      color: var(--muted);
    }
    .panel {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      margin: 16px 0;
    }
    .controls {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      align-items: end;
    }
    .controls .full {
      grid-column: 1 / -1;
    }
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
    }
    input[type="text"], input[type="number"] {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 0.95rem;
    }
    .buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    button {
      padding: 10px 14px;
      border: 1px solid var(--border);
      background: #f7f7f7;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
    }
    button.primary {
      background: var(--primary);
      color: #fff;
      border-color: var(--primary);
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    .array {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }
    .box {
      min-width: 40px;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--box);
      text-align: center;
      font-weight: 600;
    }
    .box.fixed {
      background: var(--fixed-bg);
      border-color: var(--fixed-border);
      box-shadow: 0 0 0 2px rgba(46, 134, 255, 0.15) inset;
    }
    .box.var {
      background: var(--var-bg);
      border-color: var(--var-border);
      box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.15) inset;
    }
    .result {
      margin-top: 12px;
      padding: 10px;
      background: #fafafa;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 0.95rem;
    }
    .small {
      font-size: 0.9rem;
      color: var(--muted);
    }
    code, pre {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    pre {
      margin: 0;
      padding: 12px;
      background: #0f172a;
      color: #e5e7eb;
      border-radius: 8px;
      overflow: auto;
    }
    .note {
      font-size: 0.9rem;
      color: #8a5a00;
      background: #fff6e0;
      border: 1px solid #ffe7a3;
      border-radius: 8px;
      padding: 10px;
      margin-top: 8px;
    }
    .msg {
      margin-top: 8px;
      color: #b00020;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <h1>Sliding Window</h1>
  <p>The sliding window technique is a powerful pattern for processing contiguous subarrays or substrings efficiently, often in linear time.</p>

  <div class="panel">
    <div class="controls">
      <div class="full">
        <label for="arr">Array (comma or space separated)</label>
        <input id="arr" type="text" value="2, 1, 5, 1, 3, 2" placeholder="e.g. 2, 1, 5, 1, 3, 2" />
      </div>
      <div>
        <label for="k">Fixed window size (k)</label>
        <input id="k" type="number" min="1" value="3" />
      </div>
      <div>
        <label for="target">Target sum (for variable window)</label>
        <input id="target" type="number" value="7" />
      </div>
    </div>
    <div class="buttons">
      <button id="render" title="Render array">Render</button>
      <button id="fixed" class="primary" title="Compute max sum fixed-size window">Max Sum (Fixed k)</button>
      <button id="variable" class="primary" title="Compute smallest subarray with sum ≥ target">Smallest Subarray ≥ Target</button>
      <button id="clear" title="Clear highlights">Clear Highlights</button>
      <button id="fillEx" title="Fill example data">Use Example</button>
    </div>

    <div id="message" class="msg" aria-live="polite"></div>

    <div id="array" class="array" aria-label="Array visualization"></div>

    <div id="fixedResult" class="result" hidden></div>
    <div id="varResult" class="result" hidden></div>

    <div class="note">
      Note:
      - The fixed-size window demo works with any numbers.
      - The variable-size demo assumes non-negative numbers; with negatives, standard sliding window for sum constraints may not be valid.
    </div>
  </div>

  <div class="panel">
    <h2 style="margin:0 0 8px 0;">How it works</h2>
    <ul class="small">
      <li>Fixed window: Move a window of size k across the array, update the sum in O(1) by subtracting the element that leaves and adding the one that enters.</li>
      <li>Variable window: Expand the end pointer until the condition is met, then shrink the start pointer to minimize the window while keeping the condition true.</li>
      <li>Time complexity: Typically O(n); Space complexity: O(1) additional space.</li>
    </ul>
    <pre><code>// Fixed-size window: max sum of any subarray of length k
function maxSumFixed(arr, k) {
  if (k &lt;= 0 || k &gt; arr.length) return null;
  let sum = 0;
  for (let i = 0; i &lt; k; i++) sum += arr[i];
  let best = { sum, start: 0 };
  for (let i = k; i &lt; arr.length; i++) {
    sum += arr[i] - arr[i - k];
    if (sum &gt; best.sum) best = { sum, start: i - k + 1 };
  }
  return { ...best, end: best.start + k - 1 };
}

// Variable-size window: smallest subarray with sum ≥ target (non-negative arr)
function minSubarrayAtLeast(arr, target) {
  let start = 0, sum = 0, best = { len: Infinity, start: -1, end: -1 };
  for (let end = 0; end &lt; arr.length; end++) {
    sum += arr[end];
    while (sum &gt;= target) {
      const len = end - start + 1;
      if (len &lt; best.len) best = { len, start, end };
      sum -= arr[start++];
    }
  }
  return best.len === Infinity ? null : best;
}</code></pre>
  </div>

  <noscript>
    This demo requires JavaScript enabled to run the interactive examples.
  </noscript>

  <script>
    const arrInput = document.getElementById('arr');
    const kInput = document.getElementById('k');
    const targetInput = document.getElementById('target');
    const renderBtn = document.getElementById('render');
    const fixedBtn = document.getElementById('fixed');
    const varBtn = document.getElementById('variable');
    const clearBtn = document.getElementById('clear');
    const fillExBtn = document.getElementById('fillEx');
    const arrayEl = document.getElementById('array');
    const msgEl = document.getElementById('message');
    const fixedResultEl = document.getElementById('fixedResult');
    const varResultEl = document.getElementById('varResult');

    let currentArr = [];

    function parseArray(str) {
      const parts = String(str).trim().split(/[,\s]+/).filter(Boolean);
      if (parts.length === 0) return [];
      const nums = parts.map(p => Number(p));
      if (nums.some(n => Number.isNaN(n))) return null;
      return nums;
    }

    function renderArray(arr) {
      arrayEl.innerHTML = '';
      arr.forEach((n, i) => {
        const div = document.createElement('div');
        div.className = 'box';
        div.textContent = String(n);
        div.setAttribute('data-index', i);
        arrayEl.appendChild(div);
      });
    }

    function clearHighlights() {
      [...arrayEl.children].forEach(el => {
        el.classList.remove('fixed', 'var');
      });
      fixedResultEl.hidden = true;
      varResultEl.hidden = true;
      msgEl.textContent = '';
    }

    function highlightRange(start, end, type) {
      [...arrayEl.children].forEach((el, i) => {
        el.classList.remove(type);
        if (i >= start && i <= end) {
          el.classList.add(type);
        }
      });
    }

    function maxSumFixed(arr, k) {
      if (!Array.isArray(arr) || arr.length === 0 || k <= 0 || k > arr.length) return null;
      let sum = 0;
      for (let i = 0; i < k; i++) sum += arr[i];
      let bestSum = sum;
      let bestStart = 0;
      for (let i = k; i < arr.length; i++) {
        sum += arr[i] - arr[i - k];
        if (sum > bestSum) {
          bestSum = sum;
          bestStart = i - k + 1;
        }
      }
      return { sum: bestSum, start: bestStart, end: bestStart + k - 1 };
    }

    function minSubarrayAtLeast(arr, target) {
      if (!Array.isArray(arr) || arr.length === 0) return null;
      // Warn if negatives exist (algorithm assumption)
      const hasNegative = arr.some(n => n < 0);
      if (hasNegative && target >= 0) {
        // Proceed, but may be incorrect; just compute anyway
      }
      let start = 0, sum = 0;
      let bestLen = Infinity, bestStart = -1, bestEnd = -1;
      for (let end = 0; end < arr.length; end++) {
        sum += arr[end];
        while (sum >= target) {
          const len = end - start + 1;
          if (len < bestLen) {
            bestLen = len;
            bestStart = start;
            bestEnd = end;
          }
          sum -= arr[start++];
        }
      }
      if (bestLen === Infinity) return null;
      return { len: bestLen, start: bestStart, end: bestEnd };
    }

    function runRender() {
      const arr = parseArray(arrInput.value);
      if (arr === null) {
        msgEl.textContent = 'Invalid array: please enter numbers separated by commas/spaces.';
        return;
      }
      currentArr = arr;
      renderArray(arr);
      clearHighlights();
      msgEl.textContent = 'Array rendered.';
    }

    function runFixed() {
      if (!currentArr.length) {
        msgEl.textContent = 'Please render a valid array first.';
        return;
      }
      const k = Number(kInput.value);
      if (!Number.isInteger(k) || k <= 0) {
        msgEl.textContent = 'Window size k must be a positive integer.';
        return;
      }
      if (k > currentArr.length) {
        msgEl.textContent = 'Window size k cannot exceed array length.';
        return;
      }
      const res = maxSumFixed(currentArr, k);
      if (!res) {
        msgEl.textContent = 'Unable to compute fixed window result.';
        return;
      }
      highlightRange(res.start, res.end, 'fixed');
      fixedResultEl.hidden = false;
      fixedResultEl.textContent = `Max sum for k=${k}: ${res.sum} at indices [${res.start}..${res.end}] -> [${currentArr.slice(res.start, res.end + 1).join(', ')}]`;
      msgEl.textContent = '';
    }

    function runVariable() {
      if (!currentArr.length) {
        msgEl.textContent = 'Please render a valid array first.';
        return;
      }
      const target = Number(targetInput.value);
      if (!Number.isFinite(target)) {
        msgEl.textContent = 'Target must be a valid number.';
        return;
      }
      const res = minSubarrayAtLeast(currentArr, target);
      varResultEl.hidden = false;
      if (!res) {
        clearHighlights();
        varResultEl.textContent = `No subarray has sum ≥ ${target}.`;
        return;
      }
      highlightRange(res.start, res.end, 'var');
      const sub = currentArr.slice(res.start, res.end + 1);
      const sum = sub.reduce((a, b) => a + b, 0);
      varResultEl.textContent = `Smallest subarray with sum ≥ ${target}: length ${res.len} at [${res.start}..${res.end}] -> [${sub.join(', ')}], sum=${sum}`;
      msgEl.textContent = '';
    }

    function fillExample() {
      arrInput.value = '2, 1, 5, 1, 3, 2';
      kInput.value = 3;
      targetInput.value = 7;
      runRender();
      runFixed();
      runVariable();
    }

    renderBtn.addEventListener('click', runRender);
    fixedBtn.addEventListener('click', runFixed);
    varBtn.addEventListener('click', runVariable);
    clearBtn.addEventListener('click', clearHighlights);
    fillExBtn.addEventListener('click', fillExample);

    document.addEventListener('DOMContentLoaded', fillExample);
  </script>
</body>
</html>