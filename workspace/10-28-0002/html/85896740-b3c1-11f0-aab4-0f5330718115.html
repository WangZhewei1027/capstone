<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quick Sort</title>
  <style>
    :root {
      color-scheme: light dark;
    }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      margin: 0;
      line-height: 1.5;
    }
    header {
      background: #0b5fff;
      color: white;
      padding: 1rem;
      text-align: center;
    }
    main {
      max-width: 800px;
      margin: 0 auto;
      padding: 1rem;
    }
    h1, h2, h3 {
      margin: 0.5rem 0;
    }
    .card {
      border: 1px solid #d0d7de;
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
    }
    label, input, button {
      font-size: 1rem;
    }
    input[type="text"] {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      margin-top: 0.25rem;
    }
    .actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
      flex-wrap: wrap;
    }
    button {
      padding: 0.5rem 0.75rem;
      border: 1px solid #0b5fff;
      background: #0b5fff;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
    button.secondary {
      background: transparent;
      color: #0b5fff;
    }
    pre {
      background: #f6f8fa;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      padding: 0.75rem;
      overflow: auto;
    }
    .output {
      border: 1px dashed #d0d7de;
      border-radius: 6px;
      padding: 0.75rem;
      min-height: 2.2rem;
      white-space: pre-wrap;
      word-break: break-word;
      background: #fff;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    @media (min-width: 700px) {
      .grid {
        grid-template-columns: 1fr 1fr;
      }
    }
    footer {
      padding: 1rem;
      text-align: center;
      color: #6e7781;
    }
  </style>
</head>
<body>
  <header>
    <h1>Quick Sort</h1>
    <p>Divide-and-conquer sorting algorithm with average O(n log n) time</p>
  </header>

  <main>
    <section class="card" aria-labelledby="about-title">
      <h2 id="about-title">About</h2>
      <p>
        Quick Sort is a fast, comparison-based sorting algorithm that uses a divide-and-conquer strategy.
        It selects a pivot, partitions the array into elements less than and greater than the pivot,
        and then sorts the partitions recursively.
      </p>
      <ul>
        <li>Average and best-case time: O(n log n)</li>
        <li>Worst-case time: O(nÂ²) (e.g., poor pivot choices on already sorted data)</li>
        <li>Space complexity: O(log n) auxiliary (due to recursion)</li>
        <li>Not stable (equal elements may change relative order)</li>
        <li>In-place partitioning (no large additional arrays required)</li>
      </ul>
    </section>

    <section class="card" aria-labelledby="pseudo-title">
      <h2 id="pseudo-title">Pseudocode (Hoare partition, middle pivot)</h2>
      <pre><code>procedure quicksort(A, lo, hi):
  if lo &gt;= hi:
    return

  pivot := A[(lo + hi) // 2]      // choose middle element as pivot
  i := lo
  j := hi

  while i &lt;= j:
    while A[i] &lt; pivot: i := i + 1
    while A[j] &gt; pivot: j := j - 1
    if i &lt;= j:
      swap A[i], A[j]
      i := i + 1
      j := j - 1

  quicksort(A, lo, j)
  quicksort(A, i, hi)</code></pre>
    </section>

    <section class="card" aria-labelledby="try-title">
      <h2 id="try-title">Try it</h2>
      <label for="numbers">Enter numbers (comma or space-separated):</label>
      <input id="numbers" type="text" placeholder="e.g., 5, 3, 8, 4, 2, 7" />
      <div class="actions">
        <button id="sort">Sort</button>
        <button id="random" class="secondary">Random</button>
        <button id="clear" class="secondary">Clear</button>
      </div>
      <div class="grid" style="margin-top: 1rem;">
        <div>
          <h3>Sorted result</h3>
          <div id="result" class="output" aria-live="polite"></div>
        </div>
        <div>
          <h3>Steps (partitioning and swaps)</h3>
          <div id="steps" class="output" aria-live="polite"></div>
        </div>
      </div>
    </section>

    <section class="card" aria-labelledby="impl-title">
      <h2 id="impl-title">JavaScript Implementation</h2>
      <pre><code>function quickSort(arr, left = 0, right = arr.length - 1, log = () =&gt; {}) {
  if (left &gt;= right) return;

  // Choose a pivot to reduce worst-case chances; here we use the middle element.
  const pivotIndex = Math.floor((left + right) / 2);
  const pivot = arr[pivotIndex];
  log(`Pivot: ${pivot} (index ${pivotIndex}) on subarray [${left}..${right}]`);

  // Hoare partition scheme
  let i = left;
  let j = right;
  while (i &lt;= j) {
    while (arr[i] &lt; pivot) i++;
    while (arr[j] &gt; pivot) j--;
    if (i &lt;= j) {
      if (i !== j) log(`Swap arr[${i}]=${arr[i]} with arr[${j}]=${arr[j}]`);
      [arr[i], arr[j]] = [arr[j], arr[i]];
      i++;
      j--;
    }
  }

  log(`Partitioned: [${arr.slice(left, right + 1).join(', ')}] around pivot ${pivot}`);
  if (left &lt; j) quickSort(arr, left, j, log);
  if (i &lt; right) quickSort(arr, i, right, log);
}</code></pre>
    </section>
  </main>

  <footer>
    Built for learning: experiment with inputs to see how partitioning affects performance.
  </footer>

  <script>
    function quickSort(arr, left = 0, right = arr.length - 1, log = () => {}) {
      if (left >= right) return;

      const pivotIndex = Math.floor((left + right) / 2);
      const pivot = arr[pivotIndex];
      log(`Pivot: ${pivot} (index ${pivotIndex}) on subarray [${left}..${right}]`);

      let i = left;
      let j = right;
      while (i <= j) {
        while (arr[i] < pivot) i++;
        while (arr[j] > pivot) j--;
        if (i <= j) {
          if (i !== j) log(`Swap arr[${i}]=${arr[i]} with arr[${j}]=${arr[j}]`);
          const tmp = arr[i];
          arr[i] = arr[j];
          arr[j] = tmp;
          i++;
          j--;
        }
      }

      log(`Partitioned: [${arr.slice(left, right + 1).join(', ')}] around pivot ${pivot}`);
      if (left < j) quickSort(arr, left, j, log);
      if (i < right) quickSort(arr, i, right, log);
    }

    function parseNumbers(str) {
      return str
        .split(/[\s,]+/)
        .filter(s => s.length)
        .map(s => Number(s))
        .filter(n => Number.isFinite(n));
    }

    function formatArray(arr) {
      return arr.join(', ');
    }

    const inputEl = document.getElementById('numbers');
    const sortBtn = document.getElementById('sort');
    const randomBtn = document.getElementById('random');
    const clearBtn = document.getElementById('clear');
    const resultEl = document.getElementById('result');
    const stepsEl = document.getElementById('steps');

    sortBtn.addEventListener('click', () => {
      const arr = parseNumbers(inputEl.value);
      if (!arr.length) {
        resultEl.textContent = 'Please enter at least one number.';
        stepsEl.textContent = '';
        return;
      }
      const copy = arr.slice();
      const logs = [];
      quickSort(copy, 0, copy.length - 1, msg => logs.push(msg));
      resultEl.textContent = formatArray(copy);
      stepsEl.textContent = logs.join('\n');
    });

    randomBtn.addEventListener('click', () => {
      const n = 10;
      const arr = Array.from({ length: n }, () => Math.floor(Math.random() * 100));
      inputEl.value = arr.join(', ');
      resultEl.textContent = '';
      stepsEl.textContent = '';
      inputEl.focus();
    });

    clearBtn.addEventListener('click', () => {
      inputEl.value = '';
      resultEl.textContent = '';
      stepsEl.textContent = '';
      inputEl.focus();
    });
  </script>
</body>
</html>