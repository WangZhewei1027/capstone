<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Heap Sort</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height: 1.5; margin: 0; padding: 24px; }
    .container { max-width: 760px; margin: 0 auto; }
    h1 { font-size: 1.8rem; margin: 0 0 12px; }
    p { margin: 8px 0; }
    ul { padding-left: 18px; }
    .panel { border: 1px solid rgba(127,127,127,0.35); border-radius: 8px; padding: 16px; margin-top: 16px; }
    .controls { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
    input[type="text"] { flex: 1 1 340px; padding: 8px 10px; border: 1px solid rgba(127,127,127,0.35); border-radius: 6px; font-size: 1rem; }
    button { padding: 8px 12px; border: 1px solid rgba(127,127,127,0.35); background: #f3f3f3; border-radius: 6px; cursor: pointer; font-size: 1rem; }
    button:hover { background: #e9e9e9; }
    .output { margin-top: 12px; white-space: pre-wrap; word-break: break-word; }
    code, pre { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    pre { background: rgba(127,127,127,0.1); padding: 12px; border-radius: 8px; overflow: auto; }
    .note { font-size: 0.95rem; color: #555; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Heap Sort</h1>
    <p>Heap Sort is a comparison-based sorting algorithm that builds a binary heap and repeatedly extracts the maximum (or minimum) element to produce a sorted array. It is in-place and has consistent O(n log n) time complexity.</p>

    <div class="panel">
      <strong>How it works</strong>
      <ul>
        <li>Build a max-heap from the input array.</li>
        <li>Swap the root (largest element) with the last element in the heap.</li>
        <li>Reduce the heap size by one and heapify the root to restore the heap property.</li>
        <li>Repeat until the heap size is 1.</li>
      </ul>
      <p class="note">Properties: in-place, not stable, time complexity O(n log n) in best/average/worst cases, space complexity O(1) auxiliary.</p>
    </div>

    <div class="panel">
      <strong>Try it</strong>
      <div class="controls">
        <input id="arrayInput" type="text" placeholder="Enter numbers (e.g., 5, 3, 8, 1, 2)">
        <button id="sortBtn">Sort</button>
        <button id="randomBtn" title="Fill with a random array">Randomize</button>
        <button id="clearBtn">Clear</button>
      </div>
      <div class="output" id="output"></div>
    </div>

    <div class="panel">
      <strong>JavaScript implementation</strong>
      <pre><code>// In-place Heap Sort (max-heap)
function heapSort(arr) {
  const n = arr.length;

  // Build max-heap
  for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {
    heapify(arr, n, i);
  }

  // Extract elements from heap one by one
  for (let end = n - 1; end > 0; end--) {
    [arr[0], arr[end]] = [arr[end], arr[0]]; // move current max to end
    heapify(arr, end, 0); // restore heap for reduced size
  }
  return arr;
}

// Iterative heapify for performance and to avoid recursion limits
function heapify(arr, heapSize, i) {
  while (true) {
    let largest = i;
    const l = 2 * i + 1;
    const r = 2 * i + 2;

    if (l &lt; heapSize && arr[l] > arr[largest]) largest = l;
    if (r &lt; heapSize && arr[r] > arr[largest]) largest = r;

    if (largest !== i) {
      [arr[i], arr[largest]] = [arr[largest], arr[i]];
      i = largest; // continue sifting down
    } else {
      break;
    }
  }
}</code></pre>
    </div>
  </div>

  <script>
    function parseInput(input) {
      const parts = input.split(/[\s,]+/).filter(s => s.length);
      if (parts.length === 0) return { ok: true, arr: [] };
      const arr = [];
      for (const p of parts) {
        const num = Number(p);
        if (!Number.isFinite(num)) {
          return { ok: false, error: `Invalid number: "${p}"` };
        }
        arr.push(num);
      }
      return { ok: true, arr };
    }

    function heapSort(arr) {
      const n = arr.length;
      for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {
        heapify(arr, n, i);
      }
      for (let end = n - 1; end > 0; end--) {
        const tmp = arr[0]; arr[0] = arr[end]; arr[end] = tmp;
        heapify(arr, end, 0);
      }
      return arr;
    }

    function heapify(arr, heapSize, i) {
      while (true) {
        let largest = i;
        const l = 2 * i + 1;
        const r = 2 * i + 2;
        if (l < heapSize && arr[l] > arr[largest]) largest = l;
        if (r < heapSize && arr[r] > arr[largest]) largest = r;
        if (largest !== i) {
          const tmp = arr[i]; arr[i] = arr[largest]; arr[largest] = tmp;
          i = largest;
        } else {
          break;
        }
      }
    }

    function showOutput(original, sorted) {
      const out = document.getElementById('output');
      const origStr = original.length ? original.join(', ') : '(empty array)';
      const sortedStr = sorted.length ? sorted.join(', ') : '(empty array)';
      out.textContent =
        'Original: [' + origStr + ']\n' +
        'Sorted:   [' + sortedStr + ']';
    }

    function randomArray(len = 10) {
      const arr = [];
      for (let i = 0; i < len; i++) {
        // Random integers between -99 and 99
        arr.push(Math.floor(Math.random() * 199) - 99);
      }
      return arr;
    }

    document.getElementById('sortBtn').addEventListener('click', () => {
      const inputEl = document.getElementById('arrayInput');
      const parsed = parseInput(inputEl.value);
      const out = document.getElementById('output');
      if (!parsed.ok) {
        out.textContent = parsed.error;
        return;
      }
      const original = parsed.arr;
      const sorted = heapSort([...original]);
      showOutput(original, sorted);
    });

    document.getElementById('randomBtn').addEventListener('click', () => {
      const arr = randomArray(10);
      document.getElementById('arrayInput').value = arr.join(', ');
      showOutput(arr, heapSort([...arr]));
    });

    document.getElementById('clearBtn').addEventListener('click', () => {
      document.getElementById('arrayInput').value = '';
      document.getElementById('output').textContent = '';
    });

    document.getElementById('arrayInput').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('sortBtn').click();
      }
    });
  </script>
</body>
</html>