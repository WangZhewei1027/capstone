<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Means Clustering Interactive Module</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #controls {
            margin-bottom: 16px;
        }
        button {
            margin-right: 16px;
            padding: 10px;
        }
        canvas {
            border: 1px solid #ccc;
            background-color: #f9f9f9;
        }
        #info {
            margin-top: 16px;
            text-align: center;
        }
    </style>
</head>
<body>

    <h1>K-Means Clustering: An Interactive Exploration</h1>
    <p>Understand how K-Means Clustering groups data points into clusters.</p>
    
    <div id="controls">
        <input type="number" id="clusterCount" min="1" value="3" placeholder="Number of Clusters (K)">
        <button id="generatePoints">Generate Points</button>
        <button id="setClusters">Set Clusters</button>
        <button id="runKMeans">Run K-Means</button>
    </div>

    <canvas id="canvas" width="600" height="400"></canvas>
    <div id="info"></div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let points = [];
        let centroids = [];
        let k = 3; // default K value

        document.getElementById('generatePoints').addEventListener('click', generatePoints);
        document.getElementById('setClusters').addEventListener('click', setClusters);
        document.getElementById('runKMeans').addEventListener('click', runKMeans);

        function generatePoints() {
            points = [];
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < 50; i++) {
                points.push({x: Math.random() * canvas.width, y: Math.random() * canvas.height});
            }
            drawPoints();
        }
        
        function drawPoints() {
            points.forEach(point => {
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function setClusters() {
            k = parseInt(document.getElementById('clusterCount').value);
            centroids = [];
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPoints();
            for (let i = 0; i < k; i++) {
                const cx = Math.random() * canvas.width;
                const cy = Math.random() * canvas.height;
                centroids.push({x: cx, y: cy});
                ctx.fillStyle = 'red';
                ctx.beginPath();
                ctx.arc(cx, cy, 10, 0, Math.PI * 2);
                ctx.fill();
            }
            drawCentroids();
        }

        function drawCentroids() {
            centroids.forEach(centroid => {
                ctx.fillStyle = 'blue';
                ctx.beginPath();
                ctx.arc(centroid.x, centroid.y, 10, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function runKMeans() {
            let iterations = 10;
            for (let iteration = 0; iteration < iterations; iteration++) {
                assignClusters();
                updateCentroids();
                draw();
            }
        }

        function assignClusters() {
            points.forEach(point => {
                let closest = null;
                let minDist = Infinity;

                centroids.forEach((centroid, index) => {
                    const dist = Math.sqrt(Math.pow(point.x - centroid.x, 2) + Math.pow(point.y - centroid.y, 2));
                    if (dist < minDist) {
                        minDist = dist;
                        closest = index;
                    }
                });
                point.cluster = closest;
            });
        }

        function updateCentroids() {
            centroids.forEach((centroid, index) => {
                const clusterPoints = points.filter(p => p.cluster === index);
                if (clusterPoints.length > 0) {
                    const avgX = clusterPoints.reduce((sum, p) => sum + p.x, 0) / clusterPoints.length;
                    const avgY = clusterPoints.reduce((sum, p) => sum + p.y, 0) / clusterPoints.length;
                    centroid.x = avgX;
                    centroid.y = avgY;
                }
            });
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPoints();

            centroids.forEach((centroid, index) => {
                ctx.fillStyle = 'blue';
                ctx.beginPath();
                ctx.arc(centroid.x, centroid.y, 10, 0, Math.PI * 2);
                ctx.fill();
            });

            points.forEach(point => {
                ctx.fillStyle = ['green', 'orange', 'purple'][point.cluster];
                ctx.beginPath();
                ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);
                ctx.fill();
            });
            document.getElementById('info').innerText = 'Clusters have been updated! Check the colors';
        }
    </script>
</body>
</html>