<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Union-Find Interactive Exploration</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px;
            box-sizing: border-box;
        }
        header {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 16px;
        }
        #canvas {
            border: 1px solid #ccc;
            width: 100%;
            height: 400px;
            position: relative;
            overflow: hidden;
            margin-bottom: 16px;
            background-color: #f9f9f9;
        }
        .node {
            width: 30px;
            height: 30px;
            background-color: #007bff;
            border-radius: 50%;
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            cursor: pointer;
        }
        button {
            padding: 10px 15px;
            margin-right: 16px;
            cursor: pointer;
        }
        #controls {
            display: flex;
            justify-content: center;
        }
        .instructions {
            margin-bottom: 16px;
        }
    </style>
</head>
<body>

<header>Union-Find (Disjoint Set) Interactive Exploration</header>
<div class="instructions">
    Click "Add Node" to create nodes. Drag from one node to another to union them. Click a node to see its root.
</div>
<div id="canvas"></div>
<div id="controls">
    <button id="addNode">Add Node</button>
    <button id="clearAll">Clear All</button>
</div>

<script>
    const canvas = document.getElementById('canvas');
    const addNodeButton = document.getElementById('addNode');
    const clearAllButton = document.getElementById('clearAll');
    let nodes = [];
    let nodeId = 0;
    let dragging = null;

    addNodeButton.addEventListener('click', addNode);
    clearAllButton.addEventListener('click', clearAll);
    canvas.addEventListener('mousedown', onMouseDown);
    canvas.addEventListener('mouseup', onMouseUp);
    canvas.addEventListener('mousemove', onMouseMove);
    document.addEventListener('mouseup', onDocumentMouseUp);
    
    function addNode() {
        const nodeElement = document.createElement('div');
        nodeElement.className = 'node';
        nodeElement.textContent = nodeId;
        nodeElement.style.left = Math.random() * (canvas.offsetWidth - 30) + 'px';
        nodeElement.style.top = Math.random() * (canvas.offsetHeight - 30) + 'px';
        nodeElement.dataset.id = nodeId;
        nodeElement.addEventListener('click', () => findRoot(nodeId));
        canvas.appendChild(nodeElement);
        nodes.push({ id: nodeId, parent: nodeId });
        nodeId++;
    }

    function clearAll() {
        nodes = [];
        nodeId = 0;
        while (canvas.firstChild) {
            canvas.removeChild(canvas.firstChild);
        }
    }

    function onMouseDown(event) {
        if (event.target.classList.contains('node')) {
            dragging = event.target;
            dragging.classList.add('dragging');
        }
    }

    function onMouseUp() {
        if (dragging) {
            dragging.classList.remove('dragging');
            dragging = null;
        }
    }

    function onMouseMove(event) {
        if (dragging) {
            dragging.style.left = (event.clientX - canvas.offsetLeft - 15) + 'px';
            dragging.style.top = (event.clientY - canvas.offsetTop - 15) + 'px';
        }
    }

    function onDocumentMouseUp(event) {
        if (dragging) {
            const target = event.target;
            if (target.classList.contains('node') && target !== dragging) {
                union(Number(dragging.dataset.id), Number(target.dataset.id));
            }
            onMouseUp();
        }
    }

    function union(id1, id2) {
        const root1 = findRoot(id1);
        const root2 = findRoot(id2);
        if (root1 !== root2) {
            nodes[root2].parent = root1;
            alert(`Union Made: ${id1} with ${id2}`);
        }
    }

    function findRoot(id) {
        let current = id;
        while (nodes[current].parent !== current) {
            current = nodes[current].parent;
        }
        highlightPath(id, current);
        return current;
    }

    function highlightPath(id, root) {
        let current = id;
        while (nodes[current].parent !== current) {
            setTimeout(() => {
                document.querySelector(`.node[data-id="${current}"]`).style.backgroundColor = '#dc3545';
            }, 300);
            current = nodes[current].parent;
        }
        setTimeout(() => {
            document.querySelector(`.node[data-id="${current}"]`).style.backgroundColor = '#28a745';
        }, 300);
    }

</script>
</body>
</html>