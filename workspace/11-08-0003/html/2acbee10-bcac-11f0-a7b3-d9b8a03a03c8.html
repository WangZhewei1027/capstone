<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Regression Explorer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 24px;
            background-color: #f5f5f5;
        }
        h1 {
            margin-bottom: 24px;
        }
        #graph {
            border: 1px solid #ccc;
            width: 100%;
            height: 400px;
            position: relative;
        }
        .point {
            width: 10px;
            height: 10px;
            background-color: #007BFF;
            border-radius: 50%;
            position: absolute;
            cursor: pointer;
        }
        #feedback {
            margin: 16px 0;
        }
        button {
            padding: 10px 20px;
            background-color: #28a745;
            border: none;
            color: white;
            cursor: pointer;
            margin-top: 16px;
        }
        button:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>

    <h1>Understanding Linear Regression</h1>
    <div id="graph"></div>
    <div id="feedback">Regression Equation: y = mx + b</div>
    <button id="resetButton">Reset Points</button>

    <script>

        const graph = document.getElementById('graph');
        const feedback = document.getElementById('feedback');
        const resetButton = document.getElementById('resetButton');

        let points = [];

        function drawLine() {
            const m = calculateSlope(points);
            const b = calculateIntercept(m, points);
            const equation = `y = ${m.toFixed(2)}x + ${b.toFixed(2)}`;
            feedback.textContent = equation;

            const line = document.createElement('div');
            line.style.position = 'absolute';
            line.style.width = '100%';
            line.style.height = '1px';
            line.style.background = 'red';
            const y1 = m * 0 + b; // line start
            const y2 = m * graph.clientWidth + b; // line end
            line.style.transform = `translate(0, ${y1}px) rotate(${Math.atan(m) * 180/Math.PI}deg)`;
            line.style.top = `${y1}px`;
            graph.innerHTML = ''; // clear previous points and line
            points.forEach(p => appendPoint(p.x, p.y));
            graph.appendChild(line);
        }

        function calculateSlope(points) {
            if (points.length < 2) return 0;
            const sumX = points.reduce((sum, p) => sum + p.x, 0);
            const sumY = points.reduce((sum, p) => sum + p.y, 0);
            const sumXY = points.reduce((sum, p) => sum + p.x * p.y, 0);
            const sumXX = points.reduce((sum, p) => sum + p.x * p.x, 0);
            const n = points.length;
            return (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
        }

        function calculateIntercept(m, points) {
            const meanX = points.reduce((sum, p) => sum + p.x, 0) / points.length;
            const meanY = points.reduce((sum, p) => sum + p.y, 0) / points.length;
            return meanY - m * meanX;
        }

        function appendPoint(x, y) {
            const pointElement = document.createElement('div');
            pointElement.classList.add('point');
            pointElement.style.left = `${x}px`;
            pointElement.style.top = `${y}px`;
            pointElement.draggable = true;
            pointElement.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', null);
            });
            pointElement.addEventListener('dragend', (e) => {
                const rect = graph.getBoundingClientRect();
                const newX = e.clientX - rect.left - 5; // center the point
                const newY = e.clientY - rect.top - 5;  // center the point
                handleMovePoint(pointElement, newX, newY);
            });
            graph.appendChild(pointElement);
            points.push({ x, y });
            drawLine();
        }

        function handleMovePoint(pointElement, newX, newY) {
            const updatedPoint = points.find(p => pointElement.style.left === `${p.x}px` && pointElement.style.top === `${p.y}px`);
            if (updatedPoint) {
                updatedPoint.x = newX;
                updatedPoint.y = newY;
                pointElement.style.left = `${newX}px`;
                pointElement.style.top = `${newY}px`;
                drawLine();
            }
        }

        graph.addEventListener('click', (e) => {
            const rect = graph.getBoundingClientRect();
            const x = e.clientX - rect.left - 5; // center the point
            const y = e.clientY - rect.top - 5;   // center the point
            appendPoint(x, y);
        });

        resetButton.addEventListener('click', () => {
            points = [];
            graph.innerHTML = '';
            feedback.textContent = 'Regression Equation: y = mx + b';
        });

    </script>
</body>
</html>