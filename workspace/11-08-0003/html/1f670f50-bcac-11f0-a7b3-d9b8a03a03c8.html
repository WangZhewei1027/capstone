<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Nearest Neighbors Explorer</title>
    <style>
        body {
            display: flex;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            height: 100vh;
        }

        .sidebar {
            width: 200px;
            padding: 24px;
            background-color: #f4f4f4;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }

        .canvas {
            flex-grow: 1;
            position: relative;
            background-color: #eaeaea;
        }

        h1 {
            font-size: 1.5em;
            margin-bottom: 24px;
        }

        .input-group {
            margin-bottom: 16px;
        }

        label, .controls {
            display: block;
        }

        input[type="number"] {
            width: 100%;
            padding: 8px;
            margin: 4px 0;
        }

        .canvas-point {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            position: absolute;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .selected {
            background-color: red !important;
        }

        .neighbor {
            background-color: blue !important;
        }
    </style>
</head>

<body>

    <div class="sidebar">
        <h1>Explore KNN</h1>
        <div class="input-group">
            <label for="k-input">Enter K (number of neighbors):</label>
            <input type="number" id="k-input" value="3" min="1" max="10">
        </div>
        <div class="controls">
            <button id="reset-btn">Reset</button>
        </div>
    </div>

    <div class="canvas" id="canvas"></div>

    <script>
        const canvas = document.getElementById('canvas');
        const kInput = document.getElementById('k-input');
        const resetBtn = document.getElementById('reset-btn');

        let points = [];
        let selectedPoint = null;

        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            points.push({ x, y, id: points.length });
            drawPoints();
        });

        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            const pointId = getPointAt(e.clientX, e.clientY);
            if (pointId !== null) {
                points = points.filter(p => p.id !== pointId);
                drawPoints();
            }
        });

        canvas.addEventListener('mousemove', (e) => {
            const pointId = getPointAt(e.clientX, e.clientY);
            canvas.style.cursor = pointId !== null ? 'pointer' : 'default';
        });

        canvas.addEventListener('mousedown', (e) => {
            const pointId = getPointAt(e.clientX, e.clientY);
            if (pointId !== null) {
                selectedPoint = points.find(p => p.id === pointId);
                drawPoints();
            }
        });

        canvas.addEventListener('mouseup', () => {
            selectedPoint = null;
        });

        canvas.addEventListener('mouseleave', () => {
            selectedPoint = null;
        });

        canvas.addEventListener('mousemove', (e) => {
            if (selectedPoint) {
                const rect = canvas.getBoundingClientRect();
                selectedPoint.x = e.clientX - rect.left;
                selectedPoint.y = e.clientY - rect.top;
                drawPoints();
            }
        });

        function drawPoints() {
            canvas.innerHTML = ''; // Clear the canvas
            const k = parseInt(kInput.value) || 1; // Fetch K

            points.forEach(point => {
                const pointDiv = document.createElement('div');
                pointDiv.className = 'canvas-point';
                pointDiv.style.left = point.x + 'px';
                pointDiv.style.top = point.y + 'px';
                pointDiv.style.backgroundColor = 'green'; // Default color
                if (point === selectedPoint) {
                    pointDiv.classList.add('selected');
                } else {
                    const neighbors = calculateNeighbors(point, k);
                    if (neighbors.length > 0) {
                        pointDiv.classList.add('neighbor');
                    }
                }
                canvas.appendChild(pointDiv);
            });
        }

        function calculateNeighbors(targetPoint, k) {
            const distances = points.map(point => {
                if (point === targetPoint) return null;
                const distance = Math.sqrt(Math.pow(point.x - targetPoint.x, 2) + Math.pow(point.y - targetPoint.y, 2));
                return { point, distance };
            }).filter(Boolean);

            distances.sort((a, b) => a.distance - b.distance);
            return distances.slice(0, k);
        }

        function getPointAt(x, y) {
            for (const point of points) {
                const dist = Math.sqrt(Math.pow(point.x - x, 2) + Math.pow(point.y - y, 2));
                if (dist < 12) return point.id; // 12 is the clickable area
            }
            return null;
        }

        resetBtn.addEventListener('click', () => {
            points = [];
            drawPoints();
        });
    </script>
</body>

</html>