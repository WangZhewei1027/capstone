<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Two Pointers — Pair Sum Visualizer</title>
  <style>
    :root{
      --safe-pad: 24px;
      --gap: 16px;
      --bg: #0f1724;
      --card: #0b1220;
      --muted: #98a0b3;
      --accent: #60a5fa;
      --success: #34d399;
      --danger: #fb7185;
      --info: #f59e0b;
      --panel-radius: 12px;
      --font-sans: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{
      height:100%;
      margin:0;
      background: linear-gradient(180deg,#071021 0%, #081328 60%);
      color:#e6eef8;
      font-family:var(--font-sans);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .app{
      padding:var(--safe-pad);
      box-sizing:border-box;
      min-height:100%;
      display:flex;
      flex-direction:column;
      gap:var(--gap);
    }

    header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:var(--gap);
      flex-wrap:wrap;
    }
    header .title {
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    h1 {
      margin:0;
      font-size:20px;
      letter-spacing:0.2px;
    }
    p.lead {
      margin:0;
      color:var(--muted);
      font-size:13px;
    }

    main {
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:var(--gap);
      align-items:start;
    }

    /* Responsive */
    @media (max-width: 920px){
      main{ grid-template-columns: 1fr; }
    }

    /* Visual card */
    .card {
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--panel-radius);
      padding:18px;
      box-shadow: 0 6px 20px rgba(2,6,23,0.6);
      min-height:120px;
    }

    .visual {
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
    }

    /* Array area */
    .array-wrap {
      position:relative;
      width:100%;
      min-height:140px;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .array {
      display:flex;
      gap:12px;
      align-items:flex-end;
      transition: all 300ms ease;
      padding:12px;
      justify-content:center;
    }
    .cell {
      width:68px;
      height:68px;
      background:linear-gradient(180deg,#0b1220,#07101b);
      border-radius:10px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      box-shadow: inset 0 -8px 18px rgba(0,0,0,0.6), 0 6px 14px rgba(2,6,23,0.5);
      position:relative;
      color:#dbeafe;
      font-weight:600;
      transition: box-shadow 250ms, transform 300ms;
      flex: 0 0 68px;
    }
    .cell .index {
      position:absolute;
      top:6px;
      left:6px;
      font-size:11px;
      color:var(--muted);
      font-weight:500;
    }
    .cell.value { font-size:18px; }

    .cell.active {
      box-shadow: 0 0 0 3px rgba(96,165,250,0.12), 0 10px 30px rgba(96,165,250,0.06);
      transform: translateY(-6px);
    }
    .cell.found {
      box-shadow: 0 0 0 4px rgba(52,211,153,0.12), 0 10px 30px rgba(52,211,153,0.06);
      transform: translateY(-8px) scale(1.03);
    }
    .cell.less {
      box-shadow: 0 0 0 4px rgba(96,165,250,0.12);
    }
    .cell.greater {
      box-shadow: 0 0 0 4px rgba(245,158,11,0.12);
    }

    /* Pointers */
    .pointer {
      position:absolute;
      top: -28px;
      width:48px;
      height:28px;
      background:rgba(14,165,233,0.12);
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--accent);
      font-weight:700;
      transition: transform 340ms cubic-bezier(.19,.9,.35,1), opacity 180ms;
      pointer-events:none;
      box-shadow: 0 6px 20px rgba(2,6,23,0.5);
    }
    .pointer.r {
      top: auto;
      bottom: -28px;
      background:rgba(245,158,11,0.12);
      color:var(--info);
    }

    .sum-banner {
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      font-size:15px;
      color:var(--muted);
      min-height:22px;
    }
    .sum-banner .pair {
      font-weight:700;
      color:#e6f0ff;
    }

    /* Controls */
    .controls {
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      justify-content:center;
      margin-top:6px;
    }
    .controls button {
      min-width:88px;
      padding:10px 12px;
      border-radius:10px;
      border:0;
      color:#061425;
      font-weight:700;
      background:#e6f0ff;
      cursor:pointer;
      transition:transform 120ms;
    }
    .controls button.secondary {
      background:rgba(255,255,255,0.06);
      color:var(--muted);
      font-weight:600;
    }
    .controls button:active { transform:translateY(2px); }

    /* Right panel content */
    .side {
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    label { font-size:13px; color:var(--muted); display:block; margin-bottom:6px; }
    input[type="text"], input[type="number"], textarea {
      width:100%;
      box-sizing:border-box;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.04);
      background:rgba(255,255,255,0.02);
      color:inherit;
      outline:none;
      font-size:14px;
    }
    .small-row { display:flex; gap:12px; }
    .small-row > * { flex:1; }

    .pseudocode {
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:10px;
      padding:12px;
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      font-size:13px;
      color:var(--muted);
      line-height:1.5;
      max-height:220px;
      overflow:auto;
    }
    .pseudocode .line { padding:6px 8px; border-radius:6px; }
    .pseudocode .line.current { background:linear-gradient(90deg, rgba(96,165,250,0.08), rgba(96,165,250,0.03)); color:#e6f0ff; }

    .log {
      min-height:80px;
      max-height:160px;
      overflow:auto;
      background:rgba(255,255,255,0.02);
      border-radius:10px;
      padding:10px;
      font-size:13px;
      color:var(--muted);
    }

    .footer-note {
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
    }

    /* small helper */
    .row { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
    .muted { color:var(--muted); font-size:13px; }
    .btn-ghost {
      background:transparent;
      color:var(--accent);
      border:1px solid rgba(96,165,250,0.12);
    }
    .speed {
      display:flex;
      gap:8px;
      align-items:center;
    }

  </style>
</head>
<body>
  <div class="app" role="application" aria-labelledby="app-title">
    <header>
      <div class="title">
        <h1 id="app-title">Two Pointers — Pair Sum Visualizer</h1>
        <p class="lead">See how two pointers move inward on a sorted array to find two numbers that add up to a target.</p>
      </div>
      <div class="muted">Tip: Use Step to advance or Auto Play to run continuously. Space toggles play/pause.</div>
    </header>

    <main>
      <section class="card visual" aria-label="Visualization">
        <div style="width:100%; display:flex; justify-content:space-between; align-items:center;">
          <div class="muted">Array visualization</div>
          <div class="muted">Invariant: array must be sorted (ascending)</div>
        </div>

        <div class="array-wrap" id="arrayWrap">
          <div id="leftPointer" class="pointer" aria-hidden="true">L</div>
          <div id="rightPointer" class="pointer r" aria-hidden="true">R</div>
          <div id="array" class="array" aria-live="polite" aria-atomic="true"></div>
        </div>

        <div class="sum-banner" id="sumBanner">Load an array and press "Load & Sort".</div>

        <div class="controls" role="group" aria-label="Controls">
          <button id="loadBtn">Load & Sort</button>
          <button id="randomBtn" class="secondary">Random Sorted Array</button>
          <button id="resetBtn" class="secondary">Reset</button>
          <button id="stepBtn" class="secondary">Step</button>
          <button id="playBtn" class="" aria-pressed="false">Auto Play</button>
          <div class="speed" style="align-items:center;">
            <label class="muted" for="speed">Speed</label>
            <input id="speed" type="range" min="1" max="6" value="3" aria-label="Play speed (steps per second)">
          </div>
        </div>
      </section>

      <aside class="side">
        <div class="card">
          <label for="arrayInput">Array (comma or space separated)</label>
          <textarea id="arrayInput" rows="3" placeholder="e.g., 1, 2, 3, 4, 6" aria-label="Array input">1, 2, 3, 4, 6</textarea>

          <div class="small-row" style="margin-top:12px;">
            <div style="flex:1;">
              <label for="targetInput">Target</label>
              <input id="targetInput" type="number" value="8" aria-label="Target value">
            </div>
            <div style="width:120px;">
              <label>&nbsp;</label>
              <button id="sortOnlyBtn" class="btn-ghost" style="width:100%;">Sort</button>
            </div>
          </div>

          <div style="margin-top:12px;">
            <button id="explainToggle" class="secondary" style="width:100%;">Show/Hide Learning Summary</button>
            <div id="explainPanel" style="margin-top:8px; display:none;">
              <div class="muted" style="margin-bottom:8px;">
                Two pointers starts at both ends of a sorted array. If the sum is too small, advance the left pointer; if too large, move the right pointer. Continue until pointers cross or a pair is found.
              </div>
            </div>
          </div>
        </div>

        <div class="pseudocode card" aria-hidden="false">
          <div style="font-weight:700; margin-bottom:8px;">Pseudocode</div>
          <div id="codeLines">
            <div class="line" data-line="1">1. L = 0; R = n - 1</div>
            <div class="line" data-line="2">2. while L &lt; R:</div>
            <div class="line" data-line="3">3. &nbsp;&nbsp;sum = arr[L] + arr[R]</div>
            <div class="line" data-line="4">4. &nbsp;&nbsp;if sum == target: return (L, R)</div>
            <div class="line" data-line="5">5. &nbsp;&nbsp;elif sum &lt; target: L += 1</div>
            <div class="line" data-line="6">6. &nbsp;&nbsp;else: R -= 1</div>
            <div class="line" data-line="7">7. return not found</div>
          </div>
        </div>

        <div class="card">
          <div style="font-weight:700; margin-bottom:8px;">Step Log</div>
          <div id="log" class="log" aria-live="polite"></div>
          <div class="footer-note">Use &larr; Reset &nbsp; • &nbsp; Step to advance one comparison &nbsp; • &nbsp; Auto Play to animate</div>
        </div>
      </aside>
    </main>
  </div>

  <script>
    (function(){
      // Utilities
      function $(s){ return document.querySelector(s); }
      function $all(s){ return Array.from(document.querySelectorAll(s)); }
      const arrayEl = $('#array');
      const leftPtrEl = $('#leftPointer');
      const rightPtrEl = $('#rightPointer');
      const sumBanner = $('#sumBanner');
      const logEl = $('#log');
      const codeLines = $all('#codeLines .line');

      // Controls
      const loadBtn = $('#loadBtn');
      const randomBtn = $('#randomBtn');
      const resetBtn = $('#resetBtn');
      const stepBtn = $('#stepBtn');
      const playBtn = $('#playBtn');
      const speedInput = $('#speed');
      const arrayInput = $('#arrayInput');
      const targetInput = $('#targetInput');
      const sortOnlyBtn = $('#sortOnlyBtn');
      const explainToggle = $('#explainToggle');
      const explainPanel = $('#explainPanel');

      let arr = [];
      let target = 0;
      let L = 0, R = -1;
      let playing = false;
      let timer = null;

      // Animation helpers
      function createCells(values){
        arrayEl.innerHTML = '';
        values.forEach((v,i) => {
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.setAttribute('data-index', i);
          cell.innerHTML = '<div class="index">'+i+'</div><div class="value">'+v+'</div>';
          arrayEl.appendChild(cell);
        });
        // Reset pointers visibility
        leftPtrEl.style.opacity = '0';
        rightPtrEl.style.opacity = '0';
      }

      function placePointers(){
        const cells = $all('.cell');
        if(cells.length === 0) return;
        const wrapRect = $('#arrayWrap').getBoundingClientRect();
        // ensure pointer visible
        const leftCell = cells[L];
        const rightCell = cells[R];
        if(!leftCell || !rightCell) return;
        const lRect = leftCell.getBoundingClientRect();
        const rRect = rightCell.getBoundingClientRect();
        // compute x offset relative to arrayWrap center
        const wrapLeft = wrapRect.left;
        const xL = lRect.left + lRect.width/2 - wrapLeft - leftPtrEl.offsetWidth/2;
        const xR = rRect.left + rRect.width/2 - wrapLeft - rightPtrEl.offsetWidth/2;
        leftPtrEl.style.transform = 'translateX(' + xL + 'px)';
        rightPtrEl.style.transform = 'translateX(' + xR + 'px)';
        leftPtrEl.style.opacity = '1';
        rightPtrEl.style.opacity = '1';
      }

      function highlightCells(i,j, state){
        // clear previous
        $all('.cell').forEach(c => {
          c.classList.remove('active','less','greater','found');
        });
        const cellI = document.querySelector('.cell[data-index="'+i+'"]');
        const cellJ = document.querySelector('.cell[data-index="'+j+'"]');
        if(cellI) cellI.classList.add(state === 'found' ? 'found' : 'active');
        if(cellJ) cellJ.classList.add(state === 'found' ? 'found' : 'active');
        if(state === 'less' && cellI) cellI.classList.add('less');
        if(state === 'greater' && cellJ) cellJ.classList.add('greater');
      }

      function setActiveCode(line){
        codeLines.forEach(el => el.classList.toggle('current', el.dataset.line === String(line)));
      }

      function log(msg){
        const p = document.createElement('div');
        p.textContent = msg;
        logEl.prepend(p);
      }

      function parseArrayInput(){
        const raw = arrayInput.value.trim();
        if(!raw) return [];
        const parts = raw.split(/[\s,]+/).filter(Boolean);
        const nums = parts.map(x => Number(x)).filter(v => !Number.isNaN(v));
        return nums;
      }

      function loadAndSort(){
        arr = parseArrayInput();
        arr.sort((a,b)=>a-b);
        createCells(arr);
        L = 0;
        R = arr.length - 1;
        target = Number(targetInput.value) || 0;
        placePointers();
        sumBanner.textContent = (arr.length ? 'Left at 0, Right at '+R+'. Target: ' + target : 'Array is empty.');
        log('Loaded array [' + arr.join(', ') + '] sorted. Target = ' + target + '.');
        setActiveCode(1);
        clearHighlights();
      }

      function clearHighlights(){
        $all('.cell').forEach(c => c.classList.remove('active','less','greater','found'));
      }

      function resetAll(){
        stopPlaying();
        arr = parseArrayInput();
        createCells(arr);
        L = 0;
        R = Math.max(0, arr.length - 1);
        placePointers();
        sumBanner.textContent = 'Reset. Load & Sort to sort the array before running.';
        log('Reset view. Edit array or press Load & Sort.');
        setActiveCode(1);
        clearHighlights();
      }

      function stepOnce(){
        if(!arr || arr.length === 0){
          sumBanner.textContent = 'Array empty: nothing to do.';
          return;
        }
        if(L >= R){
          sumBanner.textContent = 'Pointers crossed — pair not found.';
          setActiveCode(7);
          log('Pointers crossed. No pair found.');
          stopPlaying();
          return;
        }
        setActiveCode(2); // while line
        // perform comparison
        setActiveCode(3);
        const a = arr[L], b = arr[R];
        const s = a + b;
        sumBanner.innerHTML = '<span class="pair">arr['+L+'] ('+a+') + arr['+R+'] ('+b+') = '+s+'</span>';
        highlightCells(L,R,'active');

        // small delay to make the effect visible
        setTimeout(() => {
          if(s === target){
            setActiveCode(4);
            highlightCells(L,R,'found');
            sumBanner.innerHTML = '<span class="pair">FOUND: '+a+' + '+b+' = '+target+'</span>';
            log('Found pair: indexes ('+L+','+R+') values ('+a+','+b+').');
            stopPlaying();
          } else if (s < target){
            setActiveCode(5);
            highlightCells(L,R,'less');
            log('Sum '+s+' < '+target+' → move L from '+L+' to '+(L+1)+'.');
            L += 1;
            placePointers();
          } else {
            setActiveCode(6);
            highlightCells(L,R,'greater');
            log('Sum '+s+' > '+target+' → move R from '+R+' to '+(R-1)+'.');
            R -= 1;
            placePointers();
          }
          // check termination after move
          if(L >= R){
            setTimeout(() => {
              if(L >= R){
                sumBanner.textContent = 'Pointers crossed — pair not found.';
                setActiveCode(7);
                log('Pointers crossed. No pair found.');
                stopPlaying();
              }
            }, 350);
          }
        }, 360);
      }

      function playTick(){
        stepOnce();
        // if we found or finished, timer will be cleared by stopPlaying
      }

      function startPlaying(){
        if(playing) return;
        playing = true;
        playBtn.textContent = 'Pause';
        playBtn.setAttribute('aria-pressed','true');
        const sp = Number(speedInput.value) || 3;
        const ms = Math.max(120, 1000 / sp);
        timer = setInterval(playTick, ms);
      }

      function stopPlaying(){
        playing = false;
        playBtn.textContent = 'Auto Play';
        playBtn.setAttribute('aria-pressed','false');
        if(timer){ clearInterval(timer); timer = null; }
      }

      // Event wiring
      loadBtn.addEventListener('click', () => {
        loadAndSort();
      });
      randomBtn.addEventListener('click', () => {
        const n = Math.min(12, Math.max(4, Math.round(Math.random()*9)+3));
        const arrRand = [];
        let next = Math.round(Math.random()*3);
        for(let i=0;i<n;i++){
          next += Math.round(Math.random()*6);
          arrRand.push(next);
        }
        arrayInput.value = arrRand.join(', ');
        targetInput.value = arrRand[Math.floor(Math.random()*arrRand.length)] + arrRand[Math.floor(Math.random()*arrRand.length)];
        loadAndSort();
      });
      resetBtn.addEventListener('click', () => {
        resetAll();
      });
      stepBtn.addEventListener('click', () => {
        stopPlaying();
        // if array hasn't been sorted/loaded, sort it on first step
        if(!arr || arr.length === 0){
          loadAndSort();
        }
        stepOnce();
      });
      playBtn.addEventListener('click', () => {
        if(!arr || arr.length === 0){
          loadAndSort();
        }
        if(playing) stopPlaying(); else startPlaying();
      });
      speedInput.addEventListener('input', () => {
        if(playing){
          stopPlaying();
          startPlaying();
        }
      });
      sortOnlyBtn.addEventListener('click', () => {
        const nums = parseArrayInput();
        nums.sort((a,b)=>a-b);
        arrayInput.value = nums.join(', ');
        createCells(nums);
        L = 0; R = nums.length -1;
        placePointers();
        log('Array sorted (no run).');
      });
      explainToggle.addEventListener('click', () => {
        explainPanel.style.display = explainPanel.style.display === 'none' ? 'block' : 'none';
      });

      // keyboard shortcuts
      document.addEventListener('keydown', (e) => {
        if(e.code === 'Space'){
          e.preventDefault();
          if(playing) stopPlaying(); else {
            if(!arr || arr.length === 0) loadAndSort();
            startPlaying();
          }
        } else if (e.key === 'ArrowRight'){
          e.preventDefault();
          stepBtn.click();
        } else if (e.key === 'ArrowLeft'){
          e.preventDefault();
          resetBtn.click();
        }
      });

      // window resize: reposition pointers
      window.addEventListener('resize', () => {
        requestAnimationFrame(placePointers);
      });

      // Initial setup
      (function init(){
        createCells([1,2,3,4,6]);
        L = 0; R = 4;
        placePointers();
        setActiveCode(1);
      })();

    })();
  </script>
</body>
</html>