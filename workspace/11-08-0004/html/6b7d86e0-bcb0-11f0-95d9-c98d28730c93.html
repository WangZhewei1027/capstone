<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactive Module — Linear Search</title>
  <style>
    :root{
      --safe: 24px;
      --gap: 16px;
      --accent: #1e88e5;
      --accent-2: #43a047;
      --muted: #6b7280;
      --bg: #f7fafc;
      --card: #ffffff;
      --danger: #e53935;
      --tile-size: 72px;
    }
    /* Safe area */
    html,body{
      height:100%;
      margin:0;
      padding:var(--safe);
      background:linear-gradient(180deg,#fcfeff 0%, #f7fbfd 100%);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:#0f172a;
      box-sizing:border-box;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    *{box-sizing:border-box}
    a{color:inherit}
    /* Container layout */
    .module {
      display:flex;
      gap:var(--gap);
      align-items:flex-start;
      justify-content:stretch;
      min-height: 60vh;
    }
    /* Left column: controls & info */
    .panel {
      flex: 0 0 360px;
      background:var(--card);
      border-radius:12px;
      padding:18px;
      box-shadow:0 6px 20px rgba(16,24,40,0.06);
      display:flex;
      flex-direction:column;
      gap:12px;
      min-width: 260px;
    }
    .panel h2{margin:0;font-size:1.1rem}
    .overview{
      background:linear-gradient(180deg, rgba(30,136,229,0.05), rgba(30,136,229,0.02));
      border:1px solid rgba(30,136,229,0.08);
      padding:12px;
      border-radius:10px;
      font-size:0.95rem;
      color: #0b3954;
    }
    .row{display:flex;gap:12px;align-items:center}
    .form-group{display:flex;flex-direction:column;gap:6px}
    label{font-size:0.85rem;color:var(--muted)}
    input[type="text"], input[type="number"], select {
      padding:10px 12px;
      border-radius:8px;
      border:1px solid #e6edf3;
      background: #fff;
      font-size:0.95rem;
    }
    .controls {display:flex;flex-direction:column;gap:10px}
    .btn {
      appearance:none;
      border:0;
      background:var(--accent);
      color:white;
      padding:10px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      font-size:0.95rem;
    }
    .btn.secondary{
      background:#fff;
      color:var(--accent);
      border:1px solid rgba(30,136,229,0.12);
      font-weight:600;
    }
    .btn.ghost{
      background:#fff;
      color:var(--muted);
      border:1px solid #e6edf3;
    }
    .small{font-size:0.9rem;padding:8px 10px}
    /* Right column: visualization */
    .visual {
      flex:1;
      display:flex;
      flex-direction:column;
      gap:var(--gap);
      background:transparent;
      min-width:0;
    }
    .canvas {
      background:var(--card);
      border-radius:12px;
      padding:20px;
      min-height:260px;
      box-shadow:0 6px 20px rgba(16,24,40,0.04);
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    .array-wrap {
      display:flex;
      gap:16px;
      overflow:auto;
      align-items:center;
      padding:8px;
      min-height: var(--tile-size);
    }
    .tile {
      width:var(--tile-size);
      height:var(--tile-size);
      min-width:var(--tile-size);
      background:#fff;
      border-radius:10px;
      box-shadow:0 4px 8px rgba(6,8,15,0.04);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:1rem;
      color:#0f172a;
      transition: transform 320ms cubic-bezier(.2,.9,.2,1), background-color 240ms, box-shadow 240ms, border 240ms;
      position:relative;
      border:2px solid transparent;
    }
    .tile .index {
      position:absolute;
      bottom:6px;
      right:8px;
      font-size:0.65rem;
      color:var(--muted);
      font-weight:600;
    }
    .tile.current {
      transform: translateY(-8px) scale(1.03);
      border-color: rgba(30,136,229,0.18);
      box-shadow: 0 12px 30px rgba(30,136,229,0.08);
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0% { box-shadow:0 10px 20px rgba(30,136,229,0.06); }
      50% { box-shadow:0 18px 36px rgba(30,136,229,0.10); }
      100% { box-shadow:0 10px 20px rgba(30,136,229,0.06); }
    }
    .tile.match {
      background: linear-gradient(180deg,#e6ffed,#e8fff0);
      border-color: rgba(67,160,71,0.18);
      color:var(--accent-2);
    }
    .tile.checked {
      opacity:0.65;
      transform: none;
      border-color: rgba(116,119,128,0.06);
    }
    .statusbar {
      display:flex;
      gap:16px;
      align-items:center;
      justify-content:space-between;
      font-size:0.95rem;
      color:var(--muted);
    }
    .status-left {display:flex;gap:12px;align-items:center}
    .stat {
      background:#fff;
      border-radius:8px;
      padding:8px 10px;
      border:1px solid #eef5fa;
      font-weight:600;
    }
    .narration{
      font-size:0.95rem;
      color:#0b3954;
      padding:10px;
      border-radius:8px;
      background:linear-gradient(180deg,#ffffff,#fbfeff);
      border:1px solid #e6f0f8;
    }
    /* Controls row spacing rules */
    .control-row {display:flex;gap:12px;flex-wrap:wrap}
    .flex-1{flex:1}
    .muted{color:var(--muted);font-size:0.9rem}
    /* Footer small notes */
    .footer-note{font-size:0.85rem;color:var(--muted)}
    /* Accessibility focus */
    .btn:focus, input:focus, .tile:focus {outline:3px solid rgba(30,136,229,0.12);outline-offset:2px}
    /* Responsive: stack */
    @media (max-width:980px){
      .module{flex-direction:column}
      .panel{width:100%}
      .visual{width:100%}
    }
  </style>
</head>
<body>
  <main aria-labelledby="title" role="main">
    <h1 id="title" style="margin:0 0 12px 0;font-size:1.35rem">Linear Search — Interactive Module</h1>

    <!-- Overview panel with design plan items -->
    <section class="module" aria-label="Linear Search interactive module">
      <aside class="panel" aria-labelledby="overviewTitle">
        <h2 id="overviewTitle">Overview & Learning Plan</h2>
        <div class="overview" role="region" aria-live="polite">
          <strong>Concept Title:</strong> Linear Search (Sequential Search)<br><br>
          <strong>Learning Objective:</strong>
          After interacting with this module you will be able to:
          - Understand how linear search checks items one-by-one,
          - Visualize the comparison process and count comparisons,
          - Recognize best/worst/average case behavior and early exit on success.<br><br>
          <strong>Interaction Design:</strong>
          Type or generate an array, pick a target, and press "Start Search". Use Step, Back, and Auto Play buttons. Each probe highlights the current element with animation, updates a comparison counter, and narrates the action for screen-reader accessibility. If found, the matched tile is marked; otherwise the search completes and reports "not found". Keyboard arrows step through states.
        </div>

        <div style="margin-top:8px" class="form-group">
          <label for="arrayInput">Array (comma separated)</label>
          <input id="arrayInput" type="text" value="8, 3, 7, 1, 9, 5" aria-describedby="arrayHelp" />
          <div id="arrayHelp" class="muted" style="margin-top:6px">
            Enter values (strings or numbers). Use "Generate Random" for quick examples.
          </div>
        </div>

        <div class="row control-row" style="margin-top:6px">
          <div class="form-group flex-1">
            <label for="sizeRange">Random size</label>
            <input id="sizeRange" type="range" min="3" max="15" value="8" />
          </div>
          <button id="genBtn" class="btn small">Generate Random</button>
        </div>

        <div class="form-group" style="margin-top:6px">
          <label for="targetInput">Target value</label>
          <input id="targetInput" type="text" value="1" />
        </div>

        <div class="row control-row" style="margin-top:6px">
          <button id="startBtn" class="btn">Start Search</button>
          <button id="resetBtn" class="btn secondary small">Reset</button>
        </div>

        <div style="margin-top:6px" class="controls">
          <div class="row">
            <button id="backBtn" class="btn ghost small" title="Step backward (Left Arrow)">◀ Step Back</button>
            <button id="stepBtn" class="btn small" title="Step forward (Right Arrow)">Step ▶</button>
            <button id="autoBtn" class="btn ghost small" title="Auto play / pause">Auto ▶</button>
          </div>

          <div class="row" style="align-items:center">
            <label for="speed" style="min-width:80px" class="muted">Speed</label>
            <input id="speed" type="range" min="200" max="1600" value="900" />
            <div class="muted" style="min-width:44px;text-align:right">ms</div>
          </div>

          <div class="row" style="align-items:center">
            <label class="muted" style="min-width:120px">Compare as numbers</label>
            <input id="numericToggle" type="checkbox" title="If checked, attempts numeric comparison" />
          </div>

          <div class="muted footer-note">Keyboard: Right = step, Left = back, Enter = start/pause</div>
        </div>
      </aside>

      <section class="visual" aria-live="polite">
        <div class="canvas" role="region" aria-label="Visualization area">
          <div class="statusbar" aria-hidden="false">
            <div class="status-left">
              <div class="stat" id="comparisons">Comparisons: 0</div>
              <div class="stat" id="position">Position: -</div>
              <div class="stat" id="result" style="color:var(--muted)">Status: Idle</div>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <div class="muted">Array length:</div>
              <div class="stat" id="arrayLen">0</div>
            </div>
          </div>

          <div class="array-wrap" id="arrayWrap" tabindex="0" aria-label="Array of values"></div>

          <div class="narration" id="narration" aria-live="polite">
            Instructions: Enter an array and a target. Press "Start Search" to step through, or use Auto Play.
          </div>
        </div>

        <div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
          <div class="muted">This single module demonstrates a sequential (linear) scan through the array.</div>
          <div style="display:flex;gap:8px">
            <button id="explainBtn" class="btn secondary small">Explain complexity</button>
            <button id="copyBtn" class="btn ghost small">Copy Array</button>
          </div>
        </div>
      </section>
    </section>
  </main>

  <script>
    // Self-contained Linear Search interactive logic (vanilla JS)
    (function(){
      // Elements
      const arrayInput = document.getElementById('arrayInput');
      const targetInput = document.getElementById('targetInput');
      const genBtn = document.getElementById('genBtn');
      const sizeRange = document.getElementById('sizeRange');
      const startBtn = document.getElementById('startBtn');
      const resetBtn = document.getElementById('resetBtn');
      const arrayWrap = document.getElementById('arrayWrap');
      const comparisonsEl = document.getElementById('comparisons');
      const positionEl = document.getElementById('position');
      const resultEl = document.getElementById('result');
      const narration = document.getElementById('narration');
      const stepBtn = document.getElementById('stepBtn');
      const backBtn = document.getElementById('backBtn');
      const autoBtn = document.getElementById('autoBtn');
      const speed = document.getElementById('speed');
      const numericToggle = document.getElementById('numericToggle');
      const arrayLenEl = document.getElementById('arrayLen');
      const explainBtn = document.getElementById('explainBtn');
      const copyBtn = document.getElementById('copyBtn');

      // State
      let arr = [];
      let target = null;
      let idx = -1;        // current index being examined
      let comps = 0;       // comparison count
      let playing = false;
      let timer = null;
      const MIN_GAP = 16;

      // Accessibility: live-text setter
      function setNarration(text){
        narration.textContent = text;
      }

      function parseArrayInput(text){
        // split by comma, trim. Preserve strings. Convert empty to empty string
        const parts = text.split(',').map(s => s.trim());
        return parts.filter((v, i)=> !(v === '' && parts.length === 1 && i===0)) // allow empty input?
      }

      function renderArray(){
        arrayWrap.innerHTML = '';
        arr.forEach((val,i)=>{
          const tile = document.createElement('div');
          tile.className = 'tile';
          tile.setAttribute('role','button');
          tile.setAttribute('tabindex','0');
          tile.setAttribute('aria-label', `Index ${i} value ${String(val)}`);
          tile.innerHTML = `<div class="value">${String(val)}</div><div class="index">${i}</div>`;
          arrayWrap.appendChild(tile);
        });
        arrayLenEl.textContent = arr.length;
      }

      function resetVisuals(){
        const tiles = arrayWrap.children;
        for(let t of tiles){
          t.classList.remove('current','match','checked');
        }
        comparisonsEl.textContent = `Comparisons: ${comps}`;
        positionEl.textContent = idx >= 0 ? idx : '-';
      }

      function prepareSearch(){
        arr = parseArrayInput(arrayInput.value);
        target = targetInput.value;
        if(numericToggle.checked){
          // attempt to parse numbers; fallback to original strings if NaN
          arr = arr.map(v=>{
            const n = Number(v);
            return (v !== '' && !Number.isNaN(n)) ? n : v;
          });
          const nt = Number(target);
          target = (target !== '' && !Number.isNaN(nt)) ? nt : target;
        } else {
          // leave strings as-is
          arr = arr.map(v=>v);
        }
        idx = -1;
        comps = 0;
        playing = false;
        clearInterval(timer);
        timer = null;
        startBtn.textContent = 'Start Search';
        autoBtn.textContent = 'Auto ▶';
        resultEl.textContent = 'Status: Ready';
        resultEl.style.color = 'var(--muted)';
        setNarration('Prepared array with ' + arr.length + ' elements. Ready to search.');
        renderArray();
        resetVisuals();
      }

      // Step forward one comparison
      function stepForward(){
        if(idx >= arr.length - 1){
          // already finished
          idx = arr.length;
          comps = comps; // no change
          resultEl.textContent = 'Status: Not found';
          resultEl.style.color = 'var(--danger)';
          setNarration(`Reached end. ${target} not found after ${comps} comparisons.`);
          markAllChecked();
          return;
        }
        idx++;
        comps++;
        comparisonsEl.textContent = `Comparisons: ${comps}`;
        positionEl.textContent = idx;
        highlightCurrent(idx);

        const curVal = arr[idx];
        const equal = compareValues(curVal, target);
        if(equal){
          // match found
          markMatch(idx);
          resultEl.textContent = `Status: Found at index ${idx}`;
          resultEl.style.color = 'var(--accent-2)';
          setNarration(`Comparison ${comps}: value ${String(curVal)} equals target ${String(target)}. Found at index ${idx}.`);
          playing = false;
          clearInterval(timer);
          autoBtn.textContent = 'Auto ▶';
          startBtn.textContent = 'Restart Search';
        } else {
          // not match: mark checked and continue or finish
          markChecked(idx);
          setNarration(`Comparison ${comps}: value ${String(curVal)} does not equal target ${String(target)}.`);
          if(idx === arr.length - 1){
            resultEl.textContent = 'Status: Not found';
            resultEl.style.color = 'var(--danger)';
            setNarration(`Completed ${comps} comparisons. ${String(target)} not found in the array.`);
            playing = false;
            clearInterval(timer);
            autoBtn.textContent = 'Auto ▶';
            startBtn.textContent = 'Restart Search';
          }
        }
      }

      function stepBackward(){
        if(idx <= -1){
          setNarration('Already at the initial state.');
          return;
        }
        // Un-do last step
        // If last step was a match, clear match
        const prevIdx = idx;
        // Reduce comparisons only if there was a comparison to undo
        if(comps > 0) comps--;
        idx--;
        comparisonsEl.textContent = `Comparisons: ${comps}`;
        positionEl.textContent = idx >= 0 ? idx : '-';
        // Reset visuals for prevIdx
        const tile = arrayWrap.children[prevIdx];
        if(tile){
          tile.classList.remove('current','match','checked');
        }
        // Remove match state if any, and reset result
        resultEl.textContent = 'Status: Running';
        resultEl.style.color = 'var(--muted)';
        setNarration(`Stepped back. Now at position ${idx >= 0 ? idx : 'start'}.`);
        // Re-highlight current if exists
        if(idx >= 0){
          const curTile = arrayWrap.children[idx];
          if(curTile) curTile.classList.add('current');
        }
      }

      function compareValues(a,b){
        // strict equality on type+value
        return a === b;
      }

      function highlightCurrent(i){
        const tiles = arrayWrap.children;
        for(let k=0;k<tiles.length;k++){
          tiles[k].classList.remove('current');
        }
        const tile = tiles[i];
        if(tile) tile.classList.add('current');
        // ensure visible
        if(tile) tile.scrollIntoView({behavior:'smooth',inline:'center',block:'nearest'});
      }

      function markChecked(i){
        const tile = arrayWrap.children[i];
        if(tile){
          tile.classList.remove('current');
          tile.classList.add('checked');
        }
      }

      function markMatch(i){
        const tile = arrayWrap.children[i];
        if(tile){
          tile.classList.remove('current');
          tile.classList.remove('checked');
          tile.classList.add('match');
        }
      }

      function markAllChecked(){
        const tiles = arrayWrap.children;
        for(let k=0;k<tiles.length;k++){
          if(!tiles[k].classList.contains('match')){
            tiles[k].classList.add('checked');
          }
        }
      }

      function startAuto(){
        if(playing){
          playing = false;
          clearInterval(timer);
          timer = null;
          autoBtn.textContent = 'Auto ▶';
          startBtn.textContent = 'Resume Search';
          setNarration('Auto playback paused.');
          return;
        }
        // if fresh start and idx >= arr.length, reset index to -1 for restart
        if(idx >= arr.length) {
          idx = -1;
          comps = 0;
          resetVisuals();
        }
        playing = true;
        autoBtn.textContent = 'Pause ⏸';
        startBtn.textContent = 'Pause';
        const delay = Number(speed.value) || 900;
        timer = setInterval(()=>{
          // if finished, stop
          if(idx >= arr.length - 1){
            clearInterval(timer);
            timer = null;
            playing = false;
            autoBtn.textContent = 'Auto ▶';
            return;
          }
          stepForward();
        }, delay);
        setNarration('Auto playback started.');
      }

      // Event bindings
      genBtn.addEventListener('click', ()=>{
        const n = Number(sizeRange.value) || 8;
        const out = [];
        for(let i=0;i<n;i++){
          out.push(String(Math.floor(Math.random()*20) + 1));
        }
        arrayInput.value = out.join(', ');
        prepareSearch();
      });

      startBtn.addEventListener('click', ()=>{
        // If search hasn't been prepared or array changed, prepare
        prepareSearch();
        // Begin with stepping forward to first comparison
        stepForward();
        // Update start button for ability to restart later
        startBtn.textContent = 'Restart Search';
      });

      resetBtn.addEventListener('click', ()=>{
        clearInterval(timer);
        timer = null;
        playing = false;
        arrayInput.value = '';
        targetInput.value = '';
        arr = [];
        idx = -1;
        comps = 0;
        renderArray();
        comparisonsEl.textContent = `Comparisons: 0`;
        positionEl.textContent = '-';
        resultEl.textContent = 'Status: Idle';
        resultEl.style.color = 'var(--muted)';
        setNarration('Reset. Enter a new array and target to begin.');
      });

      stepBtn.addEventListener('click', ()=>{
        // If not prepared or array changed, prepare
        if(arr.length === 0){
          prepareSearch();
        }
        // step one
        stepForward();
      });

      backBtn.addEventListener('click', ()=>{
        stepBackward();
      });

      autoBtn.addEventListener('click', ()=>{
        // ensure prepared
        if(arr.length === 0) prepareSearch();
        // toggle auto
        if(playing) {
          playing = false;
          clearInterval(timer);
          timer = null;
          autoBtn.textContent = 'Auto ▶';
          setNarration('Auto playback paused.');
        } else {
          startAuto();
        }
      });

      explainBtn.addEventListener('click', ()=>{
        alert('Time complexity of linear search:\n\n- Best case: O(1) (target is at first position)\n- Worst case: O(n) (target not present or at last position)\n- Average case: O(n)\n\nSpace complexity: O(1) extra space (in-place scanning).');
      });

      copyBtn.addEventListener('click', ()=>{
        navigator.clipboard && navigator.clipboard.writeText(arrayInput.value)
          .then(()=> setNarration('Array copied to clipboard.'))
          .catch(()=> setNarration('Could not copy array to clipboard.'));
      });

      // Keyboard support
      window.addEventListener('keydown', (e)=>{
        const tag = document.activeElement && document.activeElement.tagName.toLowerCase();
        // Avoid interfering with typing in inputs
        if(tag === 'input' || tag === 'textarea') {
          if(e.key === 'Enter'){
            // allow Enter to submit when focused in target/array inputs
            startBtn.click();
          }
          return;
        }
        if(e.key === 'ArrowRight') { stepBtn.click(); e.preventDefault(); }
        else if(e.key === 'ArrowLeft') { backBtn.click(); e.preventDefault(); }
        else if(e.key === 'Enter') { autoBtn.click(); e.preventDefault(); }
      });

      // Initialize with default parse
      prepareSearch();

      // Observe manual edits: if user types array or target, prepare on blur
      arrayInput.addEventListener('blur', prepareSearch);
      targetInput.addEventListener('blur', ()=> { target = targetInput.value; setNarration('Target updated.'); });

      // Ensure minimal spacing (16px) between interactive elements - enforcement via CSS gap.
      // Done.

      // Make tiles clickable to jump to that index (affords exploration)
      arrayWrap.addEventListener('click', (e)=>{
        const tile = e.target.closest('.tile');
        if(!tile) return;
        const tiles = Array.from(arrayWrap.children);
        const i = tiles.indexOf(tile);
        if(i >= 0){
          // Set idx to i-1 and then step forward so narration & comparisons update naturally
          idx = i - 1;
          comps = Math.max(0, idx+1);
          stepForward();
        }
      });

      // For accessibility, focusable tiles also allow Enter to step to that tile
      arrayWrap.addEventListener('keydown', (e)=>{
        const tile = document.activeElement.closest('.tile');
        if(!tile) return;
        if(e.key === 'Enter' || e.key === ' ') {
          const tiles = Array.from(arrayWrap.children);
          const i = tiles.indexOf(tile);
          if(i >= 0){
            idx = i - 1;
            comps = Math.max(0, idx+1);
            stepForward();
            e.preventDefault();
          }
        }
      });

      // Keep narration updated on speed changes for user feedback
      speed.addEventListener('input', ()=>{
        if(playing){
          clearInterval(timer);
          const delay = Number(speed.value) || 900;
          timer = setInterval(()=>{ if(idx < arr.length - 1) stepForward(); else { clearInterval(timer); timer=null; playing=false; } }, delay);
          setNarration(`Speed set to ${delay} ms per step.`);
        }
      });

      // Allow numeric toggle to re-prepare
      numericToggle.addEventListener('change', prepareSearch);

    })();
  </script>
</body>
</html>