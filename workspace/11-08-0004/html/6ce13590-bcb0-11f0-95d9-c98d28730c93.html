<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactive Module — Arrays (Indexed Collections)</title>
  <style>
    :root{
      --safe-margin: 24px;
      --gap: 16px;
      --bg: #0f1720;
      --panel: #0b1220;
      --accent: #4fd1c5;
      --muted: #94a3b8;
      --cell-bg: #071022;
      --cell-border: #203047;
      --glass: rgba(255,255,255,0.03);
      --radius: 12px;
      --shadow: 0 6px 18px rgba(2,6,23,0.6);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%; margin:0; background: linear-gradient(180deg,#061426 0%, #071424 100%); color:#e6eef6;}
    .app {
      padding: var(--safe-margin);
      box-sizing: border-box;
      min-height: 100%;
      display: flex;
      gap: var(--gap);
      align-items: stretch;
      justify-content: center;
    }

    /* Layout: two-column card */
    .card {
      width: 1200px;
      max-width: calc(100% - calc(var(--safe-margin)*2));
      min-height: 640px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: var(--radius);
      padding: 22px;
      box-shadow: var(--shadow);
      display: grid;
      grid-template-columns: 380px 1fr;
      gap: 20px;
    }

    /* Left panel: description + controls */
    .left {
      display: flex;
      flex-direction: column;
      gap: var(--gap);
      padding: 12px;
    }
    h1 {
      margin: 4px 0 6px 0;
      font-size: 20px;
      color: #e7f7f6;
    }
    .muted { color: var(--muted); font-size: 13px; line-height:1.4; }

    .section {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
      padding: 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.02);
    }
    label { display:block; font-weight:600; font-size:13px; margin-bottom:6px; color:#dff3ef; }
    .controls { display:flex; flex-direction:column; gap:12px; }
    .row { display:flex; gap:12px; align-items:center; }
    input[type="text"], input[type="number"], select {
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.03);
      color: #e6eef6;
      padding: 8px 10px;
      border-radius: 8px;
      outline: none;
      min-height: 38px;
      font-size: 14px;
    }
    input[type="number"]{ width: 110px; }
    .btn {
      background: linear-gradient(180deg, var(--accent), #39b6a6);
      color: #042022;
      padding: 10px 12px;
      border-radius: 9px;
      font-weight:700;
      border: none;
      cursor: pointer;
      transition: transform .12s ease, box-shadow .12s;
      min-width: 80px;
    }
    .btn:active{ transform: translateY(1px); }
    .btn.secondary {
      background: linear-gradient(180deg,#1f3346,#142231);
      color: var(--muted);
      border: 1px solid rgba(255,255,255,0.02);
      font-weight:600;
    }

    /* Visualization area */
    .visual {
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap: var(--gap);
    }

    .canvas {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
      border-radius: 12px;
      padding: 18px;
      min-height: 300px;
      display:flex;
      flex-direction:column;
      gap:12px;
      border: 1px solid rgba(255,255,255,0.02);
    }

    /* Row of cells */
    .cells {
      display:flex;
      gap: 12px;
      align-items:end;
      flex-wrap: wrap;
      min-height: 120px;
      padding: 10px;
    }
    .cell {
      width: 84px;
      height: 84px;
      border-radius: 10px;
      background: linear-gradient(180deg, var(--cell-bg), #071728);
      border: 1px solid var(--cell-border);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      color: #e3fdfb;
      font-weight:700;
      font-size: 18px;
      user-select: none;
      transition: transform .28s cubic-bezier(.2,.9,.25,1), opacity .2s ease;
      box-shadow: 0 6px 18px rgba(1,7,17,0.6);
      touch-action: none;
    }
    .cell.dragging { opacity: 0.85; transform: scale(1.03); z-index: 40; box-shadow: 0 10px 30px rgba(0,0,0,0.6); }
    .index {
      position: absolute;
      bottom: 6px;
      left: 6px;
      font-size: 12px;
      color: var(--muted);
    }
    .cell .bubble {
      font-size: 11px;
      color: #0a2a2a;
      background: #bff0e8;
      padding: 4px 8px;
      border-radius: 999px;
      position: absolute;
      top: 8px;
      right: 8px;
    }

    /* Highlight on access */
    .cell.accessed {
      animation: accessPulse .6s ease;
      border: 2px solid rgba(79,209,197,0.6);
    }
    @keyframes accessPulse {
      0% { transform: translateY(0) scale(1); box-shadow:0 8px 22px rgba(0,0,0,0.5); }
      40% { transform: translateY(-6px) scale(1.04); }
      100% { transform: translateY(0) scale(1); }
    }

    /* Code view and history */
    .meta {
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .code {
      flex:1;
      background: rgba(3,7,12,0.6);
      padding:12px;
      border-radius:10px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      font-size:13px;
      color:#bfeee6;
      border: 1px solid rgba(255,255,255,0.02);
      min-width: 280px;
    }
    .history {
      width: 220px;
      max-height:180px;
      overflow:auto;
      background: rgba(255,255,255,0.01);
      border-radius:10px;
      padding:10px;
      font-size:13px;
    }
    .hist-item { font-size:13px; color:var(--muted); padding:6px 0; border-bottom: 1px dashed rgba(255,255,255,0.02); }
    .stats { font-size:13px; color:var(--muted); }

    /* footer controls */
    .ops { display:flex; gap:12px; flex-wrap:wrap; }
    .ops .btn { min-width: 90px; }

    /* Responsive */
    @media (max-width: 980px){
      .card { grid-template-columns: 1fr; width: calc(100% - calc(var(--safe-margin)*2)); }
    }

    /* accessibility focus */
    button:focus, input:focus { outline: 2px solid rgba(79,209,197,0.18); outline-offset: 2px; }

    /* small helper */
    .hint { font-size:12px; color:var(--muted); }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Array interactive module">
    <main class="card" role="main">
      <aside class="left" aria-labelledby="title">
        <div class="section" id="intro">
          <h1 id="title">Arrays — Ordered Indexed Collections</h1>
          <div class="muted">
            Concept: An Array stores values in a specific order and each slot has an index (starting at 0).
            This interactive module demonstrates how arrays hold values, how indices change with operations,
            and how common operations (push, pop, shift, unshift, insert, remove, access) affect the array.
          </div>
        </div>

        <div class="section" aria-labelledby="objective">
          <label id="objective">Learning Objective</label>
          <div class="muted">
            After interacting with this module you will be able to:
            <ul style="margin:8px 0 0 18px; color:var(--muted)">
              <li>Visualize array indices and length.</li>
              <li>Perform and observe push/pop/shift/unshift/insert/remove operations.</li>
              <li>Access elements by index and see how indices re-arrange when you insert/remove.</li>
              <li>Reorder items by dragging to understand index changes.</li>
            </ul>
          </div>
        </div>

        <div class="section" aria-labelledby="controls">
          <label id="controls">Interaction Controls</label>
          <div class="controls">

            <div class="row">
              <div style="flex:1;">
                <label for="valueInput">Value (string or number)</label>
                <input id="valueInput" type="text" placeholder='e.g. "apple" or 42' aria-label="Value to add" />
              </div>
              <div style="width:120px;">
                <label for="indexInput">Index</label>
                <input id="indexInput" type="number" min="0" placeholder="index" aria-label="Index for operations" />
              </div>
            </div>

            <div class="row ops" role="group" aria-label="Array operations">
              <button class="btn" id="pushBtn">Push</button>
              <button class="btn" id="popBtn">Pop</button>
              <button class="btn" id="unshiftBtn">Unshift</button>
              <button class="btn" id="shiftBtn">Shift</button>
              <button class="btn secondary" id="insertBtn">Insert @Index</button>
              <button class="btn secondary" id="removeBtn">Remove @Index</button>
            </div>

            <div class="row" style="align-items:flex-start;">
              <div style="flex:1;">
                <label for="accessIndex">Access (index)</label>
                <input id="accessIndex" type="number" min="0" placeholder="index" />
              </div>
              <div style="display:flex; flex-direction:column; gap:8px;">
                <button class="btn" id="accessBtn" style="min-width:86px;">Access</button>
                <button class="btn secondary" id="clearBtn" style="min-width:86px;">Clear</button>
              </div>
            </div>

            <div>
              <div class="hint">Tip: You can drag a cell to reorder items — drop to swap positions and update indices.</div>
            </div>
          </div>
        </div>

        <div class="section" aria-labelledby="layoutdesc">
          <label id="layoutdesc">Interaction Design (how it works)</label>
          <div class="muted" style="font-size:13px;">
            - Clicking buttons triggers array operations; animations show elements sliding in/out and indices updating.<br>
            - "Access" temporarily highlights the cell to illustrate direct access by index.<br>
            - Dragging a cell lets you change its position; on drop the array swaps elements and the index labels update.<br>
            - A code view at the right shows the array as JavaScript array notation that updates live.<br>
            - History logs recent operations for review.
          </div>
        </div>
      </aside>

      <section class="visual" aria-live="polite">
        <div class="canvas" role="region" aria-label="Array visualization">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <div style="display:flex;flex-direction:column;">
              <div style="font-weight:700; font-size:15px; color:#e9fdf8;">Array Visualization</div>
              <div class="muted" style="margin-top:6px;">Each cell shows a value and its index. Length updates automatically.</div>
            </div>
            <div style="display:flex;gap:12px;align-items:center;">
              <div class="stats">Length: <span id="length">0</span></div>
            </div>
          </div>

          <div class="cells" id="cells" tabindex="0" aria-label="Array cells container">
            <!-- cells will be rendered here -->
          </div>

          <div class="meta">
            <div class="code" id="codeView" aria-label="Array code view">
              <div style="opacity:.85; font-size:12px; margin-bottom:8px;">JavaScript representation</div>
              <pre id="codePre" style="white-space:pre-wrap; margin:0;">[]</pre>
            </div>

            <div class="history" aria-label="Operation history">
              <div style="font-weight:700; margin-bottom:8px;">History</div>
              <div id="historyList" aria-live="polite"></div>
            </div>
          </div>
        </div>

        <div style="display:flex; gap:12px; align-items:center; justify-content:space-between;">
          <div class="muted">Accessibility: all controls are keyboard-focusable. Touch-draggable for mobile.</div>
          <div>
            <button class="btn secondary" id="presetBtn">Load Preset Example</button>
            <button class="btn secondary" id="explainBtn">Short Walkthrough</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    (function(){
      // State
      let arr = [];
      const cellsEl = document.getElementById('cells');
      const lengthEl = document.getElementById('length');
      const codePre = document.getElementById('codePre');
      const historyList = document.getElementById('historyList');

      // Controls
      const valueInput = document.getElementById('valueInput');
      const indexInput = document.getElementById('indexInput');
      const accessIndex = document.getElementById('accessIndex');

      document.getElementById('pushBtn').addEventListener('click', ()=> doPush(valueInput.value));
      document.getElementById('popBtn').addEventListener('click', ()=> doPop());
      document.getElementById('unshiftBtn').addEventListener('click', ()=> doUnshift(valueInput.value));
      document.getElementById('shiftBtn').addEventListener('click', ()=> doShift());
      document.getElementById('insertBtn').addEventListener('click', ()=> doInsert(valueInput.value, parseIndex(indexInput.value)));
      document.getElementById('removeBtn').addEventListener('click', ()=> doRemove(parseIndex(indexInput.value)));
      document.getElementById('accessBtn').addEventListener('click', ()=> doAccess(parseIndex(accessIndex.value)));
      document.getElementById('clearBtn').addEventListener('click', ()=> clearArray());
      document.getElementById('presetBtn').addEventListener('click', ()=> loadPreset());
      document.getElementById('explainBtn').addEventListener('click', ()=> showWalkthrough());

      function parseIndex(v){
        const n = Number(v);
        return Number.isInteger(n) && n >= 0 ? n : null;
      }

      function updateView(animate=true){
        // Update length and code
        lengthEl.textContent = arr.length;
        codePre.textContent = JSON.stringify(arr, null, 2);

        // Reconcile DOM cells with array
        const curr = Array.from(cellsEl.children).filter(c => c.classList.contains('cell'));
        // Create DOM elements for new items
        while (curr.length < arr.length) {
          const el = createCell('');
          cellsEl.appendChild(el);
          curr.push(el);
        }
        // Remove extras
        while (curr.length > arr.length) {
          const last = curr.pop();
          animateRemove(last);
        }

        // Update content and indices
        for (let i=0;i<arr.length;i++){
          const el = curr[i];
          setCellContent(el, arr[i], i);
          // position handled by flex; we can animate mild transform to show change
          el.style.transition = 'transform .28s cubic-bezier(.2,.9,.25,1), opacity .18s';
        }
      }

      function createCell(value){
        const el = document.createElement('div');
        el.className = 'cell';
        el.setAttribute('role','button');
        el.setAttribute('tabindex','0');
        el.addEventListener('keydown', (e)=>{
          // Enter -> access
          if (e.key === 'Enter') {
            const idx = Array.prototype.indexOf.call(cellsEl.children, el);
            doAccess(idx);
          }
        });
        const span = document.createElement('div');
        span.className = 'value';
        span.textContent = value;
        el.appendChild(span);
        const idxEl = document.createElement('div');
        idxEl.className = 'index';
        idxEl.textContent = '-';
        el.appendChild(idxEl);

        // Dragging support
        let dragging = false;
        let startX=0, startY=0, ox=0, oy=0;
        let placeholder = null;

        const pointerDown = (ev)=>{
          if (ev.pointerType === 'mouse' && ev.button !== 0) return;
          el.setPointerCapture(ev.pointerId);
          dragging = true;
          el.classList.add('dragging');
          startX = ev.clientX; startY = ev.clientY;
          const rect = el.getBoundingClientRect();
          ox = ev.clientX - rect.left; oy = ev.clientY - rect.top;
          // create placeholder to visualize swap target
          placeholder = document.createElement('div');
          placeholder.className = 'cell placeholder';
          placeholder.style.width = rect.width + 'px';
          placeholder.style.height = rect.height + 'px';
          placeholder.style.background = 'linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.01))';
          placeholder.style.border = '1px dashed rgba(255,255,255,0.03)';
          placeholder.style.opacity = '0.6';
          cellsEl.insertBefore(placeholder, el.nextSibling);
          el.style.position = 'fixed';
          el.style.left = (ev.clientX - ox) + 'px';
          el.style.top = (ev.clientY - oy) + 'px';
          el.style.zIndex = 1000;
        };

        const pointerMove = (ev)=>{
          if (!dragging) return;
          ev.preventDefault();
          el.style.left = (ev.clientX - ox) + 'px';
          el.style.top = (ev.clientY - oy) + 'px';
          // determine index to swap with
          const children = Array.from(cellsEl.querySelectorAll('.cell:not(.dragging)'));
          let nearest = null;
          let nearestDist = Infinity;
          for (const c of children){
            const r = c.getBoundingClientRect();
            const cx = r.left + r.width/2;
            const cy = r.top + r.height/2;
            const d = Math.hypot(ev.clientX - cx, ev.clientY - cy);
            if (d < nearestDist) { nearestDist = d; nearest = c; }
          }
          if (nearest && placeholder){
            const nextSibling = nearest.nextSibling === placeholder ? nearest.nextSibling.nextSibling : nearest.nextSibling;
            cellsEl.insertBefore(placeholder, nearest.nextSibling);
          }
        };

        const pointerUp = (ev)=>{
          if (!dragging) return;
          dragging = false;
          el.releasePointerCapture(ev.pointerId);
          el.classList.remove('dragging');
          el.style.position = '';
          el.style.left = '';
          el.style.top = '';
          el.style.zIndex = '';
          // compute old and new index
          const nodes = Array.from(cellsEl.querySelectorAll('.cell')).filter(n => n !== placeholder);
          const oldIndex = nodes.indexOf(el);
          // placeholder index:
          const children = Array.from(cellsEl.children);
          const newIndex = children.indexOf(placeholder);
          // remove placeholder
          if (placeholder) { placeholder.remove(); placeholder = null; }
          // If newIndex is -1, append to end
          if (newIndex === -1) {
            // no change
            updateView();
            return;
          }
          // Convert children index to logical index (cells only)
          const cellChildren = Array.from(cellsEl.children).filter(n => n.classList.contains('cell') && n !== el);
          let targetIndex = Math.min(cellChildren.length, newIndex);
          // Build array of indices before swap
          const oldIdx = oldIndex;
          let newIdx = targetIndex;
          if (oldIdx !== newIdx && oldIdx !== -1) {
            // perform reorder in arr: remove at oldIdx and insert at newIdx
            const item = arr.splice(oldIdx,1)[0];
            arr.splice(newIdx,0,item);
            pushHistory(`Drag: moved index ${oldIdx} → ${newIdx}`);
            updateView();
            animatePulseAt(newIdx);
          } else {
            updateView();
          }
        };

        el.addEventListener('pointerdown', pointerDown);
        window.addEventListener('pointermove', pointerMove);
        window.addEventListener('pointerup', pointerUp);

        return el;
      }

      function setCellContent(el, value, index){
        el.querySelector('.value').textContent = value;
        el.querySelector('.index').textContent = index;
      }

      // Animations
      function animateRemove(el){
        el.style.transition = 'transform .28s ease, opacity .2s ease';
        el.style.opacity = '0';
        el.style.transform = 'translateY(18px) scale(.98)';
        setTimeout(()=> {
          if (el && el.parentNode) el.parentNode.removeChild(el);
        }, 220);
      }

      function animateInsertAt(pos){
        // small "pop" on new element
        const children = Array.from(cellsEl.children).filter(c=>c.classList.contains('cell'));
        if (children[pos]) {
          const el = children[pos];
          el.style.transform = 'scale(1.06) translateY(-6px)';
          setTimeout(()=> el.style.transform = '', 260);
        }
      }

      function animatePulseAt(pos){
        const children = Array.from(cellsEl.children).filter(c=>c.classList.contains('cell'));
        if (children[pos]) {
          const el = children[pos];
          el.classList.add('accessed');
          setTimeout(()=> el.classList.remove('accessed'), 700);
        }
      }

      // Operations
      function doPush(value){
        if (!value) { flashInput(valueInput); return; }
        arr.push(parsedValue(value));
        pushHistory(`push(${value})`);
        updateView();
        setTimeout(()=> animateInsertAt(arr.length-1), 60);
      }

      function doPop(){
        if (arr.length === 0) { pushHistory('pop() → undefined (empty)'); return; }
        const v = arr.pop();
        pushHistory(`pop() → ${formatValue(v)}`);
        updateView();
      }

      function doUnshift(value){
        if (!value) { flashInput(valueInput); return; }
        arr.unshift(parsedValue(value));
        pushHistory(`unshift(${value})`);
        updateView();
        setTimeout(()=> animateInsertAt(0), 60);
      }

      function doShift(){
        if (arr.length === 0) { pushHistory('shift() → undefined (empty)'); return; }
        const v = arr.shift();
        pushHistory(`shift() → ${formatValue(v)}`);
        updateView();
      }

      function doInsert(value, index){
        if (!value) { flashInput(valueInput); return; }
        if (index === null || index < 0 || index > arr.length) { pushHistory('insert: invalid index'); return; }
        arr.splice(index, 0, parsedValue(value));
        pushHistory(`insert(${value}) @ ${index}`);
        updateView();
        setTimeout(()=> animateInsertAt(index), 60);
      }

      function doRemove(index){
        if (index === null || index < 0 || index >= arr.length) { pushHistory('remove: invalid index'); return; }
        const removed = arr.splice(index,1)[0];
        pushHistory(`remove @ ${index} → ${formatValue(removed)}`);
        updateView();
      }

      function doAccess(index){
        if (index === null || index < 0 || index >= arr.length) { pushHistory('access: invalid index'); return; }
        const v = arr[index];
        pushHistory(`access(${index}) → ${formatValue(v)}`);
        animatePulseAt(index);
      }

      function clearArray(){
        arr = [];
        pushHistory('clear()');
        updateView();
      }

      function pushHistory(text){
        const item = document.createElement('div');
        item.className = 'hist-item';
        item.textContent = text;
        historyList.insertBefore(item, historyList.firstChild);
        // limit history length
        while (historyList.children.length > 80) historyList.removeChild(historyList.lastChild);
      }

      function parsedValue(v){
        // Try to parse numbers (int/float), else leave string trimmed
        const t = v.trim();
        if (t === '') return '';
        if (!isNaN(t) && t !== '') return Number(t);
        return t;
      }
      function formatValue(v){
        if (typeof v === 'string') return `"${v}"`;
        return String(v);
      }
      function flashInput(el){
        el.style.transition = 'box-shadow .18s';
        el.style.boxShadow = '0 0 0 4px rgba(79,209,197,0.11)';
        setTimeout(()=> el.style.boxShadow = '', 180);
      }

      // Preset example data
      function loadPreset(){
        arr = ['apple', 'banana', 'cherry', 42];
        pushHistory('load preset example');
        updateView();
      }

      // Walkthrough (short)
      function showWalkthrough(){
        alert('Walkthrough:\n\n1) Use "Push" to append a value to the end of the array.\n2) "Pop" removes the last item.\n3) "Unshift" adds to front; "Shift" removes the first.\n4) Use Insert/Remove with an index to manipulate middle slots.\n5) You can drag a cell to reorder — this updates indices immediately.\n\nTry these and watch the indices and code view.');
      }

      // Initialize
      updateView();

      // For accessibility: keyboard shortcuts
      window.addEventListener('keydown', (e)=>{
        // Ctrl+P push, Ctrl+O pop
        if (e.ctrlKey && e.key.toLowerCase() === 'p') { e.preventDefault(); doPush(valueInput.value); }
        if (e.ctrlKey && e.key.toLowerCase() === 'o') { e.preventDefault(); doPop(); }
      });

      // Hint: fill with initial values for better demo
      loadPreset();

    })();
  </script>
</body>
</html>