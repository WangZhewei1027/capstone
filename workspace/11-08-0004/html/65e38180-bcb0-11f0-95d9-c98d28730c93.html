<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Deque Explorer — Interactive Module</title>
  <style>
    :root{
      --safe-margin: 24px; /* Safe area */
      --gap: 16px;         /* Minimum spacing */
      --bg: #0f1724;
      --card: #0b1220;
      --accent: #38bdf8;
      --muted: #94a3b8;
      --success: #34d399;
      --warn: #fb923c;
      --danger: #fb6f6f;
      --cell-bg: #071029;
      --cell-border: rgba(255,255,255,0.06);
      --text: #e6eef8;
      --glass: rgba(255,255,255,0.02);
      --radius: 10px;
    }

    /* Base layout & safe margin */
    html,body{
      height:100%;
      margin:0;
      background: linear-gradient(180deg,var(--bg),#051022 60%);
      color:var(--text);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .app {
      padding: var(--safe-margin);
      min-height:100%;
      box-sizing:border-box;
      display:flex;
      align-items:flex-start;
      justify-content:center;
    }

    /* Module card */
    .module {
      width: 100%;
      max-width:1100px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: var(--radius);
      padding: 22px;
      box-shadow: 0 6px 30px rgba(2,6,23,0.6);
      box-sizing:border-box;
      display:flex;
      gap: var(--gap);
      flex-wrap:wrap;
    }

    /* Left column: text & controls */
    .info {
      flex: 1 1 340px;
      min-width: 300px;
      display:flex;
      flex-direction:column;
      gap: var(--gap);
    }
    h1{
      margin:0 0 2px 0;
      font-size:20px;
      letter-spacing: -0.2px;
    }
    .meta {
      color:var(--muted);
      font-size:13px;
      margin-bottom:8px;
    }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008));
      border: 1px solid rgba(255,255,255,0.03);
      padding:12px;
      border-radius:8px;
      box-sizing:border-box;
    }
    .objective {
      font-size:14px;
      line-height:1.4;
      color:var(--text);
    }
    .small {
      font-size:13px;
      color:var(--muted);
    }

    /* Controls area */
    .controls {
      display:flex;
      flex-direction:column;
      gap: var(--gap);
    }
    .row {
      display:flex;
      gap: var(--gap);
      align-items:center;
      flex-wrap:wrap;
    }
    input[type="text"]{
      padding:10px 12px;
      background:var(--glass);
      border:1px solid rgba(255,255,255,0.04);
      color:var(--text);
      border-radius:8px;
      min-width:140px;
      outline:none;
      box-sizing:border-box;
    }
    .btn {
      background:linear-gradient(180deg,var(--accent),#2aa9d6);
      border:0;
      color:#042028;
      font-weight:600;
      padding:10px 12px;
      border-radius:8px;
      cursor:pointer;
      min-width:92px;
      box-shadow: 0 4px 14px rgba(14,165,233,0.12);
    }
    .btn.secondary {
      background:transparent;
      border:1px solid rgba(255,255,255,0.05);
      color:var(--text);
      font-weight:600;
    }
    .btn.warn {
      background: linear-gradient(180deg,var(--warn),#ea7a3a);
      color:#141205;
    }
    .btn:disabled {
      opacity:0.45;
      cursor:not-allowed;
      transform:none;
      box-shadow:none;
    }
    .muted {
      color:var(--muted);
      font-size:13px;
    }

    /* Right column: visual deque */
    .visual {
      flex: 1 1 360px;
      min-width:320px;
      display:flex;
      flex-direction:column;
      gap: var(--gap);
    }
    .deque-area {
      background: linear-gradient(180deg, rgba(255,255,255,0.006), rgba(255,255,255,0.008));
      border-radius: 10px;
      padding: 18px;
      border: 1px solid rgba(255,255,255,0.03);
      min-height: 220px;
      box-sizing:border-box;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .belt {
      height: 96px;
      background: linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008));
      border-radius:8px;
      border: 1px dashed rgba(255,255,255,0.03);
      display:flex;
      align-items:center;
      justify-content:flex-start;
      padding: 10px;
      gap:12px;
      overflow-x:auto;
      scroll-behavior:smooth;
    }
    /* Deque cells */
    .cell {
      min-width:72px;
      min-height:64px;
      background: linear-gradient(180deg,var(--cell-bg), #07142a);
      border-radius:8px;
      border:1px solid var(--cell-border);
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:16px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.6);
      position:relative;
      flex:0 0 auto;
    }
    .cell .lbl {
      position:absolute;
      bottom:-20px;
      left:50%;
      transform:translateX(-50%);
      font-size:11px;
      color:var(--muted);
    }
    .pointer {
      display:inline-flex;
      gap:8px;
      align-items:center;
      color:var(--muted);
      font-size:13px;
    }
    .pointer strong {
      color:var(--accent);
      font-weight:700;
    }

    /* Animation classes */
    .incoming-left {
      animation: slideInFromLeft 380ms cubic-bezier(.2,.9,.18,1) both;
    }
    .incoming-right {
      animation: slideInFromRight 380ms cubic-bezier(.2,.9,.18,1) both;
    }
    .outgoing-left {
      animation: slideOutToLeft 300ms cubic-bezier(.4,.0,.2,1) both;
    }
    .outgoing-right {
      animation: slideOutToRight 300ms cubic-bezier(.4,.0,.2,1) both;
    }
    .flash {
      animation: flashGlow 900ms ease;
    }
    .shake {
      animation: shakeX 420ms cubic-bezier(.36,.07,.19,.97);
    }

    @keyframes slideInFromLeft {
      0% { transform: translateX(-120%) scale(0.96); opacity:0; }
      60% { transform: translateX(10%) scale(1.02); opacity:1; }
      100% { transform: translateX(0%) scale(1); }
    }
    @keyframes slideInFromRight {
      0% { transform: translateX(120%) scale(0.96); opacity:0; }
      60% { transform: translateX(-10%) scale(1.02); opacity:1; }
      100% { transform: translateX(0%) scale(1); }
    }
    @keyframes slideOutToLeft {
      0% { transform: translateX(0%); opacity:1; }
      100% { transform: translateX(-120%); opacity:0; }
    }
    @keyframes slideOutToRight {
      0% { transform: translateX(0%); opacity:1; }
      100% { transform: translateX(120%); opacity:0; }
    }
    @keyframes flashGlow {
      0% { box-shadow: 0 0 0px rgba(56,189,248,0.0); }
      40% { box-shadow: 0 8px 30px rgba(56,189,248,0.12); }
      100% { box-shadow: 0 0 0px rgba(56,189,248,0.0); }
    }
    @keyframes shakeX {
      10%, 90% { transform: translateX(-1px); }
      20%, 80% { transform: translateX(2px); }
      30%, 50%, 70% { transform: translateX(-4px); }
      40%, 60% { transform: translateX(4px); }
    }

    /* Operation log */
    .log {
      background:transparent;
      color:var(--muted);
      font-size:13px;
      max-height:120px;
      overflow:auto;
      padding-right:8px;
    }
    .log-item { margin-bottom:8px; }
    .live {
      position:absolute;
      left:-10000px;
      top:auto;
      width:1px;
      height:1px;
      overflow:hidden;
    }

    /* Footer hints */
    .hints {
      font-size:13px;
      color:var(--muted);
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      align-items:center;
    }

    /* Responsive adjustments */
    @media (max-width:880px){
      .module { padding:16px; gap:12px; }
      .deque-area { min-height: 200px; }
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-labelledby="title">
    <main class="module" aria-live="polite">
      <!-- Left column -->
      <section class="info" aria-labelledby="title">
        <div>
          <h1 id="title">Deque Explorer — Double-Ended Queue (Deque)</h1>
          <div class="meta">Interactive visualization: push/pop at both ends • step-by-step feedback</div>
        </div>

        <div class="card">
          <div class="small" style="margin-bottom:8px;"><strong>Learning objective</strong></div>
          <div class="objective">
            After using this module you will be able to:
            <ul style="margin:8px 0 0 18px; padding:0;">
              <li>Perform push and pop operations at both front and back of a deque.</li>
              <li>Observe how elements enter and leave from either end, and how front/back pointers change.</li>
              <li>Understand capacity limitations and common behaviors (peek, clear).</li>
            </ul>
          </div>
        </div>

        <div class="card controls" aria-labelledby="controls-heading">
          <div id="controls-heading" class="small" style="margin-bottom:6px;"><strong>Controls</strong></div>

          <div class="row" style="align-items:stretch;">
            <input id="valueInput" type="text" aria-label="Value to insert" placeholder="Value (e.g. 42 or 'A')" />
            <button id="pushFrontBtn" class="btn" title="Push to front (shortcut: F)">Push Front (F)</button>
            <button id="pushBackBtn" class="btn" title="Push to back (shortcut: B)">Push Back (B)</button>
          </div>

          <div class="row">
            <button id="popFrontBtn" class="btn secondary" title="Pop from front (shortcut: 1)">Pop Front (1)</button>
            <button id="popBackBtn" class="btn secondary" title="Pop from back (shortcut: 2)">Pop Back (2)</button>
            <button id="peekFrontBtn" class="btn secondary" title="Peek front element">Peek Front</button>
            <button id="peekBackBtn" class="btn secondary" title="Peek back element">Peek Back</button>
          </div>

          <div class="row">
            <button id="clearBtn" class="btn warn">Clear</button>
            <button id="randomBtn" class="btn secondary">Insert Random</button>

            <label style="margin-left:auto; display:flex; gap:8px; align-items:center;">
              <span class="muted">Max capacity</span>
              <select id="capacitySelect" style="padding:8px 10px; border-radius:8px; background:var(--glass); color:var(--text); border:1px solid rgba(255,255,255,0.03);">
                <option value="0">unbounded</option>
                <option value="6">6</option>
                <option value="8">8</option>
                <option value="10">10</option>
              </select>
            </label>
          </div>

          <div class="row" style="align-items:center;">
            <div class="muted">Size: <strong id="sizeLabel" style="color:var(--accent); margin-left:6px;">0</strong></div>
            <div style="width:var(--gap)"></div>
            <div class="pointer" aria-hidden="true">
              <span>Front → <strong id="frontIdx">—</strong></span>
              <span style="margin-left:8px;">Back → <strong id="backIdx">—</strong></span>
            </div>
          </div>

          <div class="small" style="margin-top:6px; color:var(--muted);">
            Interaction notes: Click controls, or use keyboard shortcuts (F, B, 1, 2). Animations show the direction of insertion/removal.
          </div>
        </div>

        <div class="card">
          <div class="small" style="margin-bottom:6px;"><strong>Interaction Design</strong></div>
          <div class="small">
            - Click "Push Front" or "Push Back" to insert; a cell slides in from the left/right respectively.<br>
            - Click "Pop Front" or "Pop Back" to remove; the cell slides out to the corresponding side.<br>
            - "Peek" highlights the front/back cell without removing it.<br>
            - Capacity can be toggled; when full, insertion is blocked with a shake animation.<br>
            - Live text (screen-reader friendly) announces each operation and resulting size.
          </div>
        </div>

        <div class="hints small" style="margin-top:6px;">
          <div>Keyboard: F (push front), B (push back), 1 (pop front), 2 (pop back)</div>
          <div>Accessibility: changes announced via ARIA live region</div>
        </div>
      </section>

      <!-- Right column: Visual -->
      <section class="visual" aria-labelledby="visual-heading">
        <div id="visual-heading" class="small">Deque visualization</div>

        <div class="deque-area card" role="region" aria-label="Deque visualization area">
          <div class="belt" id="belt" tabindex="0" aria-live="polite">
            <!-- cells inserted here -->
          </div>

          <div style="display:flex; justify-content:space-between; align-items:center;">
            <div class="pointer" aria-hidden="true">
              <span>Front pointer → <strong id="frontLabel">—</strong></span>
            </div>
            <div class="pointer" aria-hidden="true">
              <span>Back pointer → <strong id="backLabel">—</strong></span>
            </div>
          </div>

          <div class="log" id="opLog" aria-live="polite" role="log" aria-atomic="false">
            <!-- log entries -->
          </div>
        </div>

        <div class="card small" style="position:relative;">
          <strong>Layout Description</strong>
          <div style="margin-top:6px; color:var(--muted);">
            This module places explanatory text and controls on the left and the interactive visualization on the right.
            Spacing and padding follow the safe-area margin (24px) and minimum spacing (16px) guidelines.
            Controls are grouped and clearly separated from the belt. The belt supports horizontal scrolling on small screens.
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Hidden live region for screen readers -->
  <div id="srLive" class="live" aria-live="polite" aria-atomic="true"></div>

  <script>
    (function(){
      /* State */
      const deque = []; // underlying array
      let capacity = 0; // 0 = unbounded

      /* DOM */
      const belt = document.getElementById('belt');
      const valueInput = document.getElementById('valueInput');
      const pushFrontBtn = document.getElementById('pushFrontBtn');
      const pushBackBtn = document.getElementById('pushBackBtn');
      const popFrontBtn = document.getElementById('popFrontBtn');
      const popBackBtn = document.getElementById('popBackBtn');
      const peekFrontBtn = document.getElementById('peekFrontBtn');
      const peekBackBtn = document.getElementById('peekBackBtn');
      const clearBtn = document.getElementById('clearBtn');
      const randomBtn = document.getElementById('randomBtn');
      const capacitySelect = document.getElementById('capacitySelect');
      const opLog = document.getElementById('opLog');
      const srLive = document.getElementById('srLive');
      const sizeLabel = document.getElementById('sizeLabel');
      const frontIdx = document.getElementById('frontIdx');
      const backIdx = document.getElementById('backIdx');
      const frontLabel = document.getElementById('frontLabel');
      const backLabel = document.getElementById('backLabel');

      /* Utilities */
      function announce(msg){
        // update a visually-hidden live region and a small log
        srLive.textContent = msg;
        const item = document.createElement('div');
        item.className = 'log-item';
        item.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
        opLog.insertBefore(item, opLog.firstChild);
      }

      function updateMeta(){
        sizeLabel.textContent = deque.length;
        frontIdx.textContent = deque.length ? 0 : '—';
        backIdx.textContent = deque.length ? (deque.length - 1) : '—';
        frontLabel.textContent = deque.length ? String(deque[0]) : '—';
        backLabel.textContent = deque.length ? String(deque[deque.length-1]) : '—';
        // disable pop buttons if empty
        const empty = deque.length === 0;
        popFrontBtn.disabled = empty;
        popBackBtn.disabled = empty;
        peekFrontBtn.disabled = empty;
        peekBackBtn.disabled = empty;
        // capacity info
        if(capacity > 0){
          capacitySelect.style.borderColor = (deque.length >= capacity) ? 'var(--danger)' : 'rgba(255,255,255,0.03)';
        } else {
          capacitySelect.style.borderColor = 'rgba(255,255,255,0.03)';
        }
      }

      function createCell(value){
        const el = document.createElement('div');
        el.className = 'cell';
        el.tabIndex = -1;
        el.setAttribute('role','group');
        el.setAttribute('aria-label','deque element ' + value);
        el.textContent = value;
        const lbl = document.createElement('div');
        lbl.className = 'lbl';
        lbl.textContent = 'element';
        el.appendChild(lbl);
        return el;
      }

      /* Operations */
      function pushFront(value, visual = true){
        if(capacity > 0 && deque.length >= capacity){
          // shake belt to indicate full
          belt.classList.add('shake');
          setTimeout(()=> belt.classList.remove('shake'), 420);
          announce('Insertion blocked: deque is at capacity ('+capacity+')');
          return;
        }
        deque.unshift(value);
        if(visual){
          const cell = createCell(value);
          cell.classList.add('incoming-left','flash');
          // Prepend visually
          if(belt.firstChild){
            belt.insertBefore(cell, belt.firstChild);
          } else {
            belt.appendChild(cell);
          }
          // remove flash after animation
          setTimeout(()=> cell.classList.remove('flash'), 900);
          // ensure visible
          cell.scrollIntoView({behavior:'smooth', inline:'start'});
        } else {
          // re-render?
        }
        announce('Pushed to front: ' + value + ' • size is now ' + deque.length);
        updateMeta();
      }

      function pushBack(value, visual = true){
        if(capacity > 0 && deque.length >= capacity){
          belt.classList.add('shake');
          setTimeout(()=> belt.classList.remove('shake'), 420);
          announce('Insertion blocked: deque is at capacity ('+capacity+')');
          return;
        }
        deque.push(value);
        if(visual){
          const cell = createCell(value);
          cell.classList.add('incoming-right','flash');
          belt.appendChild(cell);
          setTimeout(()=> cell.classList.remove('flash'), 900);
          cell.scrollIntoView({behavior:'smooth', inline:'end'});
        }
        announce('Pushed to back: ' + value + ' • size is now ' + deque.length);
        updateMeta();
      }

      function popFront(){
        if(deque.length === 0){
          announce('Pop front failed: deque is empty');
          return;
        }
        const value = deque.shift();
        // Visual: animate first cell out to left
        const first = belt.firstChild;
        if(first){
          first.classList.add('outgoing-left');
          first.addEventListener('animationend', ()=> {
            if(first && first.parentNode) first.parentNode.removeChild(first);
          }, {once:true});
        }
        announce('Popped from front: ' + value + ' • size is now ' + deque.length);
        updateMeta();
      }

      function popBack(){
        if(deque.length === 0){
          announce('Pop back failed: deque is empty');
          return;
        }
        const value = deque.pop();
        // Visual: animate last cell out to right
        const last = belt.lastChild;
        if(last){
          last.classList.add('outgoing-right');
          last.addEventListener('animationend', ()=> {
            if(last && last.parentNode) last.parentNode.removeChild(last);
          }, {once:true});
        }
        announce('Popped from back: ' + value + ' • size is now ' + deque.length);
        updateMeta();
      }

      function peekFront(){
        if(deque.length === 0) {
          announce('Peek front: deque is empty');
          return;
        }
        const val = deque[0];
        const first = belt.firstChild;
        if(first){
          first.classList.add('flash');
          setTimeout(()=> first.classList.remove('flash'), 700);
        }
        announce('Peek front: ' + val);
      }

      function peekBack(){
        if(deque.length === 0) {
          announce('Peek back: deque is empty');
          return;
        }
        const val = deque[deque.length-1];
        const last = belt.lastChild;
        if(last){
          last.classList.add('flash');
          setTimeout(()=> last.classList.remove('flash'), 700);
        }
        announce('Peek back: ' + val);
      }

      function clearAll(){
        if(deque.length === 0){
          announce('Clear: deque already empty');
          return;
        }
        deque.length = 0;
        // animate all out quickly
        const children = Array.from(belt.children);
        children.forEach((c,i)=>{
          // alternate direction for visual flair
          const cls = (i % 2 === 0) ? 'outgoing-left' : 'outgoing-right';
          c.classList.add(cls);
          c.addEventListener('animationend', () => {
            if(c && c.parentNode) c.parentNode.removeChild(c);
          }, {once:true});
        });
        announce('Cleared deque. Size is 0');
        updateMeta();
      }

      /* Bind UI */
      pushFrontBtn.addEventListener('click', ()=> {
        const val = valueInput.value.trim() || generateRandomValue();
        valueInput.value = '';
        pushFront(val);
      });
      pushBackBtn.addEventListener('click', ()=> {
        const val = valueInput.value.trim() || generateRandomValue();
        valueInput.value = '';
        pushBack(val);
      });
      popFrontBtn.addEventListener('click', popFront);
      popBackBtn.addEventListener('click', popBack);
      peekFrontBtn.addEventListener('click', peekFront);
      peekBackBtn.addEventListener('click', peekBack);
      clearBtn.addEventListener('click', clearAll);
      randomBtn.addEventListener('click', ()=> {
        const val = generateRandomValue();
        // randomly choose front/back for variety
        const toFront = Math.random() < 0.5;
        if(toFront) pushFront(val); else pushBack(val);
      });

      capacitySelect.addEventListener('change', ()=> {
        capacity = Number(capacitySelect.value) || 0;
        announce(capacity ? ('Capacity set to ' + capacity) : 'Capacity set to unbounded');
        // If current size exceeds new capacity, visually mark excess (no auto-removal)
        if(capacity > 0 && deque.length > capacity){
          announce('Deque exceeds capacity: current size ' + deque.length + ' > ' + capacity);
          belt.classList.add('shake');
          setTimeout(()=> belt.classList.remove('shake'), 420);
        }
        updateMeta();
      });

      function generateRandomValue(){
        // small set of values
        const items = ['A','B','C','X','1','2','3','42','♥','★'];
        return items[Math.floor(Math.random()*items.length)];
      }

      /* Keyboard shortcuts */
      document.addEventListener('keydown', (e)=> {
        if(e.key === 'f' || e.key === 'F'){
          e.preventDefault();
          pushFrontBtn.click();
        } else if(e.key === 'b' || e.key === 'B'){
          e.preventDefault();
          pushBackBtn.click();
        } else if(e.key === '1'){
          e.preventDefault();
          popFrontBtn.click();
        } else if(e.key === '2'){
          e.preventDefault();
          popBackBtn.click();
        } else if(e.key === 'Escape'){
          valueInput.value = '';
        }
      });

      /* Accessibility: focus belt on insertion for keyboard users */
      const observer = new MutationObserver((mutations)=>{
        for(const m of mutations){
          if(m.addedNodes && m.addedNodes.length){
            // focus last added node for screenreader
            const last = belt.lastChild;
            if(last) {
              last.focus({preventScroll:true});
            }
          }
        }
      });
      observer.observe(belt, {childList:true});

      // Initialize meta
      updateMeta();

      // Example: pre-populate with two items for immediate context
      pushBack('A', true);
      pushBack('B', true);
    })();
  </script>
</body>
</html>