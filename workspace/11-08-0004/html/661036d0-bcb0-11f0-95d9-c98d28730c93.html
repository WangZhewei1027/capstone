<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stack Visualizer — LIFO Interactive Module</title>
  <style>
    :root{
      --safe-margin: 24px;
      --gap: 16px;
      --bg: #0f1724;
      --panel: #0b1220;
      --accent: #38bdf8;
      --accent-2: #7c3aed;
      --muted: #94a3b8;
      --success: #16a34a;
      --danger: #ef4444;
      --card: #071020;
      --text: #e6eef8;
      --glass: rgba(255,255,255,0.03);
      --radius: 10px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body{
      height:100%;
      margin:0;
      background: linear-gradient(180deg, #071022 0%, #08112a 50%, #071020 100%);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Safe area */
    .app {
      padding: var(--safe-margin);
      box-sizing: border-box;
      min-height: 100%;
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    header {
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    h1 {
      margin:0;
      font-size:1.25rem;
      letter-spacing: -0.01em;
      color:var(--text);
    }
    p.lead {
      margin:0;
      color:var(--muted);
      font-size:0.95rem;
    }

    .module {
      display: grid;
      grid-template-columns: 360px 1fr;
      gap: var(--gap);
      align-items:start;
    }

    /* Responsive collapse */
    @media (max-width:920px){
      .module{
        grid-template-columns: 1fr;
      }
    }

    /* Controls panel */
    .controls {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: var(--radius);
      padding: 16px;
      min-height: 220px;
      box-shadow: 0 6px 20px rgba(3,7,18,0.6);
      display:flex;
      flex-direction:column;
      gap:var(--gap);
    }

    .row {
      display:flex;
      gap:var(--gap);
      align-items:center;
      flex-wrap:wrap;
    }

    label {
      font-size:0.85rem;
      color:var(--muted);
      display:block;
      margin-bottom:6px;
    }

    input[type="text"]{
      flex:1 1 auto;
      min-width:0;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.04);
      background: rgba(255,255,255,0.02);
      color:var(--text);
      outline:none;
      font-size:0.95rem;
    }
    input[type="text"]:focus{
      box-shadow: 0 0 0 4px rgba(56,189,248,0.08);
      border-color: var(--accent);
    }

    button {
      background:linear-gradient(180deg,var(--accent), #0fa9db);
      color:#031124;
      border:none;
      padding:10px 14px;
      border-radius:8px;
      font-weight:600;
      cursor:pointer;
      min-height:44px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    button.secondary{
      background: linear-gradient(180deg,#162235, #0f1724);
      color:var(--text);
      border:1px solid rgba(255,255,255,0.04);
      font-weight:600;
      box-shadow:none;
    }
    button.warn{
      background: linear-gradient(180deg,#fb923c,#f97316);
      color:#081022;
    }
    button:active{ transform: translateY(1px) scale(.997); }
    button:focus{ outline: 3px solid rgba(124,58,237,0.12); }

    .btn-group { display:flex; gap:8px; flex-wrap:wrap; }

    .small {
      font-size:0.9rem;
      padding:8px 10px;
      border-radius:8px;
      min-height:40px;
    }

    .meta {
      display:flex;
      gap:12px;
      align-items:center;
      color:var(--muted);
      font-size:0.9rem;
      flex-wrap:wrap;
    }

    .slider-row {
      display:flex;
      gap:var(--gap);
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    input[type="range"]{
      width:100%;
      accent-color: var(--accent-2);
    }

    /* Visualization panel */
    .visual {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: 0 6px 20px rgba(3,7,18,0.6);
      min-height: 360px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .canvas {
      display:flex;
      gap:var(--gap);
      align-items:center;
      justify-content:center;
      flex:1;
      min-height:240px;
    }

    .stack-frame {
      width:220px;
      max-width:40vw;
      height:320px;
      background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.04);
      padding:12px;
      box-sizing:border-box;
      display:flex;
      align-items:flex-end; /* stack builds upward */
      justify-content:center;
      position:relative;
      overflow:hidden;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
    }

    .stack-frame.shake {
      animation: shake .5s ease;
    }
    @keyframes shake {
      10%,90%{ transform: translateX(-1px); }
      20%,80%{ transform: translateX(2px); }
      30%,50%,70%{ transform: translateX(-4px); }
      40%,60%{ transform: translateX(4px); }
    }

    /* Stack items: stacked from bottom (index 0) to top (end) */
    .stack {
      display:flex;
      flex-direction: column-reverse;
      gap:10px;
      width:100%;
      align-items:stretch;
      padding: 8px;
      box-sizing:border-box;
    }

    .slot {
      height:44px;
      background: rgba(255,255,255,0.02);
      border:1px dashed rgba(255,255,255,0.03);
      color:var(--muted);
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:8px 12px;
      box-sizing:border-box;
      font-weight:600;
      position:relative;
      transition: background .18s ease, transform .18s ease, opacity .18s ease;
    }

    .slot .value {
      color:var(--text);
      font-weight:700;
      font-size:0.98rem;
    }
    .slot.filled {
      background: linear-gradient(90deg, rgba(56,189,248,0.08), rgba(124,58,237,0.06));
      border-style:solid;
      border-color: rgba(56,189,248,0.14);
      box-shadow: 0 6px 18px rgba(7,12,22,0.45);
    }

    .slot.top {
      box-shadow: 0 8px 30px rgba(124,58,237,0.15), 0 2px 6px rgba(3,7,18,0.6);
      transform: translateY(-4px);
      border-color: rgba(124,58,237,0.26);
    }

    .index {
      font-size:0.82rem;
      color:var(--muted);
      width:36px;
      text-align:left;
    }

    .pointer {
      position:absolute;
      right:-72px;
      top:16px;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:6px;
      font-size:0.9rem;
    }
    .pointer .arrow {
      display:inline-block;
      transform: rotate(-90deg);
      font-weight:900;
      color:var(--accent-2);
    }

    /* Push animation */
    .anim-in {
      animation: pushIn .4s cubic-bezier(.2,.9,.24,1) forwards;
      transform-origin:center;
    }
    @keyframes pushIn {
      0% { transform: translateY(-24px) scale(.96); opacity:0; }
      60% { transform: translateY(6px) scale(1.02); opacity:1; }
      100%{ transform: translateY(0) scale(1); opacity:1; }
    }

    /* Pop animation */
    .anim-out {
      animation: popOut .45s cubic-bezier(.2,.9,.24,1) forwards;
    }
    @keyframes popOut {
      0% { transform: translateX(0) rotate(0deg); opacity:1; }
      60% { transform: translateX(36px) rotate(8deg); opacity:0.6; }
      100%{ transform: translateX(120px) rotate(12deg); opacity:0; height:0; margin:0; padding:0; }
    }

    .peek {
      animation: peekPulse .9s ease;
    }
    @keyframes peekPulse {
      0% { box-shadow: 0 0 0 0 rgba(124,58,237,0.18); }
      70% { box-shadow: 0 0 0 10px rgba(124,58,237,0.02); }
      100% { box-shadow: 0 0 0 0 rgba(124,58,237,0.00); }
    }

    .info {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:var(--gap);
      color:var(--muted);
      font-size:0.9rem;
    }

    .history {
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }
    .chip {
      background: rgba(255,255,255,0.02);
      padding:6px 8px;
      border-radius:8px;
      font-size:0.82rem;
      color:var(--muted);
      border:1px solid rgba(255,255,255,0.02);
    }

    /* Announcements region (visually subtle) */
    .announcements {
      margin-top:6px;
      font-size:0.92rem;
      color:var(--muted);
      min-height:22px;
    }

    /* Small readable readout for last popped */
    .readout {
      display:flex;
      gap:8px;
      align-items:center;
      color:var(--muted);
      font-size:0.95rem;
    }

    /* Focus outlines for slots */
    .slot:focus {
      outline: 3px solid rgba(56,189,248,0.08);
    }

    /* Utility */
    .muted { color:var(--muted); }
    .danger { color:var(--danger); }
    .success { color:var(--success); }
  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <h1>Stack — LIFO Visualizer</h1>
      <p class="lead">Interact with the stack: push values, pop top, peek, and observe capacity behavior and the changing "top". Animations emphasize the LIFO order.</p>
    </header>

    <main class="module" role="application" aria-labelledby="stack-title">
      <section class="controls" aria-label="Stack controls">
        <div>
          <label for="value-input">Value to push</label>
          <div class="row">
            <input id="value-input" type="text" placeholder='Enter value (e.g., "A", "42", "node")' aria-label="Value to push" />
            <button id="push-btn" class="small" title="Push value onto stack">Push</button>
          </div>
        </div>

        <div class="row btn-group" role="group" aria-label="Stack operations">
          <button id="pop-btn" class="secondary small" title="Pop top value">Pop</button>
          <button id="peek-btn" class="secondary small" title="Peek top">Peek</button>
          <button id="clear-btn" class="secondary small" title="Clear stack">Clear</button>
          <button id="random-btn" class="small" title="Push random value">Random</button>
        </div>

        <div>
          <label for="capacity">Capacity: <span id="capacity-label">6</span></label>
          <div class="slider-row">
            <input id="capacity" type="range" min="1" max="12" value="6" />
            <div class="meta"><span class="muted">Max slots</span></div>
          </div>
        </div>

        <div class="row info" aria-hidden="false">
          <div class="readout">Last popped: <strong id="last-popped" style="margin-left:8px">—</strong></div>
          <div class="history" aria-live="polite" id="history"></div>
        </div>

        <div class="announcements" aria-live="polite" id="announcements">Ready. Use Push to add items.</div>
      </section>

      <section class="visual" aria-label="Stack visualization">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:16px;">
          <div>
            <strong id="stack-title">Visual Stack</strong>
            <div class="muted" style="font-size:0.88rem;margin-top:6px">Bottom (index 0) is at the base. Top grows upward.</div>
          </div>
          <div class="meta" style="justify-self:end">
            <div class="muted">Size: <span id="size-readout">0</span></div>
          </div>
        </div>

        <div class="canvas" aria-hidden="false">
          <div class="stack-frame" id="stack-frame" aria-describedby="stack-desc">
            <div class="stack" id="stack" role="list" aria-label="Stack slots"></div>
            <div class="pointer" aria-hidden="true"><span class="arrow">➤</span> Top</div>
          </div>
        </div>

        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div class="muted">Highlighted operations are shown with animation. Overflow/underflow causes a shake.</div>
          <div class="muted">Indices on left show array mapping.</div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // Stack visualizer implementation (vanilla JS)
    (function(){
      // DOM refs
      const input = document.getElementById('value-input');
      const pushBtn = document.getElementById('push-btn');
      const popBtn = document.getElementById('pop-btn');
      const peekBtn = document.getElementById('peek-btn');
      const clearBtn = document.getElementById('clear-btn');
      const randomBtn = document.getElementById('random-btn');
      const capacityEl = document.getElementById('capacity');
      const capacityLabel = document.getElementById('capacity-label');
      const stackEl = document.getElementById('stack');
      const sizeReadout = document.getElementById('size-readout');
      const lastPopped = document.getElementById('last-popped');
      const announcements = document.getElementById('announcements');
      const historyEl = document.getElementById('history');
      const stackFrame = document.getElementById('stack-frame');

      // State
      let stack = [];
      let capacity = parseInt(capacityEl.value, 10) || 6;
      capacityLabel.textContent = capacity;
      const maxHistory = 8;

      // Utility
      function announce(text){
        announcements.textContent = text;
        const node = document.createElement('div');
        node.className = 'chip';
        node.textContent = text;
        historyEl.insertBefore(node, historyEl.firstChild);
        if(historyEl.children.length > maxHistory) historyEl.removeChild(historyEl.lastChild);
      }

      function updateUI(){
        // Rebuild visual slots to match capacity and current stack
        stackEl.innerHTML = '';
        // Create slots for indices [capacity-1 down to 0] to visualize indices
        for(let i = capacity - 1; i >= 0; i--){
          const slot = document.createElement('div');
          slot.className = 'slot';
          slot.setAttribute('role','listitem');
          // index shown on left
          const index = document.createElement('div');
          index.className = 'index';
          index.textContent = i;
          // value area
          const valueWrap = document.createElement('div');
          valueWrap.style.display='flex';
          valueWrap.style.justifyContent='space-between';
          valueWrap.style.alignItems='center';
          valueWrap.style.gap='8px';
          valueWrap.style.width='100%';

          const value = document.createElement('div');
          value.className = 'value';
          // Determine if filled
          const arrIndex = i; // natural index
          if(arrIndex < stack.length){
            // show value from stack
            const vIndex = arrIndex; // bottom=0
            value.textContent = stack[vIndex];
            slot.classList.add('filled');
            if(vIndex === stack.length - 1){
              slot.classList.add('top');
              slot.setAttribute('aria-current','true');
            }
          } else {
            value.textContent = '';
          }

          valueWrap.appendChild(value);
          slot.appendChild(index);
          slot.appendChild(valueWrap);
          stackEl.appendChild(slot);
        }

        // Update size readout
        sizeReadout.textContent = stack.length;
      }

      function pushValue(val){
        if(!val && val !== 0){
          announce('Please enter a value to push.');
          return;
        }
        if(stack.length >= capacity){
          // overflow
          stackFrame.classList.add('shake');
          announce('Stack overflow — cannot push, capacity reached.');
          setTimeout(()=> stackFrame.classList.remove('shake'), 600);
          return;
        }
        // Add to data
        stack.push(String(val));
        // Visual add with animation:
        // We rebuild then find the top slot and animate it.
        updateUI();
        // Animate the top element
        // top slot is the last filled slot (index capacity - stack.length)
        // query first slot with .top
        const topSlot = stackEl.querySelector('.slot.top');
        if(topSlot){
          topSlot.classList.add('anim-in');
          setTimeout(()=> topSlot.classList.remove('anim-in'), 500);
        }
        announce('Pushed "' + val + '" to stack. Top updated.');
      }

      function popValue(){
        if(stack.length === 0){
          stackFrame.classList.add('shake');
          announce('Stack underflow — nothing to pop.');
          setTimeout(()=> stackFrame.classList.remove('shake'), 600);
          return;
        }
        const popped = stack.pop();
        // Animate pop: temporarily create a visual element that animates out
        // First, rebuild UI so the top slot still shows the value (we'll animate it out from there)
        updateUI();
        const topSlot = stackEl.querySelector('.slot.top');
        if(topSlot){
          // Add animation class; remove after animation and then update UI to reflect final state
          topSlot.classList.add('anim-out');
          // Make sure popped readout shows value immediately
          lastPopped.textContent = popped;
          announce('Popped "' + popped + '" from stack.');
          setTimeout(()=>{
            // Rebuild UI to remove the popped slot's content
            updateUI();
          }, 450);
        } else {
          // Fallback
          lastPopped.textContent = popped;
          announce('Popped "' + popped + '" from stack.');
          updateUI();
        }
      }

      function peek(){
        if(stack.length === 0){
          announce('Stack is empty — nothing to peek.');
          stackFrame.classList.add('shake');
          setTimeout(()=> stackFrame.classList.remove('shake'), 600);
          return;
        }
        const top = stack[stack.length - 1];
        announce('Peek top: "' + top + '".');
        // highlight top slot briefly
        const topSlot = stackEl.querySelector('.slot.top');
        if(topSlot){
          topSlot.classList.add('peek');
          setTimeout(()=> topSlot.classList.remove('peek'), 900);
        }
      }

      function clearStack(){
        if(stack.length === 0){
          announce('Stack already empty.');
          return;
        }
        // fade-out effect: add anim-out to each filled slot, then clear
        const filledSlots = Array.from(stackEl.querySelectorAll('.slot.filled'));
        filledSlots.forEach((s,i)=>{
          s.style.transition = 'opacity 250ms ease, transform 250ms ease';
          s.style.opacity = '0';
          s.style.transform = 'translateY(8px)';
        });
        setTimeout(()=>{
          stack = [];
          lastPopped.textContent = '—';
          updateUI();
          announce('Stack cleared.');
        }, 260);
      }

      // Event bindings
      pushBtn.addEventListener('click', ()=>{
        pushValue(input.value.trim());
        input.focus();
      });
      popBtn.addEventListener('click', popValue);
      peekBtn.addEventListener('click', peek);
      clearBtn.addEventListener('click', clearStack);
      randomBtn.addEventListener('click', ()=>{
        // generate small random token
        const tokens = ['A','B','C','1','42','node','X','Y','Z','foo','bar','!','@'];
        const v = tokens[Math.floor(Math.random()*tokens.length)];
        input.value = v;
        pushValue(v);
        input.focus();
      });

      // Enter to push
      input.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){
          e.preventDefault();
          pushValue(input.value.trim());
        }
      });

      // Capacity adjust
      capacityEl.addEventListener('input', (e)=>{
        const newCap = parseInt(e.target.value,10);
        capacity = newCap;
        capacityLabel.textContent = capacity;
        announce('Capacity set to ' + capacity + '. Current size: ' + stack.length + '.');
        // update UI; do not forcibly drop items if stack larger than capacity; this is educational
        updateUI();
      });

      // Keyboard shortcuts (for power users)
      document.addEventListener('keydown', (e)=>{
        if(e.altKey && !e.shiftKey){
          if(e.key.toLowerCase() === 'p'){ // Alt+P push (uses input)
            e.preventDefault(); pushBtn.click();
          } else if(e.key.toLowerCase() === 'o'){ // Alt+O pop
            e.preventDefault(); popBtn.click();
          } else if(e.key.toLowerCase() === 'k'){ // Alt+K peek
            e.preventDefault(); peekBtn.click();
          }
        }
      });

      // Initial rendering: create empty slots (capacity)
      updateUI();
      // Initial announce for screen readers
      announce('Ready. Capacity ' + capacity + '. Stack empty.');
    })();
  </script>
</body>
</html>