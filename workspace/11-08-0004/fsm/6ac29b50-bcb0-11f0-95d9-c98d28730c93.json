{
  "topic": "Knapsack DP Explorer",
  "description": "Finite state machine modeling the interactive 0/1 knapsack dynamic programming explorer: item & capacity management, stepping / automatic playback of DP cell computations, completion and solution reconstruction with backpack animation.",
  "states": [
    {
      "name": "ready",
      "onEnter": "renderTable / update UI (rebuildDP side-effects)",
      "onExit": null,
      "on": {
        "STEP": "processing",
        "PLAY": "playing",
        "ADD_ITEM": "ready",
        "ADD_RANDOM": "ready",
        "PRESET_SELECTED": "ready",
        "CAPACITY_CHANGED": "ready",
        "ITEM_REMOVED": "ready",
        "CLEAR_ITEMS": "no_items",
        "RESET": "ready",
        "KEY_SPACE": "playing",
        "KEY_ARROW_RIGHT": "processing"
      }
    },
    {
      "name": "no_items",
      "onEnter": "rebuildDP (clears dp, render empty table, clear visuals, status='Add items to start.')",
      "onExit": null,
      "on": {
        "ADD_ITEM": "ready",
        "ADD_RANDOM": "ready",
        "PRESET_SELECTED": "ready",
        "CAPACITY_CHANGED": "no_items",
        "ITEM_REMOVED": "no_items",
        "PLAY": "no_items",
        "STEP": "no_items",
        "RESET": "no_items",
        "KEY_SPACE": "no_items",
        "KEY_ARROW_RIGHT": "no_items"
      }
    },
    {
      "name": "processing",
      "onEnter": "stepOnce (compute one dp[i][w] cell, updateCell, update calcText and step counters)",
      "onExit": null,
      "on": {
        "STEP_DONE": "ready",
        "DP_COMPLETE": "completed",
        "NO_ITEMS": "no_items"
      }
    },
    {
      "name": "playing",
      "onEnter": "startPlaying (start interval timer using speed value)",
      "onExit": "stopPlaying (clear interval timer)",
      "on": {
        "TICK": "processing",
        "PAUSE": "ready",
        "STOP": "ready",
        "SPEED_CHANGED": "playing",
        "DP_COMPLETE": "completed",
        "KEY_SPACE": "ready",
        "KEY_ARROW_RIGHT": "processing",
        "ITEM_REMOVED": "playing",
        "ADD_ITEM": "playing",
        "CLEAR_ITEMS": "no_items",
        "RESET": "ready",
        "CAPACITY_CHANGED": "ready",
        "PRESET_SELECTED": "ready"
      }
    },
    {
      "name": "completed",
      "onEnter": "finalize (set status 'Completed â€” reconstructing', set maxValue, reconstruct chosen items) + animateBackpack (create & animate bp-item elements)",
      "onExit": null,
      "on": {
        "RESET": "ready",
        "ADD_ITEM": "ready",
        "ADD_RANDOM": "ready",
        "CLEAR_ITEMS": "no_items",
        "CAPACITY_CHANGED": "ready",
        "PRESET_SELECTED": "ready",
        "KEY_SPACE": "playing"
      }
    }
  ],
  "events": [
    "INIT",
    "ADD_ITEM",
    "ADD_RANDOM",
    "CLEAR_ITEMS",
    "PRESET_SELECTED",
    "CAPACITY_CHANGED",
    "ITEM_REMOVED",
    "STEP",
    "STEP_DONE",
    "PLAY",
    "PAUSE",
    "STOP",
    "TICK",
    "DP_COMPLETE",
    "RESET",
    "SPEED_CHANGED",
    "KEY_SPACE",
    "KEY_ARROW_RIGHT",
    "NO_ITEMS"
  ],
  "notes": "State actions correspond to actual functions in the code: rebuildDP/renderTable (rebuilds dp, clears visuals), startPlaying/stopPlaying (manage timer), stepOnce (compute one cell and update UI), updateCell (animates cell), finalize (reconstruct chosen items and update result text), animateBackpack (places animated items). The code implements implicit internal outcomes from stepOnce (no items, single-step done, or DP complete) rather than explicit emitted events; the FSM models these outcomes as STEP_DONE, NO_ITEMS, or DP_COMPLETE. The playing state uses a repeating timer that issues TICK events; SPEED_CHANGED restarts the timer if playing. Animations (cell flash, backpack movement) do not provide completion callbacks in the code, so transitions after animateBackpack rely on user actions or DP completion (completed state remains until user modifies/reset). Keyboard shortcuts (space and ArrowRight) map to PLAY/PAUSE toggle and STEP respectively."
}