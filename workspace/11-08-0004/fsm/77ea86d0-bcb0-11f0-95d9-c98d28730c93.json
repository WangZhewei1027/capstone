{
  "topic": "BST Explorer Interactive UI",
  "description": "Finite state machine modeling the interactive states and transitions of the Binary Search Tree visualizer (insert/search/traversals/random/sample/clear/selection and animations).",
  "states": [
    {
      "name": "idle",
      "onEnter": "layoutAndRender; setStatus('Idle or ready')",
      "onExit": "clearHighlights",
      "on": {
        "INSERT_VALID": "inserting",
        "INSERT_INVALID": "idle",
        "SEARCH_VALID": "searching",
        "SEARCH_INVALID": "idle",
        "CLICK_RANDOM": "bulk_inserting",
        "SAMPLE_STARTED": "bulk_inserting",
        "CLICK_CLEAR": "idle",
        "CLICK_BALANCE": "idle",
        "ORDER_SELECTED": "traversal_playing",
        "CLICK_PLAY": "traversal_playing",
        "CLICK_STEP": "traversal_paused",
        "CLICK_STOP": "idle",
        "NODE_CLICK": "node_selected"
      }
    },
    {
      "name": "inserting",
      "onEnter": "disable(insertBtn); insertAnimated(value) (highlights path -> bstInsertSync -> layoutAndRender -> animateNodeAppear -> setStatus('Inserted: value'))",
      "onExit": "enable(insertBtn); clearHighlights",
      "on": {
        "INSERT_DONE": "idle",
        "ERROR_INPUT": "idle",
        "CLICK_STOP": "inserting"
      }
    },
    {
      "name": "searching",
      "onEnter": "disable(searchBtn); searchAnimated(value) (layoutAndRender -> highlight comparisons -> found/not-found -> setStatus)",
      "onExit": "enable(searchBtn); clearHighlights",
      "on": {
        "SEARCH_DONE": "idle",
        "SEARCH_FOUND": "idle",
        "SEARCH_NOT_FOUND": "idle",
        "CLICK_STOP": "searching"
      }
    },
    {
      "name": "bulk_inserting",
      "onEnter": "clear tree (root=null); clearHighlights; layoutAndRender; setStatus('Inserting sequence...'); sequentially call insertAnimated for each value (random or sample)",
      "onExit": "clearHighlights; setStatus('Insert sequence complete')",
      "on": {
        "BULK_INSERT_DONE": "idle",
        "CLICK_STOP": "idle"
      }
    },
    {
      "name": "traversal_playing",
      "onEnter": "stopTraversal(); traversalSequence = generateTraversal(currentOrder); traversalIndex=0; if empty -> setStatus('Tree empty'); else start travTimer (interval) to step through traversal; setStatus('X traversal: playing')",
      "onExit": "stopTraversal(); // clears interval timer; traversalIndex/traversalSequence reset by stopTraversal if appropriate",
      "on": {
        "TRAVERSAL_STEP": "traversal_playing",
        "TRAVERSAL_COMPLETE": "idle",
        "CLICK_STOP": "idle",
        "CLICK_STEP": "traversal_paused",
        "ORDER_SELECTED": "traversal_playing"
      }
    },
    {
      "name": "traversal_paused",
      "onEnter": "ensure traversalSequence exists (generateTraversal if needed); setStatus('Traversal ready/paused')",
      "onExit": "none",
      "on": {
        "CLICK_STEP": "traversal_paused",
        "CLICK_PLAY": "traversal_playing",
        "CLICK_STOP": "idle",
        "TRAVERSAL_COMPLETE": "idle"
      }
    },
    {
      "name": "node_selected",
      "onEnter": "pulseNode(nodeId); setStatus('Node X selected')",
      "onExit": "clearHighlights",
      "on": {
        "CLICK_OUTSIDE": "idle",
        "CLICK_STOP": "idle",
        "TIMEOUT": "idle",
        "NODE_ACTIVATE": "idle"
      }
    }
  ],
  "events": [
    "CLICK_INSERT",
    "INSERT_VALID",
    "INSERT_INVALID",
    "INSERT_DONE",
    "CLICK_SEARCH",
    "SEARCH_VALID",
    "SEARCH_INVALID",
    "SEARCH_DONE",
    "SEARCH_FOUND",
    "SEARCH_NOT_FOUND",
    "CLICK_RANDOM",
    "RANDOM_STARTED",
    "RANDOM_DONE",
    "CLICK_SAMPLE_SEQ",
    "SAMPLE_STARTED",
    "SAMPLE_DONE",
    "BULK_INSERT_DONE",
    "CLICK_CLEAR",
    "CLICK_BALANCE",
    "ORDER_SELECTED",
    "CLICK_PLAY",
    "CLICK_STEP",
    "CLICK_STOP",
    "TRAVERSAL_START",
    "TRAVERSAL_STEP",
    "TRAVERSAL_COMPLETE",
    "TRAVERSAL_STOPPED",
    "NODE_CLICK",
    "NODE_ACTIVATE",
    "CLICK_OUTSIDE",
    "TIMEOUT",
    "ERROR_INPUT",
    "LAYOUT_RENDERED",
    "HIGHLIGHT_TIMEOUT"
  ],
  "notes": "State names map to visual/interaction modes in the app. onEnter/onExit list the principal DOM actions or helper calls invoked (e.g., layoutAndRender, setStatus, highlightNode, animateNodeAppear, start/stop timers). Validation is represented by INSERT_VALID/INSERT_INVALID and SEARCH_VALID/SEARCH_INVALID: the UI parses user input and emits the appropriate event; INSERT_DONE/SEARCH_DONE/BULK_INSERT_DONE/TRAVERSAL_COMPLETE are emitted when the asynchronous animations/loops finish. 'traversal_paused' represents the state where traversal is configured but not playing; CLICK_STEP triggers a single-step traversal action. 'node_selected' is transient when a node is clicked (pulse/selection highlight). The FSM abstracts concurrent details in the code (e.g., code disables individual buttons during animation); those behaviors are shown as onEnter/onExit actions (disable/enable) for the relevant states."
}