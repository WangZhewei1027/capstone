{
  "topic": "Selection Sort Interactive Module",
  "description": "Models the interactive states and transitions of a selection sort visualization web app (play/pause, step, compare/swap phases, editing/applying arrays, shuffle/reset, speed/size changes).",
  "states": [
    {
      "name": "idle",
      "onEnter": "updateStatusIdle (set status to 'Idle' and render)",
      "onExit": "none",
      "on": {
        "PLAY": "running",
        "STEP": "processing_manual",
        "SHUFFLE": "shuffling",
        "RESET": "resetting",
        "APPLY_ARRAY": "applying_array",
        "EDIT_START": "editing",
        "SIZE_APPLY": "sizing",
        "SPEED_CHANGE": "idle"
      }
    },
    {
      "name": "running",
      "onEnter": "startTimer/run (set running=true, set aria-pressed true, updateStatus Running)",
      "onExit": "stopTimer/stop (clear timer, set running=false, set aria-pressed false)",
      "on": {
        "PAUSE": "idle",
        "TIMER_TICK": "processing_auto",
        "SHUFFLE": "shuffling",
        "RESET": "resetting",
        "APPLY_ARRAY": "applying_array",
        "EDIT_START": "editing",
        "SPEED_CHANGE": "running",
        "FINISH": "finished"
      }
    },
    {
      "name": "processing_manual",
      "onEnter": "performStep (execute step() for manual step, set phase 'compare' or 'swap' as appropriate, render)",
      "onExit": "none",
      "on": {
        "STEP_DONE_CONTINUE": "idle",
        "STEP_DONE_FINISHED": "finished"
      }
    },
    {
      "name": "processing_auto",
      "onEnter": "performStep (execute step() triggered by timer; step may set phase 'compare'/'swap', modify indices/arr, render)",
      "onExit": "none",
      "on": {
        "STEP_DONE_RUNNING": "running",
        "STEP_DONE_FINISHED": "finished"
      }
    },
    {
      "name": "comparing",
      "onEnter": "performCompareVisual (phase='compare', comparisons++, render highlight of j and minIndex)",
      "onExit": "none",
      "on": {
        "COMPARE_RESULT_MIN_CHANGED": "comparing",
        "COMPARE_RESULT_NO_CHANGE": "comparing",
        "COMPARE_DONE": "processing"
      }
    },
    {
      "name": "swapping",
      "onEnter": "performSwapVisual (phase='swap', swap arr[i] and arr[minIndex] if needed, render)",
      "onExit": "none",
      "on": {
        "SWAP_DONE": "processing"
      }
    },
    {
      "name": "finished",
      "onEnter": "finishAlgorithm (set finished=true, phase='finished', updateStatus Finished â€” sorted, stopTimer, render finished classes)",
      "onExit": "none",
      "on": {
        "RESET": "resetting",
        "SHUFFLE": "shuffling",
        "APPLY_ARRAY": "applying_array",
        "EDIT_START": "editing",
        "SIZE_APPLY": "sizing"
      }
    },
    {
      "name": "editing",
      "onEnter": "promptEdit (open prompt to edit a bar's value, block until confirm/cancel)",
      "onExit": "applyOrCancelEdit (on confirm clamp and set value, treat as new initial and reset algorithm; on cancel do nothing)",
      "on": {
        "EDIT_CONFIRM": "idle",
        "EDIT_CANCEL": "idle"
      }
    },
    {
      "name": "shuffling",
      "onEnter": "shuffleArray (randomize arr, set initial copy, resetAlgorithmState, render)",
      "onExit": "none",
      "on": {
        "SHUFFLE_COMPLETE": "idle"
      }
    },
    {
      "name": "resetting",
      "onEnter": "resetToInitial (restore arr = initial, resetAlgorithmState, render)",
      "onExit": "none",
      "on": {
        "RESET_COMPLETE": "idle"
      }
    },
    {
      "name": "applying_array",
      "onEnter": "applyCustomArray (parse input, clamp values, set arr and n, set initial, resetAlgorithmState, render)",
      "onExit": "none",
      "on": {
        "APPLY_COMPLETE": "idle",
        "APPLY_INVALID": "idle"
      }
    },
    {
      "name": "sizing",
      "onEnter": "changeSize (initArray with given size -> set arr to new random array, resetAlgorithmState, render)",
      "onExit": "none",
      "on": {
        "SIZE_COMPLETE": "idle"
      }
    }
  ],
  "events": [
    "PLAY",
    "PAUSE",
    "STEP",
    "TIMER_TICK",
    "STEP_DONE_CONTINUE",
    "STEP_DONE_RUNNING",
    "STEP_DONE_FINISHED",
    "FINISH",
    "SHUFFLE",
    "SHUFFLE_COMPLETE",
    "RESET",
    "RESET_COMPLETE",
    "APPLY_ARRAY",
    "APPLY_COMPLETE",
    "APPLY_INVALID",
    "EDIT_START",
    "EDIT_CONFIRM",
    "EDIT_CANCEL",
    "SIZE_APPLY",
    "SIZE_COMPLETE",
    "SPEED_CHANGE",
    "TIMER_START",
    "TIMER_STOP",
    "COMPARE_DONE",
    "SWAP_DONE"
  ],
  "notes": "This FSM captures UI-level states and the atomic 'step' processing used by both manual stepping and automatic play. The implementation uses synchronous rendering for compare/swap phases inside performStep; here those are modeled as transient 'comparing'/'swapping' conceptual phases. 'processing_manual' and 'processing_auto' represent a single step invocation originated by a manual step or the run timer. Events like STEP_DONE_RUNNING / STEP_DONE_FINISHED are internal outcomes emitted after a step: transition back to running if auto mode and not finished, back to idle if manual, or to finished when the algorithm completes. Editing uses a blocking prompt in the real code; the FSM models that as an 'editing' state with confirm/cancel transitions. Speed changes cause a restart of the timer when running (modeled via SPEED_CHANGE event handled in 'running'). Size/Shuffle/Reset/Apply are modeled as transient states that perform their action and then return to 'idle'. Keyboard shortcuts in the app map to PLAY/PAUSE, STEP and SHUFFLE events and are not separate states."
}