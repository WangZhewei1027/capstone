{
  "topic": "Radix Sort Interactive Module",
  "description": "Models the interactive states and transitions of the LSD Radix Sort visualizer UI: loading arrays, playback (auto/step), animation phases (distribute / collect), pausing/stopping, resets and completion.",
  "states": [
    {
      "name": "empty",
      "onEnter": "none",
      "on": {
        "LOAD": "ready",
        "RANDOMIZE": "ready"
      }
    },
    {
      "name": "ready",
      "onEnter": "renderInitialArray / setStatus('Loaded')",
      "onExit": "none",
      "on": {
        "PLAY": "playing",
        "STEP": "distributing",
        "RESET": "ready",
        "LOAD": "ready",
        "RANDOMIZE": "ready",
        "BASE_CHANGE": "ready",
        "SPEED_CHANGE": "ready",
        "INPUT_ENTER": "ready"
      }
    },
    {
      "name": "playing",
      "onEnter": "playAll (sets playing=true, stopRequested=false, playBtn text -> 'Pause')",
      "onExit": "playing=false (clear play UI state)",
      "on": {
        "PAUSE": "paused",
        "STOP_REQUEST": "paused",
        "PASS_START": "distributing",
        "PASS_COMPLETE": "playing",
        "ALL_PASSES_COMPLETE": "completed",
        "ERROR_INVALID_INPUT": "error"
      }
    },
    {
      "name": "paused",
      "onEnter": "setStatus('Paused') / stopRequested=true / playBtn text -> 'Play'",
      "onExit": "stopRequested=false",
      "on": {
        "PLAY": "playing",
        "STEP": "distributing",
        "RESET": "ready",
        "LOAD": "ready",
        "RANDOMIZE": "ready"
      }
    },
    {
      "name": "distributing",
      "onEnter": "performPass -> set currentPhase='distribute' / setStatus('Distributing by digit X') / updateBucketStacksDOM / animateToBucket(...) for each item",
      "onExit": "none",
      "on": {
        "DISTRIBUTE_END": "collecting",
        "STOP_REQUEST": "paused",
        "ERROR_INVALID_INPUT": "error",
        "WINDOW_RESIZE": "distributing"
      }
    },
    {
      "name": "collecting",
      "onEnter": "set currentPhase='collect' / setStatus('Collecting buckets') / animateToArrayPosition(...) for each item in bucket order / update items order and DOM (placeItemsAtSlots, updateBucketStacksDOM([]))",
      "onExit": "currentPhase='idle'",
      "on": {
        "COLLECT_END": "ready",
        "PASS_COMPLETE": "playing",
        "STOP_REQUEST": "paused",
        "ERROR_INVALID_INPUT": "error"
      }
    },
    {
      "name": "completed",
      "onEnter": "setStatus('All passes complete' or 'Array sorted early') / explainLine update",
      "onExit": "none",
      "on": {
        "RESET": "ready",
        "LOAD": "ready",
        "RANDOMIZE": "ready"
      }
    },
    {
      "name": "error",
      "onEnter": "setStatus('Error') / alert('Invalid input')",
      "onExit": "none",
      "on": {
        "RESET": "ready",
        "LOAD": "ready"
      }
    }
  ],
  "events": [
    "LOAD",
    "RANDOMIZE",
    "PLAY",
    "PAUSE",
    "STEP",
    "RESET",
    "SPEED_CHANGE",
    "BASE_CHANGE",
    "INPUT_ENTER",
    "PASS_START",
    "DISTRIBUTE_END",
    "COLLECT_END",
    "PASS_COMPLETE",
    "ALL_PASSES_COMPLETE",
    "STOP_REQUEST",
    "ERROR_INVALID_INPUT",
    "WINDOW_RESIZE"
  ],
  "notes": "Mapping notes / implementation details:\n- Actions referenced in onEnter/onExit correspond to functions in the source: loadFromInput, renderInitialArray, playAll, performPass, animateToBucket, animateToArrayPosition, placeItemsAtSlots, updateBucketStacksDOM, setStatus, computeMaxDigits, reset, randomize.\n- The algorithm's pass is implemented in performPass(passIndex) which internally sets currentPhase to 'distribute' then 'collect' and triggers the animations. In this FSM those two detailed phases are modeled as 'distributing' and 'collecting'.\n- The UI has two playback modes: auto (PLAY -> playing -> playAll loops over passes) and step (STEP -> performing a single pass). In the FSM 'playing' drives repeated PASS_START -> distributing -> collecting -> PASS_COMPLETE transitions; after PASS_COMPLETE playing either issues another PASS_START (continue) or emits ALL_PASSES_COMPLETE when done.\n- STOP_REQUEST / PAUSE interrupts an in-progress animation: performPass checks stopRequested and throws; the code catches and returns control. In this FSM STOP_REQUEST transitions to 'paused'.\n- collecting -> COLLECT_END maps to 'ready' to represent the pass finished in manual/step mode. When in auto mode the controller issues PASS_COMPLETE which results in the 'playing' state continuing to the next pass (represented by PLAY / PASS_START flow). This conditional decision (continue vs finish) is controlled by the playAll/stepOnce logic in code.\n- WINDOW_RESIZE or speed changes adjust positions/durations (placeItemsAtSlots and updating CSS transitions) but keep the logical state; they appear as events that do not change core workflow.\n- Invalid input (parseArrayInput returns null / empty) leads to 'error' state (UI alert) which can be recovered by LOAD or RESET.\n- The initial app initialization calls loadFromInput and will transition the implicit starting state to 'ready' if a valid array exists."
}