{
  "topic": "Radix Sort Interactive Visualizer (LSD)",
  "description": "Finite state machine modeling the interactive behaviors of the Radix Sort LSD visualizer: loading/clearing data, stepping a single digit pass (animated bucket distribution and collection), playing (auto-running passes), resetting, and completion.",
  "states": [
    {
      "name": "empty",
      "onEnter": "clearModel",
      "onExit": "none",
      "on": {
        "LOAD": "ready",
        "RANDOM": "ready",
        "CLEAR": "empty",
        "STEP": "empty",
        "PLAY_TOGGLE": "empty",
        "RESET": "empty",
        "INPUT_ENTER": "ready"
      }
    },
    {
      "name": "ready",
      "onEnter": "renderModelAndBadges",
      "onExit": "none",
      "on": {
        "STEP": "animating",
        "PLAY_TOGGLE": "playing",
        "LOAD": "ready",
        "RANDOM": "ready",
        "CLEAR": "empty",
        "RESET": "ready",
        "SPEED_CHANGE": "ready",
        "MAXDIGITS_CHANGE": "ready",
        "INPUT_ENTER": "ready",
        "INVALID_INPUT": "ready"
      }
    },
    {
      "name": "animating",
      "onEnter": "startPassAnimation",
      "onExit": "finishPassAnimation",
      "on": {
        "ANIMATION_END": "afterPassDecision",
        "PASS_COMPLETE": "afterPassDecision",
        "PLAY_TOGGLE": "animating",
        "CLEAR": "animating",
        "LOAD": "animating",
        "RESET": "animating"
      }
    },
    {
      "name": "playing",
      "onEnter": "enterPlayMode",
      "onExit": "exitPlayMode",
      "on": {
        "ANIMATION_START": "animating",
        "PLAY_TOGGLE": "ready",
        "PASS_COMPLETE": "playing",
        "ALL_PASSES_COMPLETE": "done",
        "CLEAR": "playing",
        "LOAD": "playing",
        "RESET": "playing"
      }
    },
    {
      "name": "done",
      "onEnter": "showCompletionMessage",
      "onExit": "none",
      "on": {
        "RESET": "ready",
        "LOAD": "ready",
        "RANDOM": "ready",
        "CLEAR": "empty",
        "PLAY_TOGGLE": "done",
        "STEP": "done"
      }
    },
    {
      "name": "afterPassDecision",
      "onEnter": "decideAfterPass",
      "onExit": "none",
      "on": {
        "TO_READY": "ready",
        "TO_PLAYING": "playing",
        "TO_DONE": "done"
      }
    }
  ],
  "events": [
    "LOAD",
    "RANDOM",
    "CLEAR",
    "RESET",
    "STEP",
    "PLAY_TOGGLE",
    "ANIMATION_START",
    "ANIMATION_END",
    "PASS_COMPLETE",
    "ALL_PASSES_COMPLETE",
    "SPEED_CHANGE",
    "MAXDIGITS_CHANGE",
    "INPUT_ENTER",
    "INVALID_INPUT",
    "TO_READY",
    "TO_PLAYING",
    "TO_DONE"
  ],
  "notes": "State semantics and actions:\n- empty: no items loaded. onEnter clearModel clears initialArray, items, badges and creates empty buckets.\n- ready: items present, not currently animating or auto-running. onEnter renderModelAndBadges sets up buckets, pads digits, renders arrayRow and updates badges (items, maxDigits, next digit). The UI controls are enabled in this state.\n- animating: performPass is running for the current digit (passIndex). onEnter startPassAnimation disables controls (toggleControls(true)), clears bucket holders, moves slots from arrayRow to buckets sequentially (FLIP animation) and then collects buckets back to arrayRow, updates items and increments currentPass. onExit finishPassAnimation re-enables controls (toggleControls(false)) and calls renderModelAndBadges. During animating, control events from UI are disabled/ignored by the UI.\n- playing: auto-run mode. onEnter enterPlayMode sets running=true, updates the Play button aria-pressed/text. The implementation loops: while running and currentPass < maxDigits -> ANIMATION_START then await pass. After each pass, if still running it waits a short delay and starts next pass. PLAY_TOGGLE transitions to ready (pause). If passes complete, transition to done.\n- done: currentPass >= maxDigits. onEnter showCompletionMessage triggers the visible alert/notification that all passes are complete; Play is presented as inactive. Reset or Load returns to ready; Clear goes to empty.\n- afterPassDecision: internal helper pseudo-state used to choose next state after an animation ends: if currentPass >= maxDigits -> TO_DONE; else if running === true -> TO_PLAYING; else -> TO_READY.\n\nImplementation details captured:\n- Controls are disabled during animations (disabledDuringAnimation / toggleControls(true)), preventing new user actions mid-animation.\n- Play toggles running state and its button aria-pressed/text; playing triggers repeated animating passes until paused or all passes complete.\n- Step triggers a single pass (animating) when ready; if already at max passes an alert is shown (modeled as INVALID_INPUT/TO_DONE behavior).\n- Random fills input and programmatically triggers LOAD.\n- Speed and max digits changes update configuration but do not alter the high-level state.\n- Animations use a FLIP technique; onEnter/startPassAnimation and onExit/finishPassAnimation correspond to the blocking animation sequence and the subsequent model update (items array, currentPass) respectively.\n- The FSM abstracts some implementation details: 'afterPassDecision' is a small routing state used to choose whether to return to ready, continue playing, or enter done after PASS_COMPLETE/ANIMATION_END."
}