{
  "topic": "Longest Common Subsequence (LCS) Interactive Module",
  "description": "Models the interactive states and transitions of the LCS visualization app: loading strings, building the matrix UI, preparing DP data, stepping/playing the DP fill animation, instant computation, backtracking (trace) animation, and UI interactions like cell clicks, examples, randomization and resets.",
  "states": [
    {
      "name": "idle",
      "onEnter": "init -> loadStrings (called on page init)",
      "on": {
        "LOAD_STRINGS": "matrix_built"
      }
    },
    {
      "name": "matrix_built",
      "onEnter": "buildEmptyMatrix (render blank grid UI for current A/B)",
      "onExit": "clearPathHighlights (clear any visual path/seq highlights)",
      "on": {
        "PREPARE_DP": "dp_prepared",
        "COMPUTE_CLICK": "filled",
        "ANIMATE_CLICK": "animating",
        "RESET_CLICK": "matrix_built",
        "RANDOM_CLICK": "matrix_built",
        "EXAMPLE_SELECT": "matrix_built",
        "NEXT_CLICK": "dp_prepared",
        "PREV_CLICK": "dp_prepared",
        "PLAY_CLICK": "animating",
        "TRACE_CLICK": "tracing",
        "CELL_CLICK": "matrix_built",
        "SPEED_CHANGE": "matrix_built"
      }
    },
    {
      "name": "dp_prepared",
      "onEnter": "prepareDP (populate dp, parent arrays and steps but do not render all values)",
      "onExit": "none",
      "on": {
        "NEXT_CLICK": "dp_prepared",
        "PREV_CLICK": "dp_prepared",
        "PLAY_CLICK": "animating",
        "ANIMATE_CLICK": "animating",
        "COMPUTE_CLICK": "filled",
        "TRACE_CLICK": "tracing",
        "CELL_CLICK": "dp_prepared",
        "SPEED_CHANGE": "dp_prepared",
        "RESET_CLICK": "matrix_built"
      }
    },
    {
      "name": "animating",
      "onEnter": "animateStart (clear matrix values, set stepIndex=-1, start play loop via play())",
      "onExit": "animateStop (clear playTimer, set isPlaying=false, update play button UI)",
      "on": {
        "ANIMATION_STEP_COMPLETE": "animating",
        "ANIMATION_COMPLETE": "filled",
        "PLAY_CLICK": "paused",
        "NEXT_CLICK": "dp_prepared",
        "PREV_CLICK": "dp_prepared",
        "TRACE_CLICK": "tracing",
        "CELL_CLICK": "animating",
        "RESET_CLICK": "matrix_built",
        "SPEED_CHANGE": "animating"
      }
    },
    {
      "name": "paused",
      "onEnter": "animateStop (pause playing, keep current stepIndex)",
      "onExit": "none",
      "on": {
        "PLAY_CLICK": "animating",
        "NEXT_CLICK": "dp_prepared",
        "PREV_CLICK": "dp_prepared",
        "TRACE_CLICK": "tracing",
        "CELL_CLICK": "paused",
        "RESET_CLICK": "matrix_built",
        "SPEED_CHANGE": "paused"
      }
    },
    {
      "name": "filled",
      "onEnter": "computeInstant (prepareDP if needed, render all dp cell values and arrows, update filledCount and lcsText)",
      "onExit": "none",
      "on": {
        "TRACE_CLICK": "tracing",
        "PLAY_CLICK": "animating",
        "NEXT_CLICK": "dp_prepared",
        "PREV_CLICK": "dp_prepared",
        "CELL_CLICK": "filled",
        "RESET_CLICK": "matrix_built",
        "SPEED_CHANGE": "filled"
      }
    },
    {
      "name": "tracing",
      "onEnter": "traceBackAnimate (ensure parent/dp present, computeInstant if needed, then animate backtracking path, highlight header chars)",
      "onExit": "clearPathHighlights (remove path and seq-high highlights)",
      "on": {
        "TRACE_STEP": "tracing",
        "TRACE_COMPLETE": "traced",
        "RESET_CLICK": "matrix_built",
        "CELL_CLICK": "tracing",
        "SPEED_CHANGE": "tracing"
      }
    },
    {
      "name": "traced",
      "onEnter": "onTraceComplete -> setStatus('Backtracking complete'), lcsText updated (backtrackString)",
      "onExit": "clearPathHighlights",
      "on": {
        "PLAY_CLICK": "animating",
        "TRACE_CLICK": "tracing",
        "RESET_CLICK": "matrix_built",
        "CELL_CLICK": "traced",
        "SPEED_CHANGE": "traced"
      }
    }
  ],
  "events": [
    "LOAD_STRINGS",
    "PREPARE_DP",
    "COMPUTE_CLICK",
    "ANIMATE_CLICK",
    "RESET_CLICK",
    "RANDOM_CLICK",
    "EXAMPLE_SELECT",
    "NEXT_CLICK",
    "PREV_CLICK",
    "PLAY_CLICK",
    "TRACE_CLICK",
    "CELL_CLICK",
    "SPEED_CHANGE",
    "ANIMATION_STEP_COMPLETE",
    "ANIMATION_COMPLETE",
    "TRACE_STEP",
    "TRACE_COMPLETE"
  ],
  "notes": "Key actions correspond to functions in the script: loadStrings / buildEmptyMatrix (render blank grid), prepareDP (populate dp, parent, steps), computeInstant (prepareDP + render all values and arrows and update lcsText), animateStart/play/animateStop (step-based animation loop controlled by speed slider and playTimer), stepForward/stepBackward (manual Next/Prev), traceBackAnimate (build path from parent[][] and animate highlighting), backtrackString (generate LCS string). Cell clicks do not change global state but produce transient highlights and status messages. PLAY_CLICK toggles between animating and paused. Next/Prev while animating will stop the animation and perform a single step. Example selection, randomize and reset load strings and rebuild the blank matrix. Speed slider changes govern animation delay and do not by themselves change the current logical state."
}