{
  "topic": "Deque — Interactive Module",
  "description": "Finite state machine modeling the interactive states and transitions of a double-ended queue UI: adding/removing/peeking at front/back, drag & drop chip creation/use, input interactions, and animation lifecycles.",
  "states": [
    {
      "name": "idle",
      "onEnter": "render (update UI, enable/disable buttons, update size/capacity/status)",
      "on": {
        "ADD_FRONT_CLICK": "adding_front",
        "ADD_BACK_CLICK": "adding_back",
        "REMOVE_FRONT_CLICK": "removing_front",
        "REMOVE_BACK_CLICK": "removing_back",
        "PEEK_FRONT_CLICK": "peeking_front",
        "PEEK_BACK_CLICK": "peeking_back",
        "CREATE_CHIP_CLICK": "chip_created",
        "INPUT_ENTER_KEY": "adding_back",
        "CHIP_DRAG_START": "dragging.idle",
        "CLEAR_CLICK": "idle",
        "FILL_DEMO_CLICK": "idle",
        "INPUT_CHANGE": "idle",
        "DRAG_ENTER_FRONT": "dragging.over_front",
        "DRAG_ENTER_BACK": "dragging.over_back",
        "INVALID_OP": "idle"
      }
    },
    {
      "name": "adding_front",
      "onEnter": "addFront(value) (deque.unshift, addLog, render, add .new class to new node)",
      "onExit": "",
      "on": {
        "ADD_ANIMATION_COMPLETE": "idle",
        "ANIMATION_NOT_AVAILABLE": "idle",
        "INVALID_ADD": "idle"
      }
    },
    {
      "name": "adding_back",
      "onEnter": "addBack(value) (deque.push, addLog, render, add .new class to new node)",
      "onExit": "",
      "on": {
        "ADD_ANIMATION_COMPLETE": "idle",
        "ANIMATION_NOT_AVAILABLE": "idle",
        "INVALID_ADD": "idle"
      }
    },
    {
      "name": "removing_front",
      "onEnter": "start removeFront animation (add .removing to front node). If animationend fires: shift deque, addLog, render; else fallback to immediate shift + render",
      "onExit": "",
      "on": {
        "REMOVE_ANIMATION_END": "idle",
        "ANIMATION_NOT_AVAILABLE": "idle",
        "INVALID_REMOVE": "idle"
      }
    },
    {
      "name": "removing_back",
      "onEnter": "start removeBack animation (add .removing to back node). If animationend fires: pop deque, addLog, render; else fallback to immediate pop + render",
      "onExit": "",
      "on": {
        "REMOVE_ANIMATION_END": "idle",
        "ANIMATION_NOT_AVAILABLE": "idle",
        "INVALID_REMOVE": "idle"
      }
    },
    {
      "name": "peeking_front",
      "onEnter": "peekFront() (addLog, visual highlight on front node, set timer to clear highlight)",
      "onExit": "clear peek highlight (if still present)",
      "on": {
        "PEEK_COMPLETE": "idle",
        "INVALID_PEEK": "idle"
      }
    },
    {
      "name": "peeking_back",
      "onEnter": "peekBack() (addLog, visual highlight on back node, set timer to clear highlight)",
      "onExit": "clear peek highlight (if still present)",
      "on": {
        "PEEK_COMPLETE": "idle",
        "INVALID_PEEK": "idle"
      }
    },
    {
      "name": "chip_created",
      "onEnter": "createChip() (create draggable node in chipArea, addLog, clear input, disable toPool)",
      "onExit": "",
      "on": {
        "CHIP_CLICK_REMOVE": "idle",
        "CHIP_DRAG_START": "dragging.idle",
        "INVALID_CHIP_CREATE": "idle"
      }
    },
    {
      "name": "dragging",
      "onEnter": "dragging initialization (UI cues: chip opacity, drop zones accept drag)",
      "onExit": "clear drag UI cues",
      "on": {
        "DRAG_ENTER_FRONT": "dragging.over_front",
        "DRAG_ENTER_BACK": "dragging.over_back",
        "DRAG_END": "idle",
        "DROP_FRONT": "adding_front",
        "DROP_BACK": "adding_back"
      }
    },
    {
      "name": "dragging.over_front",
      "onEnter": "highlight front drop zone (add .active)",
      "onExit": "un-highlight front drop zone (remove .active)",
      "on": {
        "DRAG_LEAVE_FRONT": "dragging",
        "DROP_FRONT": "adding_front",
        "DRAG_END": "idle"
      }
    },
    {
      "name": "dragging.over_back",
      "onEnter": "highlight back drop zone (add .active)",
      "onExit": "un-highlight back drop zone (remove .active)",
      "on": {
        "DRAG_LEAVE_BACK": "dragging",
        "DROP_BACK": "adding_back",
        "DRAG_END": "idle"
      }
    }
  ],
  "events": [
    "ADD_FRONT_CLICK",
    "ADD_BACK_CLICK",
    "REMOVE_FRONT_CLICK",
    "REMOVE_BACK_CLICK",
    "PEEK_FRONT_CLICK",
    "PEEK_BACK_CLICK",
    "CREATE_CHIP_CLICK",
    "INPUT_ENTER_KEY",
    "INPUT_CHANGE",
    "CHIP_DRAG_START",
    "CHIP_DRAG_END",
    "DRAG_ENTER_FRONT",
    "DRAG_LEAVE_FRONT",
    "DROP_FRONT",
    "DRAG_ENTER_BACK",
    "DRAG_LEAVE_BACK",
    "DROP_BACK",
    "DRAG_END",
    "ADD_ANIMATION_COMPLETE",
    "REMOVE_ANIMATION_END",
    "PEEK_COMPLETE",
    "CLEAR_CLICK",
    "FILL_DEMO_CLICK",
    "CHIP_CLICK_REMOVE",
    "INVALID_OP",
    "INVALID_ADD",
    "INVALID_REMOVE",
    "ANIMATION_NOT_AVAILABLE",
    "INVALID_PEEK",
    "INVALID_CHIP_CREATE"
  ],
  "notes": "Guards and UI conditions: transitions to adding_xxx are guarded by capacity checks (no add if deque.length >= CAPACITY) and presence of a non-empty value; invalid attempts generate logs and stay in idle. Remove/peek transitions are guarded by non-empty deque (invalid attempts log a warning). Adding animations: code adds a .new class after a short timeout (no explicit animationend handler in code) — modeled as ADD_ANIMATION_COMPLETE after the animation period. Removing animations use animationend listeners that trigger deque mutation and a transition (REMOVE_ANIMATION_END). Drag & drop: DRAG_ENTER/LEAVE and DROP events map to highlighting states; keyboard focus on drop zones also toggles active class (modeled via DRAG_ENTER_/LEAVE events). Input changes update toPool button enabled state (modeled as INPUT_CHANGE). CLEAR_CLICK runs clearDeque() and remains/returns to idle. FILL_DEMO_CLICK runs fillDemoValues() and returns to idle. All onEnter/onExit actions reference functions and behaviors implemented in the script (render, addFront, addBack, removeFront, removeBack, peekFront, peekBack, createChip, clearDeque, fillDemoValues)."
}