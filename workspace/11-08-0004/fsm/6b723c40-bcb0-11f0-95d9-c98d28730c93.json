{
  "topic": "Binary Search Interactive Module",
  "description": "Models the interactive states of the Binary Search teaching module: array configuration, stepping comparisons, autoplay, and completion (found / not found). Captures user-driven events (clicks, keyboard), animation/visualization actions, and data-loading/configuration transitions.",
  "states": [
    {
      "name": "configuring",
      "onEnter": "buildFromControls -> initializeSearch (generate/sort array, set initial left/right/mid, reset stats, render)",
      "onExit": "renderArray",
      "on": {
        "BUILD_COMPLETE": "ready"
      }
    },
    {
      "name": "ready",
      "onEnter": "enterReadyState -> initializeSearch if new build or reset; highlightLine(0); setStatus('Ready. Press Step or Play to begin.'); renderArray",
      "onExit": "clearTransientHighlights",
      "on": {
        "STEP_CLICK": "comparing",
        "STEP_NO_TARGET": "awaiting_target",
        "PLAY_TOGGLE": "playing",
        "RESET_CLICK": "ready",
        "NEW_CLICK": "configuring",
        "UNIQUE_CLICK": "configuring",
        "SIZE_CHANGE": "configuring",
        "CUSTOM_ARRAY_CHANGE": "configuring",
        "TARGET_SET": "ready",
        "SPEED_CHANGE": "ready",
        "PREF_LEFT_TOGGLE": "ready",
        "AUTO_SCROLL_TOGGLE": "ready",
        "KEY_SPACE": "comparing",
        "KEY_P": "playing",
        "KEY_R": "ready"
      }
    },
    {
      "name": "awaiting_target",
      "onEnter": "setStatus('Set a numeric target first (click a cell or type and Enter).')",
      "onExit": "clearStatusIfNeeded",
      "on": {
        "TARGET_SET": "ready",
        "RESET_CLICK": "ready",
        "NEW_CLICK": "configuring",
        "UNIQUE_CLICK": "configuring"
      }
    },
    {
      "name": "comparing",
      "onEnter": "computeMidAndCompare -> highlight pseudocode lines (3,4,5); mid = floor((left+right)/2); comparisons++; iterations++; renderArray; setStatus('Comparing A[mid] to target...')",
      "onExit": "renderArray; updateStats; clearTemporaryAnimations",
      "on": {
        "STEP_RESULT_FOUND": "found",
        "STEP_RESULT_NOTFOUND": "not_found",
        "STEP_RESULT_CONTINUE": "ready",
        "STEP_NO_TARGET": "awaiting_target"
      }
    },
    {
      "name": "playing",
      "onEnter": "startAutoplay -> playing=true; setStatus('Playing...'); start timer at configured speed (setInterval -> TIMER_TICK)",
      "onExit": "stopAutoplay -> clearInterval; playing=false; setStatus('Paused.' or appropriate final status)",
      "on": {
        "PLAY_TOGGLE": "ready",
        "TIMER_TICK": "comparing",
        "STEP_RESULT_FOUND": "found",
        "STEP_RESULT_NOTFOUND": "not_found",
        "RESET_CLICK": "ready",
        "NEW_CLICK": "configuring",
        "UNIQUE_CLICK": "configuring"
      }
    },
    {
      "name": "found",
      "onEnter": "flashFoundCell; highlightLine(5); setStatus('Found target at index mid after iterations.'); resultBox='Result: index mid'; stopAutoplay",
      "onExit": "clearFoundHighlight",
      "on": {
        "RESET_CLICK": "ready",
        "NEW_CLICK": "configuring",
        "UNIQUE_CLICK": "configuring",
        "TARGET_SET": "ready"
      }
    },
    {
      "name": "not_found",
      "onEnter": "highlightLine(8); setStatus('Target not found.'); resultBox='Result: not found (-1)'; stopAutoplay",
      "onExit": "clearStatusIfNeeded",
      "on": {
        "RESET_CLICK": "ready",
        "NEW_CLICK": "configuring",
        "UNIQUE_CLICK": "configuring",
        "TARGET_SET": "ready"
      }
    }
  ],
  "events": [
    "STEP_CLICK",
    "STEP_NO_TARGET",
    "TIMER_TICK",
    "PLAY_TOGGLE",
    "PLAY_CLICK",
    "RESET_CLICK",
    "NEW_CLICK",
    "UNIQUE_CLICK",
    "SIZE_CHANGE",
    "CUSTOM_ARRAY_CHANGE",
    "TARGET_SET",
    "SPEED_CHANGE",
    "PREF_LEFT_TOGGLE",
    "AUTO_SCROLL_TOGGLE",
    "STEP_RESULT_FOUND",
    "STEP_RESULT_NOTFOUND",
    "STEP_RESULT_CONTINUE",
    "BUILD_COMPLETE",
    "KEY_SPACE",
    "KEY_P",
    "KEY_R"
  ],
  "notes": "Guards & implementation details: - The STEP_CLICK event in the ready state is guarded: if target is not set, the module emits STEP_NO_TARGET and transitions to awaiting_target; otherwise it proceeds to comparing. - The comparing state performs computeMidAndCompare which internally decides one of three outcomes and emits STEP_RESULT_FOUND (mid equals target), STEP_RESULT_NOTFOUND (search interval empty after update), or STEP_RESULT_CONTINUE (adjust left/right and continue). - The playing state uses a timer (TIMER_TICK) that triggers repeated comparing steps; it will automatically stop (stopAutoplay) when a STEP_RESULT_FOUND or STEP_RESULT_NOTFOUND occurs. - Configuration events (NEW_CLICK, UNIQUE_CLICK, SIZE_CHANGE, CUSTOM_ARRAY_CHANGE) call buildFromControls which generates arr, sets initialArr and calls initializeSearch; modelled here as the configuring state. - Visual side-effects modelled as onEnter/onExit actions: renderArray, highlightLine(n), fadeEliminated(range), flashFoundCell, updateStats, setStatus(text), startAutoplay, stopAutoplay. - Keyboard shortcuts map to events: Space -> KEY_SPACE -> STEP_CLICK, P -> KEY_P -> PLAY_TOGGLE, R -> KEY_R -> RESET_CLICK. - Some UI controls (SPEED_CHANGE, PREF_LEFT_TOGGLE, AUTO_SCROLL_TOGGLE) change parameters only and do not change the main state (kept as self-transitions to the current state). - Terminal interaction states are 'found' and 'not_found' but user can reconfigure or reset to return to ready."
}