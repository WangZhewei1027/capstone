{
  "topic": "Divide and Conquer Interactive Module",
  "description": "Models the interactive states of a divide-and-conquer visualizer (split -> solve -> combine) including user interactions (select, split, combine), playback modes (auto, step), animations, and data loading/reset.",
  "states": [
    {
      "name": "idle",
      "onEnter": "renderAll",
      "onExit": "",
      "on": {
        "CLICK_BAR": "idle",
        "CLICK_NODE": "idle",
        "SELECT_NODE": "idle",
        "SPLIT": "splitting",
        "SOLVE": "solving",
        "COMBINE": "merging",
        "AUTO_START": "autoplay",
        "STEP_PREPARE": "stepReady",
        "APPLY_INPUT": "idle",
        "RANDOMIZE": "idle",
        "RESET": "idle",
        "SPEED_CHANGE": "idle"
      }
    },
    {
      "name": "splitting",
      "onEnter": "splitNode (creates children, renderTree, animateNodeCreation)",
      "onExit": "renderTree",
      "on": {
        "SPLIT_COMPLETE": "idle",
        "ABORT": "idle"
      }
    },
    {
      "name": "solving",
      "onEnter": "solveLeaf (set solvedArray, mark solved, renderTree)",
      "onExit": "renderTree",
      "on": {
        "SOLVE_COMPLETE": "idle",
        "ABORT": "idle"
      }
    },
    {
      "name": "merging",
      "onEnter": "combineNode (set animating=true, set node.merging=true, create clones, animate, on finish set solved, animating=false)",
      "onExit": "renderTree (and set animating=false if not already)",
      "on": {
        "COMBINE_COMPLETE": "idle",
        "COMBINE_COMPLETE_AUTOPLAY": "autoplay",
        "ABORT": "idle"
      }
    },
    {
      "name": "autoplay",
      "onEnter": "prepareAutoQueue; runAuto (sets autoMode=true and steps through split->solve->combine queue)",
      "onExit": "autoMode=false",
      "on": {
        "AUTO_FINISH": "idle",
        "ABORT_AUTOPLAY": "idle",
        "SPLIT": "splitting",
        "SOLVE": "solving",
        "COMBINE": "merging",
        "COMBINE_COMPLETE": "autoplay"
      }
    },
    {
      "name": "stepReady",
      "onEnter": "prepareStepQueue (prepare stepQueue using prepareAutoQueue)",
      "onExit": "",
      "on": {
        "STEP_EXECUTE": "stepping",
        "RESET": "idle",
        "ABORT": "idle"
      }
    },
    {
      "name": "stepping",
      "onEnter": "doStep (pop one command from stepQueue and execute: splitNode/solveLeaf/combineNode)",
      "onExit": "renderTree",
      "on": {
        "STEP_COMPLETE": "stepReady",
        "COMBINE": "merging",
        "ABORT": "idle"
      }
    },
    {
      "name": "done",
      "onEnter": "renderTree (rootNode.solved true, final visual state)",
      "onExit": "resetTree",
      "on": {
        "RESET": "idle",
        "APPLY_INPUT": "idle"
      }
    }
  ],
  "events": [
    "CLICK_BAR",
    "CLICK_NODE",
    "SELECT_NODE",
    "SPLIT",
    "SPLIT_COMPLETE",
    "SOLVE",
    "SOLVE_COMPLETE",
    "COMBINE",
    "COMBINE_COMPLETE",
    "COMBINE_COMPLETE_AUTOPLAY",
    "AUTO_START",
    "AUTO_FINISH",
    "ABORT_AUTOPLAY",
    "STEP_PREPARE",
    "STEP_EXECUTE",
    "STEP_COMPLETE",
    "APPLY_INPUT",
    "RANDOMIZE",
    "RESET",
    "SPEED_CHANGE",
    "ABORT"
  ],
  "notes": "Key implementation mappings: renderAll/renderTree correspond to UI re-renders; splitNode and animateNodeCreation create children and play brief creation animation (transient); solveLeaf marks a node solved and attaches solvedArray; combineNode sets animating=true and node.merging=true, spawns floating clones and after a duration merges children arrays, sets node.solved and animating=false. The 'animating' flag blocks user-initiated splits/combines while merging. Auto mode (runAuto) builds a full queue (split -> solve -> combine) and steps through it, delegating split/solve/combine operations which may transition into splitting/solving/merging states; step mode prepares a similar queue but executes a single queued command per STEP_EXECUTE. Input events (APPLY_INPUT, RANDOMIZE, RESET) rebuild the tree and return to idle. SPEED_CHANGE updates animation durations but does not change state. The 'done' state is reached when the root node is fully solved; AUTOPLAY can re-enter merging and then return to autoplay when combine finishes. Transitions are guarded in code by checks like canSplit(node) and canCombine(node) and by the animating flag."
}