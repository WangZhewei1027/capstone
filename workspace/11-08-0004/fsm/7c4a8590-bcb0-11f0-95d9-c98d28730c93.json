{
  "topic": "Depth-First Search Visualizer",
  "description": "Models the interactive UI states for a DFS graph-building and traversal visualizer: graph editing, node/edge creation, deletion/start selection modes, and traversal playback (step/play/reset).",
  "states": [
    {
      "name": "idle",
      "onEnter": "updateModeUI",
      "onExit": "",
      "on": {
        "CLICK_CANVAS_ADD_NODE": "idle",
        "NODE_MOUSEDOWN_DRAG_START": "dragging",
        "NODE_MOUSEDOWN_SHIFT_START_EDGE": "creating_edge",
        "TOGGLE_DELETE_MODE": "delete_mode",
        "TOGGLE_SET_START_MODE": "set_start_mode",
        "PLAY_CLICK": "playing",
        "STEP_CLICK": "paused",
        "RESET_CLICK": "idle",
        "CLEAR_CLICK": "idle",
        "TOGGLE_DIRECTED": "idle",
        "WINDOW_RESIZE": "idle"
      }
    },
    {
      "name": "dragging",
      "onEnter": "startDrag (attach mousemove/mouseup handlers)",
      "onExit": "endDrag (remove mousemove/mouseup handlers)",
      "on": {
        "NODE_MOUSEMOVE_DRAG": "dragging",
        "NODE_MOUSEUP_DRAG_END": "idle",
        "CANCEL_DRAG": "idle",
        "TOGGLE_DELETE_MODE": "delete_mode",
        "TOGGLE_SET_START_MODE": "set_start_mode",
        "CLEAR_CLICK": "idle"
      }
    },
    {
      "name": "creating_edge",
      "onEnter": "startEdgeCreation (creatingEdgeFrom=temp; create tempLine; add temp listeners)",
      "onExit": "cleanupTemp (remove tempLine; remove temp listeners)",
      "on": {
        "TEMP_MOUSE_MOVE": "creating_edge",
        "TEMP_MOUSE_UP_ON_NODE": "idle",
        "TEMP_MOUSE_UP_ON_EMPTY": "idle",
        "CANCEL_EDGE_CREATION": "idle",
        "CLEAR_CLICK": "idle"
      }
    },
    {
      "name": "delete_mode",
      "onEnter": "enterDeleteMode (deleteMode=true; update UI text)",
      "onExit": "leaveDeleteMode (deleteMode=false; update UI text)",
      "on": {
        "NODE_CLICK_DELETE": "delete_mode",
        "EDGE_CLICK_DELETE": "delete_mode",
        "TOGGLE_DELETE_MODE": "idle",
        "CLEAR_CLICK": "idle",
        "PLAY_CLICK": "playing",
        "RESET_CLICK": "idle"
      }
    },
    {
      "name": "set_start_mode",
      "onEnter": "enterSetStartMode (setStartMode=true; update UI)",
      "onExit": "leaveSetStartMode (setStartMode=false; update UI)",
      "on": {
        "NODE_CLICK_SET_START": "idle",
        "TOGGLE_SET_START_MODE": "idle",
        "CLEAR_CLICK": "idle",
        "PLAY_CLICK": "playing"
      }
    },
    {
      "name": "playing",
      "onEnter": "startPlayback (if actions empty -> generateActionsDFS & buildSnapshots; set playing=true; start interval playTimer)",
      "onExit": "pausePlayback (clearInterval(playTimer); playing=false; update Play button UI)",
      "on": {
        "PLAY_CLICK": "paused",
        "TIMER_TICK_STEP": "playing",
        "TIMER_REACHED_END": "done",
        "RESET_CLICK": "idle",
        "STEP_CLICK": "paused",
        "CLEAR_CLICK": "idle"
      }
    },
    {
      "name": "paused",
      "onEnter": "pausePlayback (clearInterval; ensure UI reflects paused)",
      "onExit": "",
      "on": {
        "PLAY_CLICK": "playing",
        "STEP_CLICK": "paused",
        "RESET_CLICK": "idle",
        "CLEAR_CLICK": "idle"
      }
    },
    {
      "name": "done",
      "onEnter": "onTraversalComplete (pausePlayback; show final state)",
      "onExit": "",
      "on": {
        "RESET_CLICK": "idle",
        "PLAY_CLICK": "playing",
        "STEP_CLICK": "paused",
        "CLEAR_CLICK": "idle"
      }
    }
  ],
  "events": [
    "CLICK_CANVAS_ADD_NODE",
    "NODE_MOUSEDOWN_DRAG_START",
    "NODE_MOUSEDOWN_SHIFT_START_EDGE",
    "NODE_MOUSEMOVE_DRAG",
    "NODE_MOUSEUP_DRAG_END",
    "TEMP_MOUSE_MOVE",
    "TEMP_MOUSE_UP_ON_NODE",
    "TEMP_MOUSE_UP_ON_EMPTY",
    "CANCEL_DRAG",
    "CANCEL_EDGE_CREATION",
    "NODE_CLICK_DELETE",
    "EDGE_CLICK_DELETE",
    "NODE_CLICK_SET_START",
    "TOGGLE_DELETE_MODE",
    "TOGGLE_SET_START_MODE",
    "TOGGLE_DIRECTED",
    "PLAY_CLICK",
    "PAUSE_CLICK",
    "STEP_CLICK",
    "RESET_CLICK",
    "CLEAR_CLICK",
    "TIMER_TICK_STEP",
    "TIMER_REACHED_END",
    "WINDOW_RESIZE"
  ],
  "notes": "This FSM models both modal toggles (Delete Mode, Set Start Mode) and transient interaction states (dragging a node, creating an edge). Playback is modeled with playing/paused/done states. onEnter/onExit annotations map to the actual functions/behaviors in the implementation: startDrag/endDrag attach/remove DOM listeners; startEdgeCreation/cleanupTemp manage temporary SVG elements and listeners; startPlayback/pausePlayback manage generation of actions, building snapshots, and the play timer. Step action generates actions & snapshots on first use if none exist, then advances one snapshot. Clear and Reset return to idle and clear traversal state. Some flags (deleteMode, setStartMode, directed) are represented here as states for clarity (they are implemented as boolean toggles in code)."
}