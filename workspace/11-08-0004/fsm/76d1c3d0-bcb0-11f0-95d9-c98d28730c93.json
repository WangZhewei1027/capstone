{
  "topic": "Adjacency Matrix Interactive Module",
  "description": "Models the interactive states and user-driven transitions of a small graph editor that updates an adjacency matrix in real time (add nodes, select nodes, toggle edges, drag nodes, toggle directed/undirected, random/clear/arrange actions and short visual animations).",
  "states": [
    {
      "name": "idle",
      "onEnter": "renderMatrix; announce('idle or ready state')",
      "onExit": "",
      "on": {
        "CLICK_SVG_ADD_NODE": "idle",
        "KEY_ENTER_SVG_ADD_NODE": "idle",
        "CLICK_NODE": "nodeSelected",
        "KEY_ENTER_NODE": "nodeSelected",
        "DRAG_START": "dragging",
        "CELL_CLICK": "animating",
        "KEY_ENTER_CELL": "animating",
        "TOGGLE_DIRECTED": "idle",
        "CLICK_CLEAR": "idle",
        "CLICK_RANDOM": "idle",
        "CLICK_ARRANGE": "idle",
        "RESIZE": "idle"
      }
    },
    {
      "name": "nodeSelected",
      "onEnter": "selectNode (add 'selected' class to node; announce selection)",
      "onExit": "deselectNode (remove 'selected' class)",
      "on": {
        "CLICK_NODE_SAME": "idle",
        "KEY_ENTER_NODE_SAME": "idle",
        "CLICK_NODE_DIFFERENT": "animating",
        "KEY_ENTER_NODE_DIFFERENT": "animating",
        "CLICK_SVG_ADD_NODE": "nodeSelected",
        "KEY_ENTER_SVG_ADD_NODE": "nodeSelected",
        "DRAG_START": "dragging",
        "CELL_CLICK": "animating",
        "KEY_ENTER_CELL": "animating",
        "TOGGLE_DIRECTED": "nodeSelected",
        "CLICK_CLEAR": "idle",
        "CLICK_RANDOM": "idle",
        "CLICK_ARRANGE": "nodeSelected",
        "RESIZE": "nodeSelected"
      }
    },
    {
      "name": "dragging",
      "onEnter": "startDrag (set dragging flag; pointer capture for node; announce maybe)",
      "onExit": "endDrag (release pointer capture; update visuals/edges)",
      "on": {
        "DRAG_MOVE": "dragging",
        "DRAG_END": "idle",
        "CLICK_CLEAR": "idle",
        "CLICK_RANDOM": "idle",
        "TOGGLE_DIRECTED": "dragging",
        "RESIZE": "dragging"
      }
    },
    {
      "name": "animating",
      "onEnter": "playEdgeHighlightAnimation (highlightEdgeVisual / addEdgeVisual / add/remove 'highlight' class / flash matrix cell; schedule removal)",
      "onExit": "cleanupAnimation (remove temporary paths / remove highlight classes)",
      "on": {
        "ANIMATION_END": "idle",
        "CLICK_CLEAR": "idle",
        "CLICK_RANDOM": "idle",
        "TOGGLE_DIRECTED": "idle",
        "RESIZE": "idle"
      }
    }
  ],
  "events": [
    "CLICK_SVG_ADD_NODE",
    "KEY_ENTER_SVG_ADD_NODE",
    "CLICK_NODE",
    "KEY_ENTER_NODE",
    "CLICK_NODE_SAME",
    "KEY_ENTER_NODE_SAME",
    "CLICK_NODE_DIFFERENT",
    "KEY_ENTER_NODE_DIFFERENT",
    "DRAG_START",
    "DRAG_MOVE",
    "DRAG_END",
    "CELL_CLICK",
    "KEY_ENTER_CELL",
    "TOGGLE_DIRECTED",
    "CLICK_CLEAR",
    "CLICK_RANDOM",
    "CLICK_ARRANGE",
    "RESIZE",
    "ANIMATION_END"
  ],
  "notes": "High-level mapping/assumptions: - 'idle' means no node is selected; 'nodeSelected' means exactly one node is currently selected awaiting a second node to toggle an edge. - Dragging is orthogonal in the implementation; here it is modeled as a separate state 'dragging' that is entered from idle or nodeSelected. After DRAG_END the FSM returns to idle (the implementation preserves selection if it existed; selection is not cleared by dragging). - Edge add/remove actions are immediate (update adj[][], add/remove SVG <path>) and trigger short visual animations; those are modeled via the transient 'animating' state. - Matrix updates (renderMatrix) are synchronous and happen on many transitions (node add, edge toggle, toggle directed, random/clear/arrange). - TOGGLE_DIRECTED changes whether toggles are symmetric (undirected) or directional (directed) and calls renderMatrix; it does not clear nodes/edges. - CLICK_RANDOM and CLICK_CLEAR are global actions that clear and/or repopulate state; they transition back to idle. - Maximum nodes constraint (MAX_NODES = 8) prevents CLICK_SVG_ADD_NODE from creating new nodes and results in an announce message; not modeled as a separate state. - Keyboard equivalents (Enter/Space) are mapped to the same high-level events (KEY_*)."
}