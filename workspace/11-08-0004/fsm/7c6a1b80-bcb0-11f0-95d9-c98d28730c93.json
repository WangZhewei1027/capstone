{
  "topic": "Kruskal's Algorithm Interactive Module",
  "description": "FSM modeling the interactive states and transitions of the Kruskal MST visualizer: editing/graph-building, connect mode & edge creation, node dragging, edge-sorting and step/auto execution of Kruskal (consider/accept/reject) and completion.",
  "states": [
    {
      "name": "unsorted",
      "onEnter": "resetAlgorithmState",
      "onExit": null,
      "on": {
        "CLICK_SORT": "sorted_ready",
        "CLICK_RANDOM": "idle",
        "CLICK_CLEAR": "unsorted",
        "CLICK_RESET_ALG": "unsorted",
        "CANVAS_CLICK": "unsorted",
        "NODE_POINTER_DOWN": "dragging",
        "TOGGLE_CONNECT": "connect_mode"
      }
    },
    {
      "name": "idle",
      "onEnter": "render",
      "onExit": null,
      "on": {
        "TOGGLE_CONNECT": "connect_mode",
        "CLICK_RANDOM": "idle",
        "CLICK_CLEAR": "unsorted",
        "CLICK_SORT": "sorted_ready",
        "CLICK_STEP": "considering",
        "CLICK_AUTO_RUN": "auto_running",
        "NODE_POINTER_DOWN": "dragging",
        "CANVAS_CLICK": "idle",
        "NODE_CLICK": "idle",
        "CLICK_RESET_ALG": "unsorted"
      }
    },
    {
      "name": "connect_mode",
      "onEnter": "enterConnectMode",
      "onExit": "leaveConnectMode",
      "on": {
        "TOGGLE_CONNECT": "idle",
        "NODE_CLICK": "connect_first_selected",
        "NODE_POINTER_DOWN": "dragging",
        "CANVAS_CLICK": "connect_mode",
        "CLICK_SORT": "sorted_ready",
        "CLICK_RESET_ALG": "unsorted"
      }
    },
    {
      "name": "connect_first_selected",
      "onEnter": "selectConnectFirst",
      "onExit": "clearConnectFirst",
      "on": {
        "NODE_CLICK_SAME": "connect_first_selected",
        "NODE_CLICK_OTHER": "connect_mode",
        "CANCEL_EDGE_CREATION": "connect_mode",
        "EDGE_CREATED": "connect_mode",
        "NODE_POINTER_DOWN": "dragging",
        "TOGGLE_CONNECT": "idle",
        "CLICK_RESET_ALG": "unsorted"
      }
    },
    {
      "name": "dragging",
      "onEnter": "startDrag",
      "onExit": "endDrag",
      "on": {
        "NODE_POINTER_MOVE": "dragging",
        "NODE_POINTER_UP": "idle",
        "TOGGLE_CONNECT": "connect_mode",
        "GRAPH_CHANGED": "unsorted"
      }
    },
    {
      "name": "sorted_ready",
      "onEnter": "sortEdges",
      "onExit": null,
      "on": {
        "CLICK_STEP": "considering",
        "CLICK_AUTO_RUN": "auto_running",
        "CLICK_SORT": "sorted_ready",
        "CLICK_RESET_ALG": "unsorted",
        "NODE_POINTER_DOWN": "dragging",
        "GRAPH_CHANGED": "unsorted",
        "TOGGLE_CONNECT": "connect_mode"
      }
    },
    {
      "name": "considering",
      "onEnter": "highlightEdge",
      "onExit": "clearConsiderHighlight",
      "on": {
        "EVALUATION_ACCEPT": "sorted_ready",
        "EVALUATION_REJECT": "sorted_ready",
        "MST_COMPLETE": "done",
        "ALL_EDGES_CONSIDERED": "done",
        "AUTO_TICK": "considering"
      }
    },
    {
      "name": "auto_running",
      "onEnter": "startAuto",
      "onExit": "stopAuto",
      "on": {
        "AUTO_TICK": "considering",
        "CLICK_PAUSE": "sorted_ready",
        "GRAPH_CHANGED": "unsorted",
        "MST_COMPLETE": "done",
        "ALL_EDGES_CONSIDERED": "done"
      }
    },
    {
      "name": "done",
      "onEnter": "showComplete",
      "onExit": null,
      "on": {
        "CLICK_RESET": "unsorted",
        "CLICK_RANDOM": "idle",
        "CLICK_CLEAR": "unsorted",
        "TOGGLE_CONNECT": "connect_mode",
        "GRAPH_CHANGED": "unsorted"
      }
    }
  ],
  "events": [
    "CLICK_RANDOM",
    "CLICK_CLEAR",
    "TOGGLE_CONNECT",
    "CLICK_SORT",
    "CLICK_RESET_ALG",
    "CLICK_STEP",
    "CLICK_AUTO_RUN",
    "CLICK_PAUSE",
    "CLICK_RESET",
    "CANVAS_CLICK",
    "NODE_POINTER_DOWN",
    "NODE_POINTER_MOVE",
    "NODE_POINTER_UP",
    "NODE_CLICK",
    "NODE_CLICK_SAME",
    "NODE_CLICK_OTHER",
    "EDGE_CREATED",
    "CANCEL_EDGE_CREATION",
    "GRAPH_CHANGED",
    "NODE_CLICK",
    "AUTO_TICK",
    "EVALUATION_ACCEPT",
    "EVALUATION_REJECT",
    "MST_COMPLETE",
    "ALL_EDGES_CONSIDERED"
  ],
  "notes": "High-level notes and important conditions:\n- States are simplified, not fully orthogonal. 'dragging' is entered from node pointerdown and on pointerup returns to the prior interaction mode (idle or connect_mode). Implementation uses isConnectMode boolean to decide whether to return to connect_mode after dragging; the FSM maps NODE_POINTER_UP to 'idle' and the app conditionally re-enters connect_mode when isConnectMode is true.\n- 'unsorted' represents algorithm-reset state (sortedEdges is empty). Clicking 'Sort Edges' moves to 'sorted_ready' after performing sortEdges (onEnter). Many actions (adding nodes/edges, random/clear) call resetAlgorithmState which returns the app to 'unsorted'. Event GRAPH_CHANGED is fired whenever the graph topology or weights change.\n- 'connect_mode' toggles with TOGGLE_CONNECT; selecting the first node moves to 'connect_first_selected'. Creating an edge (EDGE_CREATED) returns to connect_mode. Canceling weight prompt returns to connect_mode.\n- 'sorted_ready' indicates a sorted edge queue exists and pointer is at position pointer. CLICK_STEP performs one Kruskal step; if sortedEdges is missing, the real app shows a status message and remains in unsorted.\n- 'considering' models the transient state where a single edge is highlighted (considered). On evaluation the edge is either accepted (EVALUATION_ACCEPT) or rejected (EVALUATION_REJECT). After update, the FSM returns to 'sorted_ready' unless MST is completed or all edges were considered, in which case it transitions to 'done'.\n- 'auto_running' uses a timer that emits AUTO_TICK repeatedly and internally runs steps; CLICK_PAUSE or auto completion calls stopAuto which returns to 'sorted_ready' (or 'done' if complete). The UI disables/enables the Auto/Pause buttons per mode (onEnter/startAuto and onExit/stopAuto).\n- Action names in onEnter/onExit correspond to the module's functions or conceptual behaviors: resetAlgorithmState, render, enterConnectMode, leaveConnectMode, selectConnectFirst, clearConnectFirst, startDrag, endDrag, sortEdges, highlightEdge, clearConsiderHighlight, startAuto, stopAuto, showComplete, generateRandomGraph, clearGraph, addNode, addEdge. These actions update data structures (nodes, edges, sortedEdges, pointer, ufParent), update UI text (statusText), and trigger rendering updates.\n- The FSM intentionally separates user-editing modes (unsorted/idle/connect_mode/dragging) from algorithm execution modes (sorted_ready/considering/auto_running/done)."
}