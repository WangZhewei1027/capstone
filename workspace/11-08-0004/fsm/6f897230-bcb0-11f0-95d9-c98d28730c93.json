{
  "topic": "Interactive Application",
  "description": "Finite state machine for the Longest Common Subsequence interactive visualization. Models building the DP table, stepping/playing the fill animation, backtracking to extract the LCS, and resets / user interactions.",
  "states": [
    {
      "name": "idle",
      "onEnter": "resetState()",
      "on": {
        "PREPARE_CLICK": "ready",
        "RESET_CLICK": "idle"
      }
    },
    {
      "name": "ready",
      "onEnter": "buildGrid() / renderTable() (creates tableEl, initializes dp and steps, stepIndex = -1)",
      "onExit": "clearHighlights()",
      "on": {
        "PLAY_TOGGLE": "playing",
        "STEP_CLICK": "ready",
        "STEP_FORWARD": "ready",
        "STEP_BACKWARD": "ready",
        "BACKTRACK_CLICK": "backtracking",
        "RESET_CLICK": "idle",
        "CELL_CLICK": "ready"
      }
    },
    {
      "name": "playing",
      "onEnter": "togglePlay() -> set playing=true; start playLoop() (start timer via playTimer)",
      "onExit": "stopPlay() (clearTimeout(playTimer); set playing=false; update play button text)",
      "on": {
        "PLAY_TOGGLE": "paused",
        "PLAY_TIMER_TICK": "playing",
        "STEP_FORWARD": "playing",
        "FILL_COMPLETE": "filled",
        "BACKTRACK_CLICK": "playing",
        "RESET_CLICK": "idle",
        "CELL_CLICK": "playing"
      }
    },
    {
      "name": "paused",
      "onEnter": "togglePlay() -> set playing=false; clear playTimer; update UI to 'Play'",
      "onExit": "none",
      "on": {
        "PLAY_TOGGLE": "playing",
        "STEP_CLICK": "paused",
        "STEP_FORWARD": "paused",
        "STEP_BACKWARD": "paused",
        "BACKTRACK_CLICK": "backtracking",
        "RESET_CLICK": "idle",
        "CELL_CLICK": "paused"
      }
    },
    {
      "name": "filled",
      "onEnter": "on table fill completion: status update 'Finished filling table.' (stepIndex == steps.length - 1)",
      "onExit": "clearHighlights()",
      "on": {
        "BACKTRACK_CLICK": "backtracking",
        "PLAY_TOGGLE": "filled",
        "STEP_BACKWARD": "paused",
        "RESET_CLICK": "idle",
        "CELL_CLICK": "filled"
      }
    },
    {
      "name": "backtracking",
      "onEnter": "animateBacktrack() (set inBacktrack=true; compute and animate path; append chars to lcsBox)",
      "onExit": "inBacktrack=false; clearHighlights(); finalize LCS display (lcsBox.textContent)",
      "on": {
        "BACKTRACK_COMPLETE": "filled",
        "RESET_CLICK": "idle",
        "CELL_CLICK": "backtracking",
        "PLAY_TOGGLE": "backtracking"
      }
    }
  ],
  "events": [
    "PREPARE_CLICK",
    "PREPARE_SUCCESS",
    "PREPARE_FAIL",
    "PLAY_TOGGLE",
    "STEP_CLICK",
    "STEP_FORWARD",
    "STEP_BACKWARD",
    "PLAY_TIMER_TICK",
    "FILL_COMPLETE",
    "BACKTRACK_CLICK",
    "BACKTRACK_COMPLETE",
    "RESET_CLICK",
    "CELL_CLICK",
    "KEY_SPACE",
    "KEY_RIGHT",
    "KEY_LEFT",
    "ALERT_CONFIRM"
  ],
  "notes": "State variables used by the FSM: tableEl (presence indicates table built), steps (array of computation steps), stepIndex (current progress index, -1 initially), dp (matrix values), playing (boolean), playTimer (timeout id), inBacktrack (boolean). Transitions are guarded in code (for example: BACKTRACK_CLICK is ignored until fill is complete; PREPARE_CLICK validates non-empty inputs and may prompt a confirm for long strings). Actions referenced in onEnter/onExit map to the functions in the source: resetState(), buildGrid(), renderTable(), updateAllCellValues(), clearHighlights(), highlightCell()/fillStep(), togglePlay()/playLoop()/stopPlay(), animateBacktrack(). Keyboard shortcuts map to events: KEY_SPACE => PLAY_TOGGLE, KEY_RIGHT => STEP_FORWARD, KEY_LEFT => STEP_BACKWARD. Cell clicks show a transient floating annotation (CELL_CLICK) without changing FSM state. Alerts and user confirms (PREPARE_FAIL / ALERT_CONFIRM) are treated as events that either block transitions or allow continuation to READY."
}