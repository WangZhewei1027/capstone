{
  "topic": "Interactive Linear Regression Explorer",
  "description": "Models the interactive UI states for a scatterplot + linear model explorer: adding/moving/removing points, live slider updates, analytic fit animation, gradient-descent (step/continuous), and dataset reset/clear.",
  "states": [
    {
      "name": "idle",
      "onEnter": "renderAll",
      "onExit": null,
      "on": {
        "POINTER_DOWN_ON_POINT": "dragging",
        "SELECT_POINT": "point_selected",
        "CLICK_EMPTY": "idle",
        "ADD_POINT": "idle",
        "ADD_RANDOM_POINT": "idle",
        "SLIDER_CHANGE": "idle",
        "FIT_ANALYTIC": "animating_fit",
        "START_GD": "gd_running",
        "STEP_GD": "stepping_gd",
        "RESET": "resetting",
        "CLEAR": "clearing",
        "BEFORE_UNLOAD": "idle"
      }
    },
    {
      "name": "point_selected",
      "onEnter": "selectPoint",
      "onExit": "unselectPoint",
      "on": {
        "START_DRAG": "dragging",
        "DELETE_POINT": "idle",
        "UNSELECT_POINT": "idle",
        "FIT_ANALYTIC": "animating_fit",
        "START_GD": "gd_running",
        "RESET": "resetting",
        "CLEAR": "clearing",
        "SLIDER_CHANGE": "point_selected",
        "BEFORE_UNLOAD": "point_selected"
      }
    },
    {
      "name": "dragging",
      "onEnter": "startDrag",
      "onExit": "endDrag",
      "on": {
        "DRAG_MOVE": "dragging",
        "POINTER_UP": "idle",
        "POINTER_CANCEL": "idle",
        "DELETE_POINT": "idle",
        "RESET": "resetting",
        "CLEAR": "clearing",
        "BEFORE_UNLOAD": "idle"
      }
    },
    {
      "name": "animating_fit",
      "onEnter": "animateToAnalyticFit",
      "onExit": null,
      "on": {
        "FIT_ANIM_DONE": "idle",
        "RESET": "resetting",
        "CLEAR": "clearing",
        "BEFORE_UNLOAD": "idle",
        "START_GD": "gd_running"
      }
    },
    {
      "name": "gd_running",
      "onEnter": "startGD",
      "onExit": "stopGD",
      "on": {
        "STOP_GD": "idle",
        "GD_TOGGLE": "idle",
        "RESET": "resetting",
        "CLEAR": "clearing",
        "BEFORE_UNLOAD": "gd_running"
      }
    },
    {
      "name": "stepping_gd",
      "onEnter": "gdStepOnce",
      "onExit": null,
      "on": {
        "STEP_DONE": "idle",
        "RESET": "resetting",
        "CLEAR": "clearing",
        "BEFORE_UNLOAD": "idle"
      }
    },
    {
      "name": "resetting",
      "onEnter": "resetDataAndStopGD",
      "onExit": null,
      "on": {
        "RESET_DONE": "idle",
        "BEFORE_UNLOAD": "resetting"
      }
    },
    {
      "name": "clearing",
      "onEnter": "clearDataAndStopGD",
      "onExit": null,
      "on": {
        "CLEAR_DONE": "idle",
        "BEFORE_UNLOAD": "clearing"
      }
    }
  ],
  "events": [
    "POINTER_DOWN_ON_POINT",
    "DRAG_MOVE",
    "POINTER_UP",
    "POINTER_CANCEL",
    "CLICK_EMPTY",
    "ADD_POINT",
    "ADD_RANDOM_POINT",
    "SELECT_POINT",
    "UNSELECT_POINT",
    "DELETE_POINT",
    "SLIDER_CHANGE",
    "FIT_ANALYTIC",
    "FIT_ANIM_DONE",
    "START_GD",
    "STOP_GD",
    "GD_TOGGLE",
    "STEP_GD",
    "STEP_DONE",
    "RESET",
    "RESET_DONE",
    "CLEAR",
    "CLEAR_DONE",
    "BEFORE_UNLOAD"
  ],
  "notes": "High-level mapping of UI interactions to states and side-effect actions. Key behaviors implemented as actions: renderAll (rebuild SVG, metrics), startDrag/endDrag (pointer capture and dragged point updates), addPoint/addRandomPoint, selectPoint/unselectPoint, animateToAnalyticFit (async interpolation to analytic fit then emits FIT_ANIM_DONE), startGD/stopGD (manage interval and button UI), gdStepOnce (single gradient-descent parameter update), resetDataAndStopGD and clearDataAndStopGD (stop any running GD and reinitialize/clear points). Slider input updates model immediately (SLIDER_CHANGE triggers model update + render). The FSM treats animation and GD as exclusive runtime states; selection and dragging are modeled separately. Some events are implicit in the implementation (e.g., FIT_ANIM_DONE emitted by the animation promise, RESET_DONE/CLEAR_DONE/STEP_DONE emitted after their synchronous actions complete)."
}