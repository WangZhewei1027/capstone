{
  "topic": "Stack Visualizer â€” LIFO Interactive Module",
  "description": "Models the interactive states and transitions of a visual stack application: push, pop, peek, clear, capacity changes, animations (push/pop/peek), and overflow/underflow shake feedback.",
  "states": [
    {
      "name": "idle",
      "onEnter": "updateUI",
      "on": {
        "PUSH": "pushing",
        "RANDOM_PUSH": "pushing",
        "POP": "popping",
        "PEEK": "peeking",
        "CLEAR": "clearing",
        "CAPACITY_CHANGE": "capacity_adjusting",
        "KEYBOARD_SHORTCUT_PUSH": "pushing",
        "KEYBOARD_SHORTCUT_POP": "popping",
        "KEYBOARD_SHORTCUT_PEEK": "peeking"
      }
    },
    {
      "name": "pushing",
      "onEnter": "validateAndPush",
      "onExit": "cleanupPushAnim",
      "on": {
        "PUSH_INVALID_EMPTY": "idle",
        "PUSH_OVERFLOW": "shaking",
        "PUSH_ANIM_END": "idle"
      }
    },
    {
      "name": "popping",
      "onEnter": "attemptPop",
      "onExit": "cleanupPopAnim",
      "on": {
        "POP_UNDERFLOW": "shaking",
        "POP_ANIM_END": "idle"
      }
    },
    {
      "name": "peeking",
      "onEnter": "attemptPeek",
      "onExit": "cleanupPeekAnim",
      "on": {
        "PEEK_UNDERFLOW": "shaking",
        "PEEK_ANIM_END": "idle"
      }
    },
    {
      "name": "clearing",
      "onEnter": "clearStack",
      "onExit": "finalizeClear",
      "on": {
        "CLEAR_NOOP": "idle",
        "CLEAR_ANIM_END": "idle"
      }
    },
    {
      "name": "capacity_adjusting",
      "onEnter": "setCapacity",
      "on": {
        "CAPACITY_SET_DONE": "idle"
      }
    },
    {
      "name": "shaking",
      "onEnter": "applyShake",
      "onExit": "removeShake",
      "on": {
        "SHAKE_END": "idle"
      }
    }
  ],
  "events": [
    "PUSH",
    "RANDOM_PUSH",
    "PUSH_INVALID_EMPTY",
    "PUSH_OVERFLOW",
    "PUSH_ANIM_END",
    "POP",
    "POP_UNDERFLOW",
    "POP_ANIM_END",
    "PEEK",
    "PEEK_UNDERFLOW",
    "PEEK_ANIM_END",
    "CLEAR",
    "CLEAR_NOOP",
    "CLEAR_ANIM_END",
    "CAPACITY_CHANGE",
    "CAPACITY_SET_DONE",
    "SHAKE_END",
    "KEYBOARD_SHORTCUT_PUSH",
    "KEYBOARD_SHORTCUT_POP",
    "KEYBOARD_SHORTCUT_PEEK",
    "ENTER_PRESS"
  ],
  "notes": "High-level mapping of interactive behavior to FSM states. Implementation details in the page:\n- validateAndPush: checks emptiness (PUSH_INVALID_EMPTY) and capacity; on overflow emits PUSH_OVERFLOW -> shaking; on success updates data model, calls updateUI(), adds .anim-in class to top slot and schedules PUSH_ANIM_END after ~500ms, and announces the push.\n- attemptPop: if stack empty emits POP_UNDERFLOW -> shaking; otherwise pops data, updates lastPopped, adds .anim-out to top slot and schedules POP_ANIM_END after ~450ms, then updateUI() and announce.\n- attemptPeek: if empty emits PEEK_UNDERFLOW -> shaking; otherwise adds .peek class to top slot, announces and schedules PEEK_ANIM_END after ~900ms.\n- clearStack: if already empty emits CLEAR_NOOP; otherwise fades filled slots and after ~260ms clears array, updates lastPopped, updateUI(), announces and emits CLEAR_ANIM_END.\n- applyShake: adds .shake to stack frame and announces overflow/underflow; shake lasts ~600ms and then emits SHAKE_END.\n- setCapacity: updates capacity variable, updates capacity label and calls updateUI(); in the real code capacity change is instantaneous and then returns to idle (CAPACITY_SET_DONE).\n- Keyboard shortcuts map to the same events as the corresponding buttons. All animations are asynchronous; the FSM models these as transitions that wait for corresponding *_ANIM_END or SHAKE_END events before returning to idle.\n- The FSM intentionally keeps UI update actions as onEnter/onExit handlers (updateUI, announce, add/remove animation classes) rather than modeling DOM internals as states."
}