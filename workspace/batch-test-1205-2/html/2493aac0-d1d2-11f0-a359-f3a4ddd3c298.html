<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red-Black Tree Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background: #f4f4f4;
        }
        #tree {
            display: grid;
            margin: 20px auto;
            width: 80%;
            max-width: 800px;
        }
        .node {
            display: inline-block;
            margin: 5px;
            padding: 10px 15px;
            border-radius: 5px;
            position: relative;
            color: #fff;
            font-weight: bold;
            width: 50px;
            text-align: center;
        }
        .red {
            background-color: red;
        }
        .black {
            background-color: black;
        }
    </style>
</head>
<body>

<h1>Red-Black Tree Visualizer</h1>
<input id="valueInput" type="number" placeholder="Enter value" />
<button onclick="insertNode()">Insert</button>
<div id="tree"></div>

<script>
    class Node {
        constructor(data) {
            this.data = data;
            this.color = 'red'; // New nodes are always red
            this.left = null;
            this.right = null;
            this.parent = null;
        }
    }

    class RedBlackTree {
        constructor() {
            this.root = null;
        }

        insert(data) {
            const newNode = new Node(data);
            this.root = this._insertNode(this.root, newNode);
            this.fixViolation(newNode);
            this.renderTree();
        }

        _insertNode(root, newNode) {
            if (root === null) {
                return newNode;
            }

            if (newNode.data < root.data) {
                root.left = this._insertNode(root.left, newNode);
                root.left.parent = root;
            } else if (newNode.data > root.data) {
                root.right = this._insertNode(root.right, newNode);
                root.right.parent = root;
            }
            return root;
        }

        fixViolation(newNode) {
            while (newNode !== this.root && newNode.parent.color === 'red') {
                if (newNode.parent === newNode.parent.parent.left) {
                    let uncle = newNode.parent.parent.right;

                    if (uncle && uncle.color === 'red') {
                        newNode.parent.color = 'black';
                        uncle.color = 'black';
                        newNode.parent.parent.color = 'red';
                        newNode = newNode.parent.parent;
                    } else {
                        if (newNode === newNode.parent.right) {
                            newNode = newNode.parent;
                            this.rotateLeft(newNode);
                        }
                        newNode.parent.color = 'black';
                        newNode.parent.parent.color = 'red';
                        this.rotateRight(newNode.parent.parent);
                    }
                } else {
                    let uncle = newNode.parent.parent.left;

                    if (uncle && uncle.color === 'red') {
                        newNode.parent.color = 'black';
                        uncle.color = 'black';
                        newNode.parent.parent.color = 'red';
                        newNode = newNode.parent.parent;
                    } else {
                        if (newNode === newNode.parent.left) {
                            newNode = newNode.parent;
                            this.rotateRight(newNode);
                        }
                        newNode.parent.color = 'black';
                        newNode.parent.parent.color = 'red';
                        this.rotateLeft(newNode.parent.parent);
                    }
                }
            }
            this.root.color = 'black';
        }

        rotateLeft(node) {
            const rightNode = node.right;
            node.right = rightNode.left;
            if (rightNode.left) {
                rightNode.left.parent = node;
            }
            rightNode.parent = node.parent;
            if (!node.parent) {
                this.root = rightNode;
            } else if (node === node.parent.left) {
                node.parent.left = rightNode;
            } else {
                node.parent.right = rightNode;
            }
            rightNode.left = node;
            node.parent = rightNode;
        }

        rotateRight(node) {
            const leftNode = node.left;
            node.left = leftNode.right;
            if (leftNode.right) {
                leftNode.right.parent = node;
            }
            leftNode.parent = node.parent;
            if (!node.parent) {
                this.root = leftNode;
            } else if (node === node.parent.left) {
                node.parent.left = leftNode;
            } else {
                node.parent.right = leftNode;
            }
            leftNode.right = node;
            node.parent = leftNode;
        }

        renderTree() {
            const treeDiv = document.getElementById('tree');
            treeDiv.innerHTML = '';
            this._renderNode(this.root, treeDiv);
        }

        _renderNode(node, parentDiv) {
            if (node) {
                const nodeDiv = document.createElement('div');
                nodeDiv.className = `node ${node.color}`;
                nodeDiv.textContent = node.data;

                parentDiv.appendChild(nodeDiv);

                const childrenDiv = document.createElement('div');
                childrenDiv.style.display = 'flex';
                childrenDiv.style.justifyContent = 'center';
                parentDiv.appendChild(childrenDiv);

                this._renderNode(node.left, childrenDiv);
                this._renderNode(node.right, childrenDiv);
            }
        }
    }

    const rbTree = new RedBlackTree();

    function insertNode() {
        const valueInput = document.getElementById('valueInput');
        const value = Number(valueInput.value);
        if (!isNaN(value)) {
            rbTree.insert(value);
            valueInput.value = '';
        } else {
            alert('Please enter a valid number.');
        }
    }
</script>

</body>
</html>