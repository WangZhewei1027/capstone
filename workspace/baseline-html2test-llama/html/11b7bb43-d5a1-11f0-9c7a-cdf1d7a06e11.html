<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Nearest Neighbors (KNN) Example</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #input-field {
            width: 50%;
            margin: 20px auto;
        }
        #result {
            font-size: 24px;
            font-weight: bold;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>K-Nearest Neighbors (KNN) Example</h1>
    <form id="knn-form">
        <label for="features">Features:</label>
        <input type="text" id="features" name="features" required>
        <br>
        <label for="k">K:</label>
        <input type="number" id="k" name="k" required>
        <br>
        <label for="distance">Distance metric:</label>
        <select id="distance" name="distance" required>
            <option value="euclidean">Euclidean</option>
            <option value="manhattan">Manhattan</option>
        </select>
        <br>
        <input type="submit" value="Calculate KNN">
    </form>
    <div id="result"></div>

    <script>
        let inputField = document.getElementById('features');
        let kInput = document.getElementById('k');
        let distanceSelect = document.getElementById('distance');
        let resultDiv = document.getElementById('result');

        let features = [];
        let k = 3;
        let distance = 'euclidean';

        inputField.addEventListener('input', () => {
            features = inputField.value.split(' ');
            console.log(features);
        });

        kInput.addEventListener('input', () => {
            k = parseInt(kInput.value);
            console.log(k);
        });

        distanceSelect.addEventListener('change', () => {
            distance = distanceSelect.value;
            console.log(distance);
        });

        let knn = new KNN(features, k, distance);
        knn.calculate();

        function KNN(features, k, distance) {
            let distances = [];
            let nearestNeighbors = [];

            for (let i = 0; i < features.length; i++) {
                let feature = features[i];
                let distanceToNeighbor = calculateDistance(feature, features);

                if (distances.length < k) {
                    distances.push([feature, distanceToNeighbor]);
                    nearestNeighbors.push(feature);
                } else {
                    if (distanceToNeighbor < distances[distances.length - 1][1]) {
                        distances = [distances];
                        nearestNeighbors = [nearestNeighbors];
                    } else if (distanceToNeighbor === distances[distances.length - 1][1]) {
                        nearestNeighbors.push(feature);
                    }
                }
            }

            let result = nearestNeighbors.map((neighbor) => {
                return `<span style="font-weight: bold">${neighbor}</span>`;
            }).join(' ');

            resultDiv.innerText = result;
        }

        function calculateDistance(feature, features) {
            let sum = 0;
            for (let i = 0; i < features.length; i++) {
                sum += (features[i] - feature) ** 2;
            }
            return Math.sqrt(sum);
        }
    </script>
</body>
</html>