<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red-Black Tree</title>
    <style>
        #tree {
            width: 50%;
            margin: 50px auto;
            text-align: center;
        }
        #tree img {
            width: 100%;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="tree">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Black_tree.svg/1200px-Black_tree.svg.png" alt="Red-Black Tree">
        <p>Red-Black Tree</p>
    </div>

    <script>
        class Node {
            constructor(key, color, left, right) {
                this.key = key;
                this.color = color;
                this.left = left;
                this.right = right;
            }
        }

        class RedBlackTree {
            constructor() {
                this.root = null;
            }

            insert(key) {
                if (this.root === null) {
                    this.root = new Node(key, 'red', null, null);
                    return this.root;
                }

                let node = this.root;
                while (node !== null) {
                    if (key < node.key) {
                        if (node.left === null) {
                            node.left = new Node(key, 'red', null, node);
                            return node.left;
                        }

                        node = node.left;
                    } else {
                        if (node.right === null) {
                            node.right = new Node(key, 'red', node, null);
                            return node.right;
                        }

                        node = node.right;
                    }
                }

                throw new Error("Key already exists in the tree");
            }

            search(key) {
                return this.searchNode(this.root, key);
            }

            searchNode(node, key) {
                if (node === null) {
                    return null;
                }

                if (key < node.key) {
                    return this.searchNode(node.left, key);
                } else if (key > node.key) {
                    return this.searchNode(node.right, key);
                } else {
                    return node;
                }
            }

            delete(key) {
                return this.deleteNode(this.root, key);
            }

            deleteNode(node, key) {
                if (node === null) {
                    return node;
                }

                if (key < node.key) {
                    node.left = this.deleteNode(node.left, key);
                } else if (key > node.key) {
                    node.right = this.deleteNode(node.right, key);
                } else {
                    if (node.left === null && node.right === null) {
                        return null;
                    } else if (node.left === null) {
                        return node.right;
                    } else if (node.right === null) {
                        return node.left;
                    } else {
                        let minNode = this.getMinValueNode(node.right);
                        node.key = minNode.key;
                        node.right = this.deleteNode(node.right, minNode.key);
                    }
                }

                return node;
            }

            getMinValueNode(node) {
                while (node.left !== null) {
                    node = node.left;
                }
                return node;
            }
        }

        let tree = new RedBlackTree();

        function printTree(node, level = 0) {
            if (node !== null) {
                console.log('  '.repeat(level) + '-> ' + node.key);
                printTree(node.left, level + 1);
                printTree(node.right, level + 1);
            }
        }

        tree.insert(10);
        tree.insert(5);
        tree.insert(15);
        tree.insert(3);
        tree.insert(7);
        tree.insert(12);
        tree.insert(20);

        printTree(tree.root);
        console.log(tree.search(10).key);

        tree.delete(5);

        printTree(tree.root);
        console.log(tree.search(5).key);
    </script>
</body>
</html>