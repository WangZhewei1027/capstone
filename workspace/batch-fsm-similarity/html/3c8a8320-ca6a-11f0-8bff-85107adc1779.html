<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sliding Window Technique Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2rem;
    background: #f0f4f8;
  }
  h1 {
    text-align: center;
    color: #333;
  }
  #arrayInput, #windowInput {
    width: 100%;
    padding: 0.5rem;
    font-size: 1rem;
    margin-bottom: 1rem;
  }
  label {
    font-weight: bold;
  }
  button {
    padding: 0.7rem 1.5rem;
    font-size: 1rem;
    cursor: pointer;
    background-color: #007bfc;
    border: none;
    color: white;
    border-radius: 4px;
    margin-bottom: 1rem;
  }
  button:hover {
    background-color: #005bb5;
  }
  #output {
    background: white;
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
  }
  .window {
    display: inline-block;
    margin: 0.2rem 0.5rem 1rem 0.2rem;
    padding: 0.5rem 0.7rem;
    background-color: #007bfc;
    color: white;
    border-radius: 4px;
    min-width: 2rem;
    text-align: center;
    font-weight: bold;
  }
  .sum {
    margin-top: 1rem;
    font-size: 1.1rem;
    font-weight: bold;
  }

  /* Visualization below */
  #visualization {
    margin-top: 2rem;
    text-align: center;
  }
  .array-container {
    display: flex;
    justify-content: center;
    gap: 8px;
  }
  .element {
    width: 40px;
    height: 40px;
    background: #cce4ff;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.1rem;
    position: relative;
    transition: background-color 0.3s ease;
  }
  .element.in-window {
    background-color: #007bfc;
    color: white;
    box-shadow: 0 0 8px #007bfcaa;
  }
  .pointer-window {
    margin-top: 0.5rem;
    font-weight: bold;
    color: #007bfc;
  }
</style>
</head>
<body>

<h1>Sliding Window Technique Demo</h1>

<label for="arrayInput">Enter an array of numbers (comma separated):</label>
<input type="text" id="arrayInput" placeholder="e.g. 2,1,5,1,3,2" value="2,1,5,1,3,2" />

<label for="windowInput">Window size (k):</label>
<input type="number" id="windowInput" value="3" min="1" max="100" />

<button id="runBtn">Run Sliding Window Sum</button>

<div id="output"></div>

<div id="visualization"></div>

<script>
  const runBtn = document.getElementById('runBtn');
  const arrayInput = document.getElementById('arrayInput');
  const windowInput = document.getElementById('windowInput');
  const output = document.getElementById('output');
  const visualization = document.getElementById('visualization');

  function parseArray(input) {
    return input.split(',').map(s => s.trim()).filter(s=>s.length>0).map(Number).filter(n => !isNaN(n));
  }

  // Animate sliding window sums step by step
  async function slidingWindowSumAnimation(array, k) {
    visualization.innerHTML = '';
    output.innerHTML = '';

    if (k > array.length) {
      output.textContent = 'Window size k cannot be greater than array length.';
      return;
    }
    if (k < 1) {
      output.textContent = 'Window size k must be at least 1.';
      return;
    }

    // Create visual elements for array
    const arrayContainer = document.createElement('div');
    arrayContainer.className = 'array-container';
    array.forEach((num, idx) => {
      const elem = document.createElement('div');
      elem.className = 'element';
      elem.textContent = num;
      elem.id = 'el-' + idx;
      arrayContainer.appendChild(elem);
    });
    visualization.appendChild(arrayContainer);

    // Explanation container
    const explanation = document.createElement('div');
    explanation.style.marginTop = '1rem';
    explanation.style.fontSize = '1.1rem';
    visualization.appendChild(explanation);

    // Calculate first window sum
    let windowSum = 0;
    for (let i = 0; i < k; i++) {
      windowSum += array[i];
      document.getElementById('el-' + i).classList.add('in-window');
    }
    explanation.textContent = `Initial window sum (indices 0 to ${k - 1}): ${windowSum}`;
    await sleep(2000);

    // Output area for sums
    const sumsContainer = document.createElement('div');
    sumsContainer.className = 'sum';
    sumsContainer.textContent = `Window sums: [${windowSum}`;
    output.appendChild(sumsContainer);

    // Slide over rest
    for (let i = k; i < array.length; i++) {
      // Remove left element highlight
      document.getElementById('el-' + (i-k)).classList.remove('in-window');
      // Add right element highlight
      document.getElementById('el-' + i).classList.add('in-window');

      windowSum = windowSum - array[i - k] + array[i];
      explanation.textContent = `Slide window to indices ${i-k+1} to ${i}: remove ${array[i - k]}, add ${array[i]}, new sum = ${windowSum}`;
      sumsContainer.textContent += `, ${windowSum}`;
      await sleep(2000);
    }
    sumsContainer.textContent += `]`;

    explanation.textContent = 'Sliding window sums calculation complete.';
  }

  function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  runBtn.addEventListener('click', () => {
    const arr = parseArray(arrayInput.value);
    if (arr.length === 0) {
      output.textContent = 'Please enter a valid array of numbers.';
      visualization.innerHTML = '';
      return;
    }
    const k = parseInt(windowInput.value);
    if (isNaN(k)) {
      output.textContent = 'Please enter a valid window size (k).';
      visualization.innerHTML = '';
      return;
    }
    slidingWindowSumAnimation(arr, k);
  });
</script>

</body>
</html>