<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Means Clustering Demo</title>
    <style>
        body { display: flex; flex-direction: column; align-items: center; font-family: Arial, sans-serif; }
        canvas { border: 1px solid black; margin: 20px; }
        #controls { margin: 10px; }
        .button { margin: 5px; padding: 10px; border: none; background-color: #007bff; color: white; cursor: pointer; }
        .button:hover { background-color: #0056b3; }
    </style>
</head>
<body>
    <h1>K-Means Clustering Demo</h1>
    <canvas id="canvas" width="600" height="400"></canvas>
    <div id="controls">
        <button class="button" id="generate-data">Generate Data Points</button>
        <button class="button" id="run-kmeans">Run K-Means</button>
        <label for="clusters">Number of Clusters:</label>
        <input type="number" id="clusters" value="3" min="1" max="10">
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const dataPoints = [];
        let centroids = [];
        
        function generateRandomData(numPoints) {
            const points = [];
            for (let i = 0; i < numPoints; i++) {
                points.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height
                });
            }
            return points;
        }

        function drawPoints() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'lightgray';
            dataPoints.forEach(point => {
                ctx.beginPath();
                ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);
                ctx.fill();
            });
            drawCentroids();
        }

        function drawCentroids() {
            centroids.forEach(centroid => {
                ctx.beginPath();
                ctx.arc(centroid.x, centroid.y, 10, 0, Math.PI * 2);
                ctx.fillStyle = 'red';
                ctx.fill();
            });
        }

        function kMeans(numClusters) {
            // Step 1: Initialize centroids
            centroids = [];
            for (let i = 0; i < numClusters; i++) {
                centroids.push(dataPoints[Math.floor(Math.random() * dataPoints.length)]);
            }

            let assignments = new Array(dataPoints.length);
            let changed = true;

            while (changed) {
                changed = false;

                // Step 2: Assign clusters
                for (let i = 0; i < dataPoints.length; i++) {
                    let minDist = Infinity;
                    let bestCluster = -1;

                    centroids.forEach((centroid, index) => {
                        const distance = Math.hypot(dataPoints[i].x - centroid.x, dataPoints[i].y - centroid.y);
                        if (distance < minDist) {
                            minDist = distance;
                            bestCluster = index;
                        }
                    });
                    if (assignments[i] !== bestCluster) {
                        assignments[i] = bestCluster;
                        changed = true;
                    }
                }

                // Step 3: Update centroids
                centroids = centroids.map((centroid, index) => {
                    let clusterPoints = dataPoints.filter((_, i) => assignments[i] === index);
                    if (clusterPoints.length === 0) return centroid;
                    const avgX = clusterPoints.reduce((sum, point) => sum + point.x, 0) / clusterPoints.length;
                    const avgY = clusterPoints.reduce((sum, point) => sum + point.y, 0) / clusterPoints.length;
                    return { x: avgX, y: avgY };
                });
            }
            drawPoints();
        }

        document.getElementById('generate-data').addEventListener('click', () => {
            const numPoints = 100;
            dataPoints.length = 0;  // Clear existing points
            dataPoints.push(...generateRandomData(numPoints));
            drawPoints();
        });

        document.getElementById('run-kmeans').addEventListener('click', () => {
            const numClusters = parseInt(document.getElementById('clusters').value);
            kMeans(numClusters);
        });
    </script>
</body>
</html>