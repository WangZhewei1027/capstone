<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hash Map Demonstration in JavaScript</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2rem;
    background: #f9f9f9;
    color: #333;
  }
  h1 {
    text-align: center;
    color: #007acc;
  }
  .container {
    max-width: 600px;
    margin: 0 auto;
    background: white;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
  label {
    display: block;
    margin-top: 1rem;
    font-weight: bold;
  }
  input[type=text] {
    width: 100%;
    padding: 0.5rem;
    font-size: 1rem;
    margin-top: 0.3rem;
    box-sizing: border-box;
  }
  button {
    margin-top: 1rem;
    padding: 0.6rem 1rem;
    font-size: 1rem;
    cursor: pointer;
    background: #007acc;
    border: none;
    color: white;
    border-radius: 4px;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background: #005fa3;
  }
  .output {
    margin-top: 1.5rem;
    background: #eee;
    padding: 1rem;
    border-radius: 4px;
    font-family: monospace;
    white-space: pre-wrap;
    max-height: 300px;
    overflow-y: auto;
  }
  .hash-map-visual {
    margin-top: 1rem;
    border: 1px solid #ccc;
    border-radius: 6px;
    overflow-x: auto;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    border-bottom: 1px solid #ddd;
    padding: 0.4rem 0.6rem;
    text-align: left;
  }
  th {
    background: #007acc;
    color: white;
    position: sticky;
    top: 0;
  }
  .footer {
    margin-top: 2rem;
    font-size: 0.9rem;
    text-align: center;
    color: #666;
  }
  .error {
    color: #c00;
    font-weight: bold;
  }
</style>
</head>
<body>
  <h1>Hash Map (JavaScript Map) Demonstration</h1>
  <div class="container">
    <p>
      This demo uses JavaScript's built-in <code>Map</code> object, which is a hash map implementation allowing keys of any type.
      You can add key-value pairs, get values by key, check existence, and delete entries.
    </p>

    <label for="keyInput">Key (can be string, number, or JSON for objects):</label>
    <input id="keyInput" type="text" placeholder='e.g. "name" or 42 or {"id":1}' />

    <label for="valueInput">Value (string):</label>
    <input id="valueInput" type="text" placeholder='e.g. "Alice" or "Blue"' />

    <button id="addBtn">Add/Update Entry</button>
    <button id="getBtn">Get Value by Key</button>
    <button id="hasBtn">Check if Key Exists</button>
    <button id="deleteBtn">Delete Entry by Key</button>
    <button id="clearBtn" style="background: #c0392b;">Clear Map</button>

    <div class="output" id="output" aria-live="polite"></div>

    <h2>Current Hash Map Contents</h2>
    <div class="hash-map-visual" id="hashMapTableContainer">
      <!-- Table will be generated here -->
    </div>
  </div>
  <div class="footer">
    &copy; 2024 Hash Map Demo | Uses JavaScript ES6 Map
  </div>

<script>
  (() => {
    // We want to support keys of type: string, number, and objects (via JSON).
    // Since JS Map accepts object keys natively, parse JSON for key if possible.
    // For non-JSON strings, treat as string or number.

    // The map we'll use
    const map = new Map();

    const keyInput = document.getElementById('keyInput');
    const valueInput = document.getElementById('valueInput');
    const outputEl = document.getElementById('output');
    const tableContainer = document.getElementById('hashMapTableContainer');

    // Utility: try to parse JSON key, but fallback nicely
    function parseKey(input) {
      input = input.trim();
      // If input looks like JSON object/array, try parse:
      if (
        (input.startsWith('{') && input.endsWith('}')) ||
        (input.startsWith('[') && input.endsWith(']'))
      ) {
        try {
          return JSON.parse(input);
        } catch (e) {
          throw new Error("Invalid JSON for key.");
        }
      }
      // Try number
      if (!isNaN(input) && input !== '') {
        // parse as number (integers or floats)
        return Number(input);
      }
      // Else treat as string
      return input;
    }

    function keyToString(key) {
      if (key === null) return "null";
      if (key === undefined) return "undefined";
      if (typeof key === "object") {
        try {
          return JSON.stringify(key);
        } catch (e) {
          return key.toString();
        }
      }
      return String(key);
    }

    function renderMap() {
      if (map.size === 0) {
        tableContainer.innerHTML = "<p>The map is empty.</p>";
        return;
      }
      let html = '<table aria-label="Hash Map Contents"><thead><tr><th>Key (type)</th><th>Value</th></tr></thead><tbody>';
      for (let [k,v] of map.entries()) {
        let typeName = typeof k;
        if (k === null) typeName = "null";
        else if (Array.isArray(k)) typeName = "array";
        html += `<tr><td title="${typeName}">${keyToString(k)}</td><td>${v}</td></tr>`;
      }
      html += '</tbody></table>';
      tableContainer.innerHTML = html;
    }

    function logMessage(msg, isError=false) {
      outputEl.textContent = msg;
      if (isError) {
        outputEl.classList.add('error');
      } else {
        outputEl.classList.remove('error');
      }
    }

    document.getElementById('addBtn').addEventListener('click', () => {
      try {
        const k = parseKey(keyInput.value);
        const v = valueInput.value;
        if (v === "") {
          logMessage("Please enter a value for the map.", true);
          return;
        }
        map.set(k, v);
        logMessage(`Added/Updated entry:\nKey (${typeof k}): ${keyToString(k)}\nValue: ${v}`);
        renderMap();
      } catch(e) {
        logMessage("Error: " + e.message, true);
      }
    });

    document.getElementById('getBtn').addEventListener('click', () => {
      try {
        const k = parseKey(keyInput.value);
        if (map.has(k)) {
          logMessage(`Value for key (${typeof k}) ${keyToString(k)}: ${map.get(k)}`);
        } else {
          logMessage(`Key (${typeof k}) ${keyToString(k)} not found in map.`, true);
        }
      } catch(e) {
        logMessage("Error: " + e.message, true);
      }
    });

    document.getElementById('hasBtn').addEventListener('click', () => {
      try {
        const k = parseKey(keyInput.value);
        if (map.has(k)) {
          logMessage(`Map contains key (${typeof k}): ${keyToString(k)}`);
        } else {
          logMessage(`Map does NOT contain key (${typeof k}): ${keyToString(k)}`, true);
        }
      } catch(e) {
        logMessage("Error: " + e.message, true);
      }
    });

    document.getElementById('deleteBtn').addEventListener('click', () => {
      try {
        const k = parseKey(keyInput.value);
        if (map.delete(k)) {
          logMessage(`Deleted entry with key (${typeof k}): ${keyToString(k)}`);
          renderMap();
        } else {
          logMessage(`No entry found with key (${typeof k}): ${keyToString(k)}`, true);
        }
      } catch(e) {
        logMessage("Error: " + e.message, true);
      }
    });

    document.getElementById('clearBtn').addEventListener('click', () => {
      map.clear();
      logMessage("Hash Map cleared.");
      renderMap();
    });

    // Initially render empty map
    renderMap();
  })();
</script>
</body>
</html>