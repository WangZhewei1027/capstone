<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Two Pointers — Interactive Playground</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#60a5fa; --muted:#94a3b8; --good:#34d399; --bad:#fb7185;
      --size:46px;
    }
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    body{margin:0;background:linear-gradient(180deg,#071229 0%, #081427 100%);color:#e6eef8;min-height:100vh;padding:28px;}
    .wrap{max-width:1100px;margin:0 auto;}
    header{display:flex;gap:20px;align-items:center;margin-bottom:18px}
    header h1{font-size:20px;margin:0}
    header p{margin:0;color:var(--muted);font-size:13px}
    .layout{display:flex;gap:18px}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:14px;flex:1;min-width:260px}
    .vis{flex:2;display:flex;flex-direction:column;gap:12px}
    .controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    select,input,button{background:transparent;border:1px solid rgba(255,255,255,0.06);color:inherit;padding:8px 10px;border-radius:8px;font-size:13px}
    button{cursor:pointer}
    .array{display:flex;gap:8px;align-items:center;flex-wrap:wrap;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
    .cell{width:var(--size);height:var(--size);display:flex;align-items:center;justify-content:center;border-radius:10px;background:rgba(255,255,255,0.03);font-weight:600;color:#dbeafe;position:relative;box-shadow:inset 0 -6px 14px rgba(2,6,23,0.3);}
    .idx{position:absolute;left:6px;bottom:4px;font-size:11px;color:var(--muted);font-weight:500}
    .ptrLeft{box-shadow:0 6px 24px rgba(96,165,250,0.12);border:2px solid rgba(96,165,250,0.18)}
    .ptrRight{box-shadow:0 6px 24px rgba(236,72,153,0.12);border:2px solid rgba(236,72,153,0.18)}
    .ptrWrite{box-shadow:0 6px 24px rgba(52,211,153,0.12);border:2px solid rgba(52,211,153,0.18)}
    .msg{padding:10px;border-radius:8px;background:rgba(0,0,0,0.12);color:var(--muted);font-size:13px}
    .small{font-size:13px;color:var(--muted)}
    .btnRow{display:flex;gap:8px}
    .hint{font-size:13px;color:var(--muted);margin-top:8px}
    .code{background:#041025;padding:12px;border-radius:8px;font-family:ui-monospace,SFMono-Regular,Consolas,monospace;font-size:13px;color:#bfe3ff}
    .footer{margin-top:12px;color:var(--muted);font-size:13px}
    .found{background:linear-gradient(90deg,#a7f3d0,#bbf7d0);color:#052e16}
    .bad{background:linear-gradient(90deg,#fecaca,#fee2e2);color:#4c0519}
    .controls input[type=range]{appearance:none;height:6px;background:rgba(255,255,255,0.06);border-radius:6px;width:120px}
    .controls label{font-size:13px;color:var(--muted)}
    .topRow{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .leftCol{display:flex;flex-direction:column;gap:8px}
    .mutedBox{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;color:var(--muted);font-size:13px}
    .copy{cursor:pointer;padding:6px;border-radius:6px;border:1px solid rgba(255,255,255,0.04)}
    .legend{display:flex;gap:8px;flex-wrap:wrap}
    .legend span{display:flex;gap:8px;align-items:center;padding:6px;border-radius:8px;font-size:13px}
    .dot{width:12px;height:12px;border-radius:3px}
    .dot.left{background:linear-gradient(180deg,#60a5fa,#3b82f6)}
    .dot.right{background:linear-gradient(180deg,#fb7185,#fb7185)}
    .dot.write{background:linear-gradient(180deg,#34d399,#10b981)}
    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}
    @media(max-width:900px){.layout{flex-direction:column}.vis{order:2}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Two Pointers — Interactive Playground</h1>
        <p>Visualize common two-pointer patterns: left/right pointers, slow/fast (write/read), and in-place swaps.</p>
      </div>
    </header>

    <div class="layout">
      <aside class="panel">
        <div class="leftCol">
          <div class="topRow">
            <label for="demoSelect">Demo</label>
            <select id="demoSelect">
              <option value="pairSum">Find Pair With Target Sum (sorted)</option>
              <option value="reverse">Reverse Array (in-place swaps)</option>
              <option value="removeDup">Remove Duplicates (in-place, sorted)</option>
            </select>
          </div>

          <div class="controls" style="margin-top:8px">
            <label style="min-width:70px">Array</label>
            <input id="arrInput" placeholder="e.g. 1,2,3,4" style="flex:1"/>
            <button id="applyArr">Apply</button>
          </div>

          <div class="controls" style="margin-top:8px">
            <label style="min-width:70px">Random</label>
            <input type="range" id="sizeRange" min="3" max="12" value="8"/>
            <button id="genBtn">Generate</button>
          </div>

          <div id="extraControls"></div>

          <div class="controls" style="margin-top:8px">
            <div class="btnRow">
              <button id="resetBtn">Reset</button>
              <button id="stepBtn">Step</button>
              <button id="autoBtn">Auto ▶</button>
              <button id="fastBtn">Run ⏩</button>
            </div>
            <div style="margin-left:6px" class="small">Interval:
              <input type="range" id="interval" min="100" max="2000" step="100" value="700"/>
            </div>
          </div>

          <div class="mutedBox">
            <div id="status" class="msg">Choose a demo and prepare an array. Use Step or Auto to advance.</div>
            <div class="hint" id="hint">Hint: Pair Sum and Remove Duplicates expect a sorted array.</div>
          </div>

          <div style="margin-top:10px">
            <strong>Pseudocode & Complexity</strong>
            <div id="pseudocode" class="code" style="margin-top:8px"></div>
          </div>
        </div>
      </aside>

      <main class="panel vis">
        <div>
          <div class="controls" style="justify-content:space-between">
            <div class="legend">
              <span><div class="dot left"></div>Left</span>
              <span><div class="dot right"></div>Right</span>
              <span><div class="dot write"></div>Write/Slow</span>
            </div>
            <div class="small">Auto mode will step every <span id="ivalLbl">700</span> ms</div>
          </div>
        </div>

        <div class="array" id="arrayVis" style="min-height:110px"></div>

        <div style="display:flex;gap:8px;align-items:flex-start">
          <div style="flex:1">
            <div class="small" style="margin-bottom:6px"><strong>Step Info</strong></div>
            <div id="stepInfo" class="msg">No steps yet.</div>
          </div>
          <div style="width:260px">
            <div class="small" style="margin-bottom:6px"><strong>Result</strong></div>
            <div id="result" class="msg">—</div>
            <div class="footer">Time: O(n) / Space: O(1)</div>
          </div>
        </div>
      </main>
    </div>

    <footer style="margin-top:18px">This interactive file demonstrates common Two Pointers patterns. Modify the array and step through the pointers to learn how they move and operate.</footer>
  </div>

  <script>
    // Two Pointers Interactive Playground
    // Demos: pairSum (left/right), reverse (swap left/right), removeDup (read/write)

    // DOM refs
    const demoSelect = document.getElementById('demoSelect');
    const arrInput = document.getElementById('arrInput');
    const applyArr = document.getElementById('applyArr');
    const genBtn = document.getElementById('genBtn');
    const sizeRange = document.getElementById('sizeRange');
    const arrayVis = document.getElementById('arrayVis');
    const stepBtn = document.getElementById('stepBtn');
    const resetBtn = document.getElementById('resetBtn');
    const autoBtn = document.getElementById('autoBtn');
    const fastBtn = document.getElementById('fastBtn');
    const status = document.getElementById('status');
    const hint = document.getElementById('hint');
    const pseudocode = document.getElementById('pseudocode');
    const stepInfo = document.getElementById('stepInfo');
    const result = document.getElementById('result');
    const extraControls = document.getElementById('extraControls');
    const interval = document.getElementById('interval');
    const ivalLbl = document.getElementById('ivalLbl');

    let state = {};
    let autoTimer = null;

    function setStatus(txt, kind) {
      status.textContent = txt;
      status.className = 'msg' + (kind ? (' ' + kind) : '');
    }

    // Utils
    function parseArrayInput(str) {
      if (!str.trim()) return null;
      const parts = str.split(',').map(s => s.trim()).filter(s=>s!=='');
      const nums = parts.map(s => {
        const n = Number(s);
        return Number.isFinite(n) ? n : NaN;
      });
      if (nums.some(n => isNaN(n))) return null;
      return nums;
    }

    function renderArray(arr, highlights = {}) {
      arrayVis.innerHTML = '';
      arr.forEach((v,i) => {
        const el = document.createElement('div');
        el.className = 'cell';
        el.innerHTML = `<div>${v}</div><div class="idx">${i}</div>`;
        if (highlights.left === i) el.classList.add('ptrLeft');
        if (highlights.right === i) el.classList.add('ptrRight');
        if (highlights.write === i) el.classList.add('ptrWrite');
        if (highlights.found && highlights.found.includes(i)) {
          el.classList.add('found');
        }
        if (highlights.removed && highlights.removed.includes(i)) {
          el.classList.add('bad');
        }
        arrayVis.appendChild(el);
      });
    }

    // Pseudocode texts per demo
    const PSEUDOS = {
      pairSum:
`# Find Pair With Target Sum (sorted)
l = 0, r = n-1
while l < r:
  sum = A[l] + A[r]
  if sum == target: return (l,r)
  if sum < target: l += 1
  else: r -= 1
Time: O(n), Space: O(1)`,

      reverse:
`# Reverse Array (in-place)
l = 0, r = n-1
while l < r:
  swap(A[l], A[r])
  l += 1; r -= 1
Time: O(n), Space: O(1)`,

      removeDup:
`# Remove Duplicates (sorted, in-place)
if n == 0: return 0
write = 1
for read in 1..n-1:
  if A[read] != A[write-1]:
    A[write] = A[read]
    write += 1
return write  # new length
Time: O(n), Space: O(1)`,
    };

    // Initialize state for each demo
    function initState() {
      const demo = demoSelect.value;
      const size = Number(sizeRange.value);
      let arr = [];

      if (demo === 'pairSum' || demo === 'removeDup') {
        // generate sorted array with possible duplicates
        const base = Math.floor(Math.random()*3) + 1;
        let cur = base;
        for (let i=0;i<size;i++){
          // sometimes repeat
          if (Math.random() < 0.25) {
            // duplicate value
          } else {
            cur += Math.floor(Math.random()*3)+1;
          }
          arr.push(cur);
        }
      } else {
        // reverse: random unsorted
        for (let i=0;i<size;i++) arr.push(Math.floor(Math.random()*20));
      }

      // allow arrInput override if provided
      const user = parseArrayInput(arrInput.value || '');
      if (user) arr = user.slice();

      // set up base state
      state = {
        demo,
        arr: arr.slice(),
        initial: arr.slice(),
        steps: 0,
        finished: false,
        message: '',
      };

      if (demo === 'pairSum') {
        // build target near some pair sometimes
        let target;
        if (Math.random() < 0.6 && arr.length >= 2) {
          // pick two indices
          const i = Math.floor(Math.random()*(arr.length-1));
          const j = Math.floor(Math.random()*(arr.length-i-1)) + i+1;
          target = arr[i] + arr[j];
        } else {
          // random target
          target = arr[Math.floor(Math.random()*arr.length)] + Math.floor(Math.random()*10);
        }
        state.l = 0; state.r = arr.length-1; state.target = target; state.found = null;
      } else if (demo === 'reverse') {
        state.l = 0; state.r = arr.length-1;
      } else if (demo === 'removeDup') {
        state.read = 1; state.write = 1; state.removed = []; state.newLen = null;
      }

      updateUI();
    }

    function updateUI() {
      const demo = state.demo;
      pseudocode.textContent = PSEUDOS[demo];
      // show extra controls based on demo
      extraControls.innerHTML = '';
      if (demo === 'pairSum') {
        const div = document.createElement('div');
        div.className = 'controls';
        div.style.marginTop = '8px';
        div.innerHTML = `<label style="min-width:70px">Target</label>
                         <input id="targetInput" value="${state.target}" style="width:120px"/>
                         <button id="setTarget">Set</button>`;
        extraControls.appendChild(div);
        document.getElementById('setTarget').addEventListener('click',()=>{
          const t = Number(document.getElementById('targetInput').value);
          if (!Number.isFinite(t)) { setStatus('Invalid target', 'bad'); return; }
          state.target = t; setStatus('Target set to ' + t);
        });
      }

      // render
      const highlights = {};
      if (state.demo === 'pairSum') {
        highlights.left = state.l; highlights.right = state.r;
        if (state.found) highlights.found = state.found;
      } else if (state.demo === 'reverse') {
        highlights.left = state.l; highlights.right = state.r;
      } else if (state.demo === 'removeDup') {
        highlights.read = state.read; highlights.write = state.write;
        // mark removed indices visually
        highlights.removed = state.removed;
        highlights.write = state.write < state.arr.length ? state.write : -1;
      }
      renderArray(state.arr, highlights);
      stepInfo.textContent = `Steps: ${state.steps}`;
      result.textContent = '—';
      if (state.demo === 'pairSum' && state.found) {
        result.textContent = `Found pair at indices ${state.found[0]} and ${state.found[1]} (values ${state.arr[state.found[0]]}, ${state.arr[state.found[1]]})`;
      } else if (state.demo === 'removeDup' && state.newLen != null) {
        result.textContent = `New length = ${state.newLen}. Elements kept at indices 0..${state.newLen-1}`;
      } else if (state.demo === 'reverse' && state.finished) {
        result.textContent = `Array reversed.`;
      }
      setStatus('Ready. Demo: ' + (demo === 'pairSum' ? 'Pair Sum' : demo === 'reverse' ? 'Reverse' : 'Remove Duplicates'));
      hint.textContent = (state.demo === 'pairSum' || state.demo === 'removeDup') ? 'Hint: This demo assumes a sorted array.' : 'Hint: Reverse works in-place using two pointers.';
    }

    // Step functions
    function stepPairSum() {
      if (state.finished) return;
      const A = state.arr;
      const l = state.l, r = state.r, t = state.target;
      state.steps++;
      if (l >= r) {
        setStatus('No pair found', 'bad');
        state.finished = true;
        return;
      }
      const s = A[l] + A[r];
      stepInfo.textContent = `A[${l}](${A[l]}) + A[${r}](${A[r]}) = ${s} (target ${t})`;
      if (s === t) {
        state.found = [l,r];
        setStatus(`Pair found at indices ${l} and ${r}`, 'found');
        state.finished = true;
      } else if (s < t) {
        state.l++;
        setStatus(`Sum ${s} < ${t} → move left pointer right (l -> ${state.l})`);
      } else {
        state.r--;
        setStatus(`Sum ${s} > ${t} → move right pointer left (r -> ${state.r})`);
      }
      renderArray(state.arr, {left: state.l, right: state.r, found: state.found ? state.found : null});
    }

    function stepReverse() {
      if (state.finished) return;
      const A = state.arr;
      state.steps++;
      if (state.l >= state.r) {
        setStatus('Reverse complete', 'found');
        state.finished = true;
        renderArray(A);
        return;
      }
      stepInfo.textContent = `Swap A[${state.l}](${A[state.l]}) and A[${state.r}](${A[state.r]})`;
      // swap
      const tmp = A[state.l];
      A[state.l] = A[state.r];
      A[state.r] = tmp;
      setStatus(`Swapped indices ${state.l} and ${state.r}`);
      state.l++; state.r--;
      renderArray(A, {left: state.l, right: state.r});
      if (state.l >= state.r) {
        state.finished = true;
        setStatus('Reverse complete', 'found');
      }
    }

    function stepRemoveDup() {
      if (state.finished) return;
      const A = state.arr;
      state.steps++;
      if (A.length === 0) {
        state.newLen = 0; state.finished = true; setStatus('Empty array', 'bad'); return;
      }
      if (state.read >= A.length) {
        state.newLen = state.write;
        state.finished = true;
        setStatus(`Done. New length = ${state.newLen}`, 'found');
        renderArray(A);
        return;
      }
      const r = state.read, w = state.write;
      stepInfo.textContent = `Compare A[${r}](${A[r]}) with A[${w-1}](${A[w-1]})`;
      if (A[r] !== A[w-1]) {
        // keep
        A[w] = A[r];
        setStatus(`A[${r}] != A[${w-1}]. Write A[${w}] = ${A[r]}. Increment write -> ${w+1}`);
        state.write++;
        // optionally mark that we moved element from r to w if they differ
      } else {
        setStatus(`A[${r}] == A[${w-1}]. Skip duplicate at index ${r}`);
        state.removed.push(r);
      }
      state.read++;
      renderArray(A, {write: state.write, removed: state.removed});
    }

    function step() {
      if (!state || !state.demo) return;
      if (state.demo === 'pairSum') stepPairSum();
      else if (state.demo === 'reverse') stepReverse();
      else if (state.demo === 'removeDup') stepRemoveDup();
    }

    // Run fast to completion with small delay to allow UI update
    async function runFast() {
      // avoid blocking UI: use setTimeout loops
      if (state.finished) return;
      setStatus('Running fast...');
      while (!state.finished) {
        step();
        await new Promise(r => setTimeout(r, 120));
      }
      setStatus('Finished (fast run)', 'found');
    }

    // Event bindings
    demoSelect.addEventListener('change', () => {
      initState();
    });

    genBtn.addEventListener('click', () => {
      arrInput.value = '';
      initState();
    });

    applyArr.addEventListener('click', () => {
      const parsed = parseArrayInput(arrInput.value || '');
      if (!parsed) { setStatus('Invalid array. Use comma separated numbers.', 'bad'); return; }
      initState();
    });

    stepBtn.addEventListener('click', () => {
      if (autoTimer) { clearInterval(autoTimer); autoTimer = null; autoBtn.textContent = 'Auto ▶'; }
      step();
    });

    resetBtn.addEventListener('click', () => {
      if (autoTimer) { clearInterval(autoTimer); autoTimer = null; autoBtn.textContent = 'Auto ▶'; }
      initState();
    });

    autoBtn.addEventListener('click', () => {
      if (autoTimer) {
        clearInterval(autoTimer); autoTimer = null; autoBtn.textContent = 'Auto ▶'; setStatus('Auto stopped');
      } else {
        autoTimer = setInterval(()=>{
          if (state.finished) { clearInterval(autoTimer); autoTimer = null; autoBtn.textContent = 'Auto ▶'; return; }
          step();
        }, Number(interval.value));
        autoBtn.textContent = 'Auto ■';
        setStatus('Auto running...');
      }
    });

    fastBtn.addEventListener('click', async () => {
      if (autoTimer) { clearInterval(autoTimer); autoTimer = null; autoBtn.textContent = 'Auto ▶'; }
      await runFast();
    });

    interval.addEventListener('input', () => {
      ivalLbl.textContent = interval.value;
      if (autoTimer) {
        clearInterval(autoTimer);
        autoTimer = setInterval(()=>{
          if (state.finished) { clearInterval(autoTimer); autoTimer = null; autoBtn.textContent = 'Auto ▶'; return; }
          step();
        }, Number(interval.value));
      }
    });

    // initial
    initState();

    // keyboard shortcuts
    window.addEventListener('keydown', (e) => {
      if (e.key === ' ') { e.preventDefault(); stepBtn.click(); }
      if (e.key === 'r') resetBtn.click();
      if (e.key === 'a') autoBtn.click();
    });

    // small tips: clicking a cell toggles selection for demo exploration
    arrayVis.addEventListener('click', (ev) => {
      const el = ev.target.closest('.cell');
      if (!el) return;
      const idx = Number(el.querySelector('.idx').textContent);
      setStatus(`Clicked index ${idx}. Value: ${state.arr[idx]}`);
    });

    // Provide simple instructions in status on load
    setTimeout(()=> setStatus('Press Space to Step, "a" to toggle Auto, "r" to Reset.'), 500);
  </script>
</body>
</html>