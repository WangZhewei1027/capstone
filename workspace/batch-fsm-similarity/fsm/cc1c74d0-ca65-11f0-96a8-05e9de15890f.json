{
  "meta": {
    "concept": "LinkedList",
    "topic": "Singly Linked List Visualizer",
    "educational_goal": "Demonstrate singly linked list operations (prepend, append, insert at index, remove by value, remove by index, search, reverse, clear) with step-by-step animations and visual feedback",
    "expected_interactions": [
      "prepend",
      "append",
      "insert_at_index",
      "remove_by_value",
      "remove_by_index",
      "search",
      "reverse",
      "clear",
      "keyboard_enter"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "idle",
      "type": "idle",
      "entry_actions": [
        "render()",
        "enableControls()",
        "updateSizeBadge()"
      ],
      "exit_actions": []
    },
    {
      "id": "S1_Prepending",
      "label": "prepending_head",
      "type": "atomic",
      "entry_actions": [
        "checkBusy()",
        "setBusy(true)",
        "readValue('#valueInput')",
        "log('Inserting at head')",
        "animateHeadHighlight()"
      ],
      "exit_actions": [
        "list.prepend(value)",
        "render()",
        "setBusy(false)"
      ]
    },
    {
      "id": "S2_Appending",
      "label": "appending_tail",
      "type": "atomic",
      "entry_actions": [
        "checkBusy()",
        "setBusy(true)",
        "readValue('#valueInput')",
        "log('Appending to tail')",
        "animateWalkToTail()"
      ],
      "exit_actions": [
        "list.append(value)",
        "render()",
        "setBusy(false)"
      ]
    },
    {
      "id": "S3_InsertingAtIndex",
      "label": "inserting_at_index",
      "type": "atomic",
      "entry_actions": [
        "checkBusy()",
        "setBusy(true)",
        "readValue('#valueInput')",
        "readIndex('#indexInput')",
        "log('Inserting at index')",
        "animateWalkToInsertionPoint()"
      ],
      "exit_actions": [
        "list.insertAt(value,index)",
        "render()",
        "setBusy(false)"
      ]
    },
    {
      "id": "S4_RemovingByValue_Walking",
      "label": "removing_by_value_walking",
      "type": "atomic",
      "entry_actions": [
        "checkBusy()",
        "setBusy(true)",
        "readValue('#valueInput')",
        "log('Removing by value: walk and highlight')",
        "animateHighlightWalk(value)"
      ],
      "exit_actions": []
    },
    {
      "id": "S5_RemovingByValue_Removing",
      "label": "removing_by_value_removing",
      "type": "atomic",
      "entry_actions": [
        "animateRemovalAt(index)",
        "log('Removing node at index')"
      ],
      "exit_actions": [
        "list.removeAt(index)",
        "render()",
        "setBusy(false)"
      ]
    },
    {
      "id": "S6_RemovingByIndex",
      "label": "removing_by_index",
      "type": "atomic",
      "entry_actions": [
        "checkBusy()",
        "setBusy(true)",
        "readIndex('#indexInput')",
        "log('Removing by index: walk and remove')",
        "animateWalkToIndex(index)"
      ],
      "exit_actions": [
        "render([], {removedIndex: index})",
        "sleep(360)",
        "list.removeAt(index)",
        "render()",
        "setBusy(false)"
      ]
    },
    {
      "id": "S7_Searching",
      "label": "searching",
      "type": "atomic",
      "entry_actions": [
        "checkBusy()",
        "setBusy(true)",
        "readValue('#valueInput')",
        "log('Searching: highlight walk')",
        "animateHighlightWalk(value)"
      ],
      "exit_actions": [
        "render()",
        "setBusy(false)"
      ]
    },
    {
      "id": "S8_Reversing",
      "label": "reversing",
      "type": "atomic",
      "entry_actions": [
        "checkBusy()",
        "setBusy(true)",
        "log('Reversing list')",
        "animateSequentialHighlight()"
      ],
      "exit_actions": [
        "list.reverse()",
        "render()",
        "sleep(360)",
        "setBusy(false)"
      ]
    },
    {
      "id": "S9_Clearing_Confirm",
      "label": "clearing_confirm",
      "type": "atomic",
      "entry_actions": [
        "checkBusy()",
        "setBusy(true)",
        "log('Clear requested')",
        "promptConfirm('Clear the entire list?')"
      ],
      "exit_actions": []
    },
    {
      "id": "S10_Clearing_Animating",
      "label": "clearing_animating",
      "type": "atomic",
      "entry_actions": [
        "animateFadeOutAllNodes()",
        "log('Clearing list: animating removal')"
      ],
      "exit_actions": [
        "list.clear()",
        "render()",
        "setBusy(false)"
      ]
    },
    {
      "id": "S11_AlertShown",
      "label": "alert_shown",
      "type": "atomic",
      "entry_actions": [
        "showAlert(message)"
      ],
      "exit_actions": [
        "dismissAlert()",
        "setBusy(false)",
        "render()"
      ]
    },
    {
      "id": "S12_BusyBlocked",
      "label": "busy_blocked",
      "type": "atomic",
      "entry_actions": [
        "noop()"
      ],
      "exit_actions": []
    }
  ],
  "events": [
    {
      "id": "CLICK_PREPEND",
      "event_type": "user_action",
      "description": "User clicks Add Head (prepend) button",
      "triggers": "#prependBtn"
    },
    {
      "id": "CLICK_APPEND",
      "event_type": "user_action",
      "description": "User clicks Add Tail (append) button",
      "triggers": "#appendBtn"
    },
    {
      "id": "CLICK_INSERT",
      "event_type": "user_action",
      "description": "User clicks Insert @ Index button",
      "triggers": "#insertBtn"
    },
    {
      "id": "CLICK_REMOVE_VALUE",
      "event_type": "user_action",
      "description": "User clicks Remove Value button (remove first occurrence)",
      "triggers": "#removeValueBtn"
    },
    {
      "id": "CLICK_REMOVE_INDEX",
      "event_type": "user_action",
      "description": "User clicks Remove Index button",
      "triggers": "#removeIndexBtn"
    },
    {
      "id": "CLICK_SEARCH",
      "event_type": "user_action",
      "description": "User clicks Search button",
      "triggers": "#searchBtn"
    },
    {
      "id": "CLICK_REVERSE",
      "event_type": "user_action",
      "description": "User clicks Reverse button",
      "triggers": "#reverseBtn"
    },
    {
      "id": "CLICK_CLEAR",
      "event_type": "user_action",
      "description": "User clicks Clear button (triggers confirm dialog)",
      "triggers": "#clearBtn"
    },
    {
      "id": "KEY_ENTER_ON_VALUE",
      "event_type": "user_action",
      "description": "User presses Enter while focus is on value input (triggers append)",
      "triggers": "#valueInput"
    },
    {
      "id": "INPUT_EMPTY_ALERT_DISPATCHED",
      "event_type": "system_event",
      "description": "A browser alert('Enter a value') is shown because value input is empty",
      "triggers": "#valueInput,#prependBtn,#appendBtn,#insertBtn,#removeValueBtn,#searchBtn"
    },
    {
      "id": "INPUT_INVALID_INDEX_ALERT",
      "event_type": "system_event",
      "description": "A browser alert shown for invalid index input",
      "triggers": "#indexInput,#removeIndexBtn"
    },
    {
      "id": "SEARCH_NOT_FOUND",
      "event_type": "system_event",
      "description": "Search walk completed and value was not found",
      "triggers": "#searchBtn,#removeValueBtn"
    },
    {
      "id": "CLEAR_CONFIRMED",
      "event_type": "system_event",
      "description": "User confirmed the clear() confirm dialog",
      "triggers": "#clearBtn"
    },
    {
      "id": "CLEAR_CANCELLED",
      "event_type": "system_event",
      "description": "User cancelled the clear() confirm dialog",
      "triggers": "#clearBtn"
    },
    {
      "id": "OPERATION_COMPLETE",
      "event_type": "system_event",
      "description": "An operation's animations and data updates complete",
      "triggers": "#canvas,#visualArea"
    }
  ],
  "transitions": [
    {
      "from": "S0_Idle",
      "to": "S1_Prepending",
      "event": "CLICK_PREPEND",
      "guard": "valueNotEmpty && !busy",
      "actions": [
        "setBusy(true)",
        "captureValue('#valueInput')",
        "log('Inserting \"{value}\" at head')",
        "animateHeadHighlight()"
      ],
      "expected_observables": [
        "dom:#prependBtn.click",
        "dom:#valueInput.value"
      ],
      "timeout": 3000
    },
    {
      "from": "S1_Prepending",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "true",
      "actions": [
        "list.prepend(value)",
        "render()",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:.node.new",
        "dom:#sizeBadge.text"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S2_Appending",
      "event": "CLICK_APPEND",
      "guard": "valueNotEmpty && !busy",
      "actions": [
        "setBusy(true)",
        "captureValue('#valueInput')",
        "log('Appending \"{value}\" to tail')",
        "animateWalkToTail()"
      ],
      "expected_observables": [
        "dom:#appendBtn.click",
        "dom:#valueInput.value"
      ],
      "timeout": 4000
    },
    {
      "from": "S0_Idle",
      "to": "S2_Appending",
      "event": "KEY_ENTER_ON_VALUE",
      "guard": "valueNotEmpty && !busy && key===Enter",
      "actions": [
        "trigger('#appendBtn')",
        "setBusy(true)"
      ],
      "expected_observables": [
        "dom:#valueInput.keydown.Enter"
      ],
      "timeout": 4000
    },
    {
      "from": "S2_Appending",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "true",
      "actions": [
        "list.append(value)",
        "render()",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:.node.new",
        "dom:#sizeBadge.text"
      ],
      "timeout": 3000
    },
    {
      "from": "S0_Idle",
      "to": "S3_InsertingAtIndex",
      "event": "CLICK_INSERT",
      "guard": "valueNotEmpty && !busy",
      "actions": [
        "setBusy(true)",
        "captureValue('#valueInput')",
        "captureIndex('#indexInput')",
        "log('Inserting \"{value}\" at index {index}')",
        "animateWalkToInsertionPoint(index)"
      ],
      "expected_observables": [
        "dom:#insertBtn.click",
        "dom:#indexInput.value",
        "dom:#valueInput.value"
      ],
      "timeout": 4500
    },
    {
      "from": "S3_InsertingAtIndex",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "true",
      "actions": [
        "list.insertAt(value,index)",
        "render()",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:.node.new",
        "dom:#sizeBadge.text"
      ],
      "timeout": 3000
    },
    {
      "from": "S0_Idle",
      "to": "S4_RemovingByValue_Walking",
      "event": "CLICK_REMOVE_VALUE",
      "guard": "valueNotEmpty && !busy",
      "actions": [
        "setBusy(true)",
        "captureValue('#valueInput')",
        "log('Removing first occurrence of \"{value}\"')",
        "animateHighlightWalk(value)"
      ],
      "expected_observables": [
        "dom:#removeValueBtn.click",
        "dom:#valueInput.value"
      ],
      "timeout": 5000
    },
    {
      "from": "S4_RemovingByValue_Walking",
      "to": "S5_RemovingByValue_Removing",
      "event": "SEARCH_FOUND",
      "guard": "indexFound>=0",
      "actions": [
        "render([], {removedIndex: indexFound})",
        "sleep(400)",
        "log('Animating removal at index {indexFound}')"
      ],
      "expected_observables": [
        "dom:.node.removed",
        "dom:#log"
      ],
      "timeout": 2000
    },
    {
      "from": "S4_RemovingByValue_Walking",
      "to": "S11_AlertShown",
      "event": "SEARCH_NOT_FOUND",
      "guard": "true",
      "actions": [
        "log('Value \"{value}\" not found')",
        "alert('Value not found')"
      ],
      "expected_observables": [
        "dom:#removeValueBtn.click",
        "dom:#log"
      ],
      "timeout": 2000
    },
    {
      "from": "S5_RemovingByValue_Removing",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "true",
      "actions": [
        "list.removeAt(indexFound)",
        "render()",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:.node.removed",
        "dom:#sizeBadge.text"
      ],
      "timeout": 2500
    },
    {
      "from": "S0_Idle",
      "to": "S6_RemovingByIndex",
      "event": "CLICK_REMOVE_INDEX",
      "guard": "!busy && list.size>0 && indexValid('#indexInput')",
      "actions": [
        "setBusy(true)",
        "captureIndex('#indexInput')",
        "log('Removing node at index {index}')",
        "animateWalkToIndex(index)"
      ],
      "expected_observables": [
        "dom:#removeIndexBtn.click",
        "dom:#indexInput.value"
      ],
      "timeout": 4000
    },
    {
      "from": "S6_RemovingByIndex",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "true",
      "actions": [
        "render([], {removedIndex: index})",
        "sleep(360)",
        "list.removeAt(index)",
        "render()",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:.node.removed",
        "dom:#sizeBadge.text"
      ],
      "timeout": 3000
    },
    {
      "from": "S0_Idle",
      "to": "S7_Searching",
      "event": "CLICK_SEARCH",
      "guard": "valueNotEmpty && !busy",
      "actions": [
        "setBusy(true)",
        "captureValue('#valueInput')",
        "log('Searching for \"{value}\"')",
        "animateHighlightWalk(value)"
      ],
      "expected_observables": [
        "dom:#searchBtn.click",
        "dom:#valueInput.value"
      ],
      "timeout": 6000
    },
    {
      "from": "S7_Searching",
      "to": "S11_AlertShown",
      "event": "SEARCH_NOT_FOUND",
      "guard": "true",
      "actions": [
        "alert('Not found')",
        "log('Search completed: not found')"
      ],
      "expected_observables": [
        "dom:#searchBtn.click",
        "dom:#log"
      ],
      "timeout": 2000
    },
    {
      "from": "S7_Searching",
      "to": "S0_Idle",
      "event": "SEARCH_FOUND",
      "guard": "indexFound>=0",
      "actions": [
        "render([], {matchIndex: indexFound})",
        "alert('Found at index ' + indexFound)",
        "log('Found value at index ' + indexFound)",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:.node.match",
        "dom:#log"
      ],
      "timeout": 3000
    },
    {
      "from": "S0_Idle",
      "to": "S8_Reversing",
      "event": "CLICK_REVERSE",
      "guard": "!busy && list.size>1",
      "actions": [
        "setBusy(true)",
        "log('Reversing list')",
        "animateSequentialHighlight()"
      ],
      "expected_observables": [
        "dom:#reverseBtn.click",
        "dom:.node.highlight"
      ],
      "timeout": 5000
    },
    {
      "from": "S8_Reversing",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "true",
      "actions": [
        "list.reverse()",
        "render()",
        "sleep(360)",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:#sizeBadge.text",
        "dom:#canvas"
      ],
      "timeout": 3000
    },
    {
      "from": "S0_Idle",
      "to": "S9_Clearing_Confirm",
      "event": "CLICK_CLEAR",
      "guard": "!busy",
      "actions": [
        "setBusy(true)",
        "log('Clear requested')",
        "promptConfirm('Clear the entire list?')"
      ],
      "expected_observables": [
        "dom:#clearBtn.click"
      ],
      "timeout": 2000
    },
    {
      "from": "S9_Clearing_Confirm",
      "to": "S10_Clearing_Animating",
      "event": "CLEAR_CONFIRMED",
      "guard": "true",
      "actions": [
        "log('Clear confirmed')",
        "animateFadeOutAllNodes()"
      ],
      "expected_observables": [
        "dom:#clearBtn.click",
        "dom:.node.removed"
      ],
      "timeout": 4000
    },
    {
      "from": "S9_Clearing_Confirm",
      "to": "S0_Idle",
      "event": "CLEAR_CANCELLED",
      "guard": "true",
      "actions": [
        "log('Clear cancelled')",
        "setBusy(false)",
        "render()"
      ],
      "expected_observables": [
        "dom:#clearBtn.click"
      ],
      "timeout": 1000
    },
    {
      "from": "S10_Clearing_Animating",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "true",
      "actions": [
        "list.clear()",
        "render()",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:#canvas",
        "dom:#sizeBadge.text"
      ],
      "timeout": 4000
    },
    {
      "from": "S0_Idle",
      "to": "S11_AlertShown",
      "event": "INPUT_EMPTY_ALERT_DISPATCHED",
      "guard": "valueEmpty",
      "actions": [
        "alert('Enter a value')",
        "log('Input empty alert shown')"
      ],
      "expected_observables": [
        "dom:#valueInput",
        "dom:#log"
      ],
      "timeout": 1000
    },
    {
      "from": "S11_AlertShown",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "true",
      "actions": [
        "dismissAlert()",
        "render()",
        "setBusy(false)"
      ],
      "expected_observables": [
        "dom:#log"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S12_BusyBlocked",
      "event": "ANY_WHILE_BUSY",
      "guard": "busy",
      "actions": [
        "ignoreInput()",
        "log('Input ignored while busy')"
      ],
      "expected_observables": [
        "dom:#prependBtn.click, dom:#appendBtn.click, dom:#insertBtn.click, dom:#removeValueBtn.click, dom:#removeIndexBtn.click, dom:#searchBtn.click, dom:#reverseBtn.click, dom:#clearBtn.click, dom:#valueInput.keydown"
      ],
      "timeout": 500
    },
    {
      "from": "S12_BusyBlocked",
      "to": "S0_Idle",
      "event": "OPERATION_COMPLETE",
      "guard": "busy===false",
      "actions": [
        "render()"
      ],
      "expected_observables": [
        "dom:#canvas"
      ],
      "timeout": 100
    }
  ],
  "components": [
    "#valueInput",
    "#indexInput",
    "#prependBtn",
    "#appendBtn",
    "#insertBtn",
    "#removeValueBtn",
    "#removeIndexBtn",
    "#searchBtn",
    "#reverseBtn",
    "#clearBtn",
    "#visualArea",
    "#canvas",
    "#arrowLayer",
    "#sizeBadge",
    "#log",
    ".node",
    ".node.new",
    ".node.removed",
    ".node.match",
    ".node.highlight",
    "button.secondary",
    "button.warn",
    ".controls",
    ".visual",
    ".app",
    ".row"
  ]
}