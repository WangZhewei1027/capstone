{
  "meta": {
    "concept": "Array",
    "topic": "Array Explorer Interactive Demo",
    "educational_goal": "Demonstrate common JavaScript Array operations (mutating and non-mutating), input parsing, prompts/confirms, and visual updates",
    "expected_interactions": [
      "push",
      "unshift",
      "pop",
      "shift",
      "splice",
      "clear",
      "reset",
      "access",
      "indexOf",
      "includes",
      "find",
      "map",
      "filter",
      "reduce",
      "forEach",
      "sort",
      "reverse",
      "concat",
      "slice",
      "flat",
      "typed",
      "runExpression",
      "clearLog (Ctrl+L)"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "idle",
      "type": "idle",
      "entry_actions": [
        "renderArray()",
        "enableUI()",
        "attachKeyboardShortcuts()"
      ],
      "exit_actions": [
        "disableTransientUI()"
      ]
    },
    {
      "id": "S1_ReadInput",
      "label": "read_input",
      "type": "atomic",
      "entry_actions": [
        "readInput('#newValue')",
        "parseInputValue()"
      ],
      "exit_actions": []
    },
    {
      "id": "S2_MutatingOperation",
      "label": "mutating_operation",
      "type": "atomic",
      "entry_actions": [
        "applyMutationToArr()",
        "logMutation()"
      ],
      "exit_actions": [
        "markArrayChanged()"
      ]
    },
    {
      "id": "S3_NonMutatingOperation",
      "label": "non_mutating_operation",
      "type": "atomic",
      "entry_actions": [
        "computeResult()",
        "logResult()"
      ],
      "exit_actions": []
    },
    {
      "id": "S4_ConfirmReplace",
      "label": "awaiting_confirm_replace",
      "type": "atomic",
      "entry_actions": [
        "showConfirmDialog()"
      ],
      "exit_actions": [
        "closeConfirmDialog()"
      ]
    },
    {
      "id": "S5_PromptOpen",
      "label": "prompt_open",
      "type": "atomic",
      "entry_actions": [
        "openPrompt()"
      ],
      "exit_actions": [
        "closePrompt()"
      ]
    },
    {
      "id": "S6_Rendering",
      "label": "rendering",
      "type": "atomic",
      "entry_actions": [
        "renderArray()",
        "updateDOM('#arrayBox')",
        "updateLog('#log')"
      ],
      "exit_actions": []
    },
    {
      "id": "S7_ExpressionEval",
      "label": "expression_evaluation",
      "type": "atomic",
      "entry_actions": [
        "evaluateExpression('#expr')",
        "logEvaluation()"
      ],
      "exit_actions": []
    },
    {
      "id": "S8_LogCleared",
      "label": "log_cleared",
      "type": "atomic",
      "entry_actions": [
        "clearLog('#log')",
        "log('Log cleared')"
      ],
      "exit_actions": []
    },
    {
      "id": "S9_SpliceFlow",
      "label": "splice_flow",
      "type": "atomic",
      "entry_actions": [
        "promptSpliceParams()"
      ],
      "exit_actions": []
    },
    {
      "id": "S10_ReduceFlow",
      "label": "reduce_flow",
      "type": "atomic",
      "entry_actions": [
        "promptReducerAndInit()"
      ],
      "exit_actions": []
    },
    {
      "id": "S11_FindFlow",
      "label": "find_flow",
      "type": "atomic",
      "entry_actions": [
        "promptPredicate()"
      ],
      "exit_actions": []
    }
  ],
  "events": [
    {
      "id": "USER_CLICK_PUSH",
      "event_type": "user_action",
      "description": "User clicks the Push button (#pushBtn)"
    },
    {
      "id": "USER_CLICK_UNSHIFT",
      "event_type": "user_action",
      "description": "User clicks the Unshift button (#unshiftBtn)"
    },
    {
      "id": "USER_CLICK_POP",
      "event_type": "user_action",
      "description": "User clicks the pop button (#popBtn)"
    },
    {
      "id": "USER_CLICK_SHIFT",
      "event_type": "user_action",
      "description": "User clicks the shift button (#shiftBtn)"
    },
    {
      "id": "USER_CLICK_SPLICE",
      "event_type": "user_action",
      "description": "User clicks the splice button (#spliceBtn)"
    },
    {
      "id": "USER_CLICK_CLEAR",
      "event_type": "user_action",
      "description": "User clicks the Clear button (#clearBtn)"
    },
    {
      "id": "USER_CLICK_RESET",
      "event_type": "user_action",
      "description": "User clicks the Reset button (#resetBtn)"
    },
    {
      "id": "USER_CLICK_ACCESS_INDEX",
      "event_type": "user_action",
      "description": "User clicks Access by index (#accessIndexBtn)"
    },
    {
      "id": "USER_CLICK_INDEXOF",
      "event_type": "user_action",
      "description": "User clicks indexOf (#indexOfBtn)"
    },
    {
      "id": "USER_CLICK_INCLUDES",
      "event_type": "user_action",
      "description": "User clicks includes (#includesBtn)"
    },
    {
      "id": "USER_CLICK_FIND",
      "event_type": "user_action",
      "description": "User clicks find (#findBtn)"
    },
    {
      "id": "USER_CLICK_MAP",
      "event_type": "user_action",
      "description": "User clicks map (#mapBtn)"
    },
    {
      "id": "USER_CLICK_FILTER",
      "event_type": "user_action",
      "description": "User clicks filter (#filterBtn)"
    },
    {
      "id": "USER_CLICK_REDUCE",
      "event_type": "user_action",
      "description": "User clicks reduce (#reduceBtn)"
    },
    {
      "id": "USER_CLICK_FOREACH",
      "event_type": "user_action",
      "description": "User clicks forEach (#forEachBtn)"
    },
    {
      "id": "USER_CLICK_SORT",
      "event_type": "user_action",
      "description": "User clicks sort (#sortBtn)"
    },
    {
      "id": "USER_CLICK_REVERSE",
      "event_type": "user_action",
      "description": "User clicks reverse (#reverseBtn)"
    },
    {
      "id": "USER_CLICK_CONCAT",
      "event_type": "user_action",
      "description": "User clicks concat (#concatBtn)"
    },
    {
      "id": "USER_CLICK_SLICE",
      "event_type": "user_action",
      "description": "User clicks slice (#sliceBtn)"
    },
    {
      "id": "USER_CLICK_FLAT",
      "event_type": "user_action",
      "description": "User clicks flat (#flatBtn)"
    },
    {
      "id": "USER_CLICK_TYPED",
      "event_type": "user_action",
      "description": "User clicks TypedArray (#typedBtn)"
    },
    {
      "id": "USER_CLICK_RUN_EXPR",
      "event_type": "user_action",
      "description": "User clicks Run expression (#runExpr)"
    },
    {
      "id": "USER_PRESS_CTRL_L",
      "event_type": "user_action",
      "description": "User presses Ctrl+L or Cmd+L to clear the log (window keydown)"
    },
    {
      "id": "PROMPT_SUBMIT",
      "event_type": "user_action",
      "description": "User submits a browser prompt (result returned)"
    },
    {
      "id": "PROMPT_CANCEL",
      "event_type": "user_action",
      "description": "User cancels a browser prompt (null returned)"
    },
    {
      "id": "CONFIRM_YES",
      "event_type": "user_action",
      "description": "User accepted a confirm dialog (true)"
    },
    {
      "id": "CONFIRM_NO",
      "event_type": "user_action",
      "description": "User declined a confirm dialog (false)"
    },
    {
      "id": "EXPRESSION_EVALUATED",
      "event_type": "system_event",
      "description": "Expression evaluated via new Function / eval"
    },
    {
      "id": "ARRAY_MUTATED",
      "event_type": "system_event",
      "description": "Array was mutated (push/pop/shift/splice/sort/reverse/concat replacement/flat replacement/reset/clear)"
    },
    {
      "id": "RENDER_COMPLETE",
      "event_type": "system_event",
      "description": "renderArray() completed and DOM updated (#arrayBox)"
    },
    {
      "id": "LOG_CLEARED",
      "event_type": "system_event",
      "description": "Log cleared (#log)"
    },
    {
      "id": "INIT_COMPLETE",
      "event_type": "system_event",
      "description": "Demo initialized and initial render/log done"
    }
  ],
  "transitions": [
    {
      "from": "S0_Idle",
      "to": "S1_ReadInput",
      "event": "USER_CLICK_PUSH",
      "guard": "newValueInput not empty",
      "actions": [
        "parseInputValue('#newValue')",
        "log('push(', parsedValue, ')')"
      ],
      "triggers": "#pushBtn",
      "expected_observables": [
        "dom:#pushBtn clicked",
        "dom:#newValue value read"
      ],
      "timeout": 2000
    },
    {
      "from": "S1_ReadInput",
      "to": "S2_MutatingOperation",
      "event": "ARRAY_MUTATED",
      "guard": "true",
      "actions": [
        "window.arr.push(parsedValue)",
        "clearInput('#newValue')"
      ],
      "triggers": "#pushBtn",
      "expected_observables": [
        "dom:#arrayBox updated",
        "dom:#newValue value cleared"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S1_ReadInput",
      "event": "USER_CLICK_UNSHIFT",
      "guard": "newValueInput not empty",
      "actions": [
        "parseInputValue('#newValue')",
        "log('unshift(', parsedValue, ')')"
      ],
      "triggers": "#unshiftBtn",
      "expected_observables": [
        "dom:#unshiftBtn clicked",
        "dom:#newValue value read"
      ],
      "timeout": 2000
    },
    {
      "from": "S1_ReadInput",
      "to": "S2_MutatingOperation",
      "event": "ARRAY_MUTATED",
      "guard": "true",
      "actions": [
        "window.arr.unshift(parsedValue)",
        "clearInput('#newValue')"
      ],
      "triggers": "#unshiftBtn",
      "expected_observables": [
        "dom:#arrayBox updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S2_MutatingOperation",
      "event": "USER_CLICK_POP",
      "guard": "arrayNotEmpty",
      "actions": [
        "const v = window.arr.pop()",
        "log('pop() ->', v)"
      ],
      "triggers": "#popBtn",
      "expected_observables": [
        "dom:#popBtn clicked",
        "dom:#arrayBox updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S2_MutatingOperation",
      "to": "S6_Rendering",
      "event": "ARRAY_MUTATED",
      "guard": "true",
      "actions": [
        "renderArray()"
      ],
      "triggers": "#popBtn",
      "expected_observables": [
        "dom:#arrayBox updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S2_MutatingOperation",
      "event": "USER_CLICK_SHIFT",
      "guard": "arrayNotEmpty",
      "actions": [
        "const v = window.arr.shift()",
        "log('shift() ->', v)"
      ],
      "triggers": "#shiftBtn",
      "expected_observables": [
        "dom:#shiftBtn clicked",
        "dom:#arrayBox updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S9_SpliceFlow",
      "event": "USER_CLICK_SPLICE",
      "guard": "true",
      "actions": [
        "prompt('Start index (number):', '1')",
        "prompt('Delete count (number):', '1')",
        "prompt('Optional new element to insert (leave empty for none):', '')"
      ],
      "triggers": "#spliceBtn",
      "expected_observables": [
        "dom:#spliceBtn clicked",
        "dom:browser prompt shown"
      ],
      "timeout": 60000
    },
    {
      "from": "S9_SpliceFlow",
      "to": "S2_MutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "user provided start and count (or empty allowed)",
      "actions": [
        "window.arr.splice(startIndex, deleteCount, optionalValueIfAny)",
        "log('splice(' + args.join(', ') + ') removed ->', removed, 'now ->', window.arr)"
      ],
      "triggers": "#spliceBtn",
      "expected_observables": [
        "dom:#arrayBox updated",
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S9_SpliceFlow",
      "to": "S0_Idle",
      "event": "PROMPT_CANCEL",
      "guard": "true",
      "actions": [
        "log('splice canceled')"
      ],
      "triggers": "#spliceBtn",
      "expected_observables": [
        "dom:prompt canceled"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S2_MutatingOperation",
      "event": "USER_CLICK_CLEAR",
      "guard": "true",
      "actions": [
        "log('Clearing array (arr.length = 0)')",
        "window.arr.length = 0"
      ],
      "triggers": "#clearBtn",
      "expected_observables": [
        "dom:#clearBtn clicked",
        "dom:#arrayBox shows '(empty array)'"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S2_MutatingOperation",
      "event": "USER_CLICK_RESET",
      "guard": "true",
      "actions": [
        "window.arr = initial.slice()",
        "log('Reset to initial array ->', window.arr)"
      ],
      "triggers": "#resetBtn",
      "expected_observables": [
        "dom:#resetBtn clicked",
        "dom:#arrayBox updated to initial"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S5_PromptOpen",
      "event": "USER_CLICK_ACCESS_INDEX",
      "guard": "true",
      "actions": [
        "prompt('Index to access:', '2')"
      ],
      "triggers": "#accessIndexBtn",
      "expected_observables": [
        "dom:#accessIndexBtn clicked",
        "dom:prompt shown"
      ],
      "timeout": 30000
    },
    {
      "from": "S5_PromptOpen",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "index provided",
      "actions": [
        "log('arr[' + i + '] ->', window.arr[i])"
      ],
      "triggers": "#accessIndexBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S5_PromptOpen",
      "to": "S0_Idle",
      "event": "PROMPT_CANCEL",
      "guard": "true",
      "actions": [
        "log('access canceled')"
      ],
      "triggers": "#accessIndexBtn",
      "expected_observables": [
        "dom:prompt canceled"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S5_PromptOpen",
      "event": "USER_CLICK_INDEXOF",
      "guard": "true",
      "actions": [
        "prompt('Value to find indexOf (use JSON literal if needed):', '7')"
      ],
      "triggers": "#indexOfBtn",
      "expected_observables": [
        "dom:#indexOfBtn clicked"
      ],
      "timeout": 30000
    },
    {
      "from": "S5_PromptOpen",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "true",
      "actions": [
        "parsed = parseInputValue(promptValue)",
        "idx = window.arr.indexOf(parsed)",
        "log('indexOf(', parsed, ') ->', idx)"
      ],
      "triggers": "#indexOfBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S5_PromptOpen",
      "event": "USER_CLICK_INCLUDES",
      "guard": "true",
      "actions": [
        "prompt('Value to includes (use JSON literal if needed):', '7')"
      ],
      "triggers": "#includesBtn",
      "expected_observables": [
        "dom:#includesBtn clicked"
      ],
      "timeout": 30000
    },
    {
      "from": "S5_PromptOpen",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "true",
      "actions": [
        "parsed = parseInputValue(promptValue)",
        "inc = window.arr.includes(parsed)",
        "log('includes(', parsed, ') ->', inc)"
      ],
      "triggers": "#includesBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S11_FindFlow",
      "event": "USER_CLICK_FIND",
      "guard": "true",
      "actions": [
        "prompt('Enter predicate using \"x\" for element (e.g. x => x>5):', 'x => x > 5')"
      ],
      "triggers": "#findBtn",
      "expected_observables": [
        "dom:#findBtn clicked",
        "dom:prompt shown"
      ],
      "timeout": 30000
    },
    {
      "from": "S11_FindFlow",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "predicateProvided",
      "actions": [
        "fn = eval('(' + expr + ')')",
        "found = window.arr.find(fn)",
        "log('find(', expr, ') ->', found)"
      ],
      "triggers": "#findBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S11_FindFlow",
      "to": "S0_Idle",
      "event": "PROMPT_CANCEL",
      "guard": "true",
      "actions": [
        "log('find canceled')"
      ],
      "triggers": "#findBtn",
      "expected_observables": [
        "dom:prompt canceled"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S3_NonMutatingOperation",
      "event": "USER_CLICK_MAP",
      "guard": "true",
      "actions": [
        "mapped = window.arr.map(x => (typeof x === 'number' ? x * 2 : x))",
        "log('map: doubled numbers ->', mapped)"
      ],
      "triggers": "#mapBtn",
      "expected_observables": [
        "dom:#mapBtn clicked",
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S3_NonMutatingOperation",
      "to": "S4_ConfirmReplace",
      "event": "CONFIRM_REQUIRED",
      "guard": "operationReturnedArray",
      "actions": [
        "askUserToConfirmReplace()"
      ],
      "triggers": "#mapBtn",
      "expected_observables": [
        "dom:confirm shown"
      ],
      "timeout": 60000
    },
    {
      "from": "S4_ConfirmReplace",
      "to": "S2_MutatingOperation",
      "event": "CONFIRM_YES",
      "guard": "true",
      "actions": [
        "window.arr = mapped",
        "log('Replaced current array.')"
      ],
      "triggers": "#mapBtn, #filterBtn, #concatBtn, #flatBtn, #runExpr",
      "expected_observables": [
        "dom:#arrayBox updated",
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S4_ConfirmReplace",
      "to": "S6_Rendering",
      "event": "CONFIRM_NO",
      "guard": "true",
      "actions": [
        "log('User declined to replace array')"
      ],
      "triggers": "#mapBtn, #filterBtn, #concatBtn, #flatBtn, #runExpr",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S5_PromptOpen",
      "event": "USER_CLICK_FILTER",
      "guard": "true",
      "actions": [
        "prompt('Enter predicate using \"x\" (e.g. x => x % 2 === 1):', 'x => typeof x === \"number\" && x % 2 === 1')"
      ],
      "triggers": "#filterBtn",
      "expected_observables": [
        "dom:#filterBtn clicked"
      ],
      "timeout": 30000
    },
    {
      "from": "S5_PromptOpen",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "predicateProvided",
      "actions": [
        "fn = eval('(' + expr + ')')",
        "filtered = window.arr.filter(fn)",
        "log('filter(', expr, ') ->', filtered)"
      ],
      "triggers": "#filterBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S10_ReduceFlow",
      "event": "USER_CLICK_REDUCE",
      "guard": "true",
      "actions": [
        "prompt('Enter reducer using (acc, x) (e.g. (acc, x) => acc + x):', '(acc, x) => acc + x')",
        "prompt('Initial value (JSON), leave empty for 0:', '0')"
      ],
      "triggers": "#reduceBtn",
      "expected_observables": [
        "dom:#reduceBtn clicked"
      ],
      "timeout": 60000
    },
    {
      "from": "S10_ReduceFlow",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "reducerProvided",
      "actions": [
        "fn = eval('(' + expr + ')')",
        "result = initVal === undefined ? window.arr.reduce(fn) : window.arr.reduce(fn, initVal)",
        "log('reduce ->', result)"
      ],
      "triggers": "#reduceBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S3_NonMutatingOperation",
      "event": "USER_CLICK_FOREACH",
      "guard": "true",
      "actions": [
        "log('forEach output:')",
        "window.arr.forEach((x,i) => log('  ['+i+']', x))"
      ],
      "triggers": "#forEachBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S2_MutatingOperation",
      "event": "USER_CLICK_SORT",
      "guard": "true",
      "actions": [
        "if(confirm('Sort numerically if possible? (Cancel for default lexicographic)')) { window.arr.sort(numericComparator) } else { window.arr.sort() }",
        "log('arr sorted ->', window.arr)"
      ],
      "triggers": "#sortBtn",
      "expected_observables": [
        "dom:#sortBtn clicked",
        "dom:confirm shown",
        "dom:#arrayBox updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S2_MutatingOperation",
      "event": "USER_CLICK_REVERSE",
      "guard": "true",
      "actions": [
        "window.arr.reverse()",
        "log('arr reversed ->', window.arr)"
      ],
      "triggers": "#reverseBtn",
      "expected_observables": [
        "dom:#reverseBtn clicked",
        "dom:#arrayBox updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S5_PromptOpen",
      "event": "USER_CLICK_CONCAT",
      "guard": "true",
      "actions": [
        "prompt('Array or value to concat (JSON literal recommended):', '[100,200]')"
      ],
      "triggers": "#concatBtn",
      "expected_observables": [
        "dom:#concatBtn clicked"
      ],
      "timeout": 30000
    },
    {
      "from": "S5_PromptOpen",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "true",
      "actions": [
        "parsed = parseInputValue(promptValue)",
        "result = window.arr.concat(parsed)",
        "log('concat(', parsed, ') ->', result)"
      ],
      "triggers": "#concatBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S3_NonMutatingOperation",
      "to": "S4_ConfirmReplace",
      "event": "CONFIRM_REQUIRED",
      "guard": "resultIsArray",
      "actions": [
        "askUserToConfirmReplace()"
      ],
      "triggers": "#concatBtn",
      "expected_observables": [
        "dom:confirm shown"
      ],
      "timeout": 60000
    },
    {
      "from": "S0_Idle",
      "to": "S5_PromptOpen",
      "event": "USER_CLICK_SLICE",
      "guard": "true",
      "actions": [
        "prompt('slice start (number or empty):','0')",
        "prompt('slice end (number or empty):','2')"
      ],
      "triggers": "#sliceBtn",
      "expected_observables": [
        "dom:#sliceBtn clicked"
      ],
      "timeout": 60000
    },
    {
      "from": "S5_PromptOpen",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "true",
      "actions": [
        "start = a === '' ? undefined : Number(a)",
        "end = b === '' ? undefined : Number(b)",
        "result = window.arr.slice(start, end)",
        "log('slice(', start, ',', end, ') ->', result)"
      ],
      "triggers": "#sliceBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S5_PromptOpen",
      "event": "USER_CLICK_FLAT",
      "guard": "true",
      "actions": [
        "prompt('Depth (number) default 1:', '1')"
      ],
      "triggers": "#flatBtn",
      "expected_observables": [
        "dom:#flatBtn clicked"
      ],
      "timeout": 30000
    },
    {
      "from": "S5_PromptOpen",
      "to": "S3_NonMutatingOperation",
      "event": "PROMPT_SUBMIT",
      "guard": "true",
      "actions": [
        "d = Number(depthRaw)",
        "result = window.arr.flat(d)",
        "log('flat(' + d + ') ->', result)"
      ],
      "triggers": "#flatBtn",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S3_NonMutatingOperation",
      "to": "S4_ConfirmReplace",
      "event": "CONFIRM_REQUIRED",
      "guard": "resultIsArray",
      "actions": [
        "askUserToConfirmReplace()"
      ],
      "triggers": "#flatBtn",
      "expected_observables": [
        "dom:confirm shown"
      ],
      "timeout": 60000
    },
    {
      "from": "S0_Idle",
      "to": "S3_NonMutatingOperation",
      "event": "USER_CLICK_TYPED",
      "guard": "arrayHasNumericElements",
      "actions": [
        "nums = window.arr.filter(x => typeof x === 'number').map(Number)",
        "ta = new Int16Array(nums)",
        "log('Created Int16Array from numeric elements ->', Array.from(ta))"
      ],
      "triggers": "#typedBtn",
      "expected_observables": [
        "dom:#typedBtn clicked",
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S7_ExpressionEval",
      "event": "USER_CLICK_RUN_EXPR",
      "guard": "expr not empty",
      "actions": [
        "evaluateExpression('#expr')",
        "log('Expression result ->', res)"
      ],
      "triggers": "#runExpr, #expr",
      "expected_observables": [
        "dom:#runExpr clicked",
        "dom:#expr value read"
      ],
      "timeout": 3000
    },
    {
      "from": "S7_ExpressionEval",
      "to": "S4_ConfirmReplace",
      "event": "EXPRESSION_EVALUATED",
      "guard": "resultIsArray",
      "actions": [
        "askUserToConfirmReplace()"
      ],
      "triggers": "#runExpr",
      "expected_observables": [
        "dom:#log updated",
        "dom:confirm shown"
      ],
      "timeout": 60000
    },
    {
      "from": "S7_ExpressionEval",
      "to": "S6_Rendering",
      "event": "EXPRESSION_EVALUATED",
      "guard": "resultNotArrayOrNoReplace",
      "actions": [
        "log('Expression result ->', res)"
      ],
      "triggers": "#runExpr",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S4_ConfirmReplace",
      "to": "S6_Rendering",
      "event": "CONFIRM_NO",
      "guard": "true",
      "actions": [
        "doNotReplace()",
        "log('User chose not to replace array')"
      ],
      "triggers": "#mapBtn, #filterBtn, #concatBtn, #flatBtn, #runExpr",
      "expected_observables": [
        "dom:#log updated"
      ],
      "timeout": 500
    },
    {
      "from": "S6_Rendering",
      "to": "S0_Idle",
      "event": "RENDER_COMPLETE",
      "guard": "true",
      "actions": [
        "enableUI()"
      ],
      "triggers": "#arrayBox",
      "expected_observables": [
        "dom:#arrayBox updated",
        "dom:#log updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S8_LogCleared",
      "event": "USER_PRESS_CTRL_L",
      "guard": "true",
      "actions": [
        "clearLog('#log')",
        "log('Log cleared (Ctrl+L)')"
      ],
      "triggers": "window (keydown: Ctrl+L or Cmd+L)",
      "expected_observables": [
        "dom:#log emptied"
      ],
      "timeout": 500
    },
    {
      "from": "S8_LogCleared",
      "to": "S0_Idle",
      "event": "LOG_CLEARED",
      "guard": "true",
      "actions": [
        "returnToIdleState()"
      ],
      "triggers": "#log",
      "expected_observables": [
        "dom:#log ready"
      ],
      "timeout": 200
    }
  ],
  "components": [
    "#arrayBox",
    "#log",
    "#newValue",
    "#expr",
    "#pushBtn",
    "#unshiftBtn",
    "#popBtn",
    "#shiftBtn",
    "#spliceBtn",
    "#clearBtn",
    "#resetBtn",
    "#accessIndexBtn",
    "#indexOfBtn",
    "#includesBtn",
    "#findBtn",
    "#mapBtn",
    "#filterBtn",
    "#reduceBtn",
    "#forEachBtn",
    "#sortBtn",
    "#reverseBtn",
    "#concatBtn",
    "#sliceBtn",
    "#flatBtn",
    "#typedBtn",
    "#runExpr",
    ".item",
    ".index",
    ".array-box",
    ".small-btn",
    ".muted"
  ]
}