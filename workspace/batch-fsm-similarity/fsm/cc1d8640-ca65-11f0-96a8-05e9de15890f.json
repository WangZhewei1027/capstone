{
  "meta": {
    "concept": "AdjacencyMatrix",
    "topic": "Adjacency Matrix Explorer",
    "educational_goal": "Interactively build and explore graph adjacency matrices: toggle edges, set weights, visualize graph, compute metrics and shortest paths.",
    "expected_interactions": [
      "toggle_cell",
      "toggle_edge_svg",
      "add_node",
      "remove_node",
      "change_node_count",
      "toggle_directed",
      "toggle_weighted",
      "randomize",
      "clear",
      "export_json",
      "import_json",
      "load_sample",
      "check_symmetry",
      "compute_degrees",
      "compute_floyd_warshall"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "idle",
      "type": "idle",
      "entry_actions": [
        "renderMatrixTable()",
        "renderSVG()",
        "updateAdjList()",
        "updateStats()",
        "updateMatrixInfo()",
        "enableControls()"
      ],
      "exit_actions": []
    },
    {
      "id": "S1_CellClicked",
      "label": "cell_clicked",
      "type": "atomic",
      "entry_actions": [
        "readCellCoords(eventTarget)",
        "determineIfWeighted()"
      ],
      "exit_actions": []
    },
    {
      "id": "S2_PromptingWeight",
      "label": "prompting_weight",
      "type": "atomic",
      "entry_actions": [
        "showPromptDialog()",
        "prefillPromptWithCurrentWeight()"
      ],
      "exit_actions": [
        "closePromptDialog()"
      ]
    },
    {
      "id": "S3_TogglingEdge",
      "label": "toggling_edge",
      "type": "atomic",
      "entry_actions": [
        "toggleEdgeValue()",
        "syncUndirectedSymmetryIfNeeded()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S4_AddingNode",
      "label": "adding_node",
      "type": "atomic",
      "entry_actions": [
        "increaseMatrixSizeByOne()",
        "updateNodeCountInput()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S5_RemovingNode",
      "label": "removing_node",
      "type": "atomic",
      "entry_actions": [
        "decreaseMatrixSizeByOne()",
        "updateNodeCountInput()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S6_NodeCountChanging",
      "label": "nodecount_changing",
      "type": "atomic",
      "entry_actions": [
        "validateNodeCountInput()",
        "resizeMatrixToNodeCount()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S7_ToggleDirected",
      "label": "toggle_directed",
      "type": "atomic",
      "entry_actions": [
        "setDirectedFlagFromCheckbox()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S8_ToggleWeighted",
      "label": "toggle_weighted",
      "type": "atomic",
      "entry_actions": [
        "setWeightedFlagFromCheckbox()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S9_Randomizing",
      "label": "randomizing",
      "type": "atomic",
      "entry_actions": [
        "readProbability()",
        "applyRandomEdges(probability)",
        "symmetrizeIfUndirected()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S10_Clearing",
      "label": "clearing",
      "type": "atomic",
      "entry_actions": [
        "setAllMatrixEntriesToZero()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S11_Exporting",
      "label": "exporting",
      "type": "atomic",
      "entry_actions": [
        "serializeMatrixToJSON()",
        "triggerDownload()"
      ],
      "exit_actions": []
    },
    {
      "id": "S12_Importing_FileSelect",
      "label": "importing_file_select",
      "type": "atomic",
      "entry_actions": [
        "openFileInputDialog()"
      ],
      "exit_actions": []
    },
    {
      "id": "S13_Importing_Processing",
      "label": "importing_processing",
      "type": "atomic",
      "entry_actions": [
        "readSelectedFile()",
        "parseAndApplyImportedMatrix()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S14_ImportError",
      "label": "import_error",
      "type": "atomic",
      "entry_actions": [
        "showImportErrorAlert()"
      ],
      "exit_actions": [
        "clearImportError()"
      ]
    },
    {
      "id": "S15_LoadSample",
      "label": "load_sample",
      "type": "atomic",
      "entry_actions": [
        "applySampleMatrix()",
        "setDirectedWeightedFromSample()",
        "updateControlsFromSample()",
        "drawAll()"
      ],
      "exit_actions": []
    },
    {
      "id": "S16_SVGEdgeClicked",
      "label": "svg_edge_clicked",
      "type": "atomic",
      "entry_actions": [
        "identifyEdgeIndexesFromSVGTarget(eventTarget)",
        "determineIfWeighted()"
      ],
      "exit_actions": []
    },
    {
      "id": "S17_Utility_Symmetry",
      "label": "computing_symmetry",
      "type": "atomic",
      "entry_actions": [
        "computeSymmetryMismatches()",
        "renderSymmetryOutput()"
      ],
      "exit_actions": []
    },
    {
      "id": "S18_Utility_Degrees",
      "label": "computing_degrees",
      "type": "atomic",
      "entry_actions": [
        "computeInOutDegrees()",
        "renderDegreesOutput()"
      ],
      "exit_actions": []
    },
    {
      "id": "S19_Utility_Floyd",
      "label": "computing_floyd",
      "type": "atomic",
      "entry_actions": [
        "computeFloydWarshallDistances()",
        "renderFloydOutput()"
      ],
      "exit_actions": []
    }
  ],
  "events": [
    {
      "id": "CLICK_MATRIX_CELL",
      "event_type": "user_action",
      "description": "User clicks a matrix cell (table.matrix td.clickable)",
      "triggers": "table.matrix td.clickable"
    },
    {
      "id": "CLICK_SVG_EDGE",
      "event_type": "user_action",
      "description": "User clicks an edge in the SVG visualization",
      "triggers": "svg#svgCanvas .edges path, svg#svgCanvas .edges line"
    },
    {
      "id": "CLICK_ADD_NODE",
      "event_type": "user_action",
      "description": "User clicks the Add node button",
      "triggers": "#addNode"
    },
    {
      "id": "CLICK_REMOVE_NODE",
      "event_type": "user_action",
      "description": "User clicks the Remove node button",
      "triggers": "#removeNode"
    },
    {
      "id": "CHANGE_NODE_COUNT",
      "event_type": "user_action",
      "description": "User changes the node count input",
      "triggers": "input#nodeCount"
    },
    {
      "id": "TOGGLE_DIRECTED",
      "event_type": "user_action",
      "description": "User toggles the Directed checkbox",
      "triggers": "input#directed"
    },
    {
      "id": "TOGGLE_WEIGHTED",
      "event_type": "user_action",
      "description": "User toggles the Weighted checkbox",
      "triggers": "input#weighted"
    },
    {
      "id": "INPUT_PROB",
      "event_type": "user_action",
      "description": "User adjusts the randomization probability slider",
      "triggers": "input#prob"
    },
    {
      "id": "CLICK_RANDOMIZE",
      "event_type": "user_action",
      "description": "User clicks the Generate (randomize) button",
      "triggers": "#randBtn"
    },
    {
      "id": "CLICK_CLEAR",
      "event_type": "user_action",
      "description": "User clicks the Clear button",
      "triggers": "#clearBtn"
    },
    {
      "id": "CLICK_EXPORT",
      "event_type": "user_action",
      "description": "User clicks the Export JSON button",
      "triggers": "#exportBtn"
    },
    {
      "id": "CLICK_IMPORT",
      "event_type": "user_action",
      "description": "User clicks the Import JSON button (opens file dialog)",
      "triggers": "#importBtn"
    },
    {
      "id": "FILE_SELECTED",
      "event_type": "user_action",
      "description": "User selected a file in the file dialog (input[type=file] created dynamically)",
      "triggers": "input[type=\"file\"]"
    },
    {
      "id": "FILE_READ_SUCCESS",
      "event_type": "system_event",
      "description": "File read and parsed successfully, matrix applied",
      "triggers": "dom:input[type=\"file\"]:change,dom:FileReader.onload"
    },
    {
      "id": "FILE_READ_ERROR",
      "event_type": "system_event",
      "description": "File read or parse error occurred during import",
      "triggers": "dom:FileReader.onerror"
    },
    {
      "id": "CLICK_SAMPLE",
      "event_type": "user_action",
      "description": "User clicks Load Example (sample) button",
      "triggers": "#sampleBtn"
    },
    {
      "id": "PROMPT_CONFIRM",
      "event_type": "user_action",
      "description": "User confirms the prompt dialog with a numeric weight (prompt returns a number)",
      "triggers": "window.prompt (synchronous)"
    },
    {
      "id": "PROMPT_CANCEL",
      "event_type": "user_action",
      "description": "User cancels the prompt dialog (prompt returns null)",
      "triggers": "window.prompt (synchronous)"
    },
    {
      "id": "CLICK_SYMMETRY",
      "event_type": "user_action",
      "description": "User clicks Check Symmetry button",
      "triggers": "#symCheck"
    },
    {
      "id": "CLICK_DEGREE",
      "event_type": "user_action",
      "description": "User clicks Compute Degrees button",
      "triggers": "#degCalc"
    },
    {
      "id": "CLICK_FLOYD",
      "event_type": "user_action",
      "description": "User clicks Shortest paths (Floyd) button",
      "triggers": "#floydWarshall"
    }
  ],
  "transitions": [
    {
      "from": "S0_Idle",
      "to": "S1_CellClicked",
      "event": "CLICK_MATRIX_CELL",
      "guard": "true",
      "actions": [
        "readCellCoords(eventTarget)",
        "determineIfWeighted()"
      ],
      "expected_observables": [
        "dom:table.matrix td.clickable (clicked)",
        "dom:matrixContainer updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S1_CellClicked",
      "to": "S2_PromptingWeight",
      "event": "CLICK_MATRIX_CELL",
      "guard": "weighted === true",
      "actions": [
        "showPromptDialog()",
        "prefillPromptWithCurrentWeight()"
      ],
      "expected_observables": [
        "dom:window.prompt opened"
      ],
      "timeout": 10000
    },
    {
      "from": "S1_CellClicked",
      "to": "S3_TogglingEdge",
      "event": "CLICK_MATRIX_CELL",
      "guard": "weighted === false",
      "actions": [
        "toggleEdgeValue()",
        "syncUndirectedSymmetryIfNeeded()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:table.matrix td.clickable (updated textContent)",
        "dom:matrixContainer (re-rendered)"
      ],
      "timeout": 1000
    },
    {
      "from": "S2_PromptingWeight",
      "to": "S3_TogglingEdge",
      "event": "PROMPT_CONFIRM",
      "guard": "enteredValueIsNumeric",
      "actions": [
        "applyPromptedWeightToMatrix()",
        "syncUndirectedSymmetryIfNeeded()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:table.matrix td.clickable (value changed)",
        "dom:svg#svgCanvas edge weight labels updated"
      ],
      "timeout": 10000
    },
    {
      "from": "S2_PromptingWeight",
      "to": "S0_Idle",
      "event": "PROMPT_CANCEL",
      "guard": "true",
      "actions": [
        "closePromptDialog()",
        "noMatrixChange()"
      ],
      "expected_observables": [
        "dom:table.matrix td.clickable (unchanged)"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S16_SVGEdgeClicked",
      "event": "CLICK_SVG_EDGE",
      "guard": "true",
      "actions": [
        "identifyEdgeIndexesFromSVGTarget(eventTarget)",
        "determineIfWeighted()"
      ],
      "expected_observables": [
        "dom:svg#svgCanvas .edges (element clicked)"
      ],
      "timeout": 1000
    },
    {
      "from": "S16_SVGEdgeClicked",
      "to": "S2_PromptingWeight",
      "event": "CLICK_SVG_EDGE",
      "guard": "weighted === true",
      "actions": [
        "showPromptDialogForEdge()",
        "prefillPromptWithCurrentWeight()"
      ],
      "expected_observables": [
        "dom:window.prompt opened"
      ],
      "timeout": 10000
    },
    {
      "from": "S16_SVGEdgeClicked",
      "to": "S3_TogglingEdge",
      "event": "CLICK_SVG_EDGE",
      "guard": "weighted === false",
      "actions": [
        "toggleEdgeValueIdentifiedBySVG()",
        "syncUndirectedSymmetryIfNeeded()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:svg#svgCanvas (edge element removed/updated)",
        "dom:table.matrix td.clickable (corresponding cell updated)"
      ],
      "timeout": 1000
    },
    {
      "from": "S16_SVGEdgeClicked",
      "to": "S3_TogglingEdge",
      "event": "PROMPT_CONFIRM",
      "guard": "enteredValueIsNumeric",
      "actions": [
        "applyPromptedWeightToIdentifiedEdge()",
        "syncUndirectedSymmetryIfNeeded()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:svg#svgCanvas (weight label updated)",
        "dom:table.matrix td.clickable (value changed)"
      ],
      "timeout": 10000
    },
    {
      "from": "S16_SVGEdgeClicked",
      "to": "S0_Idle",
      "event": "PROMPT_CANCEL",
      "guard": "true",
      "actions": [
        "closePromptDialog()",
        "noMatrixChange()"
      ],
      "expected_observables": [
        "dom:svg#svgCanvas (unchanged)"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S4_AddingNode",
      "event": "CLICK_ADD_NODE",
      "guard": "true",
      "actions": [
        "increaseMatrixSizeByOne()",
        "updateNodeCountInput()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:#addNode clicked",
        "dom:table.matrix (new row/col added)",
        "dom:input#nodeCount value updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S5_RemovingNode",
      "event": "CLICK_REMOVE_NODE",
      "guard": "n > 1",
      "actions": [
        "decreaseMatrixSizeByOne()",
        "updateNodeCountInput()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:#removeNode clicked",
        "dom:table.matrix (row/col removed)",
        "dom:input#nodeCount value updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S6_NodeCountChanging",
      "event": "CHANGE_NODE_COUNT",
      "guard": "true",
      "actions": [
        "validateNodeCountInput()",
        "resizeMatrixToNodeCount()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:input#nodeCount change",
        "dom:table.matrix (resized)"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S7_ToggleDirected",
      "event": "TOGGLE_DIRECTED",
      "guard": "true",
      "actions": [
        "setDirectedFlagFromCheckbox()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:input#directed changed",
        "dom:svg#svgCanvas (redrawn directed arrows if any)"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S8_ToggleWeighted",
      "event": "TOGGLE_WEIGHTED",
      "guard": "true",
      "actions": [
        "setWeightedFlagFromCheckbox()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:input#weighted changed",
        "dom:svg#svgCanvas (edge thickness/labels updated)"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S9_Randomizing",
      "event": "CLICK_RANDOMIZE",
      "guard": "true",
      "actions": [
        "readProbability()",
        "applyRandomEdges(probability)",
        "symmetrizeIfUndirected()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:#randBtn clicked",
        "dom:table.matrix (values changed)",
        "dom:svg#svgCanvas (edges updated)"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S10_Clearing",
      "event": "CLICK_CLEAR",
      "guard": "true",
      "actions": [
        "setAllMatrixEntriesToZero()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:#clearBtn clicked",
        "dom:table.matrix (all zeros)"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S11_Importing_FileSelect",
      "event": "CLICK_IMPORT",
      "guard": "true",
      "actions": [
        "openFileInputDialog()"
      ],
      "expected_observables": [
        "dom:#importBtn clicked",
        "dom:input[type=\"file\"] created and clicked"
      ],
      "timeout": 5000
    },
    {
      "from": "S11_Importing_FileSelect",
      "to": "S13_Importing_Processing",
      "event": "FILE_SELECTED",
      "guard": "filePresent",
      "actions": [
        "readSelectedFile()",
        "parseAndApplyImportedMatrix()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:input[type=\"file\"] change",
        "dom:matrixContainer (updated from imported matrix)"
      ],
      "timeout": 5000
    },
    {
      "from": "S11_Importing_FileSelect",
      "to": "S14_ImportError",
      "event": "FILE_READ_ERROR",
      "guard": "true",
      "actions": [
        "showImportErrorAlert()"
      ],
      "expected_observables": [
        "dom:alert shown (Failed to parse)",
        "dom:utilityOutput unchanged"
      ],
      "timeout": 2000
    },
    {
      "from": "S13_Importing_Processing",
      "to": "S0_Idle",
      "event": "FILE_READ_SUCCESS",
      "guard": "importedMatrixValid",
      "actions": [
        "applyImportedMatrix()",
        "setDirectedWeightedFromImported()",
        "updateControlsFromImported()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:table.matrix (imported data visible)",
        "dom:input#nodeCount value updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S14_ImportError",
      "to": "S0_Idle",
      "event": "PROMPT_CONFIRM",
      "guard": "true",
      "actions": [
        "clearImportError()"
      ],
      "expected_observables": [
        "dom:alert closed"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S15_LoadSample",
      "event": "CLICK_SAMPLE",
      "guard": "true",
      "actions": [
        "applySampleMatrix()",
        "setDirectedWeightedFromSample()",
        "updateControlsFromSample()",
        "drawAll()"
      ],
      "expected_observables": [
        "dom:#sampleBtn clicked",
        "dom:table.matrix updated with sample",
        "dom:input#weighted and #directed updated"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S16_SVGEdgeClicked",
      "event": "CLICK_SVG_EDGE",
      "guard": "true",
      "actions": [
        "identifyEdgeIndexesFromSVGTarget(eventTarget)",
        "determineIfWeighted()"
      ],
      "expected_observables": [
        "dom:svg#svgCanvas .edges element clicked"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S17_Utility_Symmetry",
      "event": "CLICK_SYMMETRY",
      "guard": "true",
      "actions": [
        "computeSymmetryMismatches()",
        "renderSymmetryOutput()"
      ],
      "expected_observables": [
        "dom:#symCheck clicked",
        "dom:#utilityOutput updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S18_Utility_Degrees",
      "event": "CLICK_DEGREE",
      "guard": "true",
      "actions": [
        "computeInOutDegrees()",
        "renderDegreesOutput()"
      ],
      "expected_observables": [
        "dom:#degCalc clicked",
        "dom:#utilityOutput updated"
      ],
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S19_Utility_Floyd",
      "event": "CLICK_FLOYD",
      "guard": "true",
      "actions": [
        "computeFloydWarshallDistances()",
        "renderFloydOutput()"
      ],
      "expected_observables": [
        "dom:#floydWarshall clicked",
        "dom:#utilityOutput updated"
      ],
      "timeout": 5000
    },
    {
      "from": "S0_Idle",
      "to": "S11_Importing_FileSelect",
      "event": "CLICK_IMPORT",
      "guard": "true",
      "actions": [
        "createAndClickFileInput()"
      ],
      "expected_observables": [
        "dom:input[type=\"file\"] element created in DOM"
      ],
      "timeout": 3000
    },
    {
      "from": "S0_Idle",
      "to": "S10_Exporting",
      "event": "CLICK_EXPORT",
      "guard": "true",
      "actions": [
        "serializeMatrixToJSON()",
        "createBlobAndTriggerDownload()"
      ],
      "expected_observables": [
        "dom:#exportBtn clicked",
        "download started: adjacency_matrix.json"
      ],
      "timeout": 2000
    }
  ],
  "components": [
    "input#nodeCount",
    "button#addNode",
    "button#removeNode",
    "input#directed",
    "input#weighted",
    "input#prob",
    "span#probLabel",
    "button#randBtn",
    "button#clearBtn",
    "button#exportBtn",
    "button#importBtn",
    "button#sampleBtn",
    "div#matrixContainer",
    "table.matrix td.clickable",
    "table.matrix td.loopCell",
    "svg#svgCanvas",
    "svg#svgCanvas .edges path",
    "svg#svgCanvas .edges line",
    "div#adjList",
    "div#matrixInfo",
    "button#symCheck",
    "button#degCalc",
    "button#floydWarshall",
    "div#utilityOutput"
  ]
}