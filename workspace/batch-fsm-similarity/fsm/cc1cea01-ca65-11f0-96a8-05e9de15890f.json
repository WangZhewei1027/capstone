{
  "meta": {
    "concept": "Set",
    "topic": "JavaScript Set Interactive Playground",
    "educational_goal": "Demonstrate ES6 Set behavior: uniqueness, insertion order, reference equality, NaN and ±0 behavior, and basic set operations (union, intersection, difference, symmetric difference)",
    "expected_interactions": [
      "add",
      "delete",
      "has",
      "clear",
      "create_object",
      "create_sample_b",
      "to_array",
      "iterate",
      "union",
      "intersection",
      "difference",
      "symmetric_difference"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "Idle",
      "type": "idle",
      "entry_actions": [
        "updateDisplays()",
        "showResult('Ready — try adding values to Set A.')",
        "startPeriodicUpdateDisplays()"
      ],
      "exit_actions": []
    },
    {
      "id": "S1_Adding",
      "label": "AddingToA",
      "type": "atomic",
      "entry_actions": [
        "read('#type-a','#value-a')",
        "val = interpretValue(type, txt)",
        "A.add(val)",
        "updateDisplays()",
        "showResult('Added to A: ' + fmtValue(val))"
      ],
      "exit_actions": []
    },
    {
      "id": "S2_Deleting",
      "label": "DeletingFromA",
      "type": "atomic",
      "entry_actions": [
        "read('#type-a','#value-a')",
        "val = interpretValue(type, txt)",
        "ok = A.delete(val)",
        "updateDisplays()",
        "showResult(ok ? 'Deleted from A: ' + fmtValue(val) : 'Not found in A: ' + fmtValue(val))"
      ],
      "exit_actions": []
    },
    {
      "id": "S3_HasChecking",
      "label": "HasCheck",
      "type": "atomic",
      "entry_actions": [
        "read('#type-a','#value-a')",
        "val = interpretValue(type, txt)",
        "res = A.has(val)",
        "showResult('A.has(' + fmtValue(val) + ') → ' + res)"
      ],
      "exit_actions": []
    },
    {
      "id": "S4_ClearA",
      "label": "ClearA",
      "type": "atomic",
      "entry_actions": [
        "A.clear()",
        "updateDisplays()",
        "showResult('Cleared A')"
      ],
      "exit_actions": []
    },
    {
      "id": "S5_ClearB",
      "label": "ClearB",
      "type": "atomic",
      "entry_actions": [
        "B.clear()",
        "updateDisplays()",
        "showResult('Cleared B')"
      ],
      "exit_actions": []
    },
    {
      "id": "S6_ToArray",
      "label": "ConvertAtoArray",
      "type": "atomic",
      "entry_actions": [
        "arr = Array.from(A)",
        "showResult('Array.from(A): [' + arr.map(fmtValue).join(', ') + ']')"
      ],
      "exit_actions": []
    },
    {
      "id": "S7_Iterating",
      "label": "IterateA",
      "type": "atomic",
      "entry_actions": [
        "s = ''",
        "for v of A: s += fmtValue(v) + ' ← '",
        "s = s ? s.slice(0, -3) : '(empty)'",
        "showResult('Iterating A: ' + s)"
      ],
      "exit_actions": []
    },
    {
      "id": "S8_CreateObject",
      "label": "CreateObjectInPool",
      "type": "atomic",
      "entry_actions": [
        "id = objectPool.length + 1",
        "obj = { _id: id, timestamp: Date.now() }",
        "objectPool.push(obj)",
        "opt = document.createElement('option')",
        "opt.value = objectPool.length - 1",
        "opt.textContent = 'Object{id:' + obj._id + '}'",
        "poolSelect.appendChild(opt)",
        "poolSelect.value = objectPool.length - 1",
        "showResult('Created ' + fmtValue(obj) + ' in pool')",
        "updateDisplays()"
      ],
      "exit_actions": []
    },
    {
      "id": "S9_CreateSampleB",
      "label": "PopulateBWithSample",
      "type": "atomic",
      "entry_actions": [
        "B.clear()",
        "B.add(1)",
        "B.add(2)",
        "B.add('a')",
        "B.add('b')",
        "if objectPool.length === 0 then create fallback object {_id:999} and push to pool and append option",
        "B.add(objectPool[0])",
        "updateDisplays()",
        "showResult('B populated with sample items (1,2,\"a\",\"b\",object)')"
      ],
      "exit_actions": []
    },
    {
      "id": "S10_Union",
      "label": "UnionOperation",
      "type": "atomic",
      "entry_actions": [
        "u = union(A,B)",
        "showResultSet('A ∪ B', u)"
      ],
      "exit_actions": []
    },
    {
      "id": "S11_Intersection",
      "label": "IntersectionOperation",
      "type": "atomic",
      "entry_actions": [
        "i = intersection(A,B)",
        "showResultSet('A ∩ B', i)"
      ],
      "exit_actions": []
    },
    {
      "id": "S12_Difference",
      "label": "DifferenceOperation",
      "type": "atomic",
      "entry_actions": [
        "d = difference(A,B)",
        "showResultSet('A \\\\ B', d)"
      ],
      "exit_actions": []
    },
    {
      "id": "S13_Symmetric",
      "label": "SymmetricDifferenceOperation",
      "type": "atomic",
      "entry_actions": [
        "s = symmetricDifference(A,B)",
        "showResultSet('A △ B (symmetric difference)', s)"
      ],
      "exit_actions": []
    },
    {
      "id": "S14_UpdatingDisplays",
      "label": "UpdatingDisplays",
      "type": "atomic",
      "entry_actions": [
        "updateDisplays()"
      ],
      "exit_actions": []
    },
    {
      "id": "S15_Error_InvalidPool",
      "label": "InvalidPoolSelection",
      "type": "atomic",
      "entry_actions": [
        "showResult('Invalid pool selection')"
      ],
      "exit_actions": []
    }
  ],
  "events": [
    {
      "id": "CLICK_ADD_A",
      "event_type": "user_action",
      "description": "User clicks the Add → A button",
      "triggers": "#add-a"
    },
    {
      "id": "KEY_ENTER_VALUE_A",
      "event_type": "user_action",
      "description": "User presses Enter key inside the input #value-a (triggers Add)",
      "triggers": "input#value-a"
    },
    {
      "id": "CLICK_DEL_A",
      "event_type": "user_action",
      "description": "User clicks the Delete from A button",
      "triggers": "#del-a"
    },
    {
      "id": "CLICK_HAS_A",
      "event_type": "user_action",
      "description": "User clicks the Has? button",
      "triggers": "#has-a"
    },
    {
      "id": "CLICK_CLEAR_A",
      "event_type": "user_action",
      "description": "User clicks Clear A",
      "triggers": "#clear-a"
    },
    {
      "id": "CLICK_CLEAR_B",
      "event_type": "user_action",
      "description": "User clicks Clear B",
      "triggers": "#clear-b"
    },
    {
      "id": "CLICK_TO_ARRAY_A",
      "event_type": "user_action",
      "description": "User clicks Convert A → Array",
      "triggers": "#to-array-a"
    },
    {
      "id": "CLICK_ITERATE_A",
      "event_type": "user_action",
      "description": "User clicks Show iteration",
      "triggers": "#iterate-a"
    },
    {
      "id": "CLICK_CREATE_OBJ",
      "event_type": "user_action",
      "description": "User clicks Create new object in pool",
      "triggers": "#create-obj"
    },
    {
      "id": "CLICK_CREATE_SAMPLE_B",
      "event_type": "user_action",
      "description": "User clicks Add sample items to B",
      "triggers": "#create-sample-b"
    },
    {
      "id": "CLICK_UNION",
      "event_type": "user_action",
      "description": "User clicks A ∪ B (Union)",
      "triggers": "#union"
    },
    {
      "id": "CLICK_INTERSECTION",
      "event_type": "user_action",
      "description": "User clicks A ∩ B (Intersection)",
      "triggers": "#intersection"
    },
    {
      "id": "CLICK_DIFFERENCE",
      "event_type": "user_action",
      "description": "User clicks A \\ B (Difference)",
      "triggers": "#difference"
    },
    {
      "id": "CLICK_SYMMETRIC",
      "event_type": "user_action",
      "description": "User clicks Symmetric Difference",
      "triggers": "#symmetric"
    },
    {
      "id": "TIMER_UPDATE_DISPLAYS",
      "event_type": "system_event",
      "description": "Periodic updateDisplays invoked by setInterval",
      "triggers": "N/A (internal setInterval)"
    },
    {
      "id": "POOL_SELECTION_CHANGE",
      "event_type": "user_action",
      "description": "User selects a different object in the pool select",
      "triggers": "#pool"
    },
    {
      "id": "ACTION_COMPLETE",
      "event_type": "system_event",
      "description": "Synchronous action completed and UI updated",
      "triggers": "#result"
    }
  ],
  "transitions": [
    {
      "from": "S0_Idle",
      "to": "S1_Adding",
      "event": "CLICK_ADD_A",
      "guard": "true",
      "actions": [
        "read('#type-a','#value-a')",
        "val = interpretValue(type, txt)",
        "A.add(val)",
        "updateDisplays()",
        "showResult('Added to A: ' + fmtValue(val))"
      ],
      "expected_observables": [
        "dom:#list-a changed",
        "dom:#size-a.textContent changed",
        "dom:#result.textContent changed"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S1_Adding",
      "event": "KEY_ENTER_VALUE_A",
      "guard": "e.key === 'Enter'",
      "actions": [
        "simulate click '#add-a' (calls same handler as CLICK_ADD_A)"
      ],
      "expected_observables": [
        "dom:#value-a keydown Enter",
        "dom:#result.textContent changed"
      ],
      "timeout": 500
    },
    {
      "from": "S1_Adding",
      "to": "S14_UpdatingDisplays",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [
        "updateDisplays()"
      ],
      "expected_observables": [
        "dom:#list-a updated",
        "dom:#size-a.textContent updated"
      ],
      "timeout": 500
    },
    {
      "from": "S14_UpdatingDisplays",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#result.textContent visible"
      ],
      "timeout": 200
    },
    {
      "from": "S0_Idle",
      "to": "S2_Deleting",
      "event": "CLICK_DEL_A",
      "guard": "true",
      "actions": [
        "read('#type-a','#value-a')",
        "val = interpretValue(type, txt)",
        "ok = A.delete(val)",
        "updateDisplays()",
        "showResult(ok ? 'Deleted from A: ' + fmtValue(val) : 'Not found in A: ' + fmtValue(val))"
      ],
      "expected_observables": [
        "dom:#list-a changed",
        "dom:#result.textContent changed"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S3_HasChecking",
      "event": "CLICK_HAS_A",
      "guard": "true",
      "actions": [
        "read('#type-a','#value-a')",
        "val = interpretValue(type, txt)",
        "showResult('A.has(' + fmtValue(val) + ') → ' + A.has(val))"
      ],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S4_ClearA",
      "event": "CLICK_CLEAR_A",
      "guard": "true",
      "actions": [
        "A.clear()",
        "updateDisplays()",
        "showResult('Cleared A')"
      ],
      "expected_observables": [
        "dom:#list-a emptied",
        "dom:#size-a.textContent changed",
        "dom:#result.textContent changed"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S5_ClearB",
      "event": "CLICK_CLEAR_B",
      "guard": "true",
      "actions": [
        "B.clear()",
        "updateDisplays()",
        "showResult('Cleared B')"
      ],
      "expected_observables": [
        "dom:#list-b emptied",
        "dom:#size-b.textContent changed",
        "dom:#result.textContent changed"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S6_ToArray",
      "event": "CLICK_TO_ARRAY_A",
      "guard": "true",
      "actions": [
        "arr = Array.from(A)",
        "showResult('Array.from(A): [' + arr.map(fmtValue).join(', ') + ']')"
      ],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S7_Iterating",
      "event": "CLICK_ITERATE_A",
      "guard": "true",
      "actions": [
        "iterate A and showResult('Iterating A: ...')"
      ],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 800
    },
    {
      "from": "S0_Idle",
      "to": "S8_CreateObject",
      "event": "CLICK_CREATE_OBJ",
      "guard": "true",
      "actions": [
        "create object, push to objectPool, append option to #pool, set poolSelect.value",
        "showResult('Created object in pool')",
        "updateDisplays()"
      ],
      "expected_observables": [
        "dom:#pool options changed",
        "dom:#result.textContent changed"
      ],
      "timeout": 800
    },
    {
      "from": "S0_Idle",
      "to": "S9_CreateSampleB",
      "event": "CLICK_CREATE_SAMPLE_B",
      "guard": "true",
      "actions": [
        "B.clear()",
        "B.add(1); B.add(2); B.add('a'); B.add('b')",
        "if objectPool empty then create fallback and append to #pool",
        "B.add(objectPool[0])",
        "updateDisplays()",
        "showResult('B populated with sample items (1,2,\"a\",\"b\",object)')"
      ],
      "expected_observables": [
        "dom:#list-b changed",
        "dom:#size-b.textContent changed",
        "dom:#pool options may change",
        "dom:#result.textContent changed"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S10_Union",
      "event": "CLICK_UNION",
      "guard": "true",
      "actions": [
        "u = union(A,B)",
        "showResultSet('A ∪ B', u)"
      ],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 800
    },
    {
      "from": "S0_Idle",
      "to": "S11_Intersection",
      "event": "CLICK_INTERSECTION",
      "guard": "true",
      "actions": [
        "i = intersection(A,B)",
        "showResultSet('A ∩ B', i)"
      ],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 800
    },
    {
      "from": "S0_Idle",
      "to": "S12_Difference",
      "event": "CLICK_DIFFERENCE",
      "guard": "true",
      "actions": [
        "d = difference(A,B)",
        "showResultSet('A \\\\ B', d)"
      ],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 800
    },
    {
      "from": "S0_Idle",
      "to": "S13_Symmetric",
      "event": "CLICK_SYMMETRIC",
      "guard": "true",
      "actions": [
        "s = symmetricDifference(A,B)",
        "showResultSet('A △ B (symmetric difference)', s)"
      ],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 800
    },
    {
      "from": "S0_Idle",
      "to": "S15_Error_InvalidPool",
      "event": "CLICK_ADD_A",
      "guard": "type-a === 'reuseObject' && (poolSelect.value === '-1' || objectPool[parseInt(poolSelect.value,10)] === undefined)",
      "actions": [
        "showResult('Invalid pool selection')"
      ],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 500
    },
    {
      "from": "S8_CreateObject",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#pool options updated",
        "dom:#result.textContent changed"
      ],
      "timeout": 300
    },
    {
      "from": "S9_CreateSampleB",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#list-b updated",
        "dom:#size-b.textContent updated",
        "dom:#result.textContent changed"
      ],
      "timeout": 300
    },
    {
      "from": "S10_Union",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#result.textContent shows union",
        "dom:#result visible"
      ],
      "timeout": 300
    },
    {
      "from": "S11_Intersection",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#result.textContent shows intersection"
      ],
      "timeout": 300
    },
    {
      "from": "S12_Difference",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#result.textContent shows difference"
      ],
      "timeout": 300
    },
    {
      "from": "S13_Symmetric",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#result.textContent shows symmetric difference"
      ],
      "timeout": 300
    },
    {
      "from": "S2_Deleting",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#list-a updated",
        "dom:#result.textContent changed"
      ],
      "timeout": 300
    },
    {
      "from": "S3_HasChecking",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 200
    },
    {
      "from": "S4_ClearA",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#list-a emptied",
        "dom:#size-a textContent 0"
      ],
      "timeout": 300
    },
    {
      "from": "S5_ClearB",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#list-b emptied",
        "dom:#size-b textContent 0"
      ],
      "timeout": 300
    },
    {
      "from": "S6_ToArray",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 200
    },
    {
      "from": "S7_Iterating",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [],
      "expected_observables": [
        "dom:#result.textContent changed"
      ],
      "timeout": 200
    },
    {
      "from": "S15_Error_InvalidPool",
      "to": "S0_Idle",
      "event": "ACTION_COMPLETE",
      "guard": "true",
      "actions": [
        "noop"
      ],
      "expected_observables": [
        "dom:#result.textContent indicates error"
      ],
      "timeout": 300
    },
    {
      "from": "S0_Idle",
      "to": "S14_UpdatingDisplays",
      "event": "TIMER_UPDATE_DISPLAYS",
      "guard": "true",
      "actions": [
        "updateDisplays()"
      ],
      "expected_observables": [
        "dom:#list-a/#list-b reflect current sets",
        "dom:#size-a and dom:#size-b reflect sizes"
      ],
      "timeout": 200
    }
  ],
  "components": [
    "#type-a",
    "input#value-a",
    "button#add-a",
    "button#del-a",
    "button#create-obj",
    "select#pool",
    "button#has-a",
    "button#clear-a",
    "button#to-array-a",
    "button#iterate-a",
    "div#list-a",
    "span#size-a",
    "button#create-sample-b",
    "button#clear-b",
    "button#union",
    "button#intersection",
    "button#difference",
    "button#symmetric",
    "div#list-b",
    "div#result",
    "div#note-a"
  ]
}