{
  "meta": {
    "concept": "Graph",
    "topic": "Graph Visualization (Directed / Undirected)",
    "educational_goal": "Demonstrate graph creation and manipulation",
    "expected_interactions": [
      "addNode",
      "addEdge",
      "clearGraph",
      "toggleDirected"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "Idle",
      "type": "idle",
      "entry_actions": [
        "drawGraph()"
      ],
      "exit_actions": []
    },
    {
      "id": "S1_AddingNode",
      "label": "AddingNode",
      "type": "atomic",
      "entry_actions": [
        "addNode()"
      ],
      "exit_actions": [
        "drawGraph()"
      ]
    },
    {
      "id": "S2_AddingEdge",
      "label": "AddingEdge",
      "type": "atomic",
      "entry_actions": [
        "selectNodeForEdge()"
      ],
      "exit_actions": [
        "resetEdgeSelection()"
      ]
    },
    {
      "id": "S3_EdgeSelected",
      "label": "EdgeSelected",
      "type": "atomic",
      "entry_actions": [
        "addEdge()"
      ],
      "exit_actions": [
        "resetEdgeSelection()"
      ]
    },
    {
      "id": "S4_ClearGraph",
      "label": "ClearGraph",
      "type": "atomic",
      "entry_actions": [
        "clearGraph()"
      ],
      "exit_actions": [
        "drawGraph()"
      ]
    }
  ],
  "events": [
    {
      "id": "UserClicksCanvas",
      "event_type": "user_action",
      "description": "User clicks on the canvas to add a node or edge",
      "triggers": [
        "#graphCanvas"
      ]
    },
    {
      "id": "UserChangesMode",
      "event_type": "user_action",
      "description": "User changes the mode between Add Node and Add Edge",
      "triggers": [
        "input[name='mode']"
      ]
    },
    {
      "id": "UserTogglesDirected",
      "event_type": "user_action",
      "description": "User toggles the Directed Graph checkbox",
      "triggers": [
        "#directedCheckbox"
      ]
    },
    {
      "id": "UserClicksClear",
      "event_type": "user_action",
      "description": "User clicks the Clear Graph button",
      "triggers": [
        "#clearBtn"
      ]
    }
  ],
  "transitions": [
    {
      "from": "S0_Idle",
      "to": "S1_AddingNode",
      "event": "UserClicksCanvas",
      "guard": "modeIsAddNode",
      "actions": [
        "addNode()"
      ],
      "expected_observables": [
        "dom:nodeAdded"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S2_AddingEdge",
      "event": "UserClicksCanvas",
      "guard": "modeIsAddEdge",
      "actions": [
        "selectNodeForEdge()"
      ],
      "expected_observables": [
        "dom:edgeSelectionStarted"
      ],
      "timeout": 500
    },
    {
      "from": "S2_AddingEdge",
      "to": "S3_EdgeSelected",
      "event": "UserClicksCanvas",
      "guard": "nodeSelectedForEdge",
      "actions": [
        "addEdge()"
      ],
      "expected_observables": [
        "dom:edgeAdded"
      ],
      "timeout": 500
    },
    {
      "from": "S3_EdgeSelected",
      "to": "S2_AddingEdge",
      "event": "UserClicksCanvas",
      "guard": "resetEdgeSelection",
      "actions": [
        "resetEdgeSelection()"
      ],
      "expected_observables": [
        "dom:edgeSelectionReset"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S4_ClearGraph",
      "event": "UserClicksClear",
      "guard": "true",
      "actions": [
        "clearGraph()"
      ],
      "expected_observables": [
        "dom:graphCleared"
      ],
      "timeout": 500
    }
  ],
  "components": [
    "#graphCanvas",
    "input[name='mode']",
    "#directedCheckbox",
    "#clearBtn"
  ]
}