{
  "id": "cc1dd461-ca65-11f0-96a8-05e9de15890f",
  "timestamp": "2025-11-26T01:21:31.080Z",
  "model": "gpt-5-mini",
  "status": "success",
  "question": "Merge Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\"/>\n<title>Merge Sort Visualizer</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"/>\n<style>\n  :root{\n    --bg:#0f1724;\n    --panel:#0b1220;\n    --muted:#9aa7bf;\n    --accent:#60a5fa;\n    --success:#34d399;\n    --danger:#fb7185;\n    --compare:#a78bfa;\n    --write:#f59e0b;\n    --range:#1e293b;\n    --bar:#60a5fa;\n    --sorted:#38bdf8;\n    font-family: Inter, Roboto, system-ui, -apple-system, \"Segoe UI\", \"Helvetica Neue\", Arial;\n  }\n  html,body{height:100%;margin:0;background:linear-gradient(180deg,#071029 0%, #061226 100%);color:#cbd5e1}\n  .container{max-width:1100px;margin:18px auto;padding:18px;}\n  header{display:flex;align-items:center;gap:18px;margin-bottom:12px}\n  h1{font-size:20px;margin:0;color:var(--accent)}\n  .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:10px 0}\n  .controls > *{background:var(--panel);border:1px solid rgba(255,255,255,0.03);padding:8px;border-radius:8px;color:var(--muted)}\n  .btn{cursor:pointer;padding:8px 12px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);color:#e6eef8;border:1px solid rgba(255,255,255,0.03)}\n  .btn:active{transform:translateY(1px)}\n  .btn.secondary{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.03)}\n  .controls label{display:flex;gap:6px;align-items:center;font-size:13px}\n  .slider{width:160px}\n  .panel{background:linear-gradient(180deg,var(--panel),rgba(255,255,255,0.01));padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}\n  .viz{height:360px;margin-top:14px;display:flex;align-items:flex-end;gap:4px;padding:10px;overflow:hidden;border-radius:8px;background:linear-gradient(180deg,#071023 0,#071a28 100%);border:1px solid rgba(255,255,255,0.02)}\n  .bar{flex:1 1 auto;display:flex;align-items:flex-end;justify-content:center;background:linear-gradient(180deg,var(--bar),#2b6cb0);border-radius:4px 4px 4px 4px;transition:height 200ms linear, background-color 120ms linear, transform 120ms ease;min-width:4px;position:relative}\n  .bar.small{min-width:2px}\n  .bar .val{position:absolute;top:-18px;font-size:11px;color:#e6eef8;opacity:0.9}\n  .bar.compare{background:linear-gradient(180deg,var(--compare),#7c3aed);transform:scaleX(1.02)}\n  .bar.write{background:linear-gradient(180deg,var(--write),#d97706);transform:scaleX(1.02)}\n  .bar.range{outline:3px solid rgba(96,165,250,0.08);box-shadow:inset 0 0 30px rgba(2,6,23,0.6)}\n  .bar.sorted{background:linear-gradient(180deg,var(--sorted),#0ea5e9)}\n  .info{display:flex;gap:12px;margin-top:12px;align-items:flex-start}\n  .side{flex:0 0 360px}\n  pre{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:linear-gradient(180deg,#04101a,#071429);padding:10px;border-radius:8px;color:#cbd5e1;max-height:320px;overflow:auto;margin:0;font-size:13px;border:1px solid rgba(255,255,255,0.02)}\n  .legend{display:flex;gap:8px;flex-wrap:wrap;font-size:13px;margin-top:8px}\n  .legend .item{display:flex;gap:6px;align-items:center}\n  .swatch{width:18px;height:12px;border-radius:3px}\n  .swatch.range{background:linear-gradient(180deg,rgba(96,165,250,0.06),transparent);border:1px solid rgba(96,165,250,0.06)}\n  .log{max-height:120px;overflow:auto;font-size:13px;padding:8px;border-radius:6px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)}\n  .status{font-size:13px;color:var(--muted)}\n  footer{margin-top:12px;color:var(--muted);font-size:13px}\n  @media (max-width:880px){\n    .info{flex-direction:column}\n    .side{flex:1}\n    .controls label{width:100%}\n    .slider{width:140px}\n    .viz{height:280px}\n  }\n</style>\n</head>\n<body>\n  <div class=\"container\">\n    <header>\n      <h1>Merge Sort Visualizer</h1>\n      <div class=\"status panel\" id=\"status\">Ready — generate an array to begin.</div>\n    </header>\n\n    <div class=\"controls\">\n      <div class=\"panel\" style=\"display:flex;gap:8px;align-items:center;\">\n        <button id=\"startBtn\" class=\"btn\">Start</button>\n        <button id=\"pauseBtn\" class=\"btn secondary\">Pause</button>\n        <button id=\"stepBtn\" class=\"btn secondary\">Step</button>\n        <button id=\"resetBtn\" class=\"btn secondary\">Reset</button>\n      </div>\n\n      <div class=\"panel\" style=\"display:flex;gap:8px;align-items:center;\">\n        <label>Size\n          <input id=\"size\" type=\"range\" min=\"6\" max=\"90\" value=\"32\" class=\"slider\">\n        </label>\n        <span id=\"sizeVal\" style=\"min-width:30px;text-align:center;color:var(--muted)\">32</span>\n      </div>\n\n      <div class=\"panel\" style=\"display:flex;gap:8px;align-items:center;\">\n        <label>Speed\n          <input id=\"speed\" type=\"range\" min=\"10\" max=\"1000\" value=\"180\" class=\"slider\">\n        </label>\n        <span id=\"speedVal\" style=\"min-width:40px;text-align:center;color:var(--muted)\">180 ms</span>\n      </div>\n\n      <div class=\"panel\" style=\"display:flex;gap:8px;align-items:center;\">\n        <button id=\"randomizeBtn\" class=\"btn secondary\">Randomize</button>\n        <label style=\"margin-left:6px\"><input id=\"order\" type=\"checkbox\"> Descending</label>\n      </div>\n    </div>\n\n    <div class=\"panel\">\n      <div class=\"viz\" id=\"viz\"></div>\n      <div class=\"info\">\n        <div class=\"side\">\n          <div style=\"display:flex;justify-content:space-between;align-items:center\">\n            <strong style=\"color:#e6eef8\">Pseudocode (Merge Sort)</strong>\n            <small style=\"color:var(--muted)\">Lines highlight during action</small>\n          </div>\n          <pre id=\"pseudocode\">\n// MergeSort(A, l, r)\n// if r - l <= 1: return\n// m = (l + r) / 2\n// MergeSort(A, l, m)\n// MergeSort(A, m, r)\n// merge two sorted halves:\n// i = l, j = m, k = l\n// while i < m and j < r:\n//   if A[i] <= A[j]:\n//     B[k++] = A[i++]\n//   else:\n//     B[k++] = A[j++]\n// copy remaining elements\n// copy B back into A\n          </pre>\n        </div>\n\n        <div style=\"flex:1;\">\n          <div style=\"display:flex;justify-content:space-between;align-items:center\">\n            <strong style=\"color:#e6eef8\">Legend & Log</strong>\n            <div class=\"legend\">\n              <div class=\"item\"><div class=\"swatch compare\" style=\"background:linear-gradient(180deg,var(--compare),#7c3aed)\"></div><span style=\"color:var(--muted)\">Comparing</span></div>\n              <div class=\"item\"><div class=\"swatch write\" style=\"background:linear-gradient(180deg,var(--write),#d97706)\"></div><span style=\"color:var(--muted)\">Write</span></div>\n              <div class=\"item\"><div class=\"swatch range\"></div><span style=\"color:var(--muted)\">Current merge range</span></div>\n              <div class=\"item\"><div class=\"swatch\" style=\"background:linear-gradient(180deg,var(--sorted),#0ea5e9)\"></div><span style=\"color:var(--muted)\">Sorted segment</span></div>\n            </div>\n          </div>\n\n          <div class=\"log panel\" id=\"log\"></div>\n        </div>\n      </div>\n    </div>\n\n    <footer>\n      Tip: Use \"Step\" to proceed one recorded animation at a time. Pause stops automatic playback.\n    </footer>\n  </div>\n\n<script>\n// Merge Sort Visualizer\n// Single-file demo. No external libs.\n\n(function(){\n  // DOM\n  const viz = document.getElementById('viz');\n  const startBtn = document.getElementById('startBtn');\n  const pauseBtn = document.getElementById('pauseBtn');\n  const stepBtn = document.getElementById('stepBtn');\n  const resetBtn = document.getElementById('resetBtn');\n  const randomizeBtn = document.getElementById('randomizeBtn');\n  const sizeInput = document.getElementById('size');\n  const sizeVal = document.getElementById('sizeVal');\n  const speedInput = document.getElementById('speed');\n  const speedVal = document.getElementById('speedVal');\n  const orderCheckbox = document.getElementById('order');\n  const log = document.getElementById('log');\n  const status = document.getElementById('status');\n\n  let array = [];\n  let bars = [];\n  let actions = [];\n  let actionIndex = 0;\n  let isPlaying = false;\n  let isPaused = false;\n  let isStarted = false;\n  let comparatorDescending = false;\n\n  // Initialize\n  const defaultSize = +sizeInput.value;\n  sizeVal.textContent = defaultSize;\n  speedVal.textContent = speedInput.value + ' ms';\n  comparatorDescending = orderCheckbox.checked;\n\n  function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }\n\n  function generateArray(n){\n    array = new Array(n).fill(0).map((_,i) => randInt(5, 400));\n    // optionally shuffle to avoid sorted\n    for(let i=array.length-1;i>0;i--){\n      const j=Math.floor(Math.random()*(i+1));\n      [array[i],array[j]]=[array[j],array[i]];\n    }\n    renderArray();\n    logMessage(`Generated array of ${n} elements.`);\n    status.textContent = 'Array generated. Click Start to record merges and animate.';\n    isStarted = false;\n    actions = [];\n    actionIndex = 0;\n    updateButtons();\n  }\n\n  function renderArray(){\n    viz.innerHTML = '';\n    bars = [];\n    const n = array.length;\n    // determine width: let each bar flex and min-width small; set class small if many\n    const small = n > 70;\n    for(let i=0;i<n;i++){\n      const b = document.createElement('div');\n      b.className = 'bar' + (small ? ' small' : '');\n      b.style.height = `${array[i]}px`;\n      b.dataset.index = i;\n      const val = document.createElement('div');\n      val.className = 'val';\n      val.textContent = array[i];\n      b.appendChild(val);\n      viz.appendChild(b);\n      bars.push(b);\n    }\n  }\n\n  function logMessage(s){\n    const time = new Date().toLocaleTimeString();\n    log.innerHTML = `<div style=\"color:var(--muted);font-size:12px\">[${time}]</div>` + `<div>${s}</div>` + log.innerHTML;\n  }\n\n  // Recording actions during merge sort (non-visual), to be animated later.\n  // Action types: range {l,m,r}, compare {a,b}, write {index,value}, done\n  function recordMergeSort(arr){\n    actions = [];\n    function cmp(a,b){\n      return comparatorDescending ? b - a : a - b;\n    }\n    function mergeSortRec(a,l,r){\n      if(r - l <= 1) return;\n      const m = Math.floor((l + r) / 2);\n      mergeSortRec(a,l,m);\n      mergeSortRec(a,m,r);\n      // record range\n      actions.push({type:'range', l, m, r});\n      let left = a.slice(l,m);\n      let right = a.slice(m,r);\n      let i=0,j=0,k=l;\n      while(i < left.length && j < right.length){\n        // compare indices (original positions before overwrite)\n        const idxL = l + i;\n        const idxR = m + j;\n        actions.push({type:'compare', a: idxL, b: idxR});\n        if(cmp(left[i], right[j]) <= 0){\n          actions.push({type:'write', index:k, value:left[i]});\n          a[k++] = left[i++];\n        } else {\n          actions.push({type:'write', index:k, value:right[j]});\n          a[k++] = right[j++];\n        }\n      }\n      while(i < left.length){\n        actions.push({type:'write', index:k, value:left[i]});\n        a[k++] = left[i++];\n      }\n      while(j < right.length){\n        actions.push({type:'write', index:k, value:right[j]});\n        a[k++] = right[j++];\n      }\n      // optional: mark this segment as sorted (for visualization we'll treat completed when all writes done)\n    }\n    const copy = arr.slice();\n    mergeSortRec(copy, 0, copy.length);\n    actions.push({type:'done'});\n    return actions;\n  }\n\n  // Visualization step: apply one action\n  function applyAction(act){\n    // clear temporary highlights except range/stays\n    // We'll not clear the range here; range acts to set a \"current\" merge highlight which remains until next range.\n    if(!act) return;\n    if(act.type === 'range'){\n      // clear all range styles first\n      bars.forEach(b => b.classList.remove('range'));\n      const {l,m,r} = act;\n      for(let i=l;i<r;i++){\n        if(bars[i]) bars[i].classList.add('range');\n      }\n      logMessage(`Merging range [${l}, ${r}) (mid=${m}).`);\n      highlightPseudo('range');\n    } else if(act.type === 'compare'){\n      const a = act.a, b = act.b;\n      if(bars[a]) bars[a].classList.add('compare');\n      if(bars[b]) bars[b].classList.add('compare');\n      highlightPseudo('compare');\n      // clear compare highlights after a short time (we keep them until next action processing or after write)\n      setTimeout(()=>{\n        if(bars[a]) bars[a].classList.remove('compare');\n        if(bars[b]) bars[b].classList.remove('compare');\n      }, Math.max(60, getDelay()/2));\n      logMessage(`Compare positions ${a} and ${b}.`);\n    } else if(act.type === 'write'){\n      const idx = act.index;\n      const val = act.value;\n      // animate write: change height & value text & temporary class\n      if(bars[idx]){\n        bars[idx].classList.add('write');\n        bars[idx].style.height = `${val}px`;\n        const v = bars[idx].querySelector('.val');\n        if(v) v.textContent = val;\n        // remove write after short time\n        setTimeout(()=>{ if(bars[idx]) bars[idx].classList.remove('write'); }, Math.max(80, getDelay()/2));\n      }\n      // reflect in array so subsequent operations see updated heights\n      array[idx] = val;\n      highlightPseudo('write');\n      logMessage(`Write ${val} at index ${idx}.`);\n    } else if(act.type === 'done'){\n      // mark everything sorted\n      bars.forEach(b => b.classList.add('sorted'));\n      bars.forEach(b => b.classList.remove('range'));\n      logMessage('Merge sort complete.');\n      highlightPseudo('done');\n    }\n  }\n\n  // Pseudocode highlighting: simple mapping\n  const pseudoEl = document.getElementById('pseudocode');\n  const pseudoLines = pseudoEl.textContent.split('\\n');\n  function highlightPseudo(kind){\n    // We'll create styled lines by reconstructing with simple highlights matching action type.\n    const map = {\n      'range': 4,      // \"merge two sorted halves:\"\n      'compare': 9,    // \"if A[i] <= A[j]:\"\n      'write': 10,     // \"B[k++] = A[i++]\" or \"B[k++] = A[j++]\"\n      'done': 0\n    };\n    const lineToHighlight = map[kind] || 0;\n    const newHtml = pseudoLines.map((ln,i)=>{\n      const index = i;\n      const escaped = ln.replace(/</g,'&lt;').replace(/>/g,'&gt;');\n      if(i === lineToHighlight) return `<span style=\"background:linear-gradient(90deg, rgba(96,165,250,0.08), rgba(96,165,250,0.02));display:block;padding:2px 4px;border-radius:4px\">${escaped}</span>`;\n      return escaped;\n    }).join('\\n');\n    pseudoEl.innerHTML = newHtml;\n  }\n\n  // Playback controls\n  function getDelay(){ return Math.max(10, +speedInput.value); }\n\n  function updateButtons(){\n    if(isPlaying){\n      startBtn.disabled = true;\n      pauseBtn.textContent = 'Pause';\n      pauseBtn.classList.remove('secondary');\n      pauseBtn.classList.add('btn');\n    } else {\n      startBtn.disabled = false;\n      pauseBtn.textContent = 'Pause';\n      pauseBtn.classList.remove('btn');\n      pauseBtn.classList.add('secondary');\n    }\n  }\n\n  function processNextAction(){\n    if(actionIndex >= actions.length) return false;\n    const act = actions[actionIndex++];\n    applyAction(act);\n    // when write occurs inside range and whole range completed, we don't specially mark, we rely on done action at end or eventual next range\n    return true;\n  }\n\n  async function play(){\n    if(actions.length === 0){\n      logMessage('No recorded actions. Click Start first.');\n      return;\n    }\n    if(actionIndex >= actions.length){\n      logMessage('Already finished. Reset to run again.');\n      return;\n    }\n    isPlaying = true;\n    isPaused = false;\n    updateButtons();\n    status.textContent = 'Playing...';\n    while(isPlaying && actionIndex < actions.length){\n      processNextAction();\n      await new Promise(res => setTimeout(res, getDelay()));\n    }\n    isPlaying = false;\n    updateButtons();\n    if(actionIndex >= actions.length){\n      status.textContent = 'Finished.';\n      isStarted = false;\n    } else {\n      status.textContent = 'Paused.';\n    }\n  }\n\n  // Button handlers\n  startBtn.addEventListener('click', ()=>{\n    if(isPlaying) return;\n    // if not recorded, record now\n    comparatorDescending = orderCheckbox.checked;\n    actions = recordMergeSort(array.slice());\n    actionIndex = 0;\n    // clear previous visual markers\n    bars.forEach(b => b.classList.remove('sorted','range','compare','write'));\n    // start playing\n    isStarted = true;\n    play();\n  });\n\n  pauseBtn.addEventListener('click', ()=>{\n    if(isPlaying){\n      // pause\n      isPlaying = false;\n      isPaused = true;\n      updateButtons();\n      status.textContent = 'Paused.';\n      logMessage('Playback paused.');\n    } else {\n      // resume (if there are remaining actions)\n      if(actionIndex >= actions.length){\n        logMessage('Nothing to resume; animation already finished.');\n        return;\n      }\n      play();\n    }\n  });\n\n  stepBtn.addEventListener('click', ()=>{\n    if(actions.length === 0){\n      // record one time so step can show the first action\n      comparatorDescending = orderCheckbox.checked;\n      actions = recordMergeSort(array.slice());\n      actionIndex = 0;\n      bars.forEach(b => b.classList.remove('sorted','range','compare','write'));\n    }\n    if(isPlaying){\n      // if playing, step isn't allowed\n      logMessage('Cannot step while playing — pause first.');\n      return;\n    }\n    if(actionIndex >= actions.length){\n      logMessage('Finished. Reset to run again.');\n      return;\n    }\n    processNextAction();\n    if(actionIndex >= actions.length){\n      status.textContent = 'Finished.';\n      isStarted = false;\n    } else {\n      status.textContent = 'Paused.';\n    }\n  });\n\n  resetBtn.addEventListener('click', ()=>{\n    isPlaying = false;\n    isPaused = false;\n    actions = [];\n    actionIndex = 0;\n    // regenerate visual from current array values (no recording)\n    renderArray();\n    logMessage('Reset visualization to current array.');\n    status.textContent = 'Reset.';\n    updateButtons();\n  });\n\n  randomizeBtn.addEventListener('click', ()=>{\n    generateArray(+sizeInput.value);\n  });\n\n  sizeInput.addEventListener('input', (e)=>{\n    sizeVal.textContent = e.target.value;\n  });\n\n  speedInput.addEventListener('input', (e)=>{\n    speedVal.textContent = e.target.value + ' ms';\n  });\n\n  orderCheckbox.addEventListener('change', (e)=>{\n    comparatorDescending = e.target.checked;\n  });\n\n  // keyboard shortcuts\n  window.addEventListener('keydown', (e)=>{\n    if(e.key === ' '){ e.preventDefault(); pauseBtn.click(); }\n    if(e.key === 'Enter'){ startBtn.click(); }\n    if(e.key === 'ArrowRight'){ stepBtn.click(); }\n  });\n\n  // initial generate\n  generateArray(defaultSize);\n\n  // Small note: resizing window should keep bars responsive. We'll re-render heights when container width changes (not necessary).\n})();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Merge Sort"
    }
  ],
  "topic": "Merge Sort",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}