{
  "id": "92ff6a22-ca67-11f0-a3d6-179b5eb5e89b",
  "timestamp": "2025-11-26T01:31:57.438Z",
  "model": "gpt-3.5-turbo",
  "status": "success",
  "question": "Linear Regression",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<title>Linear Regression Demo</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 20px;\n    max-width: 900px;\n  }\n  h1 {\n    text-align: center;\n  }\n  #plot {\n    border: 1px solid #ccc;\n    margin-top: 20px;\n  }\n  #info {\n    margin-top: 15px;\n    font-size: 1.1em;\n  }\n  #resetBtn {\n    margin-top: 15px;\n  }\n  #instructions {\n    font-size: 0.9em;\n    color: #555;\n    margin-top: 10px;\n  }\n</style>\n</head>\n<body>\n<h1>Interactive Linear Regression Demo</h1>\n<p>Click on the plot area below to add data points. The blue line is the best-fit line computed by linear regression (least squares method).</p>\n\n<canvas id=\"plot\" width=\"800\" height=\"500\"></canvas>\n\n<div id=\"info\"></div>\n<button id=\"resetBtn\">Reset Points</button>\n\n<div id=\"instructions\">\n  <strong>Instructions:</strong><br/>\n  - Click anywhere on the canvas to add a data point.<br/>\n  - The regression line updates automatically.<br/>\n  - Click \"Reset Points\" to clear all data and start over.<br/>\n  <br/>\n  Coordinates are normalized in the range 0-100 for x and y.<br/>\n</div>\n\n<script>\n(() => {\n  const canvas = document.getElementById(\"plot\");\n  const ctx = canvas.getContext(\"2d\");\n  const width = canvas.width;\n  const height = canvas.height;\n  let points = [];\n\n  // Margins for plotting (to leave space for axes)\n  const margin = 50;\n\n  // Coordinate system range\n  const xRange = [0, 100];\n  const yRange = [0, 100];\n\n  // Map data coordinates (0-100) to canvas pixels\n  function xToCanvas(x) {\n    return margin + ((x - xRange[0]) / (xRange[1] - xRange[0])) * (width - 2 * margin);\n  }\n  function yToCanvas(y) {\n    // y increases downwards on canvas, so flip\n    return height - margin - ((y - yRange[0]) / (yRange[1] - yRange[0])) * (height - 2 * margin);\n  }\n\n  // Map canvas pixel to data coordinate\n  function canvasToX(px) {\n    let val = ((px - margin) / (width - 2 * margin)) * (xRange[1] - xRange[0]) + xRange[0];\n    return Math.min(Math.max(val, xRange[0]), xRange[1]);\n  }\n  function canvasToY(py) {\n    let val = ((height - margin - py) / (height - 2 * margin)) * (yRange[1] - yRange[0]) + yRange[0];\n    return Math.min(Math.max(val, yRange[0]), yRange[1]);\n  }\n\n  // Draw axes\n  function drawAxes() {\n    ctx.strokeStyle = \"#000\";\n    ctx.lineWidth = 1;\n    ctx.font = \"12px Arial\";\n    ctx.fillStyle = \"#000\";\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"middle\";\n\n    // X axis line\n    ctx.beginPath();\n    ctx.moveTo(margin, height - margin);\n    ctx.lineTo(width - margin, height - margin);\n    ctx.stroke();\n\n    // Y axis line\n    ctx.beginPath();\n    ctx.moveTo(margin, margin);\n    ctx.lineTo(margin, height - margin);\n    ctx.stroke();\n\n    // X axis labels (0, 20, ..., 100)\n    for(let i=0; i<=5; i++) {\n      let xVal = i * 20;\n      let xPos = xToCanvas(xVal);\n      ctx.beginPath();\n      ctx.moveTo(xPos, height - margin);\n      ctx.lineTo(xPos, height - margin + 6);\n      ctx.stroke();\n      ctx.fillText(xVal, xPos, height - margin + 18);\n    }\n\n    // Y axis labels (0, 20, ..., 100)\n    ctx.textAlign = \"right\";\n    ctx.textBaseline = \"middle\";\n    for(let i=0; i<=5; i++) {\n      let yVal = i * 20;\n      let yPos = yToCanvas(yVal);\n      ctx.beginPath();\n      ctx.moveTo(margin, yPos);\n      ctx.lineTo(margin - 6, yPos);\n      ctx.stroke();\n      ctx.fillText(yVal, margin - 10, yPos);\n    }\n\n    // Axes titles\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"bottom\";\n    ctx.fillText(\"X\", width/2, height - 10);\n\n    ctx.save();\n    ctx.translate(15, height/2);\n    ctx.rotate(-Math.PI/2);\n    ctx.fillText(\"Y\", 0, 0);\n    ctx.restore();\n  }\n\n  // Draw points\n  function drawPoints() {\n    ctx.fillStyle = \"red\";\n    for(const pt of points) {\n      const cx = xToCanvas(pt.x);\n      const cy = yToCanvas(pt.y);\n      ctx.beginPath();\n      ctx.arc(cx, cy, 5, 0, 2*Math.PI);\n      ctx.fill();\n    }\n  }\n\n  // Perform linear regression (least squares)\n  // returns {m, b} for line y = mx + b\n  function linearRegression(data) {\n    const n = data.length;\n    if (n === 0) return null;\n    let sumX = 0, sumY = 0, sumXY = 0, sumXX = 0;\n    for(const pt of data) {\n      sumX += pt.x;\n      sumY += pt.y;\n      sumXY += pt.x * pt.y;\n      sumXX += pt.x * pt.x;\n    }\n    const meanX = sumX / n;\n    const meanY = sumY / n;\n\n    const denominator = sumXX - sumX * meanX;\n    if (denominator === 0) {\n      // Vertical line / no variation in X\n      return null;\n    }\n    const m = (sumXY - sumX * meanY) / denominator;\n    const b = meanY - m * meanX;\n    return { m, b };\n  }\n\n  // Draw regression line\n  function drawRegressionLine(lr) {\n    if (!lr) return;\n\n    let { m, b } = lr;\n\n    // Compute y for x=0 and x=100 for the line\n    let y1 = b;\n    let y2 = m * 100 + b;\n\n    // Clip line to plot area y bounds [0,100]\n    if (y1 < yRange[0]) {\n      y1 = yRange[0];\n      // x = (y - b)/m\n      if (m !== 0) var x1 = (y1 - b) / m;\n      else var x1 = 0;\n    } else if (y1 > yRange[1]) {\n      y1 = yRange[1];\n      if (m !== 0) var x1 = (y1 - b) / m;\n      else var x1 = 0;\n    } else {\n      var x1 = 0;\n    }\n\n    if (y2 < yRange[0]) {\n      y2 = yRange[0];\n      if (m !== 0) var x2 = (y2 - b) / m;\n      else var x2 = 100;\n    } else if (y2 > yRange[1]) {\n      y2 = yRange[1];\n      if(m !== 0) var x2 = (y2 - b) / m;\n      else var x2 = 100;\n    } else {\n      var x2 = 100;\n    }\n\n    // Now draw line between (x1,y1) and (x2,y2)\n    ctx.strokeStyle = \"blue\";\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo(xToCanvas(x1), yToCanvas(y1));\n    ctx.lineTo(xToCanvas(x2), yToCanvas(y2));\n    ctx.stroke();\n  }\n\n  function draw() {\n    // clear\n    ctx.clearRect(0,0,width,height);\n\n    drawAxes();\n    drawPoints();\n\n    const lr = linearRegression(points);\n    drawRegressionLine(lr);\n    displayRegression(lr);\n  }\n\n  function displayRegression(lr) {\n    const info = document.getElementById(\"info\");\n    if (!lr) {\n      if(points.length === 0){\n        info.textContent = \"Add points by clicking on the canvas to see the regression line.\";\n      } else if(points.length === 1){\n        info.textContent = \"Add at least two points for linear regression.\";\n      } else {\n        info.textContent = \"Cannot compute linear regression (vertical line or all points identical).\";\n      }\n      return;\n    }\n    let { m, b } = lr;\n\n    // Calculate R^2\n    const n = points.length;\n    const meanY = points.reduce((acc, p) => acc + p.y, 0) / n;\n    let ssTot = 0;\n    let ssRes = 0;\n    for(const pt of points){\n      const yi = pt.y;\n      const yPred = m * pt.x + b;\n      ssTot += (yi - meanY) ** 2;\n      ssRes += (yi - yPred) ** 2;\n    }\n    const r2 = 1 - ssRes / ssTot;\n\n    info.innerHTML = `\n      Regression line: y = ${m.toFixed(3)} x + ${b.toFixed(3)} <br/>\n      RÂ² = ${r2.toFixed(3)} <br/>\n      Points: ${points.length}\n    `;\n  }\n\n  // Add point on click\n  canvas.addEventListener(\"click\", (e) => {\n    const rect = canvas.getBoundingClientRect();\n    const px = e.clientX - rect.left;\n    const py = e.clientY - rect.top;\n    const x = canvasToX(px);\n    const y = canvasToY(py);\n    points.push({x, y});\n    draw();\n  });\n\n  // Reset points button\n  document.getElementById(\"resetBtn\").addEventListener(\"click\", () => {\n    points = [];\n    draw();\n  });\n\n  // Initial draw\n  draw();\n})();\n</script>\n\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Linear Regression"
    }
  ],
  "topic": "Linear Regression",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}