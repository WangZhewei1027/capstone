<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red-Black Tree Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #tree {
            margin: 20px auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .node {
            display: inline-block;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            position: relative;
        }
        .red {
            background-color: red;
            color: white;
        }
        .black {
            background-color: black;
            color: white;
        }
        .link {
            position: absolute;
            width: 50px;
            height: 2px;
            background: black;
        }
        .link.left {
            transform: rotate(45deg);
            transform-origin: left bottom;
            left: -35px;
            top: 20px;
        }
        .link.right {
            transform: rotate(-45deg);
            transform-origin: right bottom;
            right: -35px;
            top: 20px;
        }
        #insertValue {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Red-Black Tree Visualization</h1>
    <div id="tree"></div>
    <input type="number" id="insertValue" placeholder="Enter a value to insert">
    <button onclick="insertNode()">Insert</button>

    <script>
        class Node {
            constructor(data) {
                this.data = data;
                this.color = 'red';
                this.left = null;
                this.right = null;
                this.parent = null;
            }
        }

        class RedBlackTree {
            constructor() {
                this.NIL_LEAF = new Node(null);
                this.NIL_LEAF.color = 'black';
                this.root = this.NIL_LEAF;
            }

            insert(data) {
                const newNode = new Node(data);
                newNode.left = this.NIL_LEAF;
                newNode.right = this.NIL_LEAF;

                let temp = this.root;
                let parent = null;

                while (temp !== this.NIL_LEAF) {
                    parent = temp;
                    if (newNode.data < temp.data) {
                        temp = temp.left;
                    } else {
                        temp = temp.right;
                    }
                }

                newNode.parent = parent;

                if (parent == null) {
                    this.root = newNode;
                } else if (newNode.data < parent.data) {
                    parent.left = newNode;
                } else {
                    parent.right = newNode;
                }

                this.fixInsert(newNode);
                this.display();
            }

            fixInsert(node) {
                while (node !== this.root && node.parent.color === 'red') {
                    if (node.parent === node.parent.parent.left) {
                        const uncle = node.parent.parent.right;
                        if (uncle.color === 'red') {
                            node.parent.color = 'black';
                            uncle.color = 'black';
                            node.parent.parent.color = 'red';
                            node = node.parent.parent;
                        } else {
                            if (node === node.parent.right) {
                                node = node.parent;
                                this.rotateLeft(node);
                            }
                            node.parent.color = 'black';
                            node.parent.parent.color = 'red';
                            this.rotateRight(node.parent.parent);
                        }
                    } else {
                        const uncle = node.parent.parent.left;
                        if (uncle.color === 'red') {
                            node.parent.color = 'black';
                            uncle.color = 'black';
                            node.parent.parent.color = 'red';
                            node = node.parent.parent;
                        } else {
                            if (node === node.parent.left) {
                                node = node.parent;
                                this.rotateRight(node);
                            }
                            node.parent.color = 'black';
                            node.parent.parent.color = 'red';
                            this.rotateLeft(node.parent.parent);
                        }
                    }
                }
                this.root.color = 'black';
            }

            rotateLeft(x) {
                const y = x.right;
                x.right = y.left;
                if (y.left !== this.NIL_LEAF) {
                    y.left.parent = x;
                }
                y.parent = x.parent;
                if (x.parent === null) {
                    this.root = y;
                } else if (x === x.parent.left) {
                    x.parent.left = y;
                } else {
                    x.parent.right = y;
                }
                y.left = x;
                x.parent = y;
            }

            rotateRight(y) {
                const x = y.left;
                y.left = x.right;
                if (x.right !== this.NIL_LEAF) {
                    x.right.parent = y;
                }
                x.parent = y.parent;
                if (y.parent === null) {
                    this.root = x;
                } else if (y === y.parent.right) {
                    y.parent.right = x;
                } else {
                    y.parent.left = x;
                }
                x.right = y;
                y.parent = x;
            }

            display() {
                const treeElement = document.getElementById('tree');
                treeElement.innerHTML = '';
                this.renderTree(this.root, treeElement);
            }

            renderTree(node, container) {
                if (node !== this.NIL_LEAF) {
                    const nodeElement = document.createElement('div');
                    nodeElement.className = `node ${node.color}`;
                    nodeElement.innerText = node.data !== null ? node.data : '';
                    container.appendChild(nodeElement);

                    const leftLink = document.createElement('div');
                    leftLink.className = 'link left';
                    const rightLink = document.createElement('div');
                    rightLink.className = 'link right';

                    this.renderTree(node.left, container);
                    if (node.left !== this.NIL_LEAF) {
                        container.appendChild(leftLink);
                    }
                    
                    this.renderTree(node.right, container);
                    if (node.right !== this.NIL_LEAF) {
                        container.appendChild(rightLink);
                    }
                }
            }
        }

        const rbTree = new RedBlackTree();

        function insertNode() {
            const value = parseInt(document.getElementById('insertValue').value);
            if (!isNaN(value)) {
                rbTree.insert(value);
                document.getElementById('insertValue').value = '';
            } else {
                alert('Please enter a valid number');
            }
        }
    </script>
</body>
</html>