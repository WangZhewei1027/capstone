<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red-Black Tree Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
        }
        canvas {
            border: 1px solid #ccc;
            background: #fff;
        }
        input[type="number"] {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<h1>Red-Black Tree Visualization</h1>
<p>Insert a number into the Red-Black Tree:</p>
<input type="number" id="value" placeholder="Enter a number" />
<button id="insert">Insert</button>
<canvas id="treeCanvas" width="800" height="600"></canvas>

<script>
    class Node {
        constructor(data) {
            this.data = data;
            this.color = "red";
            this.left = null;
            this.right = null;
            this.parent = null;
        }
    }

    class RedBlackTree {
        constructor() {
            this.NIL = new Node(null);
            this.NIL.color = "black";
            this.root = this.NIL;
        }

        insert(key) {
            let node = new Node(key);
            node.left = this.NIL;
            node.right = this.NIL;

            let parent = null;
            let current = this.root;

            while (current !== this.NIL) {
                parent = current;
                if (node.data < current.data) {
                    current = current.left;
                } else {
                    current = current.right;
                }
            }

            node.parent = parent;

            if (parent === null) {
                this.root = node;
            } else if (node.data < parent.data) {
                parent.left = node;
            } else {
                parent.right = node;
            }

            node.color = "red";
            this.fixInsert(node);
        }

        fixInsert(node) {
            while (node !== this.root && node.parent.color === "red") {
                if (node.parent === node.parent.parent.left) {
                    const uncle = node.parent.parent.right;

                    if (uncle.color === "red") {
                        node.parent.color = "black";
                        uncle.color = "black";
                        node.parent.parent.color = "red";
                        node = node.parent.parent;
                    } else {
                        if (node === node.parent.right) {
                            node = node.parent;
                            this.rotateLeft(node);
                        }
                        node.parent.color = "black";
                        node.parent.parent.color = "red";
                        this.rotateRight(node.parent.parent);
                    }
                } else {
                    const uncle = node.parent.parent.left;

                    if (uncle.color === "red") {
                        node.parent.color = "black";
                        uncle.color = "black";
                        node.parent.parent.color = "red";
                        node = node.parent.parent;
                    } else {
                        if (node === node.parent.left) {
                            node = node.parent;
                            this.rotateRight(node);
                        }
                        node.parent.color = "black";
                        node.parent.parent.color = "red";
                        this.rotateLeft(node.parent.parent);
                    }
                }
            }
            this.root.color = "black";
        }

        rotateLeft(x) {
            let y = x.right;
            x.right = y.left;

            if (y.left !== this.NIL) {
                y.left.parent = x;
            }
            y.parent = x.parent;

            if (x.parent === null) {
                this.root = y;
            } else if (x === x.parent.left) {
                x.parent.left = y;
            } else {
                x.parent.right = y;
            }

            y.left = x;
            x.parent = y;
        }

        rotateRight(x) {
            let y = x.left;
            x.left = y.right;

            if (y.right !== this.NIL) {
                y.right.parent = x;
            }
            y.parent = x.parent;

            if (x.parent === null) {
                this.root = y;
            } else if (x === x.parent.right) {
                x.parent.right = y;
            } else {
                x.parent.left = y;
            }

            y.right = x;
            x.parent = y;
        }

        draw(ctx, node, x, y, offset) {
            if (node !== this.NIL) {
                ctx.fillStyle = node.color === "red" ? "red" : "black";
                ctx.beginPath();
                ctx.arc(x, y, 20, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = "white";
                ctx.fillText(node.data, x - 5, y + 5);
                
                if (node.left !== this.NIL) {
                    ctx.beginPath();
                    ctx.moveTo(x - 20, y + 20);
                    ctx.lineTo(x - offset, y + 60);
                    ctx.stroke();
                    this.draw(ctx, node.left, x - offset, y + 60, offset / 2);
                }
                if (node.right !== this.NIL) {
                    ctx.beginPath();
                    ctx.moveTo(x + 20, y + 20);
                    ctx.lineTo(x + offset, y + 60);
                    ctx.stroke();
                    this.draw(ctx, node.right, x + offset, y + 60, offset / 2);
                }
            }
        }

        render() {
            const canvas = document.getElementById('treeCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            this.draw(ctx, this.root, canvas.width / 2, 30, 200);
        }
    }

    const tree = new RedBlackTree();
    const insertButton = document.getElementById('insert');

    insertButton.addEventListener('click', () => {
        const valueInput = document.getElementById('value');
        const value = parseInt(valueInput.value);
        if (!isNaN(value)) {
            tree.insert(value);
            tree.render();
            valueInput.value = '';
        }
    });
</script>

</body>
</html>