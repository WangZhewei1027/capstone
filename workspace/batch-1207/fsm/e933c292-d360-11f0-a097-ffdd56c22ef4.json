{
  "meta": {
    "concept": "Heap Sort Visualizer",
    "topic": "Heap Sort",
    "educational_goal": "To demonstrate the Heap Sort algorithm interactively.",
    "expected_interactions": [
      "Play/Pause the sorting animation",
      "Step through the sorting process",
      "Reset the array to its initial state",
      "Shuffle the array randomly",
      "Randomize the values in the array",
      "Change the size of the array",
      "Adjust the speed of the sorting animation",
      "Select sorting order (ascending/descending)"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "Idle",
      "type": "default",
      "entry_actions": [
        "render()"
      ],
      "exit_actions": [],
      "evidence": [
        "setPhase('idle')"
      ],
      "confidence": 1
    },
    {
      "id": "S1_BuildingHeap",
      "label": "Building Heap",
      "type": "process",
      "entry_actions": [
        "setPhase('building heap')"
      ],
      "exit_actions": [],
      "evidence": [
        "setPhase('building heap')"
      ],
      "confidence": 1
    },
    {
      "id": "S2_Extracting",
      "label": "Extracting",
      "type": "process",
      "entry_actions": [
        "setPhase('extracting')"
      ],
      "exit_actions": [],
      "evidence": [
        "setPhase('extracting')"
      ],
      "confidence": 1
    },
    {
      "id": "S3_Finished",
      "label": "Finished",
      "type": "final",
      "entry_actions": [
        "setPhase('finished')"
      ],
      "exit_actions": [],
      "evidence": [
        "setPhase('finished')"
      ],
      "confidence": 1
    }
  ],
  "events": [
    {
      "id": "PlayPause",
      "event_type": "click",
      "description": "Play or pause the sorting animation.",
      "trigger_selectors": [
        "#playBtn"
      ],
      "evidence": [
        "playBtn.addEventListener('click', ()=>{ togglePlay(); });"
      ],
      "confidence": 1
    },
    {
      "id": "Step",
      "event_type": "click",
      "description": "Step through one action of the sorting process.",
      "trigger_selectors": [
        "#stepBtn"
      ],
      "evidence": [
        "stepBtn.addEventListener('click', ()=>{ pause(); step(); });"
      ],
      "confidence": 1
    },
    {
      "id": "Reset",
      "event_type": "click",
      "description": "Reset the array to its initial state.",
      "trigger_selectors": [
        "#resetBtn"
      ],
      "evidence": [
        "resetBtn.addEventListener('click', ()=>{ pause(); arr = createArray(n,5,200); resetStats(); generator = null; heapActiveSize = -1; setPhase('idle'); render(); });"
      ],
      "confidence": 1
    },
    {
      "id": "Shuffle",
      "event_type": "click",
      "description": "Shuffle the array randomly.",
      "trigger_selectors": [
        "#shuffleBtn"
      ],
      "evidence": [
        "shuffleBtn.addEventListener('click', ()=>{ pause(); /* shuffle logic */ resetStats(); generator = null; heapActiveSize = -1; setPhase('idle'); render(); });"
      ],
      "confidence": 1
    },
    {
      "id": "Randomize",
      "event_type": "click",
      "description": "Randomize the values in the array.",
      "trigger_selectors": [
        "#randomizeBtn"
      ],
      "evidence": [
        "randomizeBtn.addEventListener('click', ()=>{ pause(); arr = createArray(n,5,200); resetStats(); generator = null; heapActiveSize = -1; setPhase('idle'); render(); });"
      ],
      "confidence": 1
    },
    {
      "id": "ChangeSize",
      "event_type": "input",
      "description": "Change the size of the array.",
      "trigger_selectors": [
        "#size"
      ],
      "evidence": [
        "sizeInput.addEventListener('input', (e)=>{ n = parseInt(e.target.value,10); sizeVal.textContent = n; pause(); arr = createArray(n,5,200); resetStats(); generator = null; heapActiveSize = -1; render(); });"
      ],
      "confidence": 1
    },
    {
      "id": "ChangeSpeed",
      "event_type": "input",
      "description": "Adjust the speed of the sorting animation.",
      "trigger_selectors": [
        "#speed"
      ],
      "evidence": [
        "speedInput.addEventListener('input', (e)=>{ delay = parseInt(e.target.value,10); speedVal.textContent = delay + 'ms'; });"
      ],
      "confidence": 1
    },
    {
      "id": "ChangeOrder",
      "event_type": "change",
      "description": "Change the sorting order (ascending/descending).",
      "trigger_selectors": [
        "#order"
      ],
      "evidence": [
        "orderSel.addEventListener('change', (e)=>{ order = e.target.value; pause(); resetStats(); generator = null; heapActiveSize = -1; setPhase('idle'); render(); });"
      ],
      "confidence": 1
    },
    {
      "id": "KeyboardSpace",
      "event_type": "keydown",
      "description": "Toggle play/pause with the space bar.",
      "trigger_selectors": [
        "window"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{ if(e.code === 'Space'){ e.preventDefault(); togglePlay(); } });"
      ],
      "confidence": 1
    },
    {
      "id": "KeyboardStep",
      "event_type": "keydown",
      "description": "Step through one action with the right arrow key.",
      "trigger_selectors": [
        "window"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{ if(e.code === 'ArrowRight'){ e.preventDefault(); pause(); step(); } });"
      ],
      "confidence": 1
    }
  ],
  "transitions": [
    {
      "from": "S0_Idle",
      "to": "S1_BuildingHeap",
      "event": "Reset",
      "actions": [],
      "expected_observables": [],
      "evidence": [
        "setPhase('idle')"
      ],
      "confidence": 1
    },
    {
      "from": "S1_BuildingHeap",
      "to": "S2_Extracting",
      "event": "Step",
      "actions": [],
      "expected_observables": [],
      "evidence": [
        "setPhase('extracting')"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Extracting",
      "to": "S3_Finished",
      "event": "Step",
      "actions": [],
      "expected_observables": [],
      "evidence": [
        "setPhase('finished')"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Finished",
      "to": "S0_Idle",
      "event": "Reset",
      "actions": [],
      "expected_observables": [],
      "evidence": [
        "setPhase('idle')"
      ],
      "confidence": 1
    }
  ],
  "components": [
    {
      "type": "button",
      "selector": "#playBtn",
      "text": "Play",
      "attributes": {
        "title": "Play / Pause"
      },
      "evidence": [
        "<button class=\"btn primary\" id=\"playBtn\" title=\"Play / Pause\">Play</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#stepBtn",
      "text": "Step",
      "attributes": {
        "title": "Step one action"
      },
      "evidence": [
        "<button class=\"btn\" id=\"stepBtn\" title=\"Step one action\">Step</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#resetBtn",
      "text": "Reset",
      "attributes": {
        "title": "Reset array"
      },
      "evidence": [
        "<button class=\"btn\" id=\"resetBtn\" title=\"Reset array\">Reset</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#shuffleBtn",
      "text": "Shuffle",
      "attributes": {
        "title": "Shuffle array"
      },
      "evidence": [
        "<button class=\"btn\" id=\"shuffleBtn\" title=\"Shuffle array\">Shuffle</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#randomizeBtn",
      "text": "Randomize Values",
      "attributes": {},
      "evidence": [
        "<button class=\"btn\" id=\"randomizeBtn\">Randomize Values</button>"
      ]
    },
    {
      "type": "input",
      "selector": "#size",
      "text": "",
      "attributes": {
        "min": "8",
        "max": "80",
        "value": "36",
        "type": "range"
      },
      "evidence": [
        "<input type=\"range\" id=\"size\" min=\"8\" max=\"80\" value=\"36\">"
      ]
    },
    {
      "type": "input",
      "selector": "#speed",
      "text": "",
      "attributes": {
        "min": "10",
        "max": "1000",
        "value": "220",
        "type": "range"
      },
      "evidence": [
        "<input type=\"range\" id=\"speed\" min=\"10\" max=\"1000\" value=\"220\">"
      ]
    },
    {
      "type": "select",
      "selector": "#order",
      "text": "",
      "attributes": {
        "title": "Sort order"
      },
      "evidence": [
        "<select id=\"order\" title=\"Sort order\">"
      ]
    }
  ],
  "extraction_summary": {
    "timestamp": "2023-10-05T12:00:00Z",
    "detected_components_count": 7,
    "detected_components": [
      {
        "type": "button",
        "selector": "#playBtn"
      },
      {
        "type": "button",
        "selector": "#stepBtn"
      },
      {
        "type": "button",
        "selector": "#resetBtn"
      },
      {
        "type": "button",
        "selector": "#shuffleBtn"
      },
      {
        "type": "button",
        "selector": "#randomizeBtn"
      },
      {
        "type": "input",
        "selector": "#size"
      },
      {
        "type": "input",
        "selector": "#speed"
      }
    ],
    "detected_event_handlers_count": 9,
    "detected_event_handlers": [
      "playBtn.addEventListener('click', ()=>{ togglePlay(); });",
      "stepBtn.addEventListener('click', ()=>{ pause(); step(); });",
      "resetBtn.addEventListener('click', ()=>{ pause(); arr = createArray(n,5,200); resetStats(); generator = null; heapActiveSize = -1; setPhase('idle'); render(); });",
      "shuffleBtn.addEventListener('click', ()=>{ pause(); /* shuffle logic */ resetStats(); generator = null; heapActiveSize = -1; setPhase('idle'); render(); });",
      "randomizeBtn.addEventListener('click', ()=>{ pause(); arr = createArray(n,5,200); resetStats(); generator = null; heapActiveSize = -1; setPhase('idle'); render(); });",
      "sizeInput.addEventListener('input', (e)=>{ n = parseInt(e.target.value,10); sizeVal.textContent = n; pause(); arr = createArray(n,5,200); resetStats(); generator = null; heapActiveSize = -1; render(); });",
      "speedInput.addEventListener('input', (e)=>{ delay = parseInt(e.target.value,10); speedVal.textContent = delay + 'ms'; });",
      "orderSel.addEventListener('change', (e)=>{ order = e.target.value; pause(); resetStats(); generator = null; heapActiveSize = -1; setPhase('idle'); render(); });",
      "window.addEventListener('keydown', (e)=>{ if(e.code === 'Space'){ e.preventDefault(); togglePlay(); } });",
      "window.addEventListener('keydown', (e)=>{ if(e.code === 'ArrowRight'){ e.preventDefault(); pause(); step(); } });"
    ],
    "extracted_states_count": 4,
    "extracted_transitions_count": 4,
    "extraction_confidence": 1,
    "notes": []
  }
}