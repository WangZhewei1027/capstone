{
  "id": "e93485e1-d360-11f0-a097-ffdd56c22ef4",
  "timestamp": "2025-12-07T11:38:24.001Z",
  "model": "gpt-5-mini",
  "status": "success",
  "question": "Knapsack Problem",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <title>Knapsack Problem — Interactive Demo</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n  <style>\n    body { font-family: system-ui, -apple-system, \"Segoe UI\", Roboto, Ubuntu, \"Helvetica Neue\", Arial; margin: 18px; color: #111; }\n    h1 { margin-top: 0 }\n    .container { display: flex; gap: 18px; align-items: flex-start; flex-wrap: wrap; }\n    .panel { background: #fff; border: 1px solid #ddd; padding: 12px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.04); min-width: 300px; }\n    label { display: block; margin-top: 8px; font-size: 13px; color: #333; }\n    input[type=\"number\"], input[type=\"text\"] { width: 100%; box-sizing: border-box; padding: 6px 8px; margin-top: 6px; border-radius: 6px; border: 1px solid #ccc; }\n    button { margin-top: 10px; padding: 8px 12px; border-radius: 6px; border: 1px solid #2b6cb0; background: linear-gradient(#2b6cb0, #205a9a); color: white; cursor: pointer; }\n    button.secondary { background: #f4f6fb; color: #0b3b66; border: 1px solid #cdd9ea; }\n    button.danger { background: linear-gradient(#f97373,#ef4444); border-color: #e11d48; }\n    .items-list { margin-top: 8px; border-top: 1px dashed #e6eef8; padding-top: 8px; }\n    .item { display:flex; gap: 8px; align-items:center; margin-bottom:8px; }\n    .item input { width: auto; }\n    .small { font-size: 13px; color: #444; }\n    table { border-collapse: collapse; width: 100%; margin-top: 8px; }\n    th, td { border: 1px solid #e7eef8; padding: 6px 8px; text-align: center; font-family: monospace; }\n    th { background: #f7fbff; }\n    .selected { background: linear-gradient(90deg, rgba(197,237,255,0.8), rgba(220,248,255,0.6)); }\n    .highlight { background: #fff8dc; }\n    .ratio { color: #0b3b66; font-weight: 600; }\n    .result { margin-top: 12px; padding: 10px; background:#f7fdfa; border:1px solid #e3f7ec; border-radius:6px; }\n    .note { margin-top: 10px; font-size: 13px; color: #444; }\n    .controls { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }\n    .small-btn { padding:6px 8px; font-size:13px; border-radius:6px; }\n    .footer { margin-top: 16px; font-size: 12px; color: #666; }\n  </style>\n</head>\n<body>\n  <h1>Knapsack Problem — Interactive Demo</h1>\n  <div class=\"container\">\n    <div class=\"panel\" style=\"flex:1 1 360px; max-width:420px;\">\n      <h3>Items</h3>\n      <div class=\"small\">Add items with a weight (positive integer) and a value (number). Names optional.</div>\n      <div style=\"margin-top:8px;\">\n        <label>Name <input id=\"itemName\" type=\"text\" placeholder=\"Item A\"></label>\n        <label>Weight <input id=\"itemWeight\" type=\"number\" min=\"1\" value=\"3\"></label>\n        <label>Value <input id=\"itemValue\" type=\"number\" min=\"0\" value=\"4\"></label>\n        <div class=\"controls\">\n          <button id=\"addItemBtn\">Add item</button>\n          <button id=\"randomBtn\" class=\"secondary small-btn\">Generate random set</button>\n          <button id=\"clearBtn\" class=\"danger small-btn\">Clear all</button>\n        </div>\n      </div>\n\n      <div class=\"items-list\" id=\"itemsList\"></div>\n\n      <label style=\"margin-top:10px\">Knapsack Capacity <input id=\"capacityInput\" type=\"number\" min=\"0\" value=\"7\"></label>\n\n      <label style=\"margin-top:8px\">Choose algorithm</label>\n      <div class=\"controls\">\n        <button id=\"runDpBtn\" class=\"small-btn\">0/1 Knapsack (DP)</button>\n        <button id=\"runFracBtn\" class=\"small-btn secondary\">Fractional Knapsack (Greedy)</button>\n        <button id=\"animateDpBtn\" class=\"small-btn\">Animate DP table</button>\n      </div>\n\n      <div class=\"note\">\n        - 0/1 Knapsack: items are indivisible (each item taken at most once). Uses dynamic programming, exact solution for integer weights.<br>\n        - Fractional Knapsack: allows taking fractions of items; solved by greedy ratio (value/weight).\n      </div>\n    </div>\n\n    <div class=\"panel\" style=\"flex:2 1 520px; min-width:320px;\">\n      <h3>Output & Visualization</h3>\n      <div id=\"outputArea\">\n        <div class=\"small\">Run an algorithm to see results here.</div>\n      </div>\n      <div id=\"dpTableContainer\" style=\"overflow:auto; margin-top:12px;\"></div>\n      <div id=\"fracTableContainer\" style=\"overflow:auto; margin-top:12px;\"></div>\n    </div>\n  </div>\n\n  <div class=\"footer\">\n    Complexity: 0/1 DP O(n * W) time and O(n * W) memory (W = capacity). Fractional greedy O(n log n) due to sorting.\n  </div>\n\n  <script>\n    // State\n    let items = [\n      {name:'A', w:3, v:4},\n      {name:'B', w:4, v:5},\n      {name:'C', w:2, v:3}\n    ];\n\n    // DOM\n    const itemsList = document.getElementById('itemsList');\n    const itemName = document.getElementById('itemName');\n    const itemWeight = document.getElementById('itemWeight');\n    const itemValue = document.getElementById('itemValue');\n    const addItemBtn = document.getElementById('addItemBtn');\n    const randomBtn = document.getElementById('randomBtn');\n    const clearBtn = document.getElementById('clearBtn');\n    const capacityInput = document.getElementById('capacityInput');\n    const runDpBtn = document.getElementById('runDpBtn');\n    const runFracBtn = document.getElementById('runFracBtn');\n    const animateDpBtn = document.getElementById('animateDpBtn');\n    const outputArea = document.getElementById('outputArea');\n    const dpTableContainer = document.getElementById('dpTableContainer');\n    const fracTableContainer = document.getElementById('fracTableContainer');\n\n    // Helpers\n    function renderItems() {\n      itemsList.innerHTML = '';\n      items.forEach((it, idx) => {\n        const el = document.createElement('div');\n        el.className = 'item';\n        el.innerHTML = `\n          <div style=\"width:38px; font-weight:600\">${it.name || ('#'+(idx+1))}</div>\n          <div class=\"small\" style=\"flex:1\">weight: <strong>${it.w}</strong>, value: <strong>${it.v}</strong></div>\n          <div>\n            <button class=\"small-btn secondary\" data-idx=\"${idx}\">Edit</button>\n            <button class=\"small-btn danger\" data-del=\"${idx}\">Del</button>\n          </div>\n        `;\n        itemsList.appendChild(el);\n      });\n      // attach handlers\n      itemsList.querySelectorAll('button[data-idx]').forEach(b=>{\n        b.onclick = () => {\n          const i = +b.getAttribute('data-idx');\n          const it = items[i];\n          const newName = prompt('Name', it.name);\n          if (newName === null) return;\n          const newW = parseInt(prompt('Weight (positive integer)', it.w), 10);\n          if (!Number.isInteger(newW) || newW <= 0) { alert('Invalid weight'); return; }\n          const newV = Number(prompt('Value (number)', it.v));\n          if (isNaN(newV)) { alert('Invalid value'); return; }\n          items[i] = {name: newName, w: newW, v: newV};\n          renderItems();\n        };\n      });\n      itemsList.querySelectorAll('button[data-del]').forEach(b=>{\n        b.onclick = () => {\n          const i = +b.getAttribute('data-del');\n          items.splice(i,1);\n          renderItems();\n        };\n      });\n    }\n\n    addItemBtn.onclick = () => {\n      const name = itemName.value.trim() || null;\n      const w = parseInt(itemWeight.value, 10);\n      const v = Number(itemValue.value);\n      if (!Number.isInteger(w) || w <= 0) { alert('Weight must be a positive integer.'); return; }\n      if (isNaN(v)) { alert('Value must be a number.'); return; }\n      items.push({name, w, v});\n      itemName.value = '';\n      itemWeight.value = 1;\n      itemValue.value = 0;\n      renderItems();\n    };\n\n    randomBtn.onclick = () => {\n      items = [];\n      const n = Math.floor(Math.random()*6) + 4; // 4..9 items\n      for (let i=0;i<n;i++){\n        const w = Math.floor(Math.random()*10) + 1;\n        const v = Math.floor(Math.random()*20) + 1;\n        items.push({name: String.fromCharCode(65+i), w, v});\n      }\n      const cap = Math.floor((items.reduce((s,it)=>s+it.w,0)) * (0.35 + Math.random()*0.45));\n      capacityInput.value = Math.max(1, cap);\n      renderItems();\n    };\n\n    clearBtn.onclick = () => {\n      if (!confirm('Clear all items?')) return;\n      items = [];\n      renderItems();\n      outputArea.innerHTML = '<div class=\"small\">Cleared.</div>';\n      dpTableContainer.innerHTML = '';\n      fracTableContainer.innerHTML = '';\n    };\n\n    // 0/1 Knapsack DP (integer weights)\n    function knapsackDP(items, capacity) {\n      const n = items.length;\n      const W = capacity;\n      // dp[i][w] = max value using first i items (i from 0..n), capacity w (0..W)\n      const dp = Array.from({length: n+1}, ()=> new Array(W+1).fill(0));\n      for (let i=1;i<=n;i++){\n        const wi = items[i-1].w;\n        const vi = items[i-1].v;\n        for (let w=0; w<=W; w++){\n          if (wi > w) dp[i][w] = dp[i-1][w];\n          else dp[i][w] = Math.max(dp[i-1][w], dp[i-1][w-wi] + vi);\n        }\n      }\n      // reconstruct chosen items\n      let w = W;\n      const chosen = [];\n      for (let i=n; i>0; i--){\n        if (dp[i][w] !== dp[i-1][w]) {\n          chosen.push(i-1);\n          w -= items[i-1].w;\n        }\n      }\n      chosen.reverse();\n      return {value: dp[n][W], chosen, dp};\n    }\n\n    // Fractional knapsack greedy\n    function fractionalKnapsack(items, capacity) {\n      const W = capacity;\n      const arr = items.map((it, i) => ({...it, idx:i, ratio: it.v / it.w}));\n      arr.sort((a,b) => b.ratio - a.ratio);\n      let remaining = W;\n      let totalValue = 0;\n      const result = [];\n      for (const it of arr) {\n        if (remaining <= 0) break;\n        if (it.w <= remaining) {\n          result.push({idx: it.idx, take: 1, value: it.v, weight: it.w, ratio: it.ratio});\n          remaining -= it.w;\n          totalValue += it.v;\n        } else {\n          const frac = remaining / it.w;\n          result.push({idx: it.idx, take: frac, value: it.v * frac, weight: remaining, ratio: it.ratio});\n          totalValue += it.v * frac;\n          remaining = 0;\n        }\n      }\n      return {value: totalValue, selection: result};\n    }\n\n    function renderDPResult(res, items, capacity) {\n      outputArea.innerHTML = '';\n      dpTableContainer.innerHTML = '';\n      fracTableContainer.innerHTML = '';\n\n      const selNames = res.chosen.map(i => items[i].name || ('#'+(i+1)));\n      const out = document.createElement('div');\n      out.innerHTML = `\n        <div class=\"result\">\n          <div><strong>Optimal total value:</strong> ${res.value}</div>\n          <div style=\"margin-top:6px\"><strong>Items selected (${res.chosen.length}):</strong> ${selNames.length ? selNames.join(', ') : '(none)'}</div>\n          <div class=\"small\" style=\"margin-top:6px\">Capacity used: ${res.chosen.reduce((s,i)=>s+items[i].w,0)} / ${capacity}</div>\n        </div>\n      `;\n      outputArea.appendChild(out);\n\n      // Render DP table\n      const dp = res.dp;\n      const n = items.length;\n      const W = capacity;\n      const table = document.createElement('table');\n      const thead = document.createElement('thead');\n      const trHead = document.createElement('tr');\n      trHead.appendChild(document.createElement('th')); // corner\n      for (let w=0; w<=W; w++){\n        const th = document.createElement('th');\n        th.textContent = w;\n        trHead.appendChild(th);\n      }\n      thead.appendChild(trHead);\n      table.appendChild(thead);\n      const tbody = document.createElement('tbody');\n      // row 0\n      const tr0 = document.createElement('tr');\n      const th0 = document.createElement('th'); th0.textContent = '0(items)';\n      tr0.appendChild(th0);\n      for (let w=0; w<=W; w++){\n        const td = document.createElement('td'); td.textContent = dp[0][w];\n        tr0.appendChild(td);\n      }\n      tbody.appendChild(tr0);\n      for (let i=1;i<=n;i++){\n        const tr = document.createElement('tr');\n        const th = document.createElement('th');\n        th.textContent = (items[i-1].name || ('#'+i)) + ` (w=${items[i-1].w}, v=${items[i-1].v})`;\n        tr.appendChild(th);\n        for (let w=0; w<=W; w++){\n          const td = document.createElement('td');\n          td.textContent = dp[i][w];\n          // highlight cells that are part of chosen solution path\n          if (res.chosen.includes(i-1)) {\n            // if chosen, and capacity w is >= cumulative weight threshold — can't mark all with confidence.\n            // We'll mark the cell at the time of selection (dp[i][w] != dp[i-1][w])\n            if (dp[i][w] !== dp[i-1][w]) {\n              td.classList.add('selected');\n            }\n          }\n          tr.appendChild(td);\n        }\n        tbody.appendChild(tr);\n      }\n      table.appendChild(tbody);\n      const wrap = document.createElement('div');\n      wrap.innerHTML = `<div style=\"margin-top:10px;font-weight:600\">DP table (rows: items processed, cols: capacity 0..W). Selected transitions highlighted:</div>`;\n      wrap.appendChild(table);\n      dpTableContainer.appendChild(wrap);\n\n      // Show chosen items detail\n      const detail = document.createElement('div');\n      detail.style.marginTop = '8px';\n      const list = res.chosen.map(i=> {\n        const it = items[i];\n        return `<div class=\"small\">${it.name || ('#'+(i+1))} — weight ${it.w}, value ${it.v}</div>`;\n      }).join('');\n      detail.innerHTML = `<div style=\"margin-top:8px\"><strong>Chosen items detail:</strong>${ list || '<div class=\"small\">none</div>' }</div>`;\n      dpTableContainer.appendChild(detail);\n    }\n\n    function renderFractionalResult(res, items, capacity) {\n      outputArea.innerHTML = '';\n      dpTableContainer.innerHTML = '';\n      fracTableContainer.innerHTML = '';\n\n      const out = document.createElement('div');\n      out.innerHTML = `\n        <div class=\"result\">\n          <div><strong>Maximum value achievable (fractional):</strong> ${res.value.toFixed(4)}</div>\n          <div style=\"margin-top:6px\"><strong>Capacity used:</strong> ${res.selection.reduce((s,sel)=>s+sel.weight,0)} / ${capacity}</div>\n        </div>\n      `;\n      outputArea.appendChild(out);\n\n      // Table of selections in order of ratio\n      const table = document.createElement('table');\n      const thead = document.createElement('thead');\n      thead.innerHTML = `<tr><th>Order</th><th>Item</th><th>Weight taken</th><th>Value taken</th><th>Fraction</th><th>Ratio (v/w)</th></tr>`;\n      table.appendChild(thead);\n      const tbody = document.createElement('tbody');\n      res.selection.forEach((s, idx)=>{\n        const tr = document.createElement('tr');\n        const it = items[s.idx];\n        tr.innerHTML = `<td>${idx+1}</td>\n                        <td>${it.name || ('#'+(s.idx+1))} (w=${it.w}, v=${it.v})</td>\n                        <td>${s.weight}</td>\n                        <td>${Number(s.value).toFixed(4)}</td>\n                        <td>${Number(s.take).toFixed(4)}</td>\n                        <td class=\"ratio\">${Number(s.ratio).toFixed(4)}</td>`;\n        tbody.appendChild(tr);\n      });\n      table.appendChild(tbody);\n      fracTableContainer.innerHTML = `<div style=\"font-weight:600;margin-bottom:6px\">Greedy selection by value/weight ratio</div>`;\n      fracTableContainer.appendChild(table);\n    }\n\n    // Animate DP table building step-by-step\n    async function animateDP(items, capacity) {\n      dpTableContainer.innerHTML = '';\n      fracTableContainer.innerHTML = '';\n      outputArea.innerHTML = '<div class=\"small\">Animating DP table. This shows dp[i][w] values being filled. (Click \"Run DP\" to compute final selection.)</div>';\n\n      const n = items.length;\n      const W = capacity;\n      const dp = Array.from({length: n+1}, ()=> new Array(W+1).fill(0));\n\n      // Create table UI\n      const table = document.createElement('table');\n      const thead = document.createElement('thead');\n      const trHead = document.createElement('tr');\n      trHead.appendChild(document.createElement('th'));\n      for (let w=0; w<=W; w++){\n        const th = document.createElement('th');\n        th.textContent = w;\n        trHead.appendChild(th);\n      }\n      thead.appendChild(trHead);\n      table.appendChild(thead);\n      const tbody = document.createElement('tbody');\n      // row 0\n      const tr0 = document.createElement('tr');\n      const th0 = document.createElement('th'); th0.textContent = '0(items)';\n      tr0.appendChild(th0);\n      for (let w=0; w<=W; w++){\n        const td = document.createElement('td'); td.textContent = '0';\n        tr0.appendChild(td);\n      }\n      tbody.appendChild(tr0);\n      for (let i=1;i<=n;i++){\n        const tr = document.createElement('tr');\n        const th = document.createElement('th'); th.textContent = (items[i-1].name || ('#'+i)) + ` (w=${items[i-1].w}, v=${items[i-1].v})`;\n        tr.appendChild(th);\n        for (let w=0; w<=W; w++){\n          const td = document.createElement('td'); td.textContent = ''; td.dataset.i = i; td.dataset.w = w;\n          tr.appendChild(td);\n        }\n        tbody.appendChild(tr);\n      }\n      table.appendChild(tbody);\n      dpTableContainer.appendChild(table);\n\n      // Fill cells with animation\n      function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }\n      for (let i=1;i<=n;i++){\n        const wi = items[i-1].w;\n        const vi = items[i-1].v;\n        for (let w=0; w<=W; w++){\n          // compute dp[i][w]\n          let val;\n          if (wi > w) val = dp[i-1][w];\n          else val = Math.max(dp[i-1][w], dp[i-1][w-wi] + vi);\n          dp[i][w] = val;\n          // update cell in UI\n          const cell = tbody.querySelector(`td[data-i=\"${i}\"][data-w=\"${w}\"]`);\n          cell.textContent = val;\n          // temporarily highlight the cell\n          cell.classList.add('highlight');\n          // also show the option values as tooltip-like small text\n          const opt1 = dp[i-1][w];\n          const opt2 = (wi<=w) ? dp[i-1][w-wi] + vi : '-';\n          cell.title = `without item: ${opt1}\\nwith item: ${opt2}`;\n          await sleep(60); // delay for animation\n          cell.classList.remove('highlight');\n        }\n      }\n      outputArea.innerHTML = '<div class=\"small\">Animation finished. You can now click \"Run DP\" to see which items are selected.</div>';\n      return dp;\n    }\n\n    // Button handlers\n    runDpBtn.onclick = () => {\n      const cap = parseInt(capacityInput.value, 10);\n      if (!Number.isInteger(cap) || cap < 0) { alert('Capacity must be a non-negative integer.'); return; }\n      if (items.length === 0) { alert('No items.'); return; }\n      const res = knapsackDP(items, cap);\n      renderDPResult(res, items, cap);\n    };\n\n    runFracBtn.onclick = () => {\n      const cap = Number(capacityInput.value);\n      if (!isFinite(cap) || cap < 0) { alert('Capacity must be a non-negative number.'); return; }\n      if (items.length === 0) { alert('No items.'); return; }\n      const res = fractionalKnapsack(items, cap);\n      renderFractionalResult(res, items, cap);\n    };\n\n    animateDpBtn.onclick = async () => {\n      const cap = parseInt(capacityInput.value, 10);\n      if (!Number.isInteger(cap) || cap < 0) { alert('Capacity must be a non-negative integer.'); return; }\n      if (items.length === 0) { alert('No items.'); return; }\n      animateDp(items, cap);\n    };\n\n    // Initial render\n    renderItems();\n    outputArea.innerHTML = '<div class=\"small\">Try the controls: add items, set capacity, then run an algorithm.</div>';\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Knapsack Problem"
    }
  ],
  "topic": "Knapsack Problem",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}