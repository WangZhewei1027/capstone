{
  "id": "d7b488b2-d5c2-11f0-9651-0f1ae31ac260",
  "timestamp": "2025-12-10T12:24:18.911Z",
  "model": "gpt-3.5-turbo",
  "status": "success",
  "question": "Linear Regression",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<title>Linear Regression Demonstration</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 20px;\n    background: #f9f9f9;\n  }\n  h1 {\n    text-align: center;\n  }\n  #container {\n    max-width: 900px;\n    margin: 0 auto;\n    background: white;\n    padding: 15px 30px 40px 30px;\n    box-shadow: 0 0 15px rgba(0,0,0,0.1);\n    border-radius: 10px;\n  }\n  #plot {\n    border: 1px solid #ddd;\n    margin-top: 20px;\n    background: #fff;\n  }\n  .controls {\n    display: flex;\n    justify-content: space-between;\n    margin-top: 10px;\n    flex-wrap: wrap;\n  }\n  .control-group {\n    margin: 10px 0;\n    flex: 1 1 250px;\n    max-width: 300px;\n  }\n  label {\n    display: block;\n    margin-bottom: 6px;\n    font-weight: 600;\n  }\n  input[type=number], input[type=text] {\n    width: 100%;\n    padding: 6px 8px;\n    font-size: 16px;\n    box-sizing: border-box;\n  }\n  button {\n    background-color: #0078d7;\n    color: white;\n    border: none;\n    padding: 10px 20px;\n    font-size: 16px;\n    cursor: pointer;\n    border-radius: 4px;\n    margin-top: 10px;\n  }\n  button:hover {\n    background-color: #005fa3;\n  }\n  #info {\n    margin-top: 20px;\n    font-size: 18px;\n  }\n  #info span {\n    font-weight: bold;\n  }\n  #instructions {\n    font-size: 14px;\n    color: #555;\n    margin-top: 15px;\n  }\n</style>\n</head>\n<body>\n  <div id=\"container\">\n    <h1>Linear Regression Demo</h1>\n    <p>\n      Add points by clicking on the plot area. The linear regression line fit to the points will update live.\n    </p>\n    <canvas id=\"plot\" width=\"800\" height=\"400\"></canvas>\n    <div class=\"controls\">\n      <div class=\"control-group\">\n        <button id=\"clearBtn\">Clear Points</button>\n      </div>\n      <div class=\"control-group\">\n        <label for=\"predictX\">Predict y at x = </label>\n        <input type=\"number\" id=\"predictX\" step=\"any\" value=\"0\" />\n        <button id=\"predictBtn\">Predict</button>\n        <div id=\"predictionResult\"></div>\n      </div>\n    </div>\n    <div id=\"info\">\n      <div>Slope (m): <span id=\"slope\">-</span></div>\n      <div>Intercept (b): <span id=\"intercept\">-</span></div>\n      <div>R² (Coefficient of Determination): <span id=\"r2\">-</span></div>\n    </div>\n    <div id=\"instructions\">\n      <p><strong>Instructions:</strong></p>\n      <ul>\n        <li>Click inside the plot area to add data points.</li>\n        <li>The regression line updates as you add points.</li>\n        <li>Use the prediction box to find y for any x using the fitted line.</li>\n        <li>Click \"Clear Points\" to start over.</li>\n      </ul>\n    </div>\n  </div>\n\n<script>\n// Linear Regression Functions\nfunction linearRegression(points) {\n  const n = points.length;\n  if (n === 0) return null;\n  let sumX = 0, sumY = 0, sumXY = 0, sumXX = 0, sumYY=0;\n  for (const p of points) {\n    sumX += p.x;\n    sumY += p.y;\n    sumXY += p.x*p.y;\n    sumXX += p.x*p.x;\n    sumYY += p.y*p.y;\n  }\n  const meanX = sumX / n;\n  const meanY = sumY / n;\n  const denominator = (sumXX - sumX*meanX);\n  if (denominator === 0) {\n    // vertical line or all points same X\n    return null;\n  }\n  const m = (sumXY - sumX*meanY) / denominator;\n  const b = meanY - m*meanX;\n\n  // R squared:\n  // R² = 1 - SS_res / SS_tot\n  let SS_res = 0, SS_tot = 0;\n  for (const p of points) {\n    const y_pred = m*p.x + b;\n    SS_res += (p.y - y_pred)**2;\n    SS_tot += (p.y - meanY)**2;\n  }\n  const r2 = SS_tot === 0 ? 1 : 1 - SS_res/SS_tot;\n  return {m,b,r2};\n}\n\nfunction drawPlot(ctx, points, regression, width, height, padding) {\n  ctx.clearRect(0, 0, width, height);\n\n  // Determine plotting boundaries (with margin)\n  let xs = points.map(p => p.x);\n  let ys = points.map(p => p.y);\n  let minX = Math.min(...xs);\n  let maxX = Math.max(...xs);\n  let minY = Math.min(...ys);\n  let maxY = Math.max(...ys);\n  if (points.length === 0) {\n    minX = 0; maxX = 10;\n    minY = 0; maxY = 10;\n  } else if (maxX === minX) {\n    maxX = minX + 1;\n  } \n  if (maxY === minY) {\n    maxY = minY + 1;\n  }\n  // Add 10% margin\n  const xMargin = (maxX - minX)*0.1;\n  const yMargin = (maxY - minY)*0.1;\n  minX -= xMargin;\n  maxX += xMargin;\n  minY -= yMargin;\n  maxY += yMargin;\n\n  // Functions to transform data <-> canvas coords\n  function xToCanvas(x) {\n    return padding + (x - minX) / (maxX - minX) * (width - 2*padding);\n  }\n  function yToCanvas(y) {\n    return height - padding - (y - minY) / (maxY - minY) * (height - 2*padding);\n  }\n  function canvasToX(cx) {\n    return minX + (cx - padding) / (width - 2*padding) * (maxX - minX);\n  }\n  function canvasToY(cy) {\n    return minY + (height - padding - cy) / (height - 2*padding) * (maxY - minY);\n  }\n\n  // Draw axes\n  ctx.strokeStyle = '#333';\n  ctx.lineWidth = 1.5;\n  ctx.fillStyle = '#333';\n  ctx.font = '13px Arial';\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n\n  // X axis line\n  ctx.beginPath();\n  ctx.moveTo(padding, height - padding);\n  ctx.lineTo(width - padding, height - padding);\n  ctx.stroke();\n\n  // Y axis line\n  ctx.beginPath();\n  ctx.moveTo(padding, padding);\n  ctx.lineTo(padding, height - padding);\n  ctx.stroke();\n\n  // Draw ticks and labels\n  const xTicks = 7;\n  for (let i=0; i<=xTicks; i++) {\n    const xVal = minX + i*(maxX-minX)/xTicks;\n    const cx = xToCanvas(xVal);\n    ctx.beginPath();\n    ctx.moveTo(cx, height - padding);\n    ctx.lineTo(cx, height - padding + 6);\n    ctx.stroke();\n    ctx.fillText(xVal.toFixed(2), cx, height - padding + 18);\n  }\n  const yTicks = 7;\n  ctx.textAlign = 'right';\n  for (let i=0; i<=yTicks; i++) {\n    const yVal = minY + i*(maxY-minY)/yTicks;\n    const cy = yToCanvas(yVal);\n    ctx.beginPath();\n    ctx.moveTo(padding-6, cy);\n    ctx.lineTo(padding, cy);\n    ctx.stroke();\n    ctx.fillText(yVal.toFixed(2), padding-8, cy);\n  }\n\n  // Draw points\n  ctx.fillStyle = '#0078d7';\n  for (const p of points) {\n    const cx = xToCanvas(p.x);\n    const cy = yToCanvas(p.y);\n    ctx.beginPath();\n    ctx.arc(cx, cy, 6, 0, 2*Math.PI);\n    ctx.fill();\n    ctx.strokeStyle = '#004a8f';\n    ctx.lineWidth = 1;\n    ctx.stroke();\n  }\n\n  // Draw regression line if any\n  if (regression) {\n    ctx.strokeStyle = 'crimson';\n    ctx.lineWidth = 3;\n    const x1 = minX;\n    const y1 = regression.m*x1 + regression.b;\n    const x2 = maxX;\n    const y2 = regression.m*x2 + regression.b;\n    const cx1 = xToCanvas(x1);\n    const cy1 = yToCanvas(y1);\n    const cx2 = xToCanvas(x2);\n    const cy2 = yToCanvas(y2);\n\n    ctx.beginPath();\n    ctx.moveTo(cx1, cy1);\n    ctx.lineTo(cx2, cy2);\n    ctx.stroke();\n\n    // Draw equation text near line end\n    ctx.fillStyle = 'crimson';\n    ctx.font = '16px Arial';\n    ctx.textAlign = 'right';\n    ctx.textBaseline = 'top';\n    let mFixed = regression.m.toFixed(3);\n    let bFixed = regression.b.toFixed(3);\n    let eqText = `y = ${mFixed}x + ${bFixed}`;\n    ctx.fillText(eqText, cx2 - 5, cy2 + 5);\n  }\n\n  return {canvasToX, canvasToY};\n}\n\n// Main\n(function() {\n  const canvas = document.getElementById('plot');\n  const ctx = canvas.getContext('2d');\n  const width = canvas.width;\n  const height = canvas.height;\n  const padding = 50;\n\n  let points = [];\n\n  let coordConverters = null;\n\n  function updateRegressionInfo(regr) {\n    const slopeSpan = document.getElementById('slope');\n    const interceptSpan = document.getElementById('intercept');\n    const r2Span = document.getElementById('r2');\n\n    if (!regr) {\n      slopeSpan.textContent = '-';\n      interceptSpan.textContent = '-';\n      r2Span.textContent = '-';\n      return;\n    }\n    slopeSpan.textContent = regr.m.toFixed(5);\n    interceptSpan.textContent = regr.b.toFixed(5);\n    r2Span.textContent = regr.r2.toFixed(5);\n  }\n\n  function redraw() {\n    const regression = linearRegression(points);\n    coordConverters = drawPlot(ctx, points, regression, width, height, padding);\n    updateRegressionInfo(regression);\n  }\n\n  canvas.addEventListener('click', function(e) {\n    const rect = canvas.getBoundingClientRect();\n    const cx = e.clientX - rect.left;\n    const cy = e.clientY - rect.top;\n    if (!coordConverters) {\n      redraw();\n    }\n    const x = coordConverters.canvasToX(cx);\n    const y = coordConverters.canvasToY(cy);\n    points.push({x,y});\n    redraw();\n    document.getElementById('predictionResult').textContent = '';\n  });\n\n  document.getElementById('clearBtn').addEventListener('click', () => {\n    points = [];\n    redraw();\n    document.getElementById('predictionResult').textContent = '';\n  });\n\n  document.getElementById('predictBtn').addEventListener('click', () => {\n    const val = document.getElementById('predictX').value;\n    const xValue = parseFloat(val);\n    if (isNaN(xValue)) {\n      alert('Please enter a valid number for x.');\n      return;\n    }\n    const regression = linearRegression(points);\n    const resultDiv = document.getElementById('predictionResult');\n    if (!regression) {\n      resultDiv.textContent = 'Add at least two points with varying x to perform prediction.';\n      return;\n    }\n    const yPred = regression.m*xValue + regression.b;\n    resultDiv.textContent = `Predicted y = ${yPred.toFixed(5)}`;\n  });\n\n  redraw();\n})();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Linear Regression"
    }
  ],
  "topic": "Linear Regression",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}