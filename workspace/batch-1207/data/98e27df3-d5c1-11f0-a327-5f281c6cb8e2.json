{
  "id": "98e27df3-d5c1-11f0-a327-5f281c6cb8e2",
  "timestamp": "2025-12-10T12:17:34.436Z",
  "model": "gpt-5-mini",
  "status": "success",
  "question": "Knapsack Problem",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\"/>\n  <title>Knapsack Problem — Interactive Demo</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"/>\n  <style>\n    :root{\n      --bg:#0f1724; --card:#0b1220; --accent:#3b82f6; --muted:#94a3b8; --text:#e6eef8;\n      --good:#16a34a; --bad:#ef4444;\n    }\n    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Arial;background:linear-gradient(180deg,#061029 0%,#071526 100%);color:var(--text);}\n    .container{max-width:1100px;margin:28px auto;padding:22px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;border:1px solid rgba(255,255,255,0.03);}\n    header{display:flex;gap:16px;align-items:center;margin-bottom:14px}\n    h1{font-size:20px;margin:0}\n    p.lead{margin:0;color:var(--muted);font-size:13px}\n    .layout{display:flex;gap:18px}\n    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)}\n    .left{width:320px;min-width:260px}\n    .right{flex:1;overflow:auto}\n    label{display:block;font-size:12px;margin-bottom:6px;color:var(--muted)}\n    .row{display:flex;gap:8px;align-items:center;margin-bottom:10px}\n    input[type=\"number\"], input[type=\"text\"], select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)}\n    button{padding:8px 10px;border-radius:8px;border:none;background:var(--accent);color:white;cursor:pointer}\n    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text)}\n    .small{padding:6px 8px;font-size:13px}\n    ul.items{list-style:none;padding:0;margin:8px 0 0 0}\n    li.item{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;margin-bottom:8px;background:linear-gradient(90deg, rgba(255,255,255,0.01), transparent)}\n    .meta{font-size:13px;color:var(--muted)}\n    .controls{display:flex;gap:8px;flex-wrap:wrap}\n    .visual{padding:12px}\n    .table-wrap{overflow:auto;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:rgba(255,255,255,0.01);padding:8px}\n    table.dp{border-collapse:collapse}\n    table.dp td, table.dp th{border:1px solid rgba(255,255,255,0.03);padding:6px;font-family:monospace;text-align:center;min-width:34px}\n    table.dp th{background:rgba(255,255,255,0.02);font-weight:600}\n    .cell-current{background:linear-gradient(90deg, rgba(59,130,246,0.18), rgba(59,130,246,0.06));}\n    .cell-update{background:linear-gradient(90deg, rgba(34,197,94,0.14), rgba(34,197,94,0.04));}\n    .chosen{background:linear-gradient(90deg, rgba(99,102,241,0.12), rgba(99,102,241,0.03));}\n    .legend{display:flex;gap:12px;align-items:center;margin-top:8px;color:var(--muted);font-size:13px}\n    .badge{display:inline-block;padding:4px 8px;border-radius:6px;background:rgba(255,255,255,0.02);font-size:13px}\n    .result{margin-top:12px;padding:10px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid rgba(255,255,255,0.02)}\n    .item-pill{display:inline-block;padding:4px 8px;border-radius:8px;margin-right:6px;background:rgba(255,255,255,0.02)}\n    .speed{width:120px}\n    footer{margin-top:14px;color:var(--muted);font-size:12px}\n    .flex-between{display:flex;justify-content:space-between;align-items:center}\n    .fraction-bar{height:18px;background:rgba(255,255,255,0.03);border-radius:8px;overflow:hidden;display:flex}\n    .fraction-seg{height:100%;display:flex;align-items:center;justify-content:center;font-size:12px;color:white}\n    .fraction-label{font-size:13px;color:var(--muted);margin-top:6px}\n    .warning{color:var(--bad);font-size:13px}\n    .ok{color:var(--good);font-size:13px}\n    .muted{color:var(--muted);font-size:13px}\n    /* responsive */\n    @media (max-width:900px){.layout{flex-direction:column}.left{width:100%}}\n  </style>\n</head>\n<body>\n  <div class=\"container\" role=\"main\">\n    <header>\n      <div>\n        <h1>Knapsack Problem — Interactive Demo</h1>\n        <p class=\"lead\">Explore 0/1 knapsack (dynamic programming) and fractional knapsack (greedy). Add items, set capacity, animate the DP table and see the optimal selection.</p>\n      </div>\n    </header>\n\n    <div class=\"layout\">\n      <div class=\"panel left\">\n        <div class=\"flex-between\">\n          <div>\n            <label>Capacity (integer)</label>\n            <input id=\"capacityInput\" type=\"number\" min=\"1\" max=\"200\" value=\"20\">\n            <div class=\"muted\" style=\"margin-top:6px\">For DP table, keep capacity ≤ 60 for readability.</div>\n          </div>\n          <div style=\"width:10px\"></div>\n        </div>\n\n        <hr style=\"border:none;border-top:1px solid rgba(255,255,255,0.02);margin:12px 0\">\n\n        <label>Items</label>\n        <div style=\"display:flex;gap:8px;margin-bottom:8px\">\n          <input id=\"nameInput\" type=\"text\" placeholder=\"name\" style=\"width:28%\">\n          <input id=\"weightInput\" type=\"number\" placeholder=\"weight\" min=\"1\" value=\"5\" style=\"width:34%\">\n          <input id=\"valueInput\" type=\"number\" placeholder=\"value\" min=\"0\" value=\"10\" style=\"width:34%\">\n        </div>\n        <div class=\"controls\" style=\"margin-bottom:10px\">\n          <button id=\"addItemBtn\" class=\"small\">Add item</button>\n          <button id=\"randomBtn\" class=\"ghost small\">Random items</button>\n          <button id=\"clearBtn\" class=\"ghost small\">Clear</button>\n        </div>\n\n        <ul id=\"itemsList\" class=\"items\" aria-live=\"polite\"></ul>\n\n        <hr style=\"border:none;border-top:1px solid rgba(255,255,255,0.02);margin:12px 0\">\n\n        <label>Algorithm</label>\n        <select id=\"algoSelect\">\n          <option value=\"dp\">0/1 Knapsack — Dynamic Programming (exact)</option>\n          <option value=\"fractional\">Fractional Knapsack — Greedy (by value/weight)</option>\n        </select>\n\n        <div style=\"margin-top:10px\">\n          <label>Animation speed</label>\n          <input id=\"speed\" class=\"speed\" type=\"range\" min=\"10\" max=\"1000\" value=\"200\">\n          <div class=\"muted\" id=\"speedLabel\">delay: 200 ms per cell</div>\n        </div>\n\n        <div style=\"margin-top:10px\" class=\"controls\">\n          <button id=\"runBtn\">Run</button>\n          <button id=\"stepBtn\" class=\"ghost\">Step</button>\n          <button id=\"resetBtn\" class=\"ghost\">Reset</button>\n        </div>\n\n        <div style=\"margin-top:12px\">\n          <label>Options</label>\n          <div style=\"display:flex;gap:8px;margin-top:8px\">\n            <label style=\"font-size:13px\"><input type=\"checkbox\" id=\"showTable\" checked> Show DP table</label>\n            <label style=\"font-size:13px\"><input type=\"checkbox\" id=\"animate\" checked> Animate</label>\n          </div>\n        </div>\n\n        <footer>\n          Tip: Add several items, set capacity, choose DP, then \"Run\" to animate filling the table. Use \"Fractional\" to see greedy filling with partial items.\n        </footer>\n      </div>\n\n      <div class=\"panel right\">\n        <div class=\"visual\">\n          <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:8px\">\n            <div>\n              <div class=\"muted\">Items (weight, value, value/weight)</div>\n            </div>\n            <div>\n              <span class=\"badge\">Capacity: <strong id=\"capBadge\">20</strong></span>\n              <span class=\"badge\">Algorithm: <strong id=\"algBadge\">DP</strong></span>\n            </div>\n          </div>\n\n          <div id=\"itemsPreview\" style=\"margin-bottom:12px\"></div>\n\n          <div id=\"visualArea\">\n            <div id=\"dpArea\">\n              <div class=\"legend\">\n                <div class=\"muted\">DP Table:</div>\n                <div class=\"badge\"><span style=\"display:inline-block;width:10px;height:10px;background:linear-gradient(90deg, rgba(59,130,246,0.18), rgba(59,130,246,0.06));border-radius:2px;margin-right:6px\"></span> current cell</div>\n                <div class=\"badge\"><span style=\"display:inline-block;width:10px;height:10px;background:linear-gradient(90deg, rgba(34,197,94,0.14), rgba(34,197,94,0.04));border-radius:2px;margin-right:6px\"></span> updated when taking item</div>\n                <div class=\"badge\"><span style=\"display:inline-block;width:10px;height:10px;background:linear-gradient(90deg, rgba(99,102,241,0.12), rgba(99,102,241,0.03));border-radius:2px;margin-right:6px\"></span> chosen in final solution</div>\n              </div>\n\n              <div id=\"tableWrap\" class=\"table-wrap\" style=\"margin-top:12px\"></div>\n\n              <div id=\"fracArea\" style=\"margin-top:12px;display:none\">\n                <div class=\"muted\">Fractional knapsack visualization</div>\n                <div style=\"margin-top:8px\" id=\"fractionBar\" class=\"fraction-bar\"></div>\n                <div id=\"fractionInfo\" style=\"margin-top:8px\"></div>\n              </div>\n\n              <div id=\"result\" class=\"result\" style=\"display:none\">\n                <div><strong>Result</strong></div>\n                <div style=\"margin-top:8px\">\n                  <div>Total value: <strong id=\"totalValue\">0</strong></div>\n                  <div>Total weight: <strong id=\"totalWeight\">0</strong></div>\n                  <div style=\"margin-top:8px\">Items chosen:</div>\n                  <div id=\"chosenItems\" style=\"margin-top:6px\"></div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n\n        </div>\n      </div>\n    </div>\n  </div>\n\n<script>\n/*\n  Interactive Knapsack demo\n  - Manage items (name, weight, value)\n  - Choose algorithm: 0/1 DP or Fractional Greedy\n  - Animate DP table fill and reconstruct chosen items\n*/\n\n(() => {\n  // State\n  let items = [\n    {name:'A', w:6, v:30},\n    {name:'B', w:3, v:14},\n    {name:'C', w:4, v:16},\n    {name:'D', w:2, v:9}\n  ];\n  let capacity = 20;\n  let algo = 'dp';\n  let animating = false;\n  let dpTable = [];\n  let currentAnimation = null;\n  let animateEnabled = true;\n  let showTable = true;\n\n  // Elements\n  const itemsListEl = document.getElementById('itemsList');\n  const itemsPreview = document.getElementById('itemsPreview');\n  const capInput = document.getElementById('capacityInput');\n  const capBadge = document.getElementById('capBadge');\n  const nameInput = document.getElementById('nameInput');\n  const weightInput = document.getElementById('weightInput');\n  const valueInput = document.getElementById('valueInput');\n  const addItemBtn = document.getElementById('addItemBtn');\n  const randomBtn = document.getElementById('randomBtn');\n  const clearBtn = document.getElementById('clearBtn');\n  const algoSelect = document.getElementById('algoSelect');\n  const algBadge = document.getElementById('algBadge');\n  const runBtn = document.getElementById('runBtn');\n  const stepBtn = document.getElementById('stepBtn');\n  const resetBtn = document.getElementById('resetBtn');\n  const tableWrap = document.getElementById('tableWrap');\n  const dpArea = document.getElementById('dpArea');\n  const resultEl = document.getElementById('result');\n  const totalValueEl = document.getElementById('totalValue');\n  const totalWeightEl = document.getElementById('totalWeight');\n  const chosenItemsEl = document.getElementById('chosenItems');\n  const fractionBar = document.getElementById('fractionBar');\n  const fractionInfo = document.getElementById('fractionInfo');\n  const fracArea = document.getElementById('fracArea');\n  const speedInput = document.getElementById('speed');\n  const speedLabel = document.getElementById('speedLabel');\n  const showTableCheck = document.getElementById('showTable');\n  const animateCheck = document.getElementById('animate');\n\n  // Utility\n  function renderItemsList(){\n    itemsListEl.innerHTML = '';\n    items.forEach((it, idx) => {\n      const li = document.createElement('li');\n      li.className = 'item';\n      const left = document.createElement('div');\n      left.style.display = 'flex';\n      left.style.flexDirection = 'column';\n      left.innerHTML = `<strong style=\"font-size:14px\">${it.name}</strong><span class=\"meta\">w:${it.w}  v:${it.v}  ${ (it.v/it.w).toFixed(2)} value/w</span>`;\n      const right = document.createElement('div');\n      right.style.display = 'flex';\n      right.style.gap = '8px';\n      const del = document.createElement('button');\n      del.className = 'ghost small';\n      del.textContent = 'Remove';\n      del.onclick = () => { items.splice(idx,1); updateAll(); };\n      right.appendChild(del);\n      li.appendChild(left);\n      li.appendChild(right);\n      itemsListEl.appendChild(li);\n    });\n    renderItemsPreview();\n  }\n\n  function renderItemsPreview(){\n    itemsPreview.innerHTML = '';\n    if(items.length===0){\n      itemsPreview.innerHTML = '<div class=\"muted\">No items yet. Add items or generate random ones.</div>';\n      algBadge.textContent = algo === 'dp' ? 'DP' : 'Fractional';\n      capBadge.textContent = capacity;\n      return;\n    }\n    itemsPreview.appendChild(document.createElement('div'));\n    const container = document.createElement('div');\n    items.forEach((it,idx)=>{\n      const pill = document.createElement('span');\n      pill.className = 'item-pill';\n      pill.textContent = `${it.name}: w=${it.w}, v=${it.v}, r=${(it.v/it.w).toFixed(2)}`;\n      container.appendChild(pill);\n    });\n    itemsPreview.appendChild(container);\n    algBadge.textContent = algo === 'dp' ? 'DP' : 'Fractional';\n    capBadge.textContent = capacity;\n  }\n\n  function updateAll(){\n    capacity = Math.max(1, Math.floor(Number(capInput.value) || 0));\n    capInput.value = capacity;\n    capBadge.textContent = capacity;\n    algo = algoSelect.value;\n    algBadge.textContent = algo === 'dp' ? 'DP' : 'Fractional';\n    animateEnabled = animateCheck.checked;\n    showTable = showTableCheck.checked;\n    renderItemsList();\n    clearVisualization();\n    if(algo === 'fractional'){\n      fracArea.style.display = 'block';\n    } else {\n      fracArea.style.display = 'none';\n    }\n  }\n\n  // Handlers\n  addItemBtn.addEventListener('click', ()=>{\n    const name = nameInput.value.trim() || `I${items.length+1}`;\n    const w = Math.max(1, Math.floor(Number(weightInput.value) || 0));\n    const v = Math.max(0, Number(valueInput.value) || 0);\n    items.push({name,w,v});\n    nameInput.value=''; weightInput.value='1'; valueInput.value='0';\n    updateAll();\n  });\n\n  randomBtn.addEventListener('click', ()=>{\n    items = [];\n    const n = Math.floor(Math.random()*6)+3;\n    for(let i=0;i<n;i++){\n      const w = Math.floor(Math.random()*9)+1;\n      const v = Math.floor(Math.random()*(w*8))+5;\n      items.push({name: String.fromCharCode(65+i), w, v});\n    }\n    updateAll();\n  });\n\n  clearBtn.addEventListener('click', ()=>{\n    items = [];\n    updateAll();\n  });\n\n  capInput.addEventListener('change', updateAll);\n  algoSelect.addEventListener('change', updateAll);\n  animateCheck.addEventListener('change', updateAll);\n  showTableCheck.addEventListener('change', updateAll);\n\n  speedInput.addEventListener('input', ()=>{\n    speedLabel.textContent = `delay: ${speedInput.value} ms per cell`;\n  });\n\n  resetBtn.addEventListener('click', ()=>{\n    if(currentAnimation){ clearTimeout(currentAnimation); currentAnimation = null; }\n    animating = false;\n    clearVisualization();\n  });\n\n  stepBtn.addEventListener('click', async ()=>{\n    if(algo === 'dp'){\n      if(!dpTable || dpTable.length===0){\n        prepareDP();\n      }\n      // Step one cell\n      await dpStep();\n    } else {\n      runFractional(true);\n    }\n  });\n\n  runBtn.addEventListener('click', async ()=>{\n    if(algo === 'dp'){\n      runDP();\n    } else {\n      runFractional();\n    }\n  });\n\n  // Visualization helpers\n  function clearVisualization(){\n    tableWrap.innerHTML = '';\n    fractionBar.innerHTML = '';\n    fractionInfo.innerHTML = '';\n    resultEl.style.display='none';\n    totalValueEl.textContent = '0';\n    totalWeightEl.textContent = '0';\n    chosenItemsEl.innerHTML = '';\n    dpTable = [];\n    if(currentAnimation){ clearTimeout(currentAnimation); currentAnimation = null; }\n    animating = false;\n  }\n\n  // DP Implementation with animation/step support\n  // We'll maintain state machine for stepping: i index and w index\n  let dpState = {i:0, w:0, dp:[], parent:[]}; // parent for reconstruction when taking\n  function prepareDP(){\n    clearVisualization();\n    const n = items.length;\n    const C = capacity;\n    // initialize dp matrix (n+1) x (C+1) filled with 0\n    const dp = Array.from({length:n+1}, ()=> new Array(C+1).fill(0));\n    // parent: boolean take or not (for reconstruction) at each cell when filled\n    const take = Array.from({length:n+1}, ()=> new Array(C+1).fill(false));\n    dpState = {i:1, w:0, dp, take};\n    // Render table skeleton\n    renderDPTable(dp);\n  }\n\n  function renderDPTable(dp){\n    tableWrap.innerHTML = '';\n    if(!showTable){\n      tableWrap.innerHTML = '<div class=\"muted\">DP table hidden (toggle \"Show DP table\")</div>';\n      return;\n    }\n    const n = dp.length-1;\n    const C = dp[0].length-1;\n    const table = document.createElement('table');\n    table.className = 'dp';\n    const thead = document.createElement('thead');\n    const headRow = document.createElement('tr');\n    headRow.appendChild(document.createElement('th')); // corner\n    for(let w=0;w<=C;w++){\n      const th = document.createElement('th'); th.textContent = w; headRow.appendChild(th);\n    }\n    thead.appendChild(headRow);\n    table.appendChild(thead);\n    const tbody = document.createElement('tbody');\n    for(let i=0;i<=n;i++){\n      const tr = document.createElement('tr');\n      const th = document.createElement('th');\n      th.textContent = i===0 ? 'i=0' : `${items[i-1].name} (w${items[i-1].w})`;\n      tr.appendChild(th);\n      for(let w=0;w<=C;w++){\n        const td = document.createElement('td');\n        td.id = `cell_${i}_${w}`;\n        td.textContent = dp[i][w];\n        tr.appendChild(td);\n      }\n      tbody.appendChild(tr);\n    }\n    table.appendChild(tbody);\n    tableWrap.appendChild(table);\n  }\n\n  async function dpStep(){\n    // Performs a single cell step (or completes reconstruction once done)\n    if(!dpState.dp){ prepareDP(); return; }\n    const {dp, take} = dpState;\n    const n = dp.length-1;\n    const C = dp[0].length-1;\n    let {i,w} = dpState;\n\n    // if finished with all items: reconstruct and show result\n    if(i > n){\n      reconstructDP(dp, take);\n      return;\n    }\n\n    // find next w target cell (we iterate w from 0..C then increment i)\n    if(w > C){\n      dpState.i++; dpState.w = 0; animating = false;\n      await dpStep(); // continue with next row\n      return;\n    }\n\n    // highlight current cell\n    highlightCell(i,w,'current');\n\n    // compute value\n    await sleep( animateEnabled ? Number(speedInput.value) : 0 );\n\n    const it = items[i-1];\n    const without = dp[i-1][w];\n    let withVal = -Infinity;\n    if(it.w <= w) withVal = dp[i-1][w - it.w] + it.v;\n\n    const targetCell = document.getElementById(`cell_${i}_${w}`);\n    // update dp and optionally highlight if taking improves\n    if(withVal > without){\n      dp[i][w] = withVal;\n      take[i][w] = true;\n      if(targetCell){\n        targetCell.textContent = withVal;\n        addClass(targetCell,'cell-update');\n      }\n    } else {\n      dp[i][w] = without;\n      take[i][w] = false;\n      if(targetCell){\n        targetCell.textContent = without;\n      }\n    }\n\n    // small delay to show update\n    await sleep( animateEnabled ? Math.max(50, Number(speedInput.value)/2) : 0 );\n\n    // remove highlight classes for this cell\n    unhighlightCell(i,w);\n\n    // advance\n    dpState.w++;\n    // if we've reached end of row, move to next row in next step\n    if(dpState.w > C) dpState.i++;\n\n    // if running full animation, schedule next step\n    if(animating){\n      currentAnimation = setTimeout(()=> dpStep(), animateEnabled ? Number(speedInput.value) : 0);\n    }\n  }\n\n  function highlightCell(i,w,cls='current'){\n    const el = document.getElementById(`cell_${i}_${w}`);\n    if(el){\n      if(cls==='current') addClass(el,'cell-current');\n      else if(cls==='update') addClass(el,'cell-update');\n    }\n  }\n  function unhighlightCell(i,w){\n    const el = document.getElementById(`cell_${i}_${w}`);\n    if(el){\n      removeClass(el,'cell-current');\n      removeClass(el,'cell-update');\n    }\n  }\n\n  function addClass(el,cls){\n    if(!el) return;\n    if(!el.classList.contains(cls)) el.classList.add(cls);\n  }\n  function removeClass(el,cls){\n    if(!el) return;\n    el.classList.remove(cls);\n  }\n\n  async function runDP(){\n    if(items.length===0){\n      alert('Add some items first.');\n      return;\n    }\n    prepareDP();\n    animating = true;\n    // start stepping automatically\n    if(currentAnimation){ clearTimeout(currentAnimation); currentAnimation = null; }\n    currentAnimation = setTimeout(()=> dpStep(), 10);\n  }\n\n  function reconstructDP(dp, take){\n    // reconstruct selected items from take[][] table\n    const n = dp.length-1; const C = dp[0].length-1;\n    let w = C;\n    const chosen = [];\n    for(let i=n;i>=1;i--){\n      if(take[i][w]){\n        chosen.push(items[i-1]);\n        // mark chosen cells visually in first column (we'll mark the entire row cells where used)\n        w -= items[i-1].w;\n      }\n    }\n    showResultDP(dp[n][C], chosen);\n    // highlight chosen cells in table for better visualization: we'll mark top row index for items\n    chosen.forEach(it => {\n      // mark item name cell in table header row\n      // find item index\n      const idx = items.indexOf(it);\n      if(idx>=0){\n        const row = idx+1;\n        for(let col=0;col<=C;col++){\n          const cell = document.getElementById(`cell_${row}_${col}`);\n          if(cell) addClass(cell,'chosen');\n        }\n      }\n    });\n    animating = false;\n    if(currentAnimation){ clearTimeout(currentAnimation); currentAnimation = null; }\n  }\n\n  function showResultDP(value, chosen){\n    resultEl.style.display = 'block';\n    totalValueEl.textContent = String(value);\n    const totalW = chosen.reduce((s,it)=>s+it.w,0);\n    totalWeightEl.textContent = String(totalW);\n    chosenItemsEl.innerHTML = '';\n    if(chosen.length===0){\n      chosenItemsEl.innerHTML = '<div class=\"muted\">No items chosen (capacity too small or values zero).</div>';\n      return;\n    }\n    chosen.slice().reverse().forEach(it=>{\n      const span = document.createElement('span');\n      span.className = 'item-pill';\n      span.textContent = `${it.name} (w:${it.w}, v:${it.v})`;\n      chosenItemsEl.appendChild(span);\n    });\n  }\n\n  // Fractional knapsack (greedy) visualization\n  function runFractional(stepOnly=false){\n    if(items.length===0){ alert('Add some items first.'); return; }\n    clearVisualization();\n    // sort items by value/weight ratio\n    const list = items.map(it => ({...it, ratio: it.v/it.w})).sort((a,b)=>b.ratio - a.ratio);\n    // visualize filling\n    let remaining = capacity;\n    let totalV = 0;\n    let totalW = 0;\n    fractionBar.innerHTML = '';\n    fractionInfo.innerHTML = '';\n    const segments = [];\n    for(const it of list){\n      if(remaining<=0) break;\n      if(it.w <= remaining){\n        // take whole\n        segments.push({it, frac:1});\n        remaining -= it.w;\n        totalV += it.v;\n        totalW += it.w;\n      } else {\n        // take fraction\n        const frac = remaining / it.w;\n        segments.push({it, frac});\n        totalV += it.v * frac;\n        totalW += it.w * frac;\n        remaining = 0;\n      }\n    }\n    // build visual bar\n    const usedCapacity = capacity - remaining;\n    segments.forEach(s=>{\n      const seg = document.createElement('div');\n      const width = (s.it.w * s.frac) / capacity * 100;\n      seg.style.width = width+'%';\n      seg.className = 'fraction-seg';\n      seg.style.background = `linear-gradient(90deg, rgba(59,130,246,0.8), rgba(96,165,250,0.8))`;\n      seg.textContent = `${s.it.name}${s.frac<1 ? ('×'+s.frac.toFixed(2)) : ''}`;\n      fractionBar.appendChild(seg);\n    });\n    if(usedCapacity < capacity){\n      const rem = document.createElement('div');\n      rem.style.width = ((capacity-usedCapacity)/capacity*100)+'%';\n      rem.className = 'fraction-seg';\n      rem.style.background = 'rgba(255,255,255,0.03)';\n      rem.style.color = 'var(--muted)';\n      rem.textContent = 'free';\n      fractionBar.appendChild(rem);\n    }\n    // show info\n    fractionInfo.innerHTML = `<div>Total value ≈ <strong>${totalV.toFixed(3)}</strong></div>\n                              <div>Total weight = <strong>${totalW.toFixed(3)}</strong> / ${capacity}</div>`;\n    // detailed list\n    const listHtml = segments.map(s => {\n      const frac = s.frac;\n      const val = s.it.v * frac;\n      return `<div style=\"margin-top:6px\"><strong>${s.it.name}</strong>: taken ${ (frac*100).toFixed(1)}% — weight ${ (s.it.w*frac).toFixed(3) }, value ${ val.toFixed(3) } (ratio ${s.it.ratio.toFixed(3)})</div>`;\n    }).join('');\n    fractionInfo.innerHTML += listHtml;\n    // show final result area\n    resultEl.style.display = 'block';\n    totalValueEl.textContent = totalV.toFixed(3);\n    totalWeightEl.textContent = totalW.toFixed(3);\n    chosenItemsEl.innerHTML = segments.map(s => `<span class=\"item-pill\">${s.it.name}${s.frac<1 ? ('×'+s.frac.toFixed(2)) : ''}</span>`).join(' ');\n  }\n\n  // helper sleep\n  function sleep(ms){ return new Promise(resolve => setTimeout(resolve, ms)); }\n\n  // small helper to run step when user pressed Step repeatedly\n  async function dpStepOnce(){\n    if(!dpState.dp) prepareDP();\n    await dpStep();\n  }\n\n  // Expose dpStep used by stepBtn\n  async function dpStepWrapper(){\n    if(!dpState.dp) prepareDP();\n    animating = false;\n    await dpStep();\n  }\n\n  // attach step button to dpStepWrapper or fractional step\n  stepBtn.addEventListener('click', () => {\n    if(algo === 'dp'){\n      dpStepWrapper();\n    } else {\n      runFractional(true);\n    }\n  });\n\n  // initialization\n  updateAll();\n\n  // ensure initial DP table renders if user runs\n  window.addEventListener('resize', ()=> { /* could reflow if needed */ });\n\n  // Provide keyboard shortcuts for convenience\n  window.addEventListener('keydown', (e) => {\n    if(e.key === 'r' && e.ctrlKey){ e.preventDefault(); runBtn.click(); }\n  });\n\n  // Small UX: cap capacity for table visualization, warn\n  capInput.addEventListener('input', ()=>{\n    const v = Number(capInput.value) || 0;\n    if(v > 60){\n      capInput.style.borderColor = 'rgba(239,68,68,0.6)';\n    } else {\n      capInput.style.borderColor = '';\n    }\n  });\n\n})();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Knapsack Problem"
    }
  ],
  "topic": "Knapsack Problem",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}