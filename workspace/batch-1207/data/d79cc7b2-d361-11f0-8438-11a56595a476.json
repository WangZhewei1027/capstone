{
  "id": "d79cc7b2-d361-11f0-8438-11a56595a476",
  "timestamp": "2025-12-07T11:43:48.130Z",
  "model": "gpt-3.5-turbo",
  "status": "success",
  "question": "Heap Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<title>Heap Sort Visualization</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 20px;\n    background: #f9f9f9;\n  }\n  h1 {\n    text-align: center;\n    color: #333;\n  }\n  #inputArea {\n    text-align: center;\n    margin-bottom: 15px;\n  }\n  #arrayInput {\n    width: 60%;\n    padding: 8px;\n    font-size: 16px;\n  }\n  button {\n    padding: 9px 15px;\n    font-size: 16px;\n    margin-left: 10px;\n    cursor: pointer;\n    background-color: #2874f0;\n    color: white;\n    border: none;\n    border-radius: 5px;\n  }\n  button:hover {\n    background-color: #155ab6;\n  }\n  #bars {\n    display: flex;\n    align-items: flex-end;\n    justify-content: center;\n    height: 300px;\n    margin-top: 20px;\n    gap: 5px;\n    border-top: 2px solid #666;\n    border-bottom: 2px solid #666;\n    background: white;\n    padding: 10px 0;\n    max-width: 90vw;\n    margin-left: auto;\n    margin-right: auto;\n  }\n  .bar {\n    width: 20px;\n    background-color: #2874f0;\n    border-radius: 3px 3px 0 0;\n    position: relative;\n  }\n  .bar.highlight {\n    background-color: #e67e22;\n  }\n  .bar.swap {\n    background-color: #e74c3c;\n  }\n  .bar.sorted {\n    background-color: #2ecc71;\n  }\n  .bar::after {\n    content: attr(data-value);\n    position: absolute;\n    bottom: 100%;\n    left: 50%;\n    transform: translateX(-50%);\n    font-size: 12px;\n    color: #222;\n  }\n  #log {\n    max-width: 90vw;\n    margin: 20px auto 0;\n    background: white;\n    padding: 15px;\n    border-radius: 8px;\n    font-family: monospace;\n    height: 150px;\n    overflow-y: auto;\n    box-shadow: 0 0 8px #ccc;\n  }\n</style>\n</head>\n<body>\n<h1>Heap Sort Visualization</h1>\n<div id=\"inputArea\">\n  <input type=\"text\" id=\"arrayInput\" placeholder=\"Enter numbers separated by commas\" />\n  <button id=\"startBtn\">Start Heap Sort</button>\n</div>\n<div id=\"bars\"></div>\n<div id=\"log\"></div>\n\n<script>\n(() => {\n  const barsContainer = document.getElementById(\"bars\");\n  const input = document.getElementById(\"arrayInput\");\n  const startBtn = document.getElementById(\"startBtn\");\n  const logEl = document.getElementById(\"log\");\n\n  let array = [];\n  let delay = 600; // milliseconds per animation step\n\n  function log(message) {\n    logEl.textContent += message + \"\\n\";\n    logEl.scrollTop = logEl.scrollHeight;\n  }\n\n  function clearLog() {\n    logEl.textContent = \"\";\n  }\n\n  function createBars(arr) {\n    barsContainer.innerHTML = \"\";\n    const maxVal = Math.max(...arr);\n    arr.forEach((val) => {\n      const bar = document.createElement(\"div\");\n      bar.classList.add(\"bar\");\n      bar.style.height = ((val / maxVal) * 250 + 20) + \"px\";\n      bar.setAttribute(\"data-value\", val);\n      barsContainer.appendChild(bar);\n    });\n  }\n\n  function sleep(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  async function swap(arr, i, j) {\n    log(`Swapping indices ${i} (${arr[i]}) and ${j} (${arr[j]})`);\n    [arr[i], arr[j]] = [arr[j], arr[i]];\n    updateBars(arr, i, j, true);\n    await sleep(delay);\n    updateBars(arr);\n  }\n\n  function updateBars(arr, highlight1 = -1, highlight2 = -1, swap = false, sortedUntil = -1) {\n    const bars = barsContainer.children;\n    const maxVal = Math.max(...arr);\n    for (let i = 0; i < arr.length; i++) {\n      const bar = bars[i];\n      bar.style.height = ((arr[i] / maxVal) * 250 + 20) + \"px\";\n      bar.setAttribute(\"data-value\", arr[i]);\n      bar.classList.remove(\"highlight\", \"swap\", \"sorted\");\n      if(i <= sortedUntil) {\n        bar.classList.add(\"sorted\");\n      }\n      if (i === highlight1 || i === highlight2) {\n        if (swap) {\n          bar.classList.add(\"swap\");\n        } else {\n          bar.classList.add(\"highlight\");\n        }\n      }\n    }\n  }\n\n  async function heapify(arr, n, i) {\n    let largest = i;\n    const left = 2 * i + 1;\n    const right = 2 * i + 2;\n\n    updateBars(arr, i);\n    await sleep(delay);\n\n    if (left < n) {\n      log(`Compare arr[${left}] (${arr[left]}) and arr[${largest}] (${arr[largest]})`);\n      updateBars(arr, left, largest);\n      await sleep(delay);\n      if (arr[left] > arr[largest]) {\n        largest = left;\n      }\n    }\n\n    if (right < n) {\n      log(`Compare arr[${right}] (${arr[right]}) and arr[${largest}] (${arr[largest]})`);\n      updateBars(arr, right, largest);\n      await sleep(delay);\n      if (arr[right] > arr[largest]) {\n        largest = right;\n      }\n    }\n\n    if (largest !== i) {\n      await swap(arr, i, largest);\n      await heapify(arr, n, largest);\n    }\n  }\n\n  async function heapSort(arr) {\n    const n = arr.length;\n\n    log(\"Building Max Heap...\");\n    // Build max heap\n    for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {\n      await heapify(arr, n, i);\n    }\n    log(\"Max Heap built.\");\n\n    // One by one extract elements\n    log(\"Extracting elements from heap and sorting...\");\n    for (let i = n - 1; i > 0; i--) {\n      await swap(arr, 0, i);\n      updateBars(arr, -1, -1, false, n - 1 - i);\n      await heapify(arr, i, 0);\n      updateBars(arr, -1, -1, false, n - 1 - i + 1);\n    }\n    // Mark all as sorted\n    updateBars(arr, -1, -1, false, n - 1);\n    log(\"Heap sort completed.\");\n  }\n\n  startBtn.addEventListener(\"click\", async () => {\n    clearLog();\n    let raw = input.value.trim();\n    if (!raw) {\n      alert(\"Please enter some numbers separated by commas.\");\n      return;\n    }\n    let parsed = raw.split(\",\").map(x => Number(x.trim())).filter(x => !isNaN(x));\n    if (parsed.length === 0) {\n      alert(\"Enter valid numbers separated by commas.\");\n      return;\n    }\n    if (parsed.length > 50) {\n      alert(\"Please enter 50 or fewer numbers for visualization.\");\n      return;\n    }\n    array = parsed;\n    createBars(array);\n    startBtn.disabled = true;\n    input.disabled = true;\n    try {\n      await heapSort(array);\n    } catch(e) {\n      log(\"Error occurred: \" + e.message);\n    } finally {\n      startBtn.disabled = false;\n      input.disabled = false;\n    }\n  });\n})();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Heap Sort"
    }
  ],
  "topic": "Heap Sort",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}