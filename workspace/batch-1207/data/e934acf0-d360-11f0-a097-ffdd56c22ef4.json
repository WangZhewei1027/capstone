{
  "id": "e934acf0-d360-11f0-a097-ffdd56c22ef4",
  "timestamp": "2025-12-07T11:39:12.820Z",
  "model": "gpt-5-mini",
  "status": "success",
  "question": "Huffman Coding",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Huffman Coding Visualizer</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n  <style>\n    :root{\n      --bg:#0f1724;\n      --panel:#0b1220;\n      --accent:#38bdf8;\n      --muted:#94a3b8;\n      --card:#071226;\n      --success:#10b981;\n      --danger:#fb7185;\n      --glass: rgba(255,255,255,0.03);\n    }\n    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,\"Segoe UI\",Roboto,\"Helvetica Neue\",\"Noto Sans\",Arial;}\n    body{\n      margin:0;\n      background:linear-gradient(180deg,var(--bg),#02111a 60%);\n      color:#e6eef8;\n      padding:18px;\n    }\n    header{display:flex;align-items:center;gap:12px;margin-bottom:14px;}\n    h1{font-size:20px;margin:0;color:var(--accent);}\n    .desc{color:var(--muted);font-size:13px;margin-top:2px;}\n    .container{display:grid;grid-template-columns:380px 1fr;gap:18px;}\n    .panel{\n      background:linear-gradient(180deg,var(--panel),#041226);border-radius:10px;padding:14px;\n      box-shadow:0 6px 18px rgba(2,6,23,0.6);\n    }\n    label{font-size:13px;color:var(--muted);}\n    textarea{width:100%;min-height:120px;background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px;border-radius:8px;color:inherit;resize:vertical;}\n    .row{display:flex;gap:8px;margin-top:8px;}\n    button{background:linear-gradient(90deg,var(--accent),#6ee7b7);color:#02111a;border:0;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:600;}\n    button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);}\n    .small{padding:6px 8px;font-size:13px;border-radius:7px;}\n    .muted{color:var(--muted);font-size:13px;margin-top:8px;}\n    .freqs{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;}\n    .chip{background:var(--glass);padding:6px 8px;border-radius:8px;font-size:13px;border:1px solid rgba(255,255,255,0.03);}\n    .controls{display:flex;gap:8px;margin-top:10px;align-items:center;}\n    .steps{display:flex;gap:8px;align-items:center;margin-top:10px;}\n    .codeTable{margin-top:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);}\n    table{width:100%;border-collapse:collapse;}\n    th,td{padding:6px;font-size:13px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.02);color:var(--muted);}\n    th{color:var(--accent);font-weight:700;}\n    .svgWrap{background:linear-gradient(180deg,#02182744,transparent);border-radius:8px;padding:8px;overflow:auto;}\n    .pqList{display:flex;flex-direction:column;gap:6px;margin-top:8px;}\n    .pqItem{display:flex;gap:8px;align-items:center;background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.02);}\n    .pqLabel{font-weight:700;color:var(--accent);min-width:60px;}\n    .freq{color:var(--muted);}\n    .status{margin-top:10px;color:var(--muted);font-size:13px;}\n    .bigBits{background:#001825;padding:8px;border-radius:8px;margin-top:10px;font-family:monospace;color:#9ae6ff;word-break:break-all;}\n    .ratio{margin-top:6px;color:var(--muted);}\n    .legend{display:flex;gap:8px;align-items:center;margin-top:8px;}\n    .legendItem{display:flex;gap:6px;align-items:center;color:var(--muted);font-size:13px;}\n    .dot{width:10px;height:10px;border-radius:50%;}\n    .dot0{background:#60a5fa;}\n    .dot1{background:#f472b6;}\n    footer{margin-top:12px;color:var(--muted);font-size:12px;}\n    .help{font-size:13px;margin-top:8px;color:var(--muted);}\n    .resultRow{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-top:8px;}\n    input[type=\"text\"]{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;}\n    .badge{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;font-size:13px;color:var(--muted);}\n    .highlight{outline:2px solid rgba(56,189,248,0.15);box-shadow:0 4px 20px rgba(8,145,178,0.06);}\n    .stepControls{display:flex;gap:8px;align-items:center;margin-top:8px;}\n    .svgNode{cursor:pointer;transition:transform .12s ease;}\n    .svgNode:hover{transform:translateY(-4px);}\n    .edgeLabel{font-size:12px;fill:var(--muted);}\n  </style>\n</head>\n<body>\n  <header>\n    <div style=\"width:46px;height:46px;border-radius:10px;background:linear-gradient(90deg,var(--accent),#7c3aed);display:flex;align-items:center;justify-content:center;font-weight:800;color:#02111a;\">HC</div>\n    <div>\n      <h1>Huffman Coding Visualizer</h1>\n      <div class=\"desc\">Interactively build a Huffman tree, view codes, encode/decode text and step through the algorithm.</div>\n    </div>\n  </header>\n\n  <div class=\"container\">\n    <div class=\"panel\">\n      <label>Input text to encode</label>\n      <textarea id=\"inputText\" placeholder=\"Type or paste some text...\">this is an example for huffman encoding</textarea>\n      <div class=\"row\">\n        <button id=\"buildBtn\">Build Huffman Tree</button>\n        <button class=\"secondary small\" id=\"randomBtn\">Random demo</button>\n        <button class=\"secondary small\" id=\"clearBtn\">Clear</button>\n      </div>\n      <div class=\"help\">Try short English sentences or characters. Huffman coding assigns short bit sequences to frequent symbols.</div>\n\n      <div class=\"muted\">Character frequencies</div>\n      <div id=\"freqChips\" class=\"freqs\"></div>\n\n      <div class=\"muted\">Priority queue & building steps</div>\n      <div id=\"pqSteps\" class=\"pqList\" style=\"max-height:200px;overflow:auto;\"></div>\n\n      <div class=\"stepControls\">\n        <button id=\"prevStep\" class=\"secondary small\">◀ Prev</button>\n        <button id=\"nextStep\" class=\"secondary small\">Next ▶</button>\n        <div style=\"margin-left:auto;display:flex;gap:8px;align-items:center;\">\n          <button id=\"autoPlay\" class=\"small secondary\">▶ Play</button>\n          <span class=\"badge\" id=\"stepIndicator\">Step 0 / 0</span>\n        </div>\n      </div>\n\n      <div class=\"muted\">Codes (symbol -> bitstring)</div>\n      <div id=\"codes\" class=\"codeTable\"></div>\n\n      <div class=\"muted\">Encode / Decode</div>\n      <div class=\"row\" style=\"margin-top:8px;\">\n        <button id=\"encodeBtn\" class=\"small\">Encode</button>\n        <button id=\"decodeBtn\" class=\"small secondary\">Decode</button>\n        <input id=\"bitsInput\" type=\"text\" placeholder=\"Bits for decoding (optional)\" style=\"flex:1;\" />\n      </div>\n\n      <div id=\"encodedOut\" class=\"bigBits\" style=\"display:none;\"></div>\n      <div id=\"decodedOut\" class=\"bigBits\" style=\"display:none;background:#05221a;color:#bfffe8;\"></div>\n\n      <div class=\"ratio\" id=\"ratio\"></div>\n    </div>\n\n    <div class=\"panel\">\n      <div style=\"display:flex;justify-content:space-between;align-items:center;\">\n        <div>\n          <div style=\"font-weight:700;color:var(--accent);\">Huffman Tree</div>\n          <div class=\"muted\">Visualizes tree nodes (freq + symbol). Click nodes to highlight codes.</div>\n        </div>\n        <div class=\"legend\">\n          <div class=\"legendItem\"><div class=\"dot dot0\"></div> Left edge = 0</div>\n          <div class=\"legendItem\"><div class=\"dot dot1\"></div> Right edge = 1</div>\n        </div>\n      </div>\n\n      <div class=\"svgWrap\" style=\"margin-top:12px;\">\n        <svg id=\"treeSvg\" width=\"100%\" height=\"520\"></svg>\n      </div>\n\n      <div class=\"status\" id=\"status\">Build a tree to start the visualization.</div>\n      <footer>Tip: For single unique characters the code is \"0\" by convention to allow at least one bit per symbol in this demo.</footer>\n    </div>\n  </div>\n\n  <script>\n    // Huffman Coding Visualizer - Single file\n    (function(){\n      // Utilities\n      function uid() { return Math.random().toString(36).slice(2,9); }\n      function clamp(v,a,b){return Math.max(a,Math.min(b,v));}\n\n      // DOM references\n      const inputText = document.getElementById('inputText');\n      const buildBtn = document.getElementById('buildBtn');\n      const randomBtn = document.getElementById('randomBtn');\n      const clearBtn = document.getElementById('clearBtn');\n      const freqChips = document.getElementById('freqChips');\n      const pqStepsDiv = document.getElementById('pqSteps');\n      const codesDiv = document.getElementById('codes');\n      const treeSvg = document.getElementById('treeSvg');\n      const encodeBtn = document.getElementById('encodeBtn');\n      const decodeBtn = document.getElementById('decodeBtn');\n      const bitsInput = document.getElementById('bitsInput');\n      const encodedOut = document.getElementById('encodedOut');\n      const decodedOut = document.getElementById('decodedOut');\n      const ratioDiv = document.getElementById('ratio');\n      const status = document.getElementById('status');\n      const prevStep = document.getElementById('prevStep');\n      const nextStep = document.getElementById('nextStep');\n      const autoPlayBtn = document.getElementById('autoPlay');\n      const stepIndicator = document.getElementById('stepIndicator');\n\n      // State\n      let frequencies = {};\n      let root = null;\n      let codes = {};\n      let encodeBits = \"\";\n      let steps = []; // building steps\n      let stepIndex = -1;\n      let autoplayTimer = null;\n\n      // Build frequencies from text\n      function computeFrequencies(text){\n        const map = {};\n        for(const c of text){\n          map[c] = (map[c]||0)+1;\n        }\n        return map;\n      }\n\n      // Node structure {id, freq, chars (array), char (single symbol or null), left, right}\n      function buildHuffmanTree(freqMap){\n        // Priority queue as array sorted by (freq, order)\n        const nodes = [];\n        let orderCounter = 0;\n        function pushNode(node){\n          node._order = orderCounter++;\n          nodes.push(node);\n          nodes.sort((a,b)=> a.freq - b.freq || a._order - b._order);\n        }\n        // Create leaf nodes\n        for(const [ch,f] of Object.entries(freqMap)){\n          pushNode({id:uid(), freq:f, chars:[ch], char:ch, left:null, right:null});\n        }\n        // Edge case: empty\n        if(nodes.length===0){\n          return {steps:[], root:null};\n        }\n        // Edge case: single unique char - still create tree node (root) with that leaf as child? We'll create root with one child\n        const localSteps = [];\n        localSteps.push({pq: nodes.map(n=>({id:n.id, chars:n.chars.slice(), freq:n.freq}))});\n        if(nodes.length===1){\n          // Create a pseudo parent to ensure a code exists; conventionally assign '0' to the symbol\n          const only = nodes.shift();\n          const parent = {id:uid(), freq:only.freq, chars:only.chars.slice(), char:null, left:only, right:null};\n          localSteps.push({merged: [only.id], created: parent.id, pq: [ {id:parent.id, chars:parent.chars.slice(), freq:parent.freq} ]});\n          return {steps:localSteps, root:parent};\n        }\n        while(nodes.length>1){\n          const a = nodes.shift();\n          const b = nodes.shift();\n          const mergedChars = a.chars.concat(b.chars);\n          const parent = {id:uid(), freq: a.freq + b.freq, chars: mergedChars, char:null, left:a, right:b};\n          pushNode(parent);\n          // record step\n          localSteps.push({\n            merged: [a.id, b.id],\n            created: parent.id,\n            pq: nodes.map(n=>({id:n.id, chars:n.chars.slice(), freq:n.freq}))\n          });\n        }\n        return {steps:localSteps, root: nodes[0] || null};\n      }\n\n      // Generate codes by traversing tree\n      function generateCodes(root){\n        const map = {};\n        if(!root) return map;\n        // If root has only one child or is leaf: give '0' to single symbol\n        function dfs(node, prefix){\n          if(!node) return;\n          if(node.char !== null && node.left===null && node.right===null){\n            map[node.char] = prefix.length ? prefix : \"0\";\n            return;\n          }\n          if(node.left) dfs(node.left, prefix + \"0\");\n          if(node.right) dfs(node.right, prefix + \"1\");\n          // Handle case where right child null but left exists: codes assigned already\n        }\n        dfs(root, \"\");\n        return map;\n      }\n\n      // Encode text with codes\n      function encodeText(text, codes){\n        let bits=\"\";\n        for(const ch of text){\n          bits += (codes[ch] ?? \"\");\n        }\n        return bits;\n      }\n\n      // Decode bits using tree\n      function decodeBits(bits, root){\n        if(!root) return \"\";\n        let out = \"\";\n        let node = root;\n        // If tree is single-leaf parent with only left child and right null, interpret '0' bits as the symbol\n        for(let i=0;i<bits.length;i++){\n          const b = bits[i];\n          if(b==='0'){\n            if(node.left) node = node.left;\n            else node = node.left || node.right || node; // fallback\n          } else {\n            if(node.right) node = node.right;\n            else node = node.left || node.right || node;\n          }\n          if(node.char !== null && node.left===null && node.right===null){\n            out += node.char;\n            node = root;\n          }\n        }\n        return out;\n      }\n\n      // UI update functions\n      function renderFreqChips(freqMap){\n        freqChips.innerHTML=\"\";\n        const items = Object.entries(freqMap).sort((a,b)=> b[1]-a[1] || (a[0]<b[0]? -1:1));\n        for(const [ch,f] of items){\n          const chip = document.createElement('div');\n          chip.className = 'chip';\n          const label = ch === ' ' ? '␣ (space)' : ch;\n          chip.textContent = `${label} : ${f}`;\n          freqChips.appendChild(chip);\n        }\n        if(items.length===0){\n          freqChips.innerHTML = '<div class=\"muted\">No characters</div>';\n        }\n      }\n\n      function renderPQSteps(steps, idx){\n        pqStepsDiv.innerHTML = \"\";\n        steps.forEach((s,i)=>{\n          const item = document.createElement('div');\n          item.className = 'pqItem';\n          if(i===idx) item.classList.add('highlight');\n          const label = document.createElement('div');\n          label.className = 'pqLabel';\n          label.textContent = `Step ${i}`;\n          const info = document.createElement('div');\n          info.style.flex='1';\n          if(s.pq){\n            const list = s.pq.map(p=> `${p.chars.join('')}(${p.freq})`).join('  |  ');\n            info.innerHTML = `<div style=\"color:var(--muted)\">${list}</div>`;\n          } else {\n            info.innerHTML = `<div style=\"color:var(--muted)\">No PQ</div>`;\n          }\n          const meta = document.createElement('div');\n          meta.className = 'freq';\n          meta.textContent = s.merged ? `merged ${s.merged.join(',')} → ${s.created}` : '';\n          item.appendChild(label);\n          item.appendChild(info);\n          item.appendChild(meta);\n          pqStepsDiv.appendChild(item);\n        });\n        if(steps.length===0){\n          pqStepsDiv.innerHTML = '<div class=\"muted\">No building steps yet</div>';\n        }\n      }\n\n      function renderCodesTable(codesMap){\n        codesDiv.innerHTML = \"\";\n        const table = document.createElement('table');\n        const thead = document.createElement('thead');\n        thead.innerHTML = `<tr><th>Symbol</th><th>Code</th><th>Bits</th></tr>`;\n        table.appendChild(thead);\n        const tbody = document.createElement('tbody');\n        const rows = Object.entries(codesMap).sort((a,b)=> a[0].localeCompare(b[0]));\n        for(const [ch,code] of rows){\n          const tr = document.createElement('tr');\n          const s = ch === ' ' ? '␣ (space)' : (ch === '\\n' ? '\\\\n' : ch);\n          tr.innerHTML = `<td style=\"color:var(--accent);font-weight:700\">${s}</td><td style=\"font-family:monospace\">${code}</td><td class=\"freq\">${code.length} bits</td>`;\n          tbody.appendChild(tr);\n        }\n        if(rows.length===0){\n          const tr = document.createElement('tr'); tr.innerHTML = `<td class=\"muted\">No codes</td><td></td><td></td>`; tbody.appendChild(tr);\n        }\n        table.appendChild(tbody);\n        codesDiv.appendChild(table);\n      }\n\n      // Tree layout & drawing\n      function layoutTree(node){\n        // Compute number of leaves to determine horizontal span\n        function countLeaves(n){\n          if(!n) return 0;\n          if(n.left===null && n.right===null) return 1;\n          return (n.left?countLeaves(n.left):0) + (n.right?countLeaves(n.right):0);\n        }\n        const leafCount = countLeaves(node) || 1;\n        // assign positions\n        const xGap = 80;\n        const yGap = 70;\n        let curX = 20;\n        function assign(n, depth){\n          if(!n) return;\n          if(n.left===null && n.right===null){\n            n._x = curX;\n            n._y = depth*yGap + 40;\n            curX += xGap;\n          } else {\n            // assign left subtree first\n            if(n.left) assign(n.left, depth+1);\n            if(n.right) assign(n.right, depth+1);\n            // position at middle of children\n            const leftX = n.left? n.left._x : (n.right? n.right._x : curX);\n            const rightX = n.right? n.right._x : (n.left? n.left._x : curX);\n            n._x = (leftX + rightX)/2;\n            n._y = depth*yGap + 40;\n          }\n        }\n        assign(node, 0);\n      }\n\n      function drawTree(rootNode, highlightPathChars=[]){\n        treeSvg.innerHTML = '';\n        if(!rootNode){\n          const txt = document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\");\n          txt.setAttribute(\"x\",\"20\"); txt.setAttribute(\"y\",\"40\");\n          txt.setAttribute(\"fill\",\"#7dd3fc\");\n          txt.setAttribute(\"font-size\",\"16\");\n          txt.textContent = \"No tree to draw\";\n          treeSvg.appendChild(txt);\n          return;\n        }\n        layoutTree(rootNode);\n        // Resize svg height/width to fit nodes\n        let maxX=0, maxY=0;\n        (function traverse(n){\n          if(!n) return;\n          maxX = Math.max(maxX, n._x);\n          maxY = Math.max(maxY, n._y);\n          traverse(n.left); traverse(n.right);\n        })(rootNode);\n        treeSvg.setAttribute('viewBox',`0 0 ${Math.max(500, maxX+80)} ${Math.max(520,maxY+120)}`);\n\n        // Draw edges first\n        function drawEdges(n){\n          if(!n) return;\n          if(n.left){\n            drawLine(n._x, n._y, n.left._x, n.left._y, '0');\n            drawEdges(n.left);\n          }\n          if(n.right){\n            drawLine(n._x, n._y, n.right._x, n.right._y, '1');\n            drawEdges(n.right);\n          }\n        }\n        function drawLine(x1,y1,x2,y2,label){\n          const line = document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\");\n          line.setAttribute(\"x1\",x1); line.setAttribute(\"y1\",y1+12);\n          line.setAttribute(\"x2\",x2); line.setAttribute(\"y2\",y2-12);\n          line.setAttribute(\"stroke\", label==='0' ? \"#60a5fa\" : \"#f472b6\");\n          line.setAttribute(\"stroke-width\",\"2\");\n          treeSvg.appendChild(line);\n          // label\n          const lx = (x1+x2)/2;\n          const ly = (y1+y2)/2;\n          const lab = document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\");\n          lab.setAttribute(\"x\", lx);\n          lab.setAttribute(\"y\", ly);\n          lab.setAttribute(\"text-anchor\",\"middle\");\n          lab.setAttribute(\"class\",\"edgeLabel\");\n          lab.textContent = label;\n          treeSvg.appendChild(lab);\n        }\n\n        drawEdges(rootNode);\n\n        // Draw nodes\n        function drawNode(n){\n          const g = document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\");\n          g.setAttribute(\"transform\", `translate(${n._x},${n._y})`);\n          g.classList.add('svgNode');\n          // background circle\n          const circle = document.createElementNS(\"http://www.w3.org/2000/svg\",\"circle\");\n          circle.setAttribute(\"r\",22);\n          circle.setAttribute(\"cx\",0);\n          circle.setAttribute(\"cy\",0);\n          // highlight if part of hovered path\n          const inPath = n.chars && n.chars.some(c=> highlightPathChars.includes(c));\n          circle.setAttribute(\"fill\", inPath ? \"rgba(56,189,248,0.12)\" : \"rgba(255,255,255,0.02)\");\n          circle.setAttribute(\"stroke\", inPath ? \"#38bdf8\" : \"rgba(255,255,255,0.06)\");\n          circle.setAttribute(\"stroke-width\",\"2\");\n          g.appendChild(circle);\n\n          // label text\n          const topText = document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\");\n          topText.setAttribute(\"x\",0);\n          topText.setAttribute(\"y\",-6);\n          topText.setAttribute(\"text-anchor\",\"middle\");\n          topText.setAttribute(\"font-size\",\"12\");\n          topText.setAttribute(\"fill\", \"#e6eef8\");\n          if(n.char !== null && n.left===null && n.right===null){\n            const symbol = n.char === ' ' ? '␣' : (n.char === '\\n' ? '\\\\n' : n.char);\n            topText.textContent = symbol;\n          } else {\n            topText.textContent = '';\n          }\n          g.appendChild(topText);\n\n          const freqText = document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\");\n          freqText.setAttribute(\"x\",0);\n          freqText.setAttribute(\"y\",14);\n          freqText.setAttribute(\"text-anchor\",\"middle\");\n          freqText.setAttribute(\"font-size\",\"12\");\n          freqText.setAttribute(\"fill\",\"#9fbfd9\");\n          freqText.textContent = n.freq;\n          g.appendChild(freqText);\n\n          // attach hover/click\n          g.addEventListener('mouseenter', ()=> {\n            // show codes for chars in this node\n            const targetChars = n.chars ? n.chars.slice() : [];\n            drawTree(rootNode, targetChars);\n            showStatus(`Node includes symbols: ${targetChars.map(c=> c===' ' ? '␣(space)' : c).join(', ')}`);\n          });\n          g.addEventListener('mouseleave', ()=> {\n            drawTree(rootNode, []);\n            showStatus(`Huffman tree built. Click nodes to highlight codes.`);\n          });\n          g.addEventListener('click', ()=> {\n            // Show codes filtered to this node\n            const targetChars = n.chars ? n.chars.slice() : [];\n            const filtered = {};\n            for(const ch of targetChars){\n              if(codes[ch]) filtered[ch]=codes[ch];\n            }\n            renderCodesTable(filtered);\n            showStatus(`Codes for node: ${targetChars.map(c=> c===' ' ? '␣(space)' : c).join(', ')}`);\n          });\n\n          treeSvg.appendChild(g);\n\n          if(n.left) drawNode(n.left);\n          if(n.right) drawNode(n.right);\n        }\n\n        drawNode(rootNode);\n      }\n\n      function showStatus(text){\n        status.textContent = text;\n      }\n\n      // Steps navigation\n      function updateStepIndicator(){\n        stepIndicator.textContent = `Step ${Math.max(0,stepIndex)} / ${Math.max(0,steps.length-1)}`;\n      }\n\n      function gotoStep(i){\n        if(steps.length===0){ stepIndex = -1; updateStepIndicator(); renderPQSteps(steps, -1); return; }\n        stepIndex = clamp(i,0,steps.length-1);\n        updateStepIndicator();\n        renderPQSteps(steps, stepIndex);\n        // Show PQ snapshot for step\n        const s = steps[stepIndex];\n        if(s.pq && s.pq.length){\n          // build a pseudo forest for PQ rendering: show each node as small representation in left panel (we already render pq list)\n          // For the main tree, always show final root\n        }\n      }\n\n      function next(){\n        gotoStep(stepIndex+1);\n      }\n      function prev(){\n        gotoStep(stepIndex-1);\n      }\n      function toggleAutoplay(){\n        if(autoplayTimer){\n          clearInterval(autoplayTimer); autoplayTimer=null; autoPlayBtn.textContent=\"▶ Play\";\n        } else {\n          autoPlayBtn.textContent=\"⏸ Pause\";\n          autoplayTimer = setInterval(()=>{\n            if(stepIndex >= steps.length-1){\n              clearInterval(autoplayTimer); autoplayTimer=null; autoPlayBtn.textContent=\"▶ Play\";\n            } else next();\n          }, 700);\n        }\n      }\n\n      // Main build function\n      function build(){\n        const txt = inputText.value;\n        frequencies = computeFrequencies(txt);\n        renderFreqChips(frequencies);\n        const built = buildHuffmanTree(frequencies);\n        steps = built.steps || [];\n        root = built.root;\n        codes = generateCodes(root);\n        renderCodesTable(codes);\n        drawTree(root);\n        // reset navigation\n        stepIndex = 0;\n        updateStepIndicator();\n        renderPQSteps(steps, 0);\n        showStatus(\"Tree built. Hover nodes to highlight symbols. Click nodes to filter codes.\");\n        // reset outputs\n        encodedOut.style.display='none';\n        decodedOut.style.display='none';\n        ratioDiv.textContent = '';\n      }\n\n      // Encode event\n      function doEncode(){\n        const text = inputText.value;\n        if(!root){ showStatus(\"Build the tree first.\"); return; }\n        encodeBits = encodeText(text, codes);\n        encodedOut.style.display='block';\n        encodedOut.textContent = encodeBits || \"(empty)\";\n        // compute original size in bits assuming ASCII/UTF-8 8 bits per char\n        const originalBits = text.length * 8;\n        const compressedBits = encodeBits.length;\n        const ratio = compressedBits ? (Math.round((compressedBits/originalBits)*1000)/10) : 0;\n        ratioDiv.textContent = `Original: ${originalBits} bits (${text.length} chars @8b) · Compressed: ${compressedBits} bits · Ratio: ${ratio}%`;\n        showStatus('Encoded text. You can copy the bitstring or decode it.');\n      }\n\n      // Decode event\n      function doDecode(){\n        const bits = bitsInput.value.trim() || encodeBits;\n        if(!root){ showStatus(\"Build the tree first.\"); return; }\n        if(!bits){\n          decodedOut.style.display='block';\n          decodedOut.textContent = \"(no bits)\";\n          return;\n        }\n        const decoded = decodeBits(bits, root);\n        decodedOut.style.display='block';\n        decodedOut.textContent = decoded;\n        showStatus('Decoded bitstring using current Huffman tree.');\n      }\n\n      // random demo\n      function randomDemo(){\n        const samples = [\n          \"this is just a random demo of huffman coding\",\n          \"aaabbbbccddeeeeeeee\",\n          \"the quick brown fox jumps over the lazy dog\",\n          \"to be or not to be that is the question\",\n          \"huffman coding compresses data by using variable length codes\"\n        ];\n        inputText.value = samples[Math.floor(Math.random()*samples.length)];\n        build();\n      }\n\n      // Clear\n      function clearAll(){\n        inputText.value = '';\n        freqChips.innerHTML='';\n        pqStepsDiv.innerHTML='';\n        codesDiv.innerHTML='';\n        treeSvg.innerHTML='';\n        encodedOut.style.display='none';\n        decodedOut.style.display='none';\n        ratioDiv.textContent='';\n        status.textContent = 'Cleared. Enter text to build a Huffman tree.';\n        frequencies = {}; root = null; steps=[]; stepIndex=-1; codes={}; encodeBits=\"\";\n      }\n\n      // Wire events\n      buildBtn.addEventListener('click', build);\n      randomBtn.addEventListener('click', randomDemo);\n      clearBtn.addEventListener('click', clearAll);\n      encodeBtn.addEventListener('click', doEncode);\n      decodeBtn.addEventListener('click', doDecode);\n      nextStep.addEventListener('click', ()=>{ next(); });\n      prevStep.addEventListener('click', ()=>{ prev(); });\n      autoPlayBtn.addEventListener('click', toggleAutoplay);\n\n      // keyboard shortcuts\n      document.addEventListener('keydown', (e)=>{\n        if(e.key === 'ArrowRight') next();\n        if(e.key === 'ArrowLeft') prev();\n        if(e.key === ' ') { e.preventDefault(); toggleAutoplay(); }\n      });\n\n      // Initialize demo\n      build();\n\n      // For accessibility: show clickable instructions\n      treeSvg.addEventListener('click', ()=> {\n        showStatus('You can hover nodes to highlight and click to filter codes.');\n      });\n\n    })();\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Huffman Coding"
    }
  ],
  "topic": "Huffman Coding",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}