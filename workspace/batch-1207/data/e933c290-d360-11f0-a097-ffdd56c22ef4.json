{
  "id": "e933c290-d360-11f0-a097-ffdd56c22ef4",
  "timestamp": "2025-12-07T11:38:45.534Z",
  "model": "gpt-5-mini",
  "status": "success",
  "question": "Merge Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Merge Sort Visualizer</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n  <style>\n    :root{\n      --bg:#0f1724;\n      --panel:#0b1220;\n      --accent:#3b82f6;\n      --muted:#94a3b8;\n      --card:#0b1226;\n      --bar:#60a5fa;\n      --bar2:#34d399;\n      --danger:#ef4444;\n      --yellow:#f59e0b;\n      --white:#e6eef8;\n    }\n    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial;}\n    body{background:linear-gradient(180deg,#071025 0%,#071827 100%);color:var(--white);padding:18px;box-sizing:border-box;}\n    .container{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:1fr 380px;gap:20px;align-items:start;}\n    header{grid-column:1/-1;display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}\n    header h1{font-size:20px;margin:0;color:var(--white)}\n    header p{margin:0;color:var(--muted);font-size:13px}\n    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border:1px solid rgba(255,255,255,0.04);padding:14px;border-radius:10px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}\n    .left{min-height:360px;padding:12px;display:flex;flex-direction:column;gap:12px}\n    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}\n    .controls .btn{background:var(--accent);color:white;padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:600}\n    .controls .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--white)}\n    .controls input[type=range]{accent-color:var(--accent)}\n    .settings{display:flex;flex-direction:column;gap:8px}\n    .small{font-size:13px;color:var(--muted)}\n    .vis{height:320px;background:linear-gradient(180deg,#071827 0%, #071827 100%);border-radius:8px;display:flex;align-items:end;padding:12px;gap:4px;border:1px solid rgba(255,255,255,0.03);position:relative;overflow:hidden}\n    .bar{flex:1 1 auto;margin:0 2px;background:linear-gradient(180deg,var(--bar) 0%, #2b6ecb 100%);border-radius:4px;display:flex;align-items:flex-end;justify-content:center;color:rgba(255,255,255,0.9);font-size:11px;font-weight:700}\n    .bar.small{font-size:10px}\n    .bar .val{transform:translateY(-6px);padding-bottom:6px}\n    .legend{display:flex;gap:8px;flex-wrap:wrap;font-size:13px;color:var(--muted);align-items:center}\n    .chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02)}\n    .right{padding:12px;display:flex;flex-direction:column;gap:12px;min-height:360px}\n    .panel h3{margin:0 0 8px 0;font-size:15px}\n    .code{background:#051123;padding:12px;border-radius:8px;color:var(--muted);font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:13px;line-height:1.45;overflow:auto;max-height:220px;border:1px solid rgba(255,255,255,0.03)}\n    .code .line{padding:4px 8px;border-radius:6px}\n    .code .line.active{background:linear-gradient(90deg, rgba(59,130,246,0.12), rgba(59,130,246,0.04));color:var(--white);border-left:3px solid rgba(59,130,246,0.75);padding-left:6px}\n    .input-area{display:flex;gap:8px;align-items:center}\n    textarea{width:100%;min-height:56px;background:transparent;border:1px dashed rgba(255,255,255,0.04);padding:8px;border-radius:8px;color:var(--white);resize:vertical}\n    .controls-row{display:flex;gap:8px;align-items:center}\n    .footer{display:flex;justify-content:space-between;align-items:center;font-size:13px;color:var(--muted)}\n    .status{font-weight:700}\n    .oplog{background:#02101a;border-radius:8px;padding:8px;color:var(--muted);font-size:13px;max-height:160px;overflow:auto;border:1px solid rgba(255,255,255,0.02)}\n    .op{padding:6px;border-radius:6px}\n    .op.compare{color:var(--danger)}\n    .op.write{color:var(--bar2)}\n    .op.copy{color:var(--yellow)}\n    .mode-select{padding:6px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);color:var(--muted)}\n    @media(max-width:980px){\n      .container{grid-template-columns:1fr; padding:8px}\n      .right{order:3}\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <header>\n      <div>\n        <h1>Merge Sort â€” Visualizer & Explorer</h1>\n        <p>Interactive demonstration of Merge Sort (Top-down and Bottom-up) with step playback, pseudocode highlighting, and operation log.</p>\n      </div>\n      <div style=\"text-align:right\">\n        <div class=\"small\">Algorithm: Stable, O(n log n) time, O(n) extra space</div>\n      </div>\n    </header>\n\n    <div class=\"panel left\">\n      <div style=\"display:flex;justify-content:space-between;align-items:center\">\n        <div>\n          <strong>Array Controls</strong>\n          <div class=\"small\">Create and manipulate the array to sort.</div>\n        </div>\n        <div class=\"legend\">\n          <div class=\"chip\"><span style=\"width:12px;height:12px;background:linear-gradient(180deg,var(--bar) 0%, #2b6ecb 100%);border-radius:4px;display:inline-block\"></span> Normal</div>\n          <div class=\"chip\"><span style=\"width:12px;height:12px;background:var(--danger);display:inline-block;border-radius:4px\"></span> Comparing</div>\n          <div class=\"chip\"><span style=\"width:12px;height:12px;background:var(--yellow);display:inline-block;border-radius:4px\"></span> Merging</div>\n          <div class=\"chip\"><span style=\"width:12px;height:12px;background:var(--bar2);display:inline-block;border-radius:4px\"></span> Written</div>\n          <div class=\"chip\"><span style=\"width:12px;height:12px;background:var(--white);display:inline-block;border-radius:4px\"></span> Sorted</div>\n        </div>\n      </div>\n\n      <div class=\"controls\" style=\"margin-top:8px\">\n        <label class=\"small\">Size: <span id=\"sizeLabel\">30</span></label>\n        <input id=\"sizeRange\" type=\"range\" min=\"5\" max=\"120\" value=\"30\" />\n        <button class=\"btn\" id=\"randomBtn\">Randomize</button>\n        <button class=\"btn secondary\" id=\"reverseBtn\">Reverse</button>\n        <select id=\"modeSelect\" class=\"mode-select\" title=\"Choose merge sort variant\">\n          <option value=\"topdown\">Top-down (Recursive)</option>\n          <option value=\"bottomup\">Bottom-up (Iterative)</option>\n        </select>\n      </div>\n\n      <div class=\"input-area\" style=\"margin-top:8px\">\n        <textarea id=\"customInput\" placeholder=\"Enter comma-separated numbers (e.g. 5,3,9,1)\"></textarea>\n        <div style=\"display:flex;flex-direction:column;gap:8px\">\n          <button class=\"btn\" id=\"applyInput\">Apply</button>\n          <button class=\"btn secondary\" id=\"clearInput\">Clear</button>\n        </div>\n      </div>\n\n      <div style=\"display:flex;gap:8px;align-items:center;margin-top:8px\">\n        <button class=\"btn\" id=\"startBtn\">Start</button>\n        <button class=\"btn secondary\" id=\"stepBtn\">Step</button>\n        <button class=\"btn secondary\" id=\"pauseBtn\">Pause</button>\n        <button class=\"btn secondary\" id=\"resetBtn\">Reset</button>\n        <label class=\"small\">Speed</label>\n        <input id=\"speedRange\" type=\"range\" min=\"10\" max=\"1000\" value=\"200\" />\n      </div>\n\n      <div class=\"panel\" style=\"margin-top:8px;padding:10px\">\n        <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:6px\">\n          <strong>Array Visualization</strong>\n          <div class=\"small\">Values are shown on the bars.</div>\n        </div>\n        <div class=\"vis\" id=\"visArea\" aria-label=\"Array visualization\"></div>\n      </div>\n\n      <div style=\"display:flex;justify-content:space-between;align-items:center;margin-top:8px\">\n        <div class=\"small\">Status: <span id=\"status\" class=\"status\">Ready</span></div>\n        <div class=\"small\">Operations: <span id=\"opCount\">0</span></div>\n      </div>\n    </div>\n\n    <div class=\"panel right\">\n      <div>\n        <h3>Pseudocode</h3>\n        <div class=\"small\">Highlighted line maps to the operation currently being animated.</div>\n        <div class=\"code\" id=\"codeBox\" aria-hidden=\"false\"></div>\n      </div>\n\n      <div>\n        <h3>Operation Log</h3>\n        <div class=\"oplog\" id=\"opLog\"></div>\n      </div>\n\n      <div style=\"display:flex;gap:8px;justify-content:space-between;align-items:center;margin-top:8px\">\n        <div class=\"small\">Tip: Use Step to advance one recorded operation at a time for detailed inspection.</div>\n        <div class=\"small\">Sorted elements turn white when finalized.</div>\n      </div>\n    </div>\n  </div>\n\n<script>\n/*\n  Merge Sort Visualizer\n  - Records operations (compare, write, markSorted) into an operations array.\n  - Supports Top-down (recursive) and Bottom-up (iterative) variants.\n  - Player with play/pause/step/reset, speed control, custom input and randomize.\n*/\n\n// Utilities\nconst $ = (id) => document.getElementById(id);\n\nconst state = {\n  array: [],\n  bars: [],\n  ops: [],\n  opIndex: 0,\n  playing: false,\n  speed: 200,\n  mode: 'topdown',\n  size: 30,\n  locked: false // lock controls during playback preparation/execution\n};\n\n// Pseudocode lines for highlighting\nconst pseudocode = {\n  topdown: [\n    \"function mergeSort(arr, l, r):\",\n    \"  if l >= r: return\",\n    \"  mid = floor((l + r) / 2)\",\n    \"  mergeSort(arr, l, mid)\",\n    \"  mergeSort(arr, mid+1, r)\",\n    \"  merge(arr, l, mid, r)\",\n    \"\",\n    \"function merge(arr, l, mid, r):\",\n    \"  i = l; j = mid+1; k = l\",\n    \"  while i <= mid and j <= r:\",\n    \"    if arr[i] <= arr[j]: arr[k] = arr[i]; i += 1\",\n    \"    else: arr[k] = arr[j]; j += 1\",\n    \"    k += 1\",\n    \"  copy remaining elements from left or right\",\n    \"  return\"\n  ],\n  bottomup: [\n    \"function mergeSortBottomUp(arr):\",\n    \"  n = arr.length\",\n    \"  width = 1\",\n    \"  while width < n:\",\n    \"    for i = 0; i < n; i += 2*width:\",\n    \"      merge subarrays [i, i+width-1] and [i+width, i+2*width-1]\",\n    \"    width *= 2\",\n    \"\",\n    \"function merge(arr, l, mid, r):\",\n    \"  (same as top-down merge)\"\n  ]\n};\n\n// DOM elements\nconst visArea = $('visArea');\nconst sizeRange = $('sizeRange');\nconst sizeLabel = $('sizeLabel');\nconst randomBtn = $('randomBtn');\nconst reverseBtn = $('reverseBtn');\nconst applyInput = $('applyInput');\nconst customInput = $('customInput');\nconst clearInput = $('clearInput');\nconst startBtn = $('startBtn');\nconst stepBtn = $('stepBtn');\nconst pauseBtn = $('pauseBtn');\nconst resetBtn = $('resetBtn');\nconst speedRange = $('speedRange');\nconst statusEl = $('status');\nconst opCountEl = $('opCount');\nconst opLog = $('opLog');\nconst modeSelect = $('modeSelect');\nconst codeBox = $('codeBox');\n\nfunction init(){\n  attachEvents();\n  state.size = parseInt(sizeRange.value);\n  sizeLabel.textContent = state.size;\n  state.speed = parseInt(speedRange.value);\n  state.mode = modeSelect.value;\n  renderCode();\n  generateRandom(state.size);\n  drawArray();\n  updateStatus('Ready');\n}\n\nfunction attachEvents(){\n  sizeRange.addEventListener('input', ()=>{\n    state.size = parseInt(sizeRange.value);\n    sizeLabel.textContent = state.size;\n  });\n  sizeRange.addEventListener('change', ()=>{\n    generateRandom(state.size);\n    drawArray();\n  });\n  randomBtn.addEventListener('click', ()=>{ generateRandom(state.size); drawArray(); });\n  reverseBtn.addEventListener('click', ()=>{ state.array.reverse(); drawArray(); });\n  applyInput.addEventListener('click', applyCustomInput);\n  clearInput.addEventListener('click', ()=>{ customInput.value = ''; });\n  startBtn.addEventListener('click', startPlayback);\n  stepBtn.addEventListener('click', stepOnce);\n  pauseBtn.addEventListener('click', pausePlayback);\n  resetBtn.addEventListener('click', resetPlayback);\n  speedRange.addEventListener('input', ()=>{ state.speed = parseInt(speedRange.value); });\n  modeSelect.addEventListener('change', ()=>{\n    state.mode = modeSelect.value;\n    renderCode();\n  });\n}\n\nfunction updateStatus(txt){\n  statusEl.textContent = txt;\n}\n\n// Array and drawing\nfunction generateRandom(n){\n  const arr = [];\n  for(let i=0;i<n;i++){\n    arr.push(randInt(5, 100));\n  }\n  state.array = arr;\n  state.ops = [];\n  state.opIndex = 0;\n  opCountEl.textContent = 0;\n  opLog.innerHTML = '';\n  updateStatus('Array randomized');\n}\n\nfunction randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }\n\nfunction drawArray(highlight = {}) {\n  // highlight can indicate states for indices: comparing, merging, written, sorted\n  visArea.innerHTML = '';\n  const arr = state.array;\n  const max = Math.max(...arr, 1);\n  const n = arr.length;\n  const maxBarWidth = Math.max(3, Math.floor((visArea.clientWidth - (n-1)*4)/n));\n  state.bars = [];\n  for(let i=0;i<n;i++){\n    const v = arr[i];\n    const h = (v / max) * 100; // percent height\n    const bar = document.createElement('div');\n    bar.className = 'bar';\n    if(n>60) bar.classList.add('small');\n    bar.style.height = h + '%';\n    bar.style.flexBasis = (100/n) + '%';\n    bar.dataset.index = i;\n    bar.innerHTML = `<div class=\"val\">${v}</div>`;\n    // color states\n    if(highlight.compare && highlight.compare.includes(i)){\n      bar.style.background = 'linear-gradient(180deg, #ef4444, #b91c1c)';\n    } else if(highlight.merging && highlight.merging.includes(i)){\n      bar.style.background = 'linear-gradient(180deg, var(--yellow), #b7791f)';\n    } else if(highlight.written && highlight.written.includes(i)){\n      bar.style.background = 'linear-gradient(180deg, var(--bar2), #0ea5a0)';\n    } else if(highlight.sorted && highlight.sorted.includes(i)){\n      bar.style.background = 'linear-gradient(180deg, #ffffff, #d1e8ff)'; \n      bar.style.color = '#001827';\n    } else {\n      bar.style.background = 'linear-gradient(180deg,var(--bar) 0%, #2b6ecb 100%)';\n      bar.style.color = '';\n    }\n\n    visArea.appendChild(bar);\n    state.bars.push(bar);\n  }\n}\n\n// Recording operations for playback\n// Operation format examples:\n// {type: 'compare', i, j, line}\n// {type: 'write', index, value, line}\n// {type: 'copy', from, to, line} (copy remaining elements)\n// {type: 'markSorted', indices[] }\nfunction recordTopDown(arr){\n  const ops = [];\n  const aux = arr.slice();\n\n  function merge(a, l, mid, r){\n    // create copies (not pushing separate ops for creation)\n    let i = l, j = mid+1, k = l;\n    // We'll record comparisons and writes.\n    while(i <= mid && j <= r){\n      ops.push({type:'compare', i:i, j:j, line:9}); // pseudocode line 9\n      if(a[i] <= a[j]){\n        ops.push({type:'write', index:k, value:a[i], from:i, line:10});\n        aux[k++] = a[i++];\n      } else {\n        ops.push({type:'write', index:k, value:a[j], from:j, line:11});\n        aux[k++] = a[j++];\n      }\n    }\n    while(i <= mid){\n      ops.push({type:'copy', from:i, to:k, value:a[i], line:13});\n      aux[k++] = a[i++];\n    }\n    while(j <= r){\n      ops.push({type:'copy', from:j, to:k, value:a[j], line:13});\n      aux[k++] = a[j++];\n    }\n    // write back to original array and record writes\n    for(let t=l;t<=r;t++){\n      ops.push({type:'write', index:t, value:aux[t], from:null, line:6});\n      a[t] = aux[t];\n    }\n    // mark these indices as merged/final (not necessarily globally sorted)\n    ops.push({type:'merged', indices: range(l, r), line:6});\n  }\n\n  function sort(a, l, r){\n    if(l >= r) return;\n    const mid = Math.floor((l + r)/2);\n    sort(a, l, mid);\n    sort(a, mid+1, r);\n    merge(a, l, mid, r);\n  }\n\n  sort(arr.slice(), 0, arr.length-1);\n  return ops;\n}\n\nfunction recordBottomUp(arr){\n  const ops = [];\n  const n = arr.length;\n  let a = arr.slice();\n  let aux = new Array(n);\n  let width = 1;\n  while(width < n){\n    for(let i=0;i<n;i += 2*width){\n      const l = i;\n      const mid = Math.min(i+width-1, n-1);\n      const r = Math.min(i+2*width-1, n-1);\n      if(mid >= r) continue; // nothing to merge\n      // Merge [l,mid] and [mid+1,r]\n      let p = l, q = mid+1, k = l;\n      while(p <= mid && q <= r){\n        ops.push({type:'compare', i:p, j:q, line:3}); // line index into bottomup pseudocode approximate\n        if(a[p] <= a[q]){\n          ops.push({type:'write', index:k, value:a[p], from:p, line:7});\n          aux[k++] = a[p++];\n        } else {\n          ops.push({type:'write', index:k, value:a[q], from:q, line:7});\n          aux[k++] = a[q++];\n        }\n      }\n      while(p <= mid){ ops.push({type:'copy', from:p, to:k, value:a[p], line:7}); aux[k++] = a[p++]; }\n      while(q <= r){ ops.push({type:'copy', from:q, to:k, value:a[q], line:7}); aux[k++] = a[q++]; }\n      for(let t=l;t<=r;t++){\n        ops.push({type:'write', index:t, value:aux[t], from:null, line:7});\n        a[t] = aux[t];\n      }\n      ops.push({type:'merged', indices: range(l,r), line:6});\n    }\n    width *= 2;\n  }\n  return ops;\n}\n\n// Helpers\nfunction range(a,b){ const res=[]; for(let i=a;i<=b;i++) res.push(i); return res; }\n\n// Playback engine\nlet playTimer = null;\nfunction prepareOps(){\n  state.ops = [];\n  state.opIndex = 0;\n  opLog.innerHTML = '';\n  if(state.mode === 'topdown'){\n    updateStatus('Recording operations (top-down)...');\n    state.ops = recordTopDown(state.array.slice());\n  } else {\n    updateStatus('Recording operations (bottom-up)...');\n    state.ops = recordBottomUp(state.array.slice());\n  }\n  opCountEl.textContent = state.ops.length;\n  updateStatus('Ready to play. Operations recorded: ' + state.ops.length);\n  // Reset colors\n  drawArray();\n}\n\nfunction startPlayback(){\n  if(state.playing) return;\n  if(state.ops.length === 0){\n    prepareOps();\n    if(state.ops.length === 0){\n      updateStatus('Nothing to sort (array trivial)');\n      return;\n    }\n  }\n  state.playing = true;\n  updateStatus('Playing');\n  playStep(); // immediate first step to avoid delay\n  playTimer = setInterval(playStep, state.speed);\n}\n\nfunction playStep(){\n  if(state.opIndex >= state.ops.length){\n    finishPlayback();\n    return;\n  }\n  animateOp(state.ops[state.opIndex]);\n  state.opIndex++;\n}\n\nfunction pausePlayback(){\n  if(!state.playing) return;\n  state.playing = false;\n  clearInterval(playTimer);\n  playTimer = null;\n  updateStatus('Paused');\n}\n\nfunction resetPlayback(){\n  pausePlayback();\n  state.ops = [];\n  state.opIndex = 0;\n  opLog.innerHTML = '';\n  opCountEl.textContent = 0;\n  drawArray();\n  updateStatus('Reset');\n}\n\nfunction finishPlayback(){\n  pausePlayback();\n  // mark all indices sorted\n  const all = range(0, state.array.length-1);\n  drawArray({sorted: all});\n  updateStatus('Completed');\n  logOperation({type:'done', text:'Sorting complete'});\n}\n\nfunction stepOnce(){\n  if(state.ops.length === 0 && state.opIndex === 0){\n    prepareOps();\n    if(state.ops.length === 0) return;\n  }\n  if(state.opIndex >= state.ops.length){\n    finishPlayback();\n    return;\n  }\n  // perform single op (do not start interval)\n  animateOp(state.ops[state.opIndex]);\n  state.opIndex++;\n  updateStatus('Stepped (op ' + state.opIndex + ' / ' + state.ops.length + ')');\n}\n\nfunction animateOp(op){\n  // For each op, we will update the array state (in-memory) and re-render bars with colors\n  // Also append to op log and highlight pseudocode line\n  const n = state.array.length;\n  const highlight = {compare:[], merging:[], written:[], sorted:[]};\n  switch(op.type){\n    case 'compare':\n      highlight.compare.push(op.i, op.j);\n      logOperation({type:'compare', text: `Compare indices ${op.i} and ${op.j}`});\n      highlightCodeLine(op.line);\n      drawArray(highlight);\n      break;\n    case 'write':\n      // apply value\n      state.array[op.index] = op.value;\n      highlight.written.push(op.index);\n      logOperation({type:'write', text: `Write value ${op.value} to index ${op.index}`});\n      highlightCodeLine(op.line);\n      drawArray(highlight);\n      break;\n    case 'copy':\n      state.array[op.to] = op.value;\n      highlight.written.push(op.to);\n      highlight.merging.push(op.from);\n      logOperation({type:'copy', text: `Copy from ${op.from} to ${op.to} (${op.value})`});\n      highlightCodeLine(op.line);\n      drawArray(highlight);\n      break;\n    case 'merged':\n      // briefly mark merged indices (these are the range that got merged)\n      highlight.merging = op.indices.slice();\n      logOperation({type:'merged', text: `Merged indices [${op.indices[0]}, ${op.indices[op.indices.length-1]}]`});\n      highlightCodeLine(op.line);\n      drawArray(highlight);\n      break;\n    case 'done':\n      logOperation({type:'done', text: op.text || 'Done'});\n      highlightCodeLine(-1);\n      break;\n    default:\n      logOperation({type:'info', text: JSON.stringify(op)});\n      drawArray();\n      break;\n  }\n}\n\n// Logging\nfunction logOperation(entry){\n  const el = document.createElement('div');\n  el.className = 'op';\n  if(entry.type === 'compare') el.classList.add('compare');\n  if(entry.type === 'write' || entry.type === 'copy') el.classList.add('write');\n  el.textContent = entry.text;\n  opLog.appendChild(el);\n  opLog.scrollTop = opLog.scrollHeight;\n  opCountEl.textContent = state.opIndex + 1;\n}\n\n// Code rendering and highlighting\nfunction renderCode(){\n  codeBox.innerHTML = '';\n  const lines = pseudocode[state.mode === 'topdown' ? 'topdown' : 'bottomup'];\n  lines.forEach((l, idx)=>{\n    const div = document.createElement('div');\n    div.className = 'line';\n    div.id = 'code-line-' + (idx+1);\n    div.textContent = (idx+1).toString().padStart(2,' ') + '  ' + l;\n    codeBox.appendChild(div);\n  });\n}\n\nfunction highlightCodeLine(line){\n  // Clear all\n  const lines = codeBox.querySelectorAll('.line');\n  lines.forEach(el => el.classList.remove('active'));\n  if(typeof line === 'number' && line > 0){\n    const el = $('code-line-' + line);\n    if(el) el.classList.add('active');\n  }\n}\n\n// Custom Input handling\nfunction applyCustomInput(){\n  const txt = customInput.value.trim();\n  if(!txt) return;\n  const parts = txt.split(',').map(s=>s.trim()).filter(Boolean);\n  const nums = [];\n  for(const p of parts){\n    const v = Number(p);\n    if(Number.isFinite(v)) nums.push(v);\n    else {\n      alert('Invalid number: ' + p);\n      return;\n    }\n  }\n  if(nums.length === 0) return;\n  state.array = nums.slice();\n  state.ops = [];\n  state.opIndex = 0;\n  opLog.innerHTML = '';\n  opCountEl.textContent = 0;\n  drawArray();\n  updateStatus('Custom array applied');\n}\n\n// Initialize UI\ninit();\n\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Merge Sort"
    }
  ],
  "topic": "Merge Sort",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}