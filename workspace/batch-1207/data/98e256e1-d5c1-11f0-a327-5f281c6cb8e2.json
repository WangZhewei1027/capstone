{
  "id": "98e256e1-d5c1-11f0-a327-5f281c6cb8e2",
  "timestamp": "2025-12-10T12:18:11.414Z",
  "model": "gpt-5-mini",
  "status": "success",
  "question": "Floyd-Warshall Algorithm",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\"/>\n<title>Floyd–Warshall Algorithm Interactive Demo</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"/>\n<style>\n  :root{--bg:#0f1720;--card:#0b1220;--accent:#4f46e5;--muted:#94a3b8;--good:#16a34a;--bad:#ef4444;}\n  body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,\"Helvetica Neue\",Arial; margin:0; background:linear-gradient(180deg,#071126 0%, #071827 60%); color:#e6eef7;}\n  .wrap{max-width:1200px;margin:20px auto;padding:18px;}\n  header{display:flex;align-items:center;gap:16px;margin-bottom:14px}\n  header h1{font-size:20px;margin:0}\n  .panel{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.04);padding:12px;border-radius:10px;}\n  .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}\n  input[type=number], input[type=text], select{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:6px 8px;border-radius:6px}\n  button{background:var(--accent);border:none;color:white;padding:8px 10px;border-radius:8px;cursor:pointer}\n  button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}\n  .small{font-size:13px;padding:6px 8px}\n  .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}\n  .matrix-area{display:flex;gap:12px;align-items:flex-start}\n  .matrix{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;overflow:auto;max-height:420px}\n  table{border-collapse:collapse;font-family:monospace;font-size:13px}\n  td, th{border:1px solid rgba(255,255,255,0.03);padding:6px 8px;text-align:center;min-width:48px}\n  th{background:rgba(255,255,255,0.02);color:var(--muted);font-weight:600}\n  .inf{color:var(--muted)}\n  .updated{background:linear-gradient(90deg, rgba(79,70,229,0.18), rgba(16,185,129,0.06)); box-shadow:0 0 12px rgba(79,70,229,0.06) inset}\n  .current{background:rgba(79,70,229,0.14)}\n  .kcol{background:rgba(79,70,229,0.06)}\n  .log{font-family:ui-monospace,Monaco,monospace;background:#021226;padding:8px;border-radius:8px;color:#cfefff;max-height:220px;overflow:auto;font-size:13px}\n  .row{display:flex;gap:12px;align-items:center;margin-top:10px}\n  label{font-size:13px;color:var(--muted)}\n  .playbar{display:flex;gap:8px;align-items:center}\n  input[type=range]{accent-color:var(--accent)}\n  .path-result{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;color:var(--muted)}\n  .bad{color:var(--bad);font-weight:700}\n  .good{color:var(--good);font-weight:700}\n  footer{margin-top:18px;color:var(--muted);font-size:13px}\n  .example-btn{background:transparent;border:1px dashed rgba(255,255,255,0.04);padding:6px;border-radius:6px;color:var(--muted);cursor:pointer}\n  @media (max-width:900px){ .grid{grid-template-columns:1fr} }\n</style>\n</head>\n<body>\n<div class=\"wrap\">\n  <header>\n    <div>\n      <h1>Floyd–Warshall Algorithm — Interactive Demo</h1>\n      <div style=\"color:var(--muted);font-size:13px\">All-pairs shortest paths with step-by-step visualization, path reconstruction and negative-cycle detection.</div>\n    </div>\n  </header>\n\n  <div class=\"panel\">\n    <div class=\"controls\">\n      <label>Vertices:\n        <input id=\"nInput\" type=\"number\" min=\"1\" max=\"12\" value=\"5\" style=\"width:72px;margin-left:8px\"/>\n      </label>\n\n      <label style=\"display:flex;align-items:center\">Directed:\n        <input id=\"directed\" type=\"checkbox\" checked style=\"margin-left:8px\"/>\n      </label>\n\n      <label>Random graph:\n        <select id=\"density\" style=\"margin-left:8px\">\n          <option value=\"0.3\">sparse ~30%</option>\n          <option value=\"0.5\" selected>moderate ~50%</option>\n          <option value=\"0.8\">dense ~80%</option>\n        </select>\n      </label>\n\n      <label>Weight range:\n        <input id=\"wmin\" type=\"number\" value=\"-5\" style=\"width:64px;margin-left:8px\"/>\n        to\n        <input id=\"wmax\" type=\"number\" value=\"12\" style=\"width:64px;margin-left:8px\"/>\n      </label>\n\n      <button id=\"randBtn\" class=\"small\">Generate Random</button>\n      <button id=\"presetBtn\" class=\"small ghost\">Load Example</button>\n      <button id=\"applyBtn\" class=\"small\">Apply Matrix</button>\n    </div>\n\n    <div class=\"grid\">\n      <div class=\"panel\">\n        <div style=\"display:flex;justify-content:space-between;align-items:center\">\n          <strong>Adjacency matrix (use INF or leave blank for no edge)</strong>\n          <div style=\"display:flex;gap:8px;align-items:center\">\n            <button id=\"addNode\" class=\"example-btn\" title=\"Increase vertices\">+V</button>\n            <button id=\"remNode\" class=\"example-btn\" title=\"Decrease vertices\">-V</button>\n          </div>\n        </div>\n        <div class=\"matrix\" id=\"adjMatrixArea\" style=\"margin-top:8px\"></div>\n      </div>\n\n      <div class=\"panel\">\n        <div style=\"display:flex;justify-content:space-between;align-items:center\">\n          <strong>Controls & Playback</strong>\n          <div style=\"color:var(--muted);font-size:13px\">Step mode visualizes each i,j for current k</div>\n        </div>\n\n        <div class=\"row\" style=\"margin-top:8px\">\n          <button id=\"initBtn\">Initialize</button>\n          <button id=\"stepBack\" class=\"ghost small\" disabled>Step ◀</button>\n          <button id=\"stepFwd\" class=\"ghost small\" disabled>Step ▶</button>\n          <button id=\"playBtn\" class=\"ghost small\" disabled>Play</button>\n          <button id=\"runFull\" class=\"small\">Run to End</button>\n          <button id=\"resetBtn\" class=\"ghost small\">Reset</button>\n        </div>\n\n        <div class=\"row\">\n          <label>Speed:\n            <input id=\"speed\" type=\"range\" min=\"100\" max=\"2000\" value=\"600\" style=\"width:220px;margin-left:8px\"/>\n          </label>\n          <div style=\"color:var(--muted);font-size:13px\"> <span id=\"kLabel\">k = -</span> • Current (i,j): <span id=\"ijLabel\">-</span></div>\n        </div>\n\n        <div style=\"display:flex;gap:8px;margin-top:10px;align-items:center\">\n          <label>Source:\n            <select id=\"srcSel\"></select>\n          </label>\n          <label>Target:\n            <select id=\"tgtSel\"></select>\n          </label>\n          <button id=\"showPath\" class=\"small\" title=\"Reconstruct shortest path\">Show Path</button>\n        </div>\n\n        <div style=\"margin-top:10px\">\n          <div class=\"path-result\" id=\"pathRes\">Path: —</div>\n        </div>\n      </div>\n\n      <div class=\"panel\" style=\"grid-column:1/3\">\n        <div style=\"display:flex;gap:12px;align-items:center;justify-content:space-between\">\n          <strong>Distance and \"Next\" matrices</strong>\n          <div style=\"display:flex;gap:8px;align-items:center\">\n            <button id=\"exportBtn\" class=\"ghost small\" title=\"Export current matrices as JSON\">Export JSON</button>\n            <button id=\"loadBtn\" class=\"ghost small\" title=\"Load JSON (paste)\">Load JSON</button>\n          </div>\n        </div>\n\n        <div style=\"display:flex;gap:12px;margin-top:8px\">\n          <div class=\"matrix\" style=\"flex:1\">\n            <div style=\"font-size:13px;color:var(--muted);margin-bottom:6px\">Distance matrix</div>\n            <div id=\"distArea\"></div>\n          </div>\n          <div class=\"matrix\" style=\"flex:0.7\">\n            <div style=\"font-size:13px;color:var(--muted);margin-bottom:6px\">Next matrix (for path reconstruction)</div>\n            <div id=\"nextArea\"></div>\n          </div>\n        </div>\n\n        <div style=\"margin-top:10px\">\n          <div style=\"font-size:13px;color:var(--muted);margin-bottom:6px\">Execution log</div>\n          <div class=\"log\" id=\"logArea\" aria-live=\"polite\"></div>\n        </div>\n      </div>\n    </div>\n\n    <footer style=\"margin-top:12px\">Notes: • Initialize reads the adjacency table and prepares Floyd–Warshall. • Step shows each pair (i,j) considered for a given intermediate k. • Negative cycles: if any dist[i][i] &lt; 0 after the algorithm, a reachable negative cycle exists.</footer>\n  </div>\n</div>\n\n<script>\n/*\n  Floyd–Warshall Interactive Demo\n  - Distance matrix & \"next\" (successor) matrix representation.\n  - Step-by-step visualization captures each inner (i,j) check for each k.\n  - Allows path reconstruction using the \"next\" matrix after run completes (unless negative cycle).\n*/\n\nconst MAX_N = 12;\n\nlet N = 5;\nlet directed = true;\nlet adjInputs = []; // references to input elements\nlet dist = []; // current distance matrix\nlet nextm = []; // successor matrix for path reconstruction\nlet history = []; // states for stepping (snapshots)\nlet stepIndex = -1;\nlet playing = false;\nlet playTimer = null;\nlet currentMeta = {}; // meta info for highlighted cells\n\n// DOM refs\nconst adjMatrixArea = document.getElementById('adjMatrixArea');\nconst distArea = document.getElementById('distArea');\nconst nextArea = document.getElementById('nextArea');\nconst logArea = document.getElementById('logArea');\nconst nInput = document.getElementById('nInput');\nconst directedChk = document.getElementById('directed');\nconst densitySel = document.getElementById('density');\nconst wminInput = document.getElementById('wmin');\nconst wmaxInput = document.getElementById('wmax');\nconst randBtn = document.getElementById('randBtn');\nconst presetBtn = document.getElementById('presetBtn');\nconst applyBtn = document.getElementById('applyBtn');\nconst initBtn = document.getElementById('initBtn');\nconst stepFwdBtn = document.getElementById('stepFwd');\nconst stepBackBtn = document.getElementById('stepBack');\nconst playBtn = document.getElementById('playBtn');\nconst runFullBtn = document.getElementById('runFull');\nconst resetBtn = document.getElementById('resetBtn');\nconst kLabel = document.getElementById('kLabel');\nconst ijLabel = document.getElementById('ijLabel');\nconst speedSlider = document.getElementById('speed');\nconst srcSel = document.getElementById('srcSel');\nconst tgtSel = document.getElementById('tgtSel');\nconst showPathBtn = document.getElementById('showPath');\nconst pathRes = document.getElementById('pathRes');\nconst addNodeBtn = document.getElementById('addNode');\nconst remNodeBtn = document.getElementById('remNode');\nconst exportBtn = document.getElementById('exportBtn');\nconst loadBtn = document.getElementById('loadBtn');\n\n// Initialize UI\nfunction createAdjMatrix(n){\n  N = n;\n  adjInputs = [];\n  adjMatrixArea.innerHTML = '';\n  const table = document.createElement('table');\n  const header = document.createElement('tr');\n  header.appendChild(document.createElement('th'));\n  for(let j=0;j<N;j++){\n    const th = document.createElement('th'); th.textContent = 'v'+j; header.appendChild(th);\n  }\n  table.appendChild(header);\n  for(let i=0;i<N;i++){\n    const tr = document.createElement('tr');\n    const th = document.createElement('th'); th.textContent = 'v'+i; tr.appendChild(th);\n    const rowInputs = [];\n    for(let j=0;j<N;j++){\n      const td = document.createElement('td');\n      const inp = document.createElement('input');\n      inp.type = 'text'; inp.value = (i===j ? '0' : '');\n      inp.style.width = '64px';\n      inp.dataset.i = i; inp.dataset.j = j;\n      td.appendChild(inp); tr.appendChild(td);\n      rowInputs.push(inp);\n    }\n    adjInputs.push(rowInputs);\n    table.appendChild(tr);\n  }\n  adjMatrixArea.appendChild(table);\n  updateSelectors();\n}\n\nfunction updateSelectors(){\n  srcSel.innerHTML = ''; tgtSel.innerHTML = '';\n  for(let i=0;i<N;i++){\n    const o1=document.createElement('option');o1.value=i;o1.textContent='v'+i;srcSel.appendChild(o1);\n    const o2=document.createElement('option');o2.value=i;o2.textContent='v'+i;tgtSel.appendChild(o2);\n  }\n}\n\n// parse adjacency inputs to produce distance and next matrices\nfunction readAdjacency(){\n  directed = directedChk.checked;\n  dist = new Array(N);\n  nextm = new Array(N);\n  for(let i=0;i<N;i++){\n    dist[i] = new Array(N).fill(Infinity);\n    nextm[i] = new Array(N).fill(null);\n  }\n  for(let i=0;i<N;i++){\n    for(let j=0;j<N;j++){\n      const raw = adjInputs[i][j].value.trim();\n      if(raw === '' || /^inf(inity)?$/i.test(raw)) continue;\n      const num = Number(raw);\n      if(!isFinite(num)) continue;\n      dist[i][j] = num;\n      if(i===j && num===0){\n        nextm[i][j] = i;\n      } else {\n        nextm[i][j] = j;\n      }\n      if(!directed){\n        // mirror if undirected\n        dist[j][i] = num;\n        nextm[j][i] = i;\n      }\n    }\n  }\n  // ensure zero on diagonal\n  for(let i=0;i<N;i++){\n    if(dist[i][i] === Infinity) { dist[i][i]=0; nextm[i][i]=i; }\n  }\n}\n\n// render matrix helper\nfunction renderMatrix(mat, container, highlight){\n  // mat is either number matrix or next matrix\n  const table = document.createElement('table');\n  const trh = document.createElement('tr'); trh.appendChild(document.createElement('th'));\n  for(let j=0;j<N;j++){ const th=document.createElement('th'); th.textContent='v'+j; trh.appendChild(th); }\n  table.appendChild(trh);\n  for(let i=0;i<N;i++){\n    const tr = document.createElement('tr');\n    const th = document.createElement('th'); th.textContent='v'+i; tr.appendChild(th);\n    for(let j=0;j<N;j++){\n      const td = document.createElement('td');\n      if(typeof(mat[i][j]) === 'number'){\n        const v = mat[i][j];\n        td.textContent = (v === Infinity ? '∞' : (Math.abs(v) === Infinity ? '∞' : v));\n        if(v === Infinity) td.classList.add('inf');\n      } else {\n        td.textContent = (mat[i][j] === null ? '-' : 'v'+mat[i][j]);\n        if(mat[i][j] === null) td.classList.add('inf');\n      }\n      if(highlight){\n        if(highlight.k === i || highlight.k === j){\n          td.classList.add('kcol');\n        }\n        if(highlight.current && highlight.current.i===i && highlight.current.j===j){\n          td.classList.add('current');\n        }\n        if(highlight.updated && highlight.updated.i===i && highlight.updated.j===j){\n          td.classList.add('updated');\n        }\n      }\n      tr.appendChild(td);\n    }\n    table.appendChild(tr);\n  }\n  container.innerHTML = '';\n  container.appendChild(table);\n}\n\n// initialize algorithm: capture history for step navigation\nfunction initializeFW(){\n  readAdjacency();\n  // reset history\n  history = [];\n  stepIndex = -1;\n  currentMeta = {k:-1, i:-1, j:-1};\n  // push initial state (k = -1) - before any k processed\n  pushState(dist, nextm, {k:-1, current:null, updated:null, note:'Initial matrices'});\n  log('Initialized matrices. Ready to step.');\n  renderAll();\n  enableControls(true);\n}\n\nfunction deepCopyMat(m){\n  return m.map(row => row.slice());\n}\n\nfunction pushState(dMat, nMat, meta){\n  history.push({\n    dist: deepCopyMat(dMat),\n    next: deepCopyMat(nMat),\n    meta: Object.assign({}, meta)\n  });\n  stepIndex = history.length - 1;\n  renderFromHistoryIndex(stepIndex);\n}\n\nfunction renderAll(){\n  const h = history[stepIndex];\n  renderMatrix(h.dist, distArea, h.meta);\n  renderMatrix(h.next, nextArea, h.meta);\n  kLabel.textContent = 'k = ' + (h.meta.k>=0 ? 'v'+h.meta.k : '-');\n  ijLabel.textContent = (h.meta.current ? `(${h.meta.current.i},${h.meta.current.j})` : '-');\n  // log area kept as appended messages; matrices reflect state\n}\n\n// perform full Floyd–Warshall but record each inner step in history\nfunction runAndRecord(){\n  // working copies\n  let D = deepCopyMat(history[stepIndex].dist);\n  let NX = deepCopyMat(history[stepIndex].next);\n\n  // triple loop: for k=0..N-1; for i=0..N-1; for j=0..N-1\n  for(let k=0;k<N;k++){\n    // snapshot before processing this k (optional)\n    pushState(D, NX, {k:k, current:null, updated:null, note:`Start k=${k}`});\n    for(let i=0;i<N;i++){\n      for(let j=0;j<N;j++){\n        // record the current comparison\n        const meta = {k:k, current:{i:i,j:j}, updated:null, note:`Checking if v${i}->v${j} > v${i}->v${k} + v${k}->v${j}`};\n        pushState(D, NX, meta);\n        const dik = D[i][k];\n        const dkj = D[k][j];\n        const dij = D[i][j];\n        if(dik === Infinity || dkj === Infinity) continue;\n        const nd = dik + dkj;\n        if(nd < dij){\n          D[i][j] = nd;\n          NX[i][j] = NX[i][k]; // successor update\n          // snapshot after update\n          const updMeta = {k:k, current:{i:i,j:j}, updated:{i:i,j:j}, note:`Updated v${i}->v${j} via v${k}: ${dij} → ${nd}`};\n          pushState(D, NX, updMeta);\n        }\n      }\n    }\n    // after finishing k, push snapshot\n    pushState(D, NX, {k:k, current:null, updated:null, note:`Finished k=${k}`});\n  }\n  // final snapshot\n  pushState(D, NX, {k:-2, current:null, updated:null, note:'Completed'});\n  log('Algorithm completed. Use \"Show Path\" to reconstruct a path (unless negative cycle).');\n}\n\n// step navigation\nfunction renderFromHistoryIndex(idx){\n  if(idx < 0) { return; }\n  const h = history[idx];\n  // render\n  renderMatrix(h.dist, distArea, h.meta);\n  renderMatrix(h.next, nextArea, h.meta);\n  kLabel.textContent = 'k = ' + (h.meta.k>=0 ? 'v'+h.meta.k : (h.meta.k===-1 ? '-' : 'final'));\n  ijLabel.textContent = (h.meta.current ? `(${h.meta.current.i},${h.meta.current.j})` : '-');\n  // highlight in log\n  if(h.meta.note) {\n    // brief log addition but keep appending for trace\n    log(`[state ${idx}] ${h.meta.note}`);\n  }\n  // update enabled buttons\n  stepBackBtn.disabled = (idx <= 0);\n  stepFwdBtn.disabled = (idx >= history.length-1);\n  playBtn.disabled = false;\n}\n\n// basic logging\nfunction log(msg){\n  const ts = new Date().toLocaleTimeString();\n  const line = document.createElement('div');\n  line.textContent = `[${ts}] ${msg}`;\n  logArea.appendChild(line);\n  logArea.scrollTop = logArea.scrollHeight;\n}\n\n// UI event handlers\nrandBtn.addEventListener('click', ()=>{\n  const n = Number(nInput.value) || 5;\n  const density = Number(densitySel.value);\n  const wmin = Number(wminInput.value) || -5;\n  const wmax = Number(wmaxInput.value) || 12;\n  createAdjMatrix(n);\n  for(let i=0;i<n;i++){\n    for(let j=0;j<n;j++){\n      if(i===j){ adjInputs[i][j].value = '0'; continue; }\n      if(Math.random() < density){\n        const w = Math.floor(Math.random()*(wmax-wmin+1))+wmin;\n        adjInputs[i][j].value = w;\n        if(!directedChk.checked) adjInputs[j][i].value = w;\n      } else {\n        adjInputs[i][j].value = '';\n      }\n    }\n  }\n});\npresetBtn.addEventListener('click', ()=>{\n  // small example including a negative edge but no negative cycle\n  createAdjMatrix(4);\n  const preset = [\n    ['0','3','INF','7'],\n    ['8','0','2','INF'],\n    ['5','INF','0','1'],\n    ['2','INF','INF','0']\n  ];\n  for(let i=0;i<4;i++) for(let j=0;j<4;j++) adjInputs[i][j].value = preset[i][j];\n});\naddNodeBtn.addEventListener('click', ()=>{\n  let n = Number(nInput.value)||5;\n  if(n < MAX_N) n++;\n  nInput.value = n;\n  createAdjMatrix(n);\n});\nremNodeBtn.addEventListener('click', ()=>{\n  let n = Number(nInput.value)||5;\n  if(n > 1) n--;\n  nInput.value = n;\n  createAdjMatrix(n);\n});\napplyBtn.addEventListener('click', ()=>{\n  createAdjMatrix(Number(nInput.value) || 5);\n});\ninitBtn.addEventListener('click', ()=>{\n  try {\n    initializeFW();\n  } catch(e){\n    alert('Error initializing: '+e);\n  }\n});\nstepFwdBtn.addEventListener('click', ()=>{\n  if(stepIndex < history.length-1){\n    stepIndex++;\n    renderFromHistoryIndex(stepIndex);\n  }\n});\nstepBackBtn.addEventListener('click', ()=>{\n  if(stepIndex > 0){\n    stepIndex--;\n    renderFromHistoryIndex(stepIndex);\n  }\n});\nplayBtn.addEventListener('click', ()=>{\n  if(playing){ stopPlay(); return; }\n  playing = true;\n  playBtn.textContent = 'Pause';\n  stepFwdBtn.disabled = true; stepBackBtn.disabled = true; runFullBtn.disabled = true;\n  playStep();\n});\nfunction playStep(){\n  if(!playing){ return; }\n  if(stepIndex >= history.length-1){ stopPlay(); return; }\n  const delay = Number(speedSlider.value);\n  playTimer = setTimeout(()=>{\n    stepIndex++;\n    renderFromHistoryIndex(stepIndex);\n    if(stepIndex >= history.length-1) { stopPlay(); }\n    else playStep();\n  }, delay);\n}\nfunction stopPlay(){\n  playing = false;\n  if(playTimer) clearTimeout(playTimer);\n  playBtn.textContent = 'Play';\n  stepFwdBtn.disabled = false; stepBackBtn.disabled = false; runFullBtn.disabled = false;\n}\n\nrunFullBtn.addEventListener('click', ()=>{\n  if(history.length === 0){ log('Initialize first.'); return; }\n  // if only initial snapshot present, run and record all steps\n  if(stepIndex === history.length-1){\n    // already ran?\n  }\n  // run algorithm from initial state\n  // Reset history to start from initial state (index 0) to avoid duplicate initial snapshots\n  const initState = history[0];\n  history = [initState];\n  stepIndex = 0;\n  runAndRecord();\n  // go to last state\n  stepIndex = history.length - 1;\n  renderFromHistoryIndex(stepIndex);\n});\n\nresetBtn.addEventListener('click', ()=>{\n  createAdjMatrix(Number(nInput.value) || 5);\n  logArea.innerHTML = '';\n  distArea.innerHTML = '';\n  nextArea.innerHTML = '';\n  history = []; stepIndex = -1;\n  kLabel.textContent = 'k = -';\n  ijLabel.textContent = '-';\n  pathRes.textContent = 'Path: —';\n  enableControls(false);\n});\n\nshowPathBtn.addEventListener('click', ()=>{\n  if(history.length===0){ log('Initialize and run algorithm first.'); return; }\n  // Use final matrices (last state)\n  const final = history[history.length-1];\n  const D = final.dist;\n  const NX = final.next;\n  // detect negative cycle reachable between src and tgt?\n  for(let v=0;v<N;v++){\n    if(D[v][v] < 0){\n      pathRes.innerHTML = `<span class=\"bad\">Negative cycle detected (dist[v][v] < 0). Shortest paths undefined for some pairs.</span>`;\n      log('Negative cycle detected; path reconstruction may be invalid.');\n      return;\n    }\n  }\n  const s = Number(srcSel.value);\n  const t = Number(tgtSel.value);\n  if(D[s][t] === Infinity){\n    pathRes.textContent = `Path: no path from v${s} to v${t} (∞)`;\n    return;\n  }\n  const path = reconstructPath(s,t,NX);\n  if(!path){\n    pathRes.textContent = `Path: none`;\n  } else {\n    pathRes.innerHTML = `Path: ${path.map(v=>'v'+v).join(' → ')} • length = ${D[s][t]}`;\n  }\n});\n\nfunction reconstructPath(u,v,NX){\n  if(NX[u][v] === null) return null;\n  const path = [u];\n  let cur = u;\n  while(cur !== v){\n    cur = NX[cur][v];\n    if(cur === null || path.length > N+5) return null;\n    path.push(cur);\n  }\n  return path;\n}\n\nexportBtn.addEventListener('click', ()=>{\n  if(history.length===0){ alert('No matrices available. Initialize first.'); return; }\n  const final = history[history.length-1];\n  const payload = {N:N, directed: directedChk.checked, dist:final.dist, next:final.next};\n  const txt = JSON.stringify(payload, null, 2);\n  prompt('Copy JSON below (Ctrl/Cmd+C):', txt);\n});\nloadBtn.addEventListener('click', ()=>{\n  const txt = prompt('Paste JSON exported by this demo:');\n  if(!txt) return;\n  try{\n    const obj = JSON.parse(txt);\n    if(!obj || typeof obj.N !== 'number') throw new Error('Invalid JSON');\n    createAdjMatrix(obj.N);\n    // attempt to fill adjacency from dist (best-effort)\n    for(let i=0;i<obj.N;i++){\n      for(let j=0;j<obj.N;j++){\n        const val = obj.dist?.[i]?.[j];\n        if(val === undefined || val === null || !isFinite(val)) adjInputs[i][j].value = '';\n        else adjInputs[i][j].value = String(val);\n      }\n    }\n    log('Loaded JSON into adjacency matrix (best-effort). Press Initialize to start.');\n  }catch(e){\n    alert('Could not load JSON: '+e);\n  }\n});\n\n// enable/disable controls based on state\nfunction enableControls(enabled){\n  initBtn.disabled = !enabled;\n  stepFwdBtn.disabled = true;\n  stepBackBtn.disabled = true;\n  playBtn.disabled = true;\n  runFullBtn.disabled = !enabled;\n  resetBtn.disabled = false;\n}\n\n// initial page setup\ncreateAdjMatrix(N);\nupdateSelectors();\nenableControls(true);\n\n// When initializing, after we create initial history entry, enable stepping buttons\n// Modify initializeFW to enable step buttons after creation. We'll attach enabling there:\ninitBtn.addEventListener('click', ()=>{\n  if(history.length>0 && stepIndex>=0){\n    // Already initialized; do nothing (handled above)\n  } else {\n    initializeFW();\n  }\n});\n\n// After initializeFW, ensure we have one snapshot and enable step buttons\nconst origInit = initializeFW;\ninitializeFW = function(){\n  // call original logic from closure by referencing origInit? we already captured above; to avoid complexity, reimplement\n  readAdjacency();\n  history = [];\n  stepIndex = -1;\n  currentMeta = {k:-1,i:-1,j:-1};\n  // push initial\n  pushState(dist, nextm, {k:-1, current:null, updated:null, note:'Initial matrices'});\n  log('Initialized matrices. Ready to step.');\n  renderAll();\n  // enable controls\n  stepFwdBtn.disabled = false;\n  stepBackBtn.disabled = true;\n  playBtn.disabled = false;\n  runFullBtn.disabled = false;\n  resetBtn.disabled = false;\n};\n\n// Reassign event to use this new initializeFW (rebind)\ninitBtn.onclick = initializeFW;\n\n// Important: When \"Run to End\" executed, some controls are changed. We'll ensure step navigation works after run.\n// After runAndRecord, stepIndex is set to last; enable step back/forward accordingly:\nrunFullBtn.addEventListener('click', ()=>{\n  if(history.length===0){ log('Initialize first.'); return; }\n  // Reset history to initial state\n  const initstate = history[0];\n  history = [initstate];\n  stepIndex = 0;\n  runAndRecord();\n  // Go to last valid state\n  stepIndex = history.length - 1;\n  renderFromHistoryIndex(stepIndex);\n  stepFwdBtn.disabled = true;\n  stepBackBtn.disabled = false;\n});\n\n// To enable step as we play, ensure play button toggling handled earlier.\n\n// Small improvement: allow editing adjacency values to accept \"INF\" or empty -> treated as Infinity\n// Already handled in readAdjacency.\n\n// Ensure initial log and UI readiness\nlog('Ready. Set up a graph, click \"Initialize\", then Step/Play/Run.');\n\n// Provide some helpful hints in console for advanced users\nconsole.info('Floyd–Warshall demo loaded.');\n\n/* End of script */\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Floyd-Warshall Algorithm"
    }
  ],
  "topic": "Floyd-Warshall Algorithm",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}