{
  "id": "98e16c80-d5c1-11f0-a327-5f281c6cb8e2",
  "timestamp": "2025-12-10T12:18:48.360Z",
  "model": "gpt-5-mini",
  "status": "success",
  "question": "Graph (Directed/Undirected)",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\" />\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n<title>Interactive Graph (Directed / Undirected) Demo</title>\n<style>\n  :root{\n    --panel-width: 320px;\n    --bg: #0f1724;\n    --panel: #0b1220;\n    --accent: #06b6d4;\n    --muted: #94a3b8;\n    --card: #0b1220;\n    color-scheme: dark;\n  }\n  html,body{\n    height:100%;\n    margin:0;\n    font-family:Inter, ui-sans-serif, system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial;\n    background:linear-gradient(180deg,#071026 0%, #07122a 100%);\n    color:#e6eef6;\n  }\n  .app{\n    display:flex;\n    height:100vh;\n    gap:12px;\n    padding:12px;\n    box-sizing:border-box;\n  }\n  .panel{\n    width:var(--panel-width);\n    background:linear-gradient(180deg,#07121a 0%, #071725 100%);\n    border-radius:10px;\n    padding:12px;\n    box-shadow: 0 8px 30px rgba(2,6,23,0.6);\n    overflow:auto;\n  }\n  .canvasWrap{\n    flex:1;\n    min-width:0;\n    border-radius:10px;\n    overflow:hidden;\n    position:relative;\n  }\n  header{\n    display:flex;\n    gap:8px;\n    align-items:center;\n    margin-bottom:8px;\n  }\n  h1{font-size:16px;margin:0;}\n  .muted{color:var(--muted);font-size:13px;}\n  .row{display:flex;gap:8px;align-items:center;margin:8px 0;}\n  button, select, input[type=\"checkbox\"]{\n    background:transparent;\n    border:1px solid rgba(200,220,240,0.06);\n    color:var(--muted);\n    padding:8px;\n    border-radius:6px;\n    cursor:pointer;\n    font-size:13px;\n  }\n  button.primary{\n    background:linear-gradient(90deg,var(--accent),#60a5fa);\n    color:#04202a;\n    border:none;\n    font-weight:600;\n  }\n  label{font-size:13px;color:var(--muted);display:flex;gap:6px;align-items:center;}\n  .small{font-size:12px;color:var(--muted);}\n  svg{width:100%;height:100%;display:block;background:\n    radial-gradient(ellipse at 10% 10%, rgba(8,20,30,0.6), transparent 10%),\n    linear-gradient(180deg, rgba(9,16,26,0.5), rgba(6,8,15,0.8));\n    }\n  .infoBox{\n    margin-top:8px;\n    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));\n    border-radius:8px;\n    padding:8px;\n    font-size:13px;\n    color:var(--muted);\n  }\n  .list{\n    max-height:200px; overflow:auto; margin-top:6px;\n    border-radius:6px;padding:6px;background:rgba(255,255,255,0.01);\n  }\n  .nodeBadge{\n    display:inline-block;padding:4px 6px;margin:3px;border-radius:6px;background:rgba(255,255,255,0.03);\n    color:var(--muted);font-size:12px;\n  }\n  table{width:100%;font-size:12px;border-collapse:collapse;}\n  td,th{padding:4px 6px;border-bottom:1px dashed rgba(255,255,255,0.02);text-align:left;color:var(--muted)}\n  .footer{\n    margin-top:12px;font-size:12px;color:var(--muted);\n  }\n  .controlsRow{display:flex;gap:8px;flex-wrap:wrap;}\n  .hint{font-size:12px;color:var(--muted);margin-top:6px;}\n  .smallBtn{padding:6px;border-radius:6px;font-size:12px;}\n  .selectedInfo{background:rgba(6,11,20,0.6);padding:6px;border-radius:6px;margin-top:6px;}\n  .metric{display:flex;justify-content:space-between;gap:8px}\n</style>\n</head>\n<body>\n<div class=\"app\">\n  <div class=\"panel\">\n    <header>\n      <h1>Graph Playground</h1>\n      <div style=\"flex:1\"></div>\n      <div class=\"muted\">Interactive | JS SVG</div>\n    </header>\n\n    <div class=\"row controlsRow\">\n      <label title=\"Toggle whether edges are directed\">\n        <input id=\"directedToggle\" type=\"checkbox\" checked /> Directed\n      </label>\n      <label title=\"Treat edges as weighted\">\n        <input id=\"weightedToggle\" type=\"checkbox\" /> Weighted\n      </label>\n      <button id=\"forceBtn\" class=\"smallBtn\">Start Force</button>\n      <button id=\"clearBtn\" class=\"smallBtn\">Clear</button>\n    </div>\n\n    <div class=\"row\">\n      <button id=\"addNodeBtn\" class=\"smallBtn\">Add Node (Click canvas)</button>\n      <button id=\"edgeModeBtn\" class=\"smallBtn\">Edge Mode: Drag</button>\n    </div>\n\n    <div class=\"hint\">\n      Instructions:\n      <ul style=\"margin:6px 0 0 18px;padding:0;color:var(--muted)\">\n        <li>Click blank canvas to add nodes (or press \"Add Node\" then click).</li>\n        <li>Drag from a node to another to create an edge (or click nodes when \"Edge Mode: Click\").</li>\n        <li>Click a node to select. Shift+click adds to selection. Press Delete to remove selection.</li>\n        <li>Drag nodes to move them. Toggle Directed/Weighted with controls.</li>\n      </ul>\n    </div>\n\n    <div class=\"infoBox\">\n      <div class=\"small\">Selected: <span id=\"selInfo\">none</span></div>\n      <div style=\"margin-top:6px\" class=\"metric\">\n        <div>Nodes: <strong id=\"nodeCount\">0</strong></div>\n        <div>Edges: <strong id=\"edgeCount\">0</strong></div>\n      </div>\n      <div class=\"muted\" style=\"margin-top:6px;font-size:12px\">\n        Click an edge label to edit its weight.\n      </div>\n    </div>\n\n    <div style=\"margin-top:8px;\" class=\"row\">\n      <button id=\"bfsBtn\" class=\"smallBtn\">Run BFS</button>\n      <button id=\"dfsBtn\" class=\"smallBtn\">Run DFS</button>\n      <button id=\"shortestBtn\" class=\"smallBtn\">Shortest Path</button>\n      <select id=\"algSelect\" style=\"padding:6px;border-radius:6px\">\n        <option value=\"auto\">Auto (BFS if unweighted)</option>\n        <option value=\"dijkstra\">Dijkstra</option>\n        <option value=\"bfs\">BFS</option>\n      </select>\n    </div>\n\n    <div style=\"margin-top:8px;\">\n      <div style=\"display:flex;gap:6px\">\n        <select id=\"startSelect\"></select>\n        <select id=\"endSelect\"></select>\n        <button id=\"pathClearBtn\" class=\"smallBtn\">Clear Highlights</button>\n      </div>\n    </div>\n\n    <div style=\"margin-top:10px;\">\n      <strong>Adjacency List</strong>\n      <div class=\"list\" id=\"adjList\"></div>\n      <strong style=\"margin-top:8px;display:block\">Adjacency Matrix</strong>\n      <div style=\"overflow:auto;max-height:160px;background:rgba(255,255,255,0.01);border-radius:6px;padding:6px;margin-top:6px\">\n        <table id=\"adjMatrix\"></table>\n      </div>\n    </div>\n\n    <div class=\"footer\">\n      <div style=\"display:flex;gap:6px;margin-top:8px\">\n        <button id=\"exportBtn\" class=\"smallBtn\">Export JSON</button>\n        <button id=\"importBtn\" class=\"smallBtn\">Import JSON</button>\n        <input id=\"fileInput\" type=\"file\" accept=\"application/json\" style=\"display:none\"/>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"canvasWrap\" id=\"canvasWrap\">\n    <svg id=\"svgCanvas\" viewBox=\"0 0 1200 800\" preserveAspectRatio=\"xMidYMid meet\">\n      <defs>\n        <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"10\" refY=\"5\" orient=\"auto\" markerUnits=\"strokeWidth\">\n          <path d=\"M0,0 L10,5 L0,10 z\" fill=\"#76E4F7\"></path>\n        </marker>\n        <marker id=\"arrowDark\" markerWidth=\"10\" markerHeight=\"10\" refX=\"10\" refY=\"5\" orient=\"auto\" markerUnits=\"strokeWidth\">\n          <path d=\"M0,0 L10,5 L0,10 z\" fill=\"#bdeaf6\"></path>\n        </marker>\n      </defs>\n      <g id=\"edgesLayer\"></g>\n      <g id=\"nodesLayer\"></g>\n      <g id=\"labelsLayer\"></g>\n    </svg>\n  </div>\n</div>\n\n<script>\n/*\nInteractive Graph (Directed/Undirected) Demo\n- Click blank area to add nodes.\n- Drag from node to node to add edges.\n- Toggle Directed / Weighted.\n- Drag nodes to reposition.\n- BFS / DFS / Shortest path with animations.\n- Adjacency list and matrix display, degrees computed.\n- Export/Import JSON of graph.\n*/\n\n// Basic state\nlet nodes = []; // {id,x,y,label}\nlet edges = []; // {id,source,target,weight}\nlet svg = document.getElementById('svgCanvas');\nlet nodesLayer = document.getElementById('nodesLayer');\nlet edgesLayer = document.getElementById('edgesLayer');\nlet labelsLayer = document.getElementById('labelsLayer');\nlet directedToggle = document.getElementById('directedToggle');\nlet weightedToggle = document.getElementById('weightedToggle');\nlet nodeCountEl = document.getElementById('nodeCount');\nlet edgeCountEl = document.getElementById('edgeCount');\nlet selInfo = document.getElementById('selInfo');\nlet adjListEl = document.getElementById('adjList');\nlet adjMatrixEl = document.getElementById('adjMatrix');\nlet startSelect = document.getElementById('startSelect');\nlet endSelect = document.getElementById('endSelect');\nlet algSelect = document.getElementById('algSelect');\n\nlet idCounter = 1;\nlet edgeCounter = 1;\nlet selectedNodes = new Set();\nlet selectedEdges = new Set();\n\nlet mode = { addNode: false, edgeMode: 'drag' }; // edgeMode: 'drag' or 'click'\nlet draggingNode = null;\nlet dragOffset = {x:0,y:0};\nlet creatingEdge = null; // {fromId, previewLineElement}\n\nlet forceRunning = false;\nlet forceAnimation = null;\nlet width=1200,height=800;\n\n// utilities\nfunction ptToSVG(evt){\n  let pt = svg.createSVGPoint();\n  pt.x = evt.clientX;\n  pt.y = evt.clientY;\n  let ctm = svg.getScreenCTM().inverse();\n  let p = pt.matrixTransform(ctm);\n  return {x:p.x,y:p.y};\n}\n\nfunction findNodeAt(p, radius=18){\n  for(let i=nodes.length-1;i>=0;i--){\n    let n = nodes[i];\n    let dx = p.x - n.x, dy = p.y - n.y;\n    if (Math.hypot(dx,dy) <= radius) return n;\n  }\n  return null;\n}\n\nfunction updateCounts(){\n  nodeCountEl.textContent = nodes.length;\n  edgeCountEl.textContent = edges.length;\n  selInfo.textContent = selectedNodes.size + ' node(s), ' + selectedEdges.size + ' edge(s)';\n  rebuildSelects();\n}\n\nfunction rebuildSelects(){\n  [startSelect,endSelect].forEach(sel=>{\n    let cur = sel.value;\n    sel.innerHTML = '';\n    let nothing = document.createElement('option'); nothing.value=''; nothing.textContent='(none)';\n    sel.appendChild(nothing);\n    nodes.forEach(n=>{\n      let o = document.createElement('option'); o.value = n.id; o.textContent = n.label;\n      sel.appendChild(o);\n    });\n    sel.value = cur || '';\n  });\n  renderAdj();\n  renderMatrix();\n  renderNodesEdges();\n}\n\n// Render adjacency list\nfunction renderAdj(){\n  let directed = directedToggle.checked;\n  let map = new Map();\n  nodes.forEach(n=> map.set(n.id, []));\n  edges.forEach(e=>{\n    map.get(e.source).push({to:e.target, weight:e.weight});\n    if (!directed){\n      map.get(e.target).push({to:e.source, weight:e.weight});\n    }\n  });\n  adjListEl.innerHTML = '';\n  map.forEach((arr,k)=>{\n    let n = nodes.find(x=>x.id==k);\n    let div = document.createElement('div');\n    div.style.marginBottom='6px';\n    let title = document.createElement('div'); title.style.fontWeight='600'; title.style.color='#dff7fb';\n    title.textContent = n ? n.label : k;\n    div.appendChild(title);\n    let txt = arr.map(a=>{\n      let nm = nodes.find(x=>x.id==a.to);\n      return (nm?nm.label:a.to) + (weightedToggle.checked ? (' ('+a.weight+')') : '');\n    }).join(', ');\n    let list = document.createElement('div'); list.style.color='var(--muted)'; list.textContent = txt || '(no neighbors)';\n    div.appendChild(list);\n    adjListEl.appendChild(div);\n  });\n}\n\n// Render adjacency matrix\nfunction renderMatrix(){\n  let directed = directedToggle.checked;\n  let ids = nodes.map(n=>n.id);\n  adjMatrixEl.innerHTML = '';\n  let tr = document.createElement('tr');\n  tr.appendChild(document.createElement('th'));\n  nodes.forEach(n=>{ let th=document.createElement('th'); th.textContent = n.label; tr.appendChild(th);});\n  adjMatrixEl.appendChild(tr);\n  let map = {};\n  edges.forEach(e=>{\n    map[e.source+'-'+e.target] = e.weight;\n    if(!directed) map[e.target+'-'+e.source] = e.weight;\n  });\n  nodes.forEach(r=>{\n    let tr = document.createElement('tr');\n    let th = document.createElement('th'); th.textContent = r.label; tr.appendChild(th);\n    nodes.forEach(c=>{\n      let td = document.createElement('td');\n      let val = map[r.id+'-'+c.id];\n      td.textContent = val===undefined? '0': (weightedToggle.checked?val:'1');\n      tr.appendChild(td);\n    });\n    adjMatrixEl.appendChild(tr);\n  });\n}\n\n// Creation helpers\nfunction addNodeAt(x,y,label){\n  let id = 'n'+(idCounter++);\n  let n = {id, x, y, label: label || id};\n  nodes.push(n);\n  updateCounts();\n  renderNodesEdges();\n}\n\nfunction addEdge(s,t,w){\n  if (s==t) return;\n  // prevent duplicate identical edge for undirected: check both directions\n  let directed = directedToggle.checked;\n  if (!directed){\n    if (edges.some(e => (e.source==s && e.target==t) || (e.source==t && e.target==s))) return;\n  } else {\n    if (edges.some(e => (e.source==s && e.target==t))) return;\n  }\n  let id = 'e'+(edgeCounter++);\n  edges.push({id,source:s,target:t,weight: (weightedToggle.checked? (w===undefined?1:w) : 1)});\n  updateCounts();\n  renderNodesEdges();\n}\n\n// Render everything: edges then nodes and labels\nfunction renderNodesEdges(){\n  // clear layers\n  while(edgesLayer.firstChild) edgesLayer.removeChild(edgesLayer.firstChild);\n  while(nodesLayer.firstChild) nodesLayer.removeChild(nodesLayer.firstChild);\n  while(labelsLayer.firstChild) labelsLayer.removeChild(labelsLayer.firstChild);\n\n  // edges\n  let directed = directedToggle.checked;\n  edges.forEach(e=>{\n    let s = nodes.find(n=>n.id==e.source);\n    let t = nodes.find(n=>n.id==e.target);\n    if (!s || !t) return;\n    // compute line endpoints offset from circle radius\n    let dx = t.x - s.x, dy = t.y - s.y;\n    let dist = Math.hypot(dx,dy);\n    let r = 18;\n    let sx = s.x + (dx/dist)*r;\n    let sy = s.y + (dy/dist)*r;\n    let tx = t.x - (dx/dist)*r;\n    let ty = t.y - (dy/dist)*r;\n\n    let line = document.createElementNS('http://www.w3.org/2000/svg','line');\n    line.setAttribute('x1', sx); line.setAttribute('y1', sy);\n    line.setAttribute('x2', tx); line.setAttribute('y2', ty);\n    line.setAttribute('stroke', 'rgba(150,200,220,0.6)');\n    line.setAttribute('stroke-width', selectedEdges.has(e.id) ? 4 : 2);\n    line.setAttribute('stroke-linecap','round');\n    if (directed) line.setAttribute('marker-end','url(#arrow)');\n    line.style.cursor='pointer';\n    line.dataset.id=e.id;\n    line.addEventListener('click', (ev)=>{ ev.stopPropagation(); toggleEdgeSelect(e.id); });\n    edgesLayer.appendChild(line);\n\n    // edge label\n    let midx = (sx+tx)/2, midy = (sy+ty)/2;\n    let textBg = document.createElementNS('http://www.w3.org/2000/svg','rect');\n    let txt = document.createElementNS('http://www.w3.org/2000/svg','text');\n    txt.setAttribute('x', midx); txt.setAttribute('y', midy - 6);\n    txt.setAttribute('fill', '#bdeaf6');\n    txt.setAttribute('font-size','12');\n    txt.setAttribute('text-anchor','middle');\n    txt.style.cursor='pointer';\n    txt.dataset.id = e.id;\n    txt.textContent = (weightedToggle.checked? e.weight : '');\n    txt.addEventListener('click', (ev)=>{ ev.stopPropagation(); editEdgeWeight(e.id); });\n    labelsLayer.appendChild(txt);\n  });\n\n  // nodes\n  nodes.forEach(n=>{\n    let g = document.createElementNS('http://www.w3.org/2000/svg','g');\n    g.setAttribute('transform', `translate(${n.x},${n.y})`);\n    g.style.cursor='grab';\n    g.dataset.id = n.id;\n\n    let circle = document.createElementNS('http://www.w3.org/2000/svg','circle');\n    circle.setAttribute('r', 18);\n    circle.setAttribute('fill', selectedNodes.has(n.id)? '#06303b' : '#04202a');\n    circle.setAttribute('stroke', selectedNodes.has(n.id)? '#7eeaf2' : '#2b6b71');\n    circle.setAttribute('stroke-width', selectedNodes.has(n.id)? 3 : 2);\n    circle.addEventListener('mousedown', (ev)=>{ ev.stopPropagation(); nodeMouseDown(ev,n); });\n    circle.addEventListener('click', (ev)=>{ ev.stopPropagation(); nodeClick(ev,n); });\n    g.appendChild(circle);\n\n    let text = document.createElementNS('http://www.w3.org/2000/svg','text');\n    text.setAttribute('y',5);\n    text.setAttribute('text-anchor','middle');\n    text.setAttribute('font-size','12');\n    text.setAttribute('fill','#cdeff7');\n    text.textContent = n.label;\n    text.style.pointerEvents='none';\n    g.appendChild(text);\n\n    nodesLayer.appendChild(g);\n  });\n\n  updateCounts();\n}\n\n// selection helpers\nfunction clearSelection(){\n  selectedNodes.clear(); selectedEdges.clear();\n  updateCounts();\n  renderNodesEdges();\n}\n\nfunction toggleNodeSelect(id, additive=false){\n  if (!additive) selectedNodes.clear();\n  if (selectedNodes.has(id)) selectedNodes.delete(id);\n  else selectedNodes.add(id);\n  selectedEdges.clear();\n  updateCounts();\n  renderNodesEdges();\n}\n\nfunction toggleEdgeSelect(id){\n  selectedEdges.clear();\n  selectedNodes.clear();\n  if (selectedEdges.has(id)) selectedEdges.delete(id);\n  else selectedEdges.add(id);\n  updateCounts();\n  renderNodesEdges();\n}\n\n// Node interactions\nfunction nodeMouseDown(evt,node){\n  draggingNode = node;\n  let p = ptToSVG(evt);\n  dragOffset.x = node.x - p.x;\n  dragOffset.y = node.y - p.y;\n  document.addEventListener('mousemove', nodeMouseMove);\n  document.addEventListener('mouseup', nodeMouseUp);\n  // if edge creation via drag:\n  if (mode.edgeMode === 'drag'){\n    // start preview line\n    creatingEdge = {fromId: node.id, line: document.createElementNS('http://www.w3.org/2000/svg','line')};\n    let l = creatingEdge.line;\n    l.setAttribute('x1', node.x);\n    l.setAttribute('y1', node.y);\n    l.setAttribute('x2', node.x);\n    l.setAttribute('y2', node.y);\n    l.setAttribute('stroke', 'rgba(150,200,220,0.4)');\n    l.setAttribute('stroke-width',2);\n    l.setAttribute('stroke-dasharray','6 4');\n    edgesLayer.appendChild(l);\n  }\n}\n\nfunction nodeMouseMove(ev){\n  let p = ptToSVG(ev);\n  if (draggingNode){\n    // drag node\n    draggingNode.x = p.x + dragOffset.x;\n    draggingNode.y = p.y + dragOffset.y;\n    renderNodesEdges();\n  }\n  if (creatingEdge){\n    creatingEdge.line.setAttribute('x2', p.x);\n    creatingEdge.line.setAttribute('y2', p.y);\n  }\n}\n\nfunction nodeMouseUp(ev){\n  document.removeEventListener('mousemove', nodeMouseMove);\n  document.removeEventListener('mouseup', nodeMouseUp);\n  let p = ptToSVG(ev);\n  // drop edge if creating\n  if (creatingEdge){\n    let target = findNodeAt(p);\n    if (target && target.id !== creatingEdge.fromId){\n      let weight = 1;\n      if (weightedToggle.checked){\n        weight = parseFloat(prompt('Edge weight (number):', '1')) || 1;\n      }\n      addEdge(creatingEdge.fromId, target.id, weight);\n    }\n    if (creatingEdge.line && creatingEdge.line.parentNode) creatingEdge.line.parentNode.removeChild(creatingEdge.line);\n    creatingEdge = null;\n  }\n  draggingNode = null;\n}\n\n// clicking nodes\nfunction nodeClick(ev,node){\n  if (ev.shiftKey){\n    toggleNodeSelect(node.id, true);\n  } else if (mode.edgeMode === 'click' && selectedNodes.size === 1 && !selectedNodes.has(node.id)){\n    // create edge between previously selected node and this one\n    let from = Array.from(selectedNodes)[0];\n    let weight = 1;\n    if (weightedToggle.checked){\n      weight = parseFloat(prompt('Edge weight (number):', '1')) || 1;\n    }\n    addEdge(from, node.id, weight);\n  } else {\n    toggleNodeSelect(node.id, ev.shiftKey);\n  }\n}\n\n// canvas click to add node or clear selection\nsvg.addEventListener('click', (ev)=>{\n  let p = ptToSVG(ev);\n  let hit = findNodeAt(p);\n  if (mode.addNode || !hit){\n    if (mode.addNode || !hit){\n      // add node\n      if (mode.addNode || (!hit && !ev.shiftKey)){\n        addNodeAt(p.x,p.y,'v'+(idCounter));\n        mode.addNode=false;\n        document.getElementById('addNodeBtn').textContent = 'Add Node (Click canvas)';\n      }\n    }\n    if (!hit) clearSelection();\n  } else {\n    // clicked on a node (handled on the node)\n  }\n});\n\n// delete key to remove selected items\ndocument.addEventListener('keydown', (ev)=>{\n  if (ev.key === 'Delete' || ev.key === 'Backspace'){\n    // remove selected nodes and incident edges\n    if (selectedNodes.size>0){\n      nodes = nodes.filter(n=>!selectedNodes.has(n.id));\n      edges = edges.filter(e=> !selectedNodes.has(e.source) && !selectedNodes.has(e.target));\n      selectedNodes.clear();\n    } else if (selectedEdges.size>0){\n      edges = edges.filter(e=> !selectedEdges.has(e.id));\n      selectedEdges.clear();\n    }\n    renderNodesEdges();\n  }\n});\n\n// UI bindings\ndocument.getElementById('addNodeBtn').addEventListener('click', ()=>{\n  mode.addNode = !mode.addNode;\n  document.getElementById('addNodeBtn').textContent = mode.addNode? 'Click canvas to place' : 'Add Node (Click canvas)';\n});\ndocument.getElementById('edgeModeBtn').addEventListener('click', ()=>{\n  mode.edgeMode = (mode.edgeMode === 'drag') ? 'click' : 'drag';\n  document.getElementById('edgeModeBtn').textContent = 'Edge Mode: ' + (mode.edgeMode==='drag' ? 'Drag' : 'Click');\n});\ndirectedToggle.addEventListener('change', ()=>{ renderNodesEdges(); });\nweightedToggle.addEventListener('change', ()=>{ renderNodesEdges(); renderAdj(); renderMatrix(); });\n\n// simple editing of edge weights\nfunction editEdgeWeight(eid){\n  let e = edges.find(x=>x.id===eid); if(!e) return;\n  let w = prompt('Set edge weight (number):', e.weight);\n  if (w === null) return;\n  let num = parseFloat(w);\n  if (!isNaN(num)) e.weight = num;\n  renderNodesEdges(); renderAdj(); renderMatrix();\n}\n\n// BFS / DFS / Shortest path algorithms\nfunction bfs(startId){\n  let q = [startId];\n  let visited = new Set([startId]);\n  let order = [];\n  let parent = {};\n  while(q.length){\n    let u = q.shift();\n    order.push(u);\n    // neighbors\n    let nb = edges.filter(e=> e.source==u).map(e=>e.target);\n    if (!directedToggle.checked){\n      // undirected: include edges where u is target too\n      edges.forEach(e=>{\n        if (e.target==u && !nb.includes(e.source)) nb.push(e.source);\n      });\n    }\n    for(let v of nb){\n      if (!visited.has(v)){\n        visited.add(v);\n        parent[v]=u;\n        q.push(v);\n      }\n    }\n  }\n  return {order,parent};\n}\n\nfunction dfs(startId){\n  let visited = new Set();\n  let order = [];\n  let parent = {};\n  function visit(u){\n    visited.add(u); order.push(u);\n    let nb = edges.filter(e=> e.source==u).map(e=>e.target);\n    if (!directedToggle.checked){\n      edges.forEach(e=>{ if (e.target==u && !nb.includes(e.source)) nb.push(e.source); });\n    }\n    for(let v of nb){\n      if (!visited.has(v)){\n        parent[v]=u;\n        visit(v);\n      }\n    }\n  }\n  visit(startId);\n  return {order,parent};\n}\n\n// Dijkstra for weighted graphs\nfunction dijkstra(startId){\n  let dist = {}; let prev = {};\n  nodes.forEach(n=> dist[n.id]=Infinity);\n  dist[startId]=0;\n  let Q = new Set(nodes.map(n=>n.id));\n  while(Q.size){\n    let u = Array.from(Q).reduce((a,b)=> dist[a]<dist[b]?a:b);\n    Q.delete(u);\n    // neighbors\n    let nb = edges.filter(e=> e.source==u).map(e=>({to:e.target,w:e.weight}));\n    if (!directedToggle.checked){\n      edges.forEach(e=>{ if (e.target==u) nb.push({to:e.source,w:e.weight}); });\n    }\n    for(let {to,w} of nb){\n      if (!Q.has(to)) continue;\n      let alt = dist[u] + w;\n      if (alt < dist[to]){ dist[to]=alt; prev[to]=u; }\n    }\n  }\n  return {dist,prev};\n}\n\n// animate visitation order\nasync function animateOrder(order){\n  // highlight nodes in order briefly\n  for(let id of order){\n    selectedNodes.clear();\n    selectedNodes.add(id);\n    renderNodesEdges();\n    await new Promise(res=>setTimeout(res,400));\n  }\n  selectedNodes.clear(); renderNodesEdges();\n}\n\n// BFS button\ndocument.getElementById('bfsBtn').addEventListener('click', async ()=>{\n  let start = startSelect.value;\n  if (!start){ alert('Select a start node'); return; }\n  let res = bfs(start);\n  await animateOrder(res.order);\n});\n\n// DFS button\ndocument.getElementById('dfsBtn').addEventListener('click', async ()=>{\n  let start = startSelect.value;\n  if (!start){ alert('Select a start node'); return; }\n  let res = dfs(start);\n  await animateOrder(res.order);\n});\n\n// Shortest Path button\ndocument.getElementById('shortestBtn').addEventListener('click', async ()=>{\n  let start = startSelect.value, end = endSelect.value;\n  if (!start || !end){ alert('Pick both start and end nodes'); return; }\n  let method = algSelect.value;\n  if (method === 'auto'){\n    method = weightedToggle.checked ? 'dijkstra' : 'bfs';\n  }\n  let path = [];\n  if (method === 'bfs'){\n    let res = bfs(start);\n    // reconstruct path\n    if (!res.parent[end] && start!==end){ if (start!==end && !res.order.includes(end)){ alert('No path'); return; } }\n    let cur = end; path.push(cur);\n    while(cur !== start){\n      cur = res.parent[cur];\n      if (!cur) break;\n      path.push(cur);\n    }\n    path = path.reverse();\n  } else {\n    // dijkstra\n    let res = dijkstra(start);\n    if (!isFinite(res.dist[end])){ alert('No path'); return; }\n    let cur = end; path.push(cur);\n    while(cur !== start){\n      cur = res.prev[cur];\n      if (!cur) break;\n      path.push(cur);\n    }\n    path = path.reverse();\n  }\n  // highlight path (nodes + edges)\n  selectedNodes.clear(); selectedEdges.clear();\n  for(let i=0;i<path.length;i++){\n    selectedNodes.add(path[i]);\n    if (i<path.length-1){\n      let e = edges.find(e=> (e.source==path[i] && e.target==path[i+1]) || (!directedToggle.checked && e.source==path[i+1] && e.target==path[i]));\n      if (e) selectedEdges.add(e.id);\n    }\n  }\n  renderNodesEdges();\n});\n\n// Clear highlights\ndocument.getElementById('pathClearBtn').addEventListener('click', ()=>{\n  selectedNodes.clear(); selectedEdges.clear();\n  renderNodesEdges();\n});\n\n// Force-directed layout (simple)\ndocument.getElementById('forceBtn').addEventListener('click', ()=>{\n  forceRunning = !forceRunning;\n  document.getElementById('forceBtn').textContent = forceRunning? 'Stop Force':'Start Force';\n  if (forceRunning) startForce(); else stopForce();\n});\n\nfunction startForce(){\n  let k = 80; // ideal distance\n  let damp = 0.85;\n  if (forceAnimation) cancelAnimationFrame(forceAnimation);\n  function step(){\n    let disp = {};\n    nodes.forEach(n=> disp[n.id] = {x:0,y:0});\n    // repulsive\n    for(let i=0;i<nodes.length;i++){\n      for(let j=i+1;j<nodes.length;j++){\n        let a = nodes[i], b = nodes[j];\n        let dx = a.x - b.x, dy = a.y - b.y;\n        let dist = Math.max(1, Math.hypot(dx,dy));\n        let force = (k*k)/dist;\n        disp[a.id].x += (dx/dist)*force;\n        disp[a.id].y += (dy/dist)*force;\n        disp[b.id].x -= (dx/dist)*force;\n        disp[b.id].y -= (dy/dist)*force;\n      }\n    }\n    // attractive along edges\n    edges.forEach(e=>{\n      let a = nodes.find(n=>n.id==e.source);\n      let b = nodes.find(n=>n.id==e.target);\n      if (!a||!b) return;\n      let dx = a.x - b.x, dy = a.y - b.y;\n      let dist = Math.max(1, Math.hypot(dx,dy));\n      let force = (dist*dist)/k;\n      let fx = (dx/dist)*force, fy = (dy/dist)*force;\n      disp[a.id].x -= fx; disp[a.id].y -= fy;\n      disp[b.id].x += fx; disp[b.id].y += fy;\n    });\n    // apply\n    nodes.forEach(n=>{\n      n.x += Math.max(-10, Math.min(10, disp[n.id].x)) * 0.02;\n      n.y += Math.max(-10, Math.min(10, disp[n.id].y)) * 0.02;\n      // bounds\n      n.x = Math.max(40, Math.min(width-40, n.x));\n      n.y = Math.max(40, Math.min(height-40, n.y));\n    });\n    renderNodesEdges();\n    if (forceRunning) forceAnimation = requestAnimationFrame(step);\n  }\n  forceAnimation = requestAnimationFrame(step);\n}\nfunction stopForce(){\n  if (forceAnimation) cancelAnimationFrame(forceAnimation);\n  forceAnimation = null;\n  forceRunning = false;\n  document.getElementById('forceBtn').textContent = 'Start Force';\n}\n\n// Export / Import\ndocument.getElementById('exportBtn').addEventListener('click', ()=>{\n  const data = {nodes,edges,directed:directedToggle.checked,weighted:weightedToggle.checked};\n  const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a'); a.href = url; a.download = 'graph.json';\n  a.click();\n  URL.revokeObjectURL(url);\n});\n\ndocument.getElementById('importBtn').addEventListener('click', ()=> document.getElementById('fileInput').click());\ndocument.getElementById('fileInput').addEventListener('change', (ev)=>{\n  let f = ev.target.files[0];\n  if (!f) return;\n  let reader = new FileReader();\n  reader.onload = () => {\n    try{\n      let data = JSON.parse(reader.result);\n      if (!data.nodes || !data.edges) throw new Error('Invalid');\n      nodes = data.nodes;\n      edges = data.edges;\n      idCounter = nodes.reduce((a,b)=> Math.max(a, parseInt(b.id.replace(/\\D/g,'')) ),0)+1;\n      edgeCounter = edges.reduce((a,b)=> Math.max(a, parseInt(b.id.replace(/\\D/g,'')) ),0)+1;\n      directedToggle.checked = !!data.directed;\n      weightedToggle.checked = !!data.weighted;\n      renderNodesEdges();\n      renderAdj(); renderMatrix();\n    }catch(e){ alert('Failed to import: ' + e.message); }\n  };\n  reader.readAsText(f);\n});\n\n// when clicking the background, clear selection\ndocument.getElementById('canvasWrap').addEventListener('click', (ev)=>{\n  // handled earlier by svg click\n});\n\n// initial demo graph\nfunction demo(){\n  nodes = [\n    {id:'n1',x:200,y:150,label:'A'},\n    {id:'n2',x:360,y:120,label:'B'},\n    {id:'n3',x:520,y:180,label:'C'},\n    {id:'n4',x:360,y:300,label:'D'},\n    {id:'n5',x:200,y:300,label:'E'}\n  ];\n  edges = [\n    {id:'e1',source:'n1',target:'n2',weight:1},\n    {id:'e2',source:'n2',target:'n3',weight:2},\n    {id:'e3',source:'n3',target:'n4',weight:1},\n    {id:'e4',source:'n4',target:'n5',weight:3},\n    {id:'e5',source:'n5',target:'n1',weight:4},\n    {id:'e6',source:'n2',target:'n4',weight:1}\n  ];\n  idCounter = 6;\n  edgeCounter = 7;\n  renderNodesEdges();\n  renderAdj();\n  renderMatrix();\n}\n\n// window resize mapping\nfunction updateSVGSize(){\n  // keep viewbox as default; users can resize\n}\n\ndemo();\nupdateCounts();\n\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Graph (Directed/Undirected)"
    }
  ],
  "topic": "Graph (Directed/Undirected)",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}