<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Selection Sort Visualizer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{
      --bg:#0f1724;
      --panel:#0b1220;
      --accent:#2dd4bf;
      --muted:#94a3b8;
      --bar:#60a5fa;
      --min:#fb7185;
      --comp:#fbbf24;
      --sorted:#34d399;
      --text:#e6eef8;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    .container{max-width:1100px;margin:20px auto;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.6);}
    h1{margin:0 0 8px;font-size:20px;}
    p.lead{margin:0 0 16px;color:var(--muted);font-size:13px;}
    .controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:14px;}
    .controls > *{background:var(--panel);padding:10px;border-radius:10px;color:var(--text);font-size:13px;border:1px solid rgba(255,255,255,0.03);}
    label.inline{display:flex;gap:8px;align-items:center}
    .buttons{display:flex;gap:8px;}
    button{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04);color:var(--text);padding:8px 12px;border-radius:8px;cursor:pointer;}
    button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);}
    button:active{transform:translateY(1px);}
    input[type=range]{width:140px;}
    .visual-area{display:flex;gap:16px;align-items:flex-start;}
    .bars-wrap{flex:1;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0));padding:12px;border-radius:10px;height:360px;display:flex;align-items:end;position:relative;overflow:hidden;border:1px solid rgba(255,255,255,0.02);}
    .bars{height:100%;width:100%;display:flex;align-items:end;gap:2px;padding:8px;box-sizing:border-box;}
    .bar{flex:1 1 auto;background:var(--bar);border-radius:4px 4px 0 0;display:flex;align-items:flex-end;justify-content:center;color:#062037;font-weight:700;font-size:11px;transition:height 250ms ease, transform 200ms ease;}
    .bar .val{padding:4px 2px;color:rgba(255,255,255,0.95);font-weight:600;font-size:11px;}
    .bar.comp{background:var(--comp);transform:translateY(-6px) scale(1.02);box-shadow:0 6px 20px rgba(251,191,36,0.12);}
    .bar.min{background:var(--min);transform:translateY(-8px) scale(1.04);box-shadow:0 8px 28px rgba(251,113,133,0.12);}
    .bar.sorted{background:var(--sorted);transform:none;box-shadow:none;}
    .side-panel{width:340px;min-width:260px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);}
    .stats{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px;}
    .stat{flex:1;background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;text-align:center;}
    .stat b{display:block;font-size:18px;color:var(--accent);}
    .pseudocode{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;font-size:13px;color:var(--muted);line-height:1.5;}
    .code-line{padding:6px;border-radius:6px;}
    .code-line.active{background:linear-gradient(90deg, rgba(45,212,191,0.06), rgba(96,165,250,0.03));color:var(--text);box-shadow:inset 0 0 0 1px rgba(255,255,255,0.02);}
    .footer{margin-top:12px;color:var(--muted);font-size:12px;}
    .small{font-size:12px;color:var(--muted);}
    .indices{display:flex;gap:10px;margin-top:8px;font-size:13px;}
    .indices span{background:rgba(255,255,255,0.02);padding:6px;border-radius:8px;color:var(--muted);min-width:80px;text-align:center;}
    .controls .input-group{display:flex;gap:8px;align-items:center;}
    @media (max-width:900px){
      .visual-area{flex-direction:column;}
      .side-panel{width:100%;}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Selection Sort Visualizer</h1>
    <p class="lead">Interactive demonstration of Selection Sort. Step through comparisons and swaps, change speed and size, and watch how the algorithm selects the minimum (or maximum) and swaps elements into position.</p>

    <div class="controls">
      <div class="buttons">
        <button id="playBtn">Play</button>
        <button id="pauseBtn" class="secondary">Pause</button>
        <button id="stepBtn" class="secondary">Step</button>
        <button id="resetBtn">Shuffle</button>
      </div>

      <div class="input-group">
        <label class="inline">Size
          <input id="sizeRange" type="range" min="5" max="80" value="30">
        </label>
        <span id="sizeLabel" class="small">30</span>
      </div>

      <div class="input-group">
        <label class="inline">Speed
          <input id="speedRange" type="range" min="50" max="1500" value="350">
        </label>
        <span id="speedLabel" class="small">350 ms</span>
      </div>

      <label class="inline" title="Sort ascending (min first) or descending (max first)">
        <input id="orderToggle" type="checkbox" checked> Ascending
      </label>

      <button id="randomInputBtn" class="secondary">Custom Input</button>
    </div>

    <div class="visual-area">
      <div class="bars-wrap" aria-hidden="false">
        <div id="bars" class="bars" role="list" aria-label="Array bars"></div>
      </div>

      <div class="side-panel">
        <div class="stats">
          <div class="stat">
            Comparisons
            <b id="compCount">0</b>
          </div>
          <div class="stat">
            Swaps
            <b id="swapCount">0</b>
          </div>
          <div class="stat">
            Steps
            <b id="stepCount">0</b>
          </div>
        </div>

        <div class="indices">
          <span>i: <b id="idxI">-</b></span>
          <span>j: <b id="idxJ">-</b></span>
          <span>min: <b id="idxMin">-</b></span>
        </div>

        <h3 style="margin-top:10px;margin-bottom:6px;font-size:14px;">Pseudocode</h3>
        <div class="pseudocode" id="pseudocode">
          <div class="code-line" data-line="1">for i = 0 to n-2 do</div>
          <div class="code-line" data-line="2">&nbsp;&nbsp;minIndex = i</div>
          <div class="code-line" data-line="3">&nbsp;&nbsp;for j = i+1 to n-1 do</div>
          <div class="code-line" data-line="4">&nbsp;&nbsp;&nbsp;&nbsp;if A[j] &lt; A[minIndex] then minIndex = j</div>
          <div class="code-line" data-line="5">&nbsp;&nbsp;swap A[i] and A[minIndex]</div>
          <div class="code-line" data-line="6">&nbsp;&nbsp;mark i as sorted</div>
          <div class="code-line" data-line="7">end for</div>
        </div>

        <div class="footer">
          Tip: Use Step to move one action at a time. Play will animate with current speed. Toggle Ascending to switch behavior.
        </div>
      </div>
    </div>
  </div>

<script>
(function(){
  // DOM elements
  const barsEl = document.getElementById('bars');
  const playBtn = document.getElementById('playBtn');
  const pauseBtn = document.getElementById('pauseBtn');
  const stepBtn = document.getElementById('stepBtn');
  const resetBtn = document.getElementById('resetBtn');
  const sizeRange = document.getElementById('sizeRange');
  const sizeLabel = document.getElementById('sizeLabel');
  const speedRange = document.getElementById('speedRange');
  const speedLabel = document.getElementById('speedLabel');
  const orderToggle = document.getElementById('orderToggle');
  const compCountEl = document.getElementById('compCount');
  const swapCountEl = document.getElementById('swapCount');
  const stepCountEl = document.getElementById('stepCount');
  const idxI = document.getElementById('idxI');
  const idxJ = document.getElementById('idxJ');
  const idxMin = document.getElementById('idxMin');
  const pseudo = document.getElementById('pseudocode');

  // state
  let arr = [];
  let maxVal = 100;
  let timer = null;
  let generator = null;
  let running = false;
  let comparisons = 0;
  let swaps = 0;
  let steps = 0;
  let highlighted = {i:-1,j:-1,min:-1};
  let sortedIndices = new Set();

  // helpers
  function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

  function generateArray(n){
    arr = [];
    maxVal = 1;
    for(let i=0;i<n;i++){
      const v = randInt(5,100);
      arr.push(v);
      if(v>maxVal) maxVal = v;
    }
    resetState();
    renderBars();
  }

  function resetState(){
    clearTimer();
    generator = null;
    running = false;
    comparisons = 0;
    swaps = 0;
    steps = 0;
    highlighted = {i:-1,j:-1,min:-1};
    sortedIndices = new Set();
    updateStats();
    updateIndicesUI();
    clearCodeHighlight();
    playBtn.disabled = false;
  }

  function clearTimer(){
    if(timer){ clearInterval(timer); timer = null; }
  }

  function renderBars(){
    barsEl.innerHTML = '';
    const n = arr.length;
    const showValue = arr.length <= 40;
    for(let i=0;i<n;i++){
      const b = document.createElement('div');
      b.className = 'bar';
      b.style.height = (arr[i]/maxVal*100) + '%';
      b.dataset.index = i;
      b.setAttribute('role','listitem');
      if(showValue){
        const val = document.createElement('div');
        val.className = 'val';
        val.textContent = arr[i];
        b.appendChild(val);
      }
      barsEl.appendChild(b);
    }
    updateBarStates();
  }

  function updateBarStates(){
    const bars = barsEl.children;
    for(let k=0;k<bars.length;k++){
      const bar = bars[k];
      bar.classList.remove('comp','min','sorted');
      if(sortedIndices.has(k)) bar.classList.add('sorted');
      if(k === highlighted.j) bar.classList.add('comp');
      if(k === highlighted.min) bar.classList.add('min');
      if(k === highlighted.i) {
        // i is both current pivot and considered sorted once marked. When i hasn't been marked sorted yet, give light accent
        if(!sortedIndices.has(k)) bar.style.boxShadow = 'inset 0 0 0 1px rgba(255,255,255,0.02)';
      } else {
        bar.style.boxShadow = '';
      }
      // update height numbers only when small arrays were used
      const valDiv = bar.querySelector('.val');
      if(valDiv) valDiv.textContent = arr[k];
      bar.style.height = (arr[k]/maxVal*100) + '%';
    }
  }

  // Pseudocode highlighting
  function clearCodeHighlight(){
    Array.from(pseudo.querySelectorAll('.code-line')).forEach(el => el.classList.remove('active'));
  }
  function highlightLine(num){
    clearCodeHighlight();
    const el = pseudo.querySelector('.code-line[data-line="'+num+'"]');
    if(el) el.classList.add('active');
  }

  // Generator implementing selection sort with yields for actions
  function* selectionSortGen(a, ascending){
    const n = a.length;
    for(let i=0;i<n-1;i++){
      yield {type:'line', line:1, i};
      let minIdx = i;
      yield {type:'setMin', i, minIdx, line:2};
      for(let j=i+1;j<n;j++){
        yield {type:'compare', i, j, minIdx, line:3};
        if((ascending && a[j] < a[minIdx]) || (!ascending && a[j] > a[minIdx])){
          minIdx = j;
          yield {type:'setMin', i, minIdx, line:4};
        }
      }
      // after inner loop
      if(minIdx !== i){
        yield {type:'swap', i, minIdx, line:5};
        // do the swap on the internal array to keep generator consistent
        const tmp = a[i]; a[i]=a[minIdx]; a[minIdx]=tmp;
      } else {
        // still yield a swap-none to mark step (optional)
        yield {type:'swapNone', i, minIdx, line:5};
      }
      yield {type:'markSorted', i, line:6};
    }
    yield {type:'done', line:7};
  }

  // Process single action from generator
  function processAction(act){
    if(!act) return;
    steps++;
    stepCountEl.textContent = steps;
    highlightLine(act.line || 0);
    switch(act.type){
      case 'line':
        highlighted.i = act.i;
        highlighted.j = -1;
        highlighted.min = -1;
        updateIndicesUI();
        break;
      case 'setMin':
        highlighted.min = act.minIdx;
        highlighted.i = act.i;
        updateIndicesUI();
        updateBarStates();
        break;
      case 'compare':
        comparisons++;
        compCountEl.textContent = comparisons;
        highlighted.j = act.j;
        highlighted.min = act.minIdx;
        highlighted.i = act.i;
        updateIndicesUI();
        updateBarStates();
        break;
      case 'swap':
        swaps++;
        swapCountEl.textContent = swaps;
        // animate swap visually by swapping heights & data then re-render heights
        animateSwap(act.i, act.minIdx);
        highlighted.j = -1;
        highlighted.min = -1;
        highlighted.i = act.i;
        updateIndicesUI();
        break;
      case 'swapNone':
        // no physical swap happened (minIdx === i), small pulse
        highlighted.j = -1;
        highlighted.min = -1;
        highlighted.i = act.i;
        updateIndicesUI();
        pulseBar(act.i);
        break;
      case 'markSorted':
        sortedIndices.add(act.i);
        highlighted.j = -1;
        highlighted.min = -1;
        highlighted.i = -1;
        updateBarStates();
        updateIndicesUI();
        break;
      case 'done':
        // mark all as sorted
        for(let k=0;k<arr.length;k++) sortedIndices.add(k);
        highlighted = {i:-1,j:-1,min:-1};
        updateBarStates();
        playBtn.disabled = false;
        clearTimer();
        running = false;
        break;
    }
  }

  function updateStats(){
    compCountEl.textContent = comparisons;
    swapCountEl.textContent = swaps;
    stepCountEl.textContent = steps;
  }

  function updateIndicesUI(){
    idxI.textContent = highlighted.i>=0 ? highlighted.i : '-';
    idxJ.textContent = highlighted.j>=0 ? highlighted.j : '-';
    idxMin.textContent = highlighted.min>=0 ? highlighted.min : '-';
  }

  // Animations
  function animateSwap(i,j){
    // swap DOM heights with animation
    const bars = barsEl.children;
    const bi = bars[i];
    const bj = bars[j];
    if(!bi || !bj){ // fallback
      renderBars();
      return;
    }
    const hi = bi.style.height;
    const hj = bj.style.height;
    // animate by temporarily scaling
    bi.classList.add('comp');
    bj.classList.add('min');
    setTimeout(()=>{
      bi.style.height = hj;
      bj.style.height = hi;
      // swap textual values if present
      const vi = bi.querySelector('.val');
      const vj = bj.querySelector('.val');
      if(vi && vj){
        const tmp = vi.textContent; vi.textContent = vj.textContent; vj.textContent = tmp;
      }
      setTimeout(()=>{
        bi.classList.remove('comp');
        bj.classList.remove('min');
        updateBarStates();
      }, Math.max(120, parseInt(speedRange.value)/3));
    }, Math.max(80, parseInt(speedRange.value)/6));
  }

  function pulseBar(i){
    const bar = barsEl.children[i];
    if(!bar) return;
    bar.classList.add('comp');
    setTimeout(()=>bar.classList.remove('comp'), Math.max(160, parseInt(speedRange.value)/3));
  }

  // Controls actions
  function startPlay(){
    if(running) return;
    // setup generator if needed
    if(!generator){
      // make a copy to allow generator internal swaps without altering original arr outside
      const copy = arr.slice();
      generator = selectionSortGen(copy, orderToggle.checked);
    }
    running = true;
    playBtn.disabled = true;
    const interval = Math.max(10, parseInt(speedRange.value));
    timer = setInterval(()=>{
      const res = generator.next();
      if(res.done){
        processAction(res.value); // might be undefined
        clearTimer();
        running = false;
        playBtn.disabled = false;
      } else {
        processAction(res.value);
      }
    }, interval);
  }

  function pausePlay(){
    running = false;
    clearTimer();
    playBtn.disabled = false;
  }

  function stepOnce(){
    if(!generator){
      const copy = arr.slice();
      generator = selectionSortGen(copy, orderToggle.checked);
    }
    const res = generator.next();
    if(res.done){
      processAction(res.value); // final
      playBtn.disabled = false;
      running = false;
      clearTimer();
    } else {
      processAction(res.value);
    }
  }

  // UI events
  playBtn.addEventListener('click', startPlay);
  pauseBtn.addEventListener('click', pausePlay);
  stepBtn.addEventListener('click', stepOnce);

  resetBtn.addEventListener('click', ()=>{
    generateArray(parseInt(sizeRange.value,10));
  });

  sizeRange.addEventListener('input', ()=>{
    sizeLabel.textContent = sizeRange.value;
  });

  sizeRange.addEventListener('change', ()=>{
    generateArray(parseInt(sizeRange.value,10));
  });

  speedRange.addEventListener('input', ()=>{
    speedLabel.textContent = speedRange.value + ' ms';
    if(running){
      // restart interval with new speed
      clearTimer();
      const interval = Math.max(10, parseInt(speedRange.value));
      timer = setInterval(()=>{
        const res = generator.next();
        if(res.done){ processAction(res.value); clearTimer(); running=false; playBtn.disabled=false; }
        else processAction(res.value);
      }, interval);
    }
  });

  orderToggle.addEventListener('change', ()=>{
    // order changed: need to reset to new generator
    resetState();
    // keep current array as is, but new runs will use chosen order
  });

  // Custom input modal (simple prompt)
  document.getElementById('randomInputBtn').addEventListener('click', ()=>{
    pausePlay();
    const val = prompt('Enter comma-separated integers (e.g. 12,5,8,23). Leave empty to cancel.');
    if(!val) return;
    const parts = val.split(',').map(s=>s.trim()).filter(s=>s.length>0);
    const nums = [];
    for(const p of parts){
      const num = Number(p);
      if(Number.isFinite(num)) nums.push(Math.max(1, Math.round(num)));
    }
    if(nums.length === 0){ alert('No valid numbers parsed.'); return; }
    arr = nums.slice();
    maxVal = Math.max(...arr);
    sizeRange.value = arr.length;
    sizeLabel.textContent = arr.length;
    resetState();
    renderBars();
  });

  // initialize default array
  generateArray(parseInt(sizeRange.value,10));

  // keyboard shortcuts
  window.addEventListener('keydown', (e)=>{
    if(e.key === ' '){ e.preventDefault(); if(running) pausePlay(); else startPlay(); }
    if(e.key === 'ArrowRight') stepOnce();
    if(e.key === 'r') generateArray(parseInt(sizeRange.value,10));
  });

})();
</script>
</body>
</html>