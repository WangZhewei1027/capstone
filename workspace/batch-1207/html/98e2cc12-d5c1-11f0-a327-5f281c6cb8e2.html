<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Two Pointers — Interactive Demos</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f1724;
      --panel:#0b1220;
      --muted:#98a0b3;
      --accent:#5eead4;
      --accent2:#60a5fa;
      --danger:#fb7185;
      --card:#071022;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071022 0%, #071330 50%, #031024 100%);color:#e6eef8;}
    .wrap{max-width:980px;margin:28px auto;padding:20px;}
    header{display:flex;align-items:center;gap:14px;margin-bottom:18px;}
    header h1{font-size:20px;margin:0;}
    header p{margin:0;color:var(--muted);font-size:13px;}
    .panel{background:var(--panel);padding:16px;border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03);}
    .controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:12px;}
    label{font-size:13px;color:var(--muted);}
    select,input[type="text"],input[type="number"]{background:var(--card);border:1px solid rgba(255,255,255,0.04);color:#dbeafe;padding:8px;border-radius:8px;}
    button{background:linear-gradient(180deg,var(--accent2),#2b7adf);border:none;color:#022f4e;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600;}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);}
    .row{display:flex;gap:12px;align-items:center;}
    .array-area{display:flex;align-items:center;gap:8px;flex-wrap:wrap;padding:14px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border:1px solid rgba(255,255,255,0.03);min-height:110px;}
    .cell{width:52px;height:52px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02);border:1px dashed rgba(255,255,255,0.03);position:relative;font-weight:700;font-size:15px;color:#dbeafe;}
    .cell.small{width:44px;height:44px;font-size:14px;}
    .index{position:absolute;top:-10px;right:-8px;background:var(--glass);padding:4px;border-radius:6px;font-size:11px;color:var(--muted);}
    .pointer{position:absolute;height:8px;width:0;border-top:10px solid transparent;border-bottom:10px solid transparent;top:-26px;}
    .pointer.l{border-right:14px solid var(--accent);left:10px;}
    .pointer.r{border-left:14px solid var(--accent2);right:10px;}
    .status{margin-top:10px;padding:12px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);border:1px solid rgba(255,255,255,0.02);color:var(--muted);font-size:13px;}
    .legend{display:flex;gap:8px;align-items:center;margin-top:10px;color:var(--muted);font-size:13px;}
    .dot{width:12px;height:12px;border-radius:4px;}
    .dot.l{background:var(--accent);border:1px solid rgba(255,255,255,0.04);}
    .dot.r{background:var(--accent2);border:1px solid rgba(255,255,255,0.04);}
    .dot.found{background:var(--danger);border:1px solid rgba(255,255,255,0.04);}
    .explain{margin-top:12px;color:var(--muted);font-size:13px;line-height:1.5;}
    .small{font-size:12px;color:var(--muted);}
    .controls-right{margin-left:auto;display:flex;gap:8px;}
    .speed{display:flex;gap:8px;align-items:center;}
    .hint{color:var(--muted);font-size:13px;margin-top:8px;}
    footer{margin-top:14px;color:var(--muted);font-size:12px;}
    /* found highlight */
    .cell.found{background:linear-gradient(180deg,rgba(251,113,133,0.12),rgba(251,113,133,0.06));border:1px solid rgba(251,113,133,0.18);box-shadow:0 6px 18px rgba(251,113,133,0.06);}
    .cell.active{box-shadow:0 10px 30px rgba(96,165,250,0.08);border:1px solid rgba(96,165,250,0.12);background:linear-gradient(180deg,rgba(96,165,250,0.06),rgba(96,165,250,0.02));}
    .cell.write{box-shadow:0 10px 30px rgba(94,234,212,0.06);border:1px solid rgba(94,234,212,0.12);background:linear-gradient(180deg,rgba(94,234,212,0.06),rgba(94,234,212,0.02));}
    .muted-box{background:rgba(255,255,255,0.01);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);color:var(--muted);}
    .small-note{font-size:12px;color:var(--muted);}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Two Pointers — Interactive Visualizer</h1>
        <p>Step through classic "two pointers" patterns: two-sum on sorted array, reverse string, and remove duplicates.</p>
      </div>
    </header>

    <div class="panel">
      <div class="controls">
        <div style="min-width:220px;">
          <label>Demo</label><br/>
          <select id="demoSelect">
            <option value="twoSum">Find Pair with Target Sum (sorted array)</option>
            <option value="reverse">Reverse String (in-place)</option>
            <option value="removeDup">Remove Duplicates (in-place)</option>
          </select>
        </div>

        <div style="flex:1;">
          <label>Array (comma separated)</label><br/>
          <input id="inputArray" type="text" value="1,2,3,4,5,6,7,8" />
        </div>

        <div id="targetDiv" style="min-width:140px;">
          <label>Target (for two-sum)</label><br/>
          <input id="targetInput" type="number" value="9" />
        </div>

        <div style="display:flex;gap:8px;align-items:center;">
          <button id="randomBtn" class="ghost">Random</button>
          <button id="loadBtn">Load</button>
        </div>

        <div class="controls-right">
          <div class="speed small">
            <label class="small">Speed</label>
            <input id="speed" type="range" min="200" max="2000" step="100" value="800" />
          </div>
          <button id="stepBtn" class="ghost">Step</button>
          <button id="playBtn">Play</button>
          <button id="resetBtn" class="ghost">Reset</button>
        </div>
      </div>

      <div class="array-area" id="arrayArea" aria-live="polite"></div>

      <div class="status" id="status">Load an array and press Play or Step to begin.</div>

      <div class="legend">
        <div style="display:flex;gap:6px;align-items:center;"><div class="dot l"></div><div>left pointer</div></div>
        <div style="display:flex;gap:6px;align-items:center;"><div class="dot r"></div><div>right pointer</div></div>
        <div style="display:flex;gap:6px;align-items:center;"><div class="dot found"></div><div>found / result</div></div>
      </div>

      <div class="explain" id="explainArea">
        <strong>What is "Two Pointers"?</strong>
        <div class="small-note">A technique that uses two indices that move through a data structure (often from both ends) to solve problems in linear time and constant extra space. Choose a demo above and step through to see how pointers move.</div>
      </div>
    </div>

    <footer>
      Tip: For the two-sum demo, the array must be sorted. For remove-duplicates and reverse, operations are done in-place.
    </footer>
  </div>

<script>
(function(){
  // DOM
  const demoSelect = document.getElementById('demoSelect');
  const inputArray = document.getElementById('inputArray');
  const targetInput = document.getElementById('targetInput');
  const targetDiv = document.getElementById('targetDiv');
  const loadBtn = document.getElementById('loadBtn');
  const randomBtn = document.getElementById('randomBtn');
  const arrayArea = document.getElementById('arrayArea');
  const status = document.getElementById('status');
  const explainArea = document.getElementById('explainArea');
  const stepBtn = document.getElementById('stepBtn');
  const playBtn = document.getElementById('playBtn');
  const resetBtn = document.getElementById('resetBtn');
  const speedInput = document.getElementById('speed');

  let model = null;
  let autoplay = false;
  let timer = null;

  function parseArray(text){
    if(!text.trim()) return [];
    return text.split(',').map(s=>s.trim()).filter(s=>s!=="").map(s=>{
      // try parse number, otherwise keep string char
      if(!isNaN(Number(s))) return Number(s);
      return s;
    });
  }

  function randomArray(n=8, sorted=true, range=20){
    const a = [];
    for(let i=0;i<n;i++){
      a.push(Math.floor(Math.random()*range)+1);
    }
    if(sorted) a.sort((x,y)=>x-y);
    return a;
  }

  function createCell(value, idx){
    const el = document.createElement('div');
    el.className = 'cell';
    el.innerHTML = `<div class="val">${value}</div><div class="index">${idx}</div>`;
    return el;
  }

  function renderArray(arr, highlights={}){
    arrayArea.innerHTML = '';
    for(let i=0;i<arr.length;i++){
      const cell = createCell(arr[i], i);
      cell.dataset.idx = i;
      if(arr._meta && arr._meta[i]) {
        const meta = arr._meta[i];
        if(meta.found) cell.classList.add('found');
        if(meta.active) cell.classList.add('active');
        if(meta.write) cell.classList.add('write');
      }
      // attach pointer arrows if active
      if(highlights.left === i){
        const p = document.createElement('div');
        p.className = 'pointer l';
        cell.appendChild(p);
      }
      if(highlights.right === i){
        const p = document.createElement('div');
        p.className = 'pointer r';
        cell.appendChild(p);
      }
      arrayArea.appendChild(cell);
    }
  }

  // Algorithms: define step functions that return {done, status, highlights, arr}
  // Each implementation uses a "state" object that we mutate to progress stepwise.

  function makeTwoSumState(arr, target){
    // arr must be sorted
    const state = {
      name:'twoSum',
      arr: arr.slice(),
      target,
      left:0,
      right: arr.length-1,
      found:null,
      done:false,
      steps:0
    };
    return state;
  }

  function stepTwoSum(state){
    if(state.done) return {done:true,status:'Completed'};
    state.steps++;
    const l = state.left, r = state.right;
    if(l>r){
      state.done = true;
      return {
        done:true,
        status:`No pair found adding to ${state.target}.`,
        highlights:{}
      };
    }
    const lv = state.arr[l], rv = state.arr[r];
    const sum = (typeof lv==='number' && typeof rv==='number') ? lv+rv : String(lv)+String(rv);
    let statusText = `Compare arr[${l}] = ${lv} and arr[${r}] = ${rv} -> sum = ${sum}`;
    const highlights = {left:l,right:r};
    // mark active
    state.arr._meta = state.arr._meta || [];
    state.arr._meta[l] = {active:true};
    state.arr._meta[r] = {active:true};

    if(sum === state.target){
      state.found = [l,r];
      state.done = true;
      state.arr._meta[l].found = true;
      state.arr._meta[r].found = true;
      statusText += ` — Found! indices ${l} and ${r}.`;
      return {done:true,status:statusText,highlights};
    } else if (sum < state.target){
      state.left++;
      statusText += ` — sum < target, move left++ -> ${state.left}`;
      return {done:false,status:statusText,highlights};
    } else {
      state.right--;
      statusText += ` — sum > target, move right-- -> ${state.right}`;
      return {done:false,status:statusText,highlights};
    }
  }

  function makeReverseState(arr){
    const s = {
      name:'reverse',
      arr: arr.slice(),
      left:0,
      right: arr.length-1,
      done:false,
      steps:0
    };
    return s;
  }

  function stepReverse(state){
    if(state.done) return {done:true,status:'Completed'};
    state.steps++;
    const l = state.left, r = state.right;
    if(l>=r){
      state.done = true;
      return {done:true,status:'All pairs swapped — reversal complete',highlights:{}};
    }
    // show active
    state.arr._meta = state.arr._meta || [];
    state.arr._meta[l] = {active:true};
    state.arr._meta[r] = {active:true};
    const statusText = `Swap arr[${l}] = ${state.arr[l]} with arr[${r}] = ${state.arr[r]}`;
    // perform swap
    [state.arr[l], state.arr[r]] = [state.arr[r], state.arr[l]];
    state.arr._meta[l].write = true;
    state.arr._meta[r].write = true;
    state.left++; state.right--;
    return {done:false,status:statusText,highlights:{left:l,right:r}};
  }

  function makeRemoveDupState(arr){
    // arr must be sorted
    const state = {
      name:'removeDup',
      arr: arr.slice(),
      write: 0,  // index to write next unique
      read: 0,
      done:false,
      steps:0
    };
    return state;
  }

  function stepRemoveDup(state){
    if(state.done) return {done:true,status:'Completed'};
    state.steps++;
    const n = state.arr.length;
    if(state.read >= n){
      state.done = true;
      // final length = write
      return {done:true,status:`Finished. Unique length = ${state.write}. Remaining tail ignored.`,highlights:{}};
    }
    // read pointer compares to last unique written (at write-1)
    state.arr._meta = state.arr._meta || [];
    const r = state.read;
    const w = state.write;
    const current = state.arr[r];
    let statusText = '';
    if(w === 0){
      // first element always kept
      state.arr[w] = current;
      state.arr._meta[w] = {write:true,found:true};
      state.write++;
      state.read++;
      statusText = `Keep arr[${r}] = ${current} at position ${w}.`;
      return {done:false,status:statusText,highlights:{left:w,right:r}};
    } else {
      const lastUnique = state.arr[w-1];
      if(current === lastUnique){
        statusText = `arr[${r}] = ${current} equals last unique ${lastUnique} -> skip (read++).`;
        state.read++;
        state.arr._meta[r] = {active:true};
        return {done:false,status:statusText,highlights:{right:r,left:w-1}};
      } else {
        // write current into arr[write]
        state.arr[w] = current;
        state.arr._meta[w] = {write:true,found:true};
        statusText = `New unique arr[${r}] = ${current} -> move to arr[${w}] (write++).`;
        state.write++; state.read++;
        return {done:false,status:statusText,highlights:{left:w-1,right:r}};
      }
    }
  }

  // driver
  function loadDemo(){
    clearAuto();
    const demo = demoSelect.value;
    const arr = parseArray(inputArray.value);
    if(demo==='twoSum'){
      targetDiv.style.display = 'block';
      const t = Number(targetInput.value);
      model = makeTwoSumState(arr, t);
      status.textContent = 'Ready. Two pointers at both ends. Left=0, Right=' + (arr.length-1);
      explainDemo(demo);
      renderArray(model.arr, {left:model.left, right:model.right});
    } else if(demo==='reverse'){
      targetDiv.style.display = 'none';
      model = makeReverseState(arr);
      status.textContent = 'Ready. Two pointers at both ends to swap toward center.';
      explainDemo(demo);
      renderArray(model.arr, {left:model.left, right:model.right});
    } else if(demo==='removeDup'){
      targetDiv.style.display = 'none';
      model = makeRemoveDupState(arr);
      status.textContent = 'Ready. Read and write pointers start at index 0.';
      explainDemo(demo);
      renderArray(model.arr, {left:model.write, right:model.read});
    }
  }

  function explainDemo(name){
    if(name==='twoSum'){
      explainArea.innerHTML = `<strong>Two-sum (sorted array)</strong>
      <div class="small-note">Start with left at 0 and right at n-1. Compare sum and move the pointer that will get you closer to target. Time: O(n), Space: O(1).</div>`;
    } else if(name==='reverse'){
      explainArea.innerHTML = `<strong>Reverse string (in-place)</strong>
      <div class="small-note">Swap elements at left and right and move inward. Time: O(n/2) => O(n), Space: O(1).</div>`;
    } else {
      explainArea.innerHTML = `<strong>Remove duplicates from sorted array (in-place)</strong>
      <div class="small-note">Use a write pointer for the next unique position and a read pointer to scan. Time: O(n), Space: O(1).</div>`;
    }
  }

  function stepOnce(){
    if(!model){ status.textContent = 'Load a demo first.'; return; }
    // clear previous meta
    model.arr._meta = [];
    let res;
    if(model.name==='twoSum'){
      res = stepTwoSum(model);
      renderArray(model.arr, model.found ? { left:model.found[0], right:model.found[1]} : {left:model.left,right:model.right});
    } else if(model.name==='reverse'){
      res = stepReverse(model);
      renderArray(model.arr, {left:model.left,right:model.right});
    } else if(model.name==='removeDup'){
      res = stepRemoveDup(model);
      // for removeDup, show write and read
      renderArray(model.arr, {left:model.write, right:model.read});
    }
    status.textContent = res.status;
    if(res.done){
      clearAuto();
      if(model.name==='removeDup' && model.done){
        status.textContent += ` Final array (first ${model.write} elements unique): [${model.arr.slice(0,model.write).join(', ')}]`;
      }
      playBtn.textContent = 'Play';
      autoplay = false;
    }
  }

  function autoPlayToggle(){
    if(!model){ status.textContent = 'Load a demo first.'; return; }
    autoplay = !autoplay;
    if(autoplay){
      playBtn.textContent = 'Pause';
      runAuto();
    } else {
      playBtn.textContent = 'Play';
      clearAuto();
    }
  }

  function runAuto(){
    clearAuto();
    timer = setInterval(()=>{
      // stop if done
      if(!model || model.done){
        clearAuto();
        return;
      }
      stepOnce();
    }, Math.max(80, Number(speedInput.value)));
  }
  function clearAuto(){ autoplay=false; playBtn.textContent='Play'; if(timer){ clearInterval(timer); timer=null; } }

  // events
  loadBtn.addEventListener('click', loadDemo);
  demoSelect.addEventListener('change', ()=>{
    // show/hide target
    if(demoSelect.value === 'twoSum') targetDiv.style.display = 'block'; else targetDiv.style.display = 'none';
    // optionally adjust array input example
    if(demoSelect.value === 'twoSum') inputArray.value = '1,2,3,4,5,6,7,8';
    else if(demoSelect.value==='reverse') inputArray.value = 'a,b,c,d,e';
    else inputArray.value = '1,1,2,2,3,3,3,4';
  });

  randomBtn.addEventListener('click', ()=>{
    const demo = demoSelect.value;
    if(demo==='twoSum' || demo==='removeDup'){
      const arr = randomArray(8, true, 15);
      inputArray.value = arr.join(',');
      if(demo==='twoSum'){
        // choose target likely sum of two
        const a = Math.floor(Math.random()*arr.length);
        const b = Math.min(arr.length-1, a + Math.floor(Math.random()*3)+1);
        targetInput.value = arr[a] + arr[b];
      }
    } else {
      // reverse: random chars
      const letters = 'abcdefghijklmnpqrstuvwxyz';
      const n = 7;
      const a = [];
      for(let i=0;i<n;i++) a.push(letters[Math.floor(Math.random()*letters.length)]);
      inputArray.value = a.join(',');
    }
  });

  stepBtn.addEventListener('click', ()=>{
    clearAuto();
    autoplay = false;
    playBtn.textContent='Play';
    stepOnce();
  });

  playBtn.addEventListener('click', autoPlayToggle);
  resetBtn.addEventListener('click', ()=>{
    clearAuto();
    model = null;
    status.textContent = 'Reset. Load a demo and press Play or Step to begin.';
    arrayArea.innerHTML = '';
  });

  // keyboard: space for step
  window.addEventListener('keydown', (e)=>{
    if(e.code === 'Space'){
      e.preventDefault();
      stepOnce();
    }
  });

  // initial load
  loadDemo();
})();
</script>
</body>
</html>