<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f4f4f4;
        }
        #arrayContainer {
            display: flex;
            margin-bottom: 20px;
        }
        .bar {
            width: 20px;
            margin: 0 1px;
            background-color: #3498db;
        }
    </style>
</head>
<body>

<h1>Quick Sort Visualization</h1>
<button id="startButton">Start Quick Sort</button>
<div id="arrayContainer"></div>

<script>
    const arrayContainer = document.getElementById('arrayContainer');
    const startButton = document.getElementById('startButton');
    const arraySize = 20; // Size of the array
    let array = [];

    function generateArray() {
        array = Array.from({length: arraySize}, () => Math.floor(Math.random() * 100) + 1);
        displayArray();
    }

    function displayArray() {
        arrayContainer.innerHTML = '';
        array.forEach(value => {
            const bar = document.createElement('div');
            bar.className = 'bar';
            bar.style.height = `${value * 3}px`; // Scale the bar height
            arrayContainer.appendChild(bar);
        });
    }

    async function quickSort(arr, left = 0, right = arr.length - 1) {
        if (left < right) {
            const index = await partition(arr, left, right);
            await Promise.all([quickSort(arr, left, index - 1), quickSort(arr, index + 1, right)]);
            displayArray(); // Update the display after sorting
        }
    }

    async function partition(arr, left, right) {
        const pivot = arr[right];
        let i = left - 1;
        
        for (let j = left; j < right; j++) {
            if (arr[j] < pivot) {
                i++;
                await swap(arr, i, j);
            }
        }
        await swap(arr, i + 1, right);
        return i + 1;
    }

    async function swap(arr, i, j) {
        const tmp = arr[i];
        arr[i] = arr[j];
        arr[j] = tmp;
        displayArray();
        await new Promise(resolve => setTimeout(resolve, 300)); // Delay to visualize the swap
    }

    startButton.addEventListener('click', () => {
        generateArray();
        quickSort(array);
    });

    window.onload = generateArray; // Generate random array on page load
</script>

</body>
</html>