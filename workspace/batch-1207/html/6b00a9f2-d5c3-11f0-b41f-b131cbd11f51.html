<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Counting Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .input-section {
            margin-bottom: 20px;
        }
        input[type="text"] {
            width: 300px;
            padding: 8px;
            margin-right: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .step-container {
            margin-top: 20px;
        }
        .step {
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
        }
        .array-display {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }
        .array-element {
            padding: 8px 12px;
            background-color: #e0e0e0;
            border-radius: 4px;
            text-align: center;
            min-width: 30px;
        }
        .array-element.highlight {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        .count-array {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
        }
        .count-element {
            padding: 5px 10px;
            background-color: #2196F3;
            color: white;
            border-radius: 4px;
            text-align: center;
            min-width: 25px;
        }
        .result {
            padding: 15px;
            background-color: #e8f5e8;
            border-radius: 4px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Counting Sort Visualization</h1>
        
        <div class="input-section">
            <p>Enter numbers separated by commas (e.g., 4,2,2,8,3,3,1):</p>
            <input type="text" id="inputArray" value="4,2,2,8,3,3,1" placeholder="Enter numbers separated by commas">
            <button onclick="runCountingSort()">Sort</button>
        </div>
        
        <div id="stepsContainer" class="step-container"></div>
        
        <div id="result" class="result" style="display: none;"></div>
    </div>

    <script>
        function runCountingSort() {
            const input = document.getElementById('inputArray').value;
            const stepsContainer = document.getElementById('stepsContainer');
            const resultDiv = document.getElementById('result');
            
            // Clear previous results
            stepsContainer.innerHTML = '';
            resultDiv.style.display = 'none';
            
            try {
                // Parse input
                const array = input.split(',').map(num => parseInt(num.trim()));
                
                // Validate input
                if (array.some(isNaN)) {
                    throw new Error('Please enter valid numbers only');
                }
                if (array.some(num => num < 0)) {
                    throw new Error('Counting sort requires non-negative integers');
                }
                
                // Perform counting sort with visualization
                countingSortWithSteps(array);
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }
        
        function countingSortWithSteps(array) {
            const stepsContainer = document.getElementById('stepsContainer');
            
            // Step 1: Find the maximum value
            addStep(stepsContainer, "Step 1: Find the maximum value in the array");
            const max = Math.max(...array);
            addArrayDisplay(stepsContainer, array, `Maximum value: ${max}`);
            
            // Step 2: Initialize count array
            addStep(stepsContainer, `Step 2: Initialize count array with size ${max + 1} (0 to ${max})`);
            const countArray = new Array(max + 1).fill(0);
            displayCountArray(stepsContainer, countArray, "Initial count array (all zeros)");
            
            // Step 3: Count occurrences
            addStep(stepsContainer, "Step 3: Count occurrences of each element");
            for (let i = 0; i < array.length; i++) {
                const value = array[i];
                countArray[value]++;
                displayCountArray(stepsContainer, countArray, 
                    `Count array after processing element ${value} (index ${i})`);
            }
            
            // Step 4: Calculate cumulative counts
            addStep(stepsContainer, "Step 4: Calculate cumulative counts");
            for (let i = 1; i <= max; i++) {
                countArray[i] += countArray[i - 1];
                displayCountArray(stepsContainer, countArray, 
                    `Cumulative count after index ${i}: count[${i}] = count[${i}] + count[${i-1}]`);
            }
            
            // Step 5: Build output array
            addStep(stepsContainer, "Step 5: Build output array using cumulative counts");
            const output = new Array(array.length);
            const tempCount = [...countArray];
            
            for (let i = array.length - 1; i >= 0; i--) {
                const value = array[i];
                const position = tempCount[value] - 1;
                output[position] = value;
                tempCount[value]--;
                
                addArrayDisplay(stepsContainer, output, 
                    `Placed ${value} at position ${position} (coming from index ${i} of input array)`);
            }
            
            // Display final result
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<h3>Final Sorted Array:</h3>`;
            addArrayDisplay(resultDiv, output);
            resultDiv.style.display = 'block';
        }
        
        function addStep(container, title) {
            const stepDiv = document.createElement('div');
            stepDiv.className = 'step';
            stepDiv.innerHTML = `<h3>${title}</h3>`;
            container.appendChild(stepDiv);
            return stepDiv;
        }
        
        function addArrayDisplay(container, array, description = '') {
            const arrayDiv = document.createElement('div');
            arrayDiv.className = 'array-display';
            
            array.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'array-element';
                element.textContent = value;
                element.title = `Index ${index}: ${value}`;
                arrayDiv.appendChild(element);
            });
            
            container.appendChild(arrayDiv);
            if (description) {
                const desc = document.createElement('p');
                desc.textContent = description;
                container.appendChild(desc);
            }
        }
        
        function displayCountArray(container, countArray, description = '') {
            const countDiv = document.createElement('div');
            countDiv.className = 'count-array';
            
            countArray.forEach((count, index) => {
                const element = document.createElement('div');
                element.className = 'count-element';
                element.textContent = count;
                element.title = `Count for value ${index}: ${count}`;
                countDiv.appendChild(element);
            });
            
            container.appendChild(countDiv);
            if (description) {
                const desc = document.createElement('p');
                desc.textContent = description;
                container.appendChild(desc);
            }
        }
        
        // Initialize with example
        window.onload = function() {
            runCountingSort();
        };
    </script>
</body>
</html>