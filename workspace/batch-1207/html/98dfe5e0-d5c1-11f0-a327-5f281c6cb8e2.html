<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Arrays — Interactive Guide & Playground</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; color:#222}
    body{margin:0;padding:18px;background:#f6f8fa}
    header{display:flex;align-items:center;gap:12px}
    h1{font-size:20px;margin:0}
    .layout{display:grid;grid-template-columns:380px 1fr;gap:18px;margin-top:14px}
    .panel{background:#fff;border-radius:10px;padding:14px;box-shadow:0 2px 6px rgba(20,20,30,0.06)}
    .small{font-size:13px;color:#4b5563}
    label{display:block;margin-top:10px;font-size:13px;color:#374151}
    input[type="text"], input[type="number"], select, textarea{
      width:100%;padding:8px;border:1px solid #e5e7eb;border-radius:6px;margin-top:6px;font-size:13px;background:#fff;box-sizing:border-box;
    }
    button{padding:8px 10px;border-radius:8px;border:1px solid #e6e9ee;background:#fff;cursor:pointer;font-weight:600}
    button.primary{background:#111827;color:#fff;border:none}
    .controls{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .array-visual{display:flex;flex-wrap:wrap;gap:8px;padding:12px;border-radius:8px;background:linear-gradient(180deg,#ffffff,#fbfdff);border:1px dashed #e6eef7;min-height:72px;align-items:center}
    .cell{min-width:54px;padding:8px;border-radius:8px;background:#111827;color:#fff;text-align:center;font-weight:700;box-shadow:0 2px 6px rgba(17,24,39,0.08)}
    .index{font-size:11px;opacity:0.8;font-weight:600}
    .log{background:#0b1220;color:#e6f3ff;padding:10px;border-radius:8px;font-family:monospace;font-size:13px;white-space:pre-wrap;max-height:220px;overflow:auto}
    .section{margin-bottom:12px;border-top:1px solid #eef2f7;padding-top:12px}
    .example-btn{padding:8px;border-radius:8px;border:1px dashed #e6eef7;background:#fff;cursor:pointer}
    .row{display:flex;gap:8px;align-items:center}
    .muted{color:#6b7280;font-size:13px}
    textarea {height:100px;resize:vertical;font-family:monospace}
    footer{margin-top:12px;font-size:13px;color:#6b7280}
    .grid-small{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .notice{background:#fff6d6;color:#6b4a00;padding:8px;border-radius:8px;border:1px solid #fde8a0;font-size:13px}
    .badge{display:inline-block;background:#eef2ff;color:#0b5cff;padding:4px 8px;border-radius:999px;font-size:12px;font-weight:700}
  </style>
</head>
<body>
  <header>
    <div class="badge">Arrays</div>
    <h1>JavaScript Arrays — Interactive Guide & Playground</h1>
  </header>

  <div class="layout">
    <!-- Left panel: Controls & examples -->
    <div class="panel">
      <div class="small">Current array visualizer and mutation controls. Try pushing, splicing, mapping, filtering and more to see how arrays behave.</div>

      <div class="section">
        <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
          <strong>Array</strong>
          <div class="muted">length: <span id="arr-length">0</span></div>
        </div>
        <div id="visual" class="array-visual" aria-live="polite"></div>

        <div style="margin-top:10px" class="controls">
          <input id="value-input" type="text" placeholder='Value (e.g. 42 or "hello")' />
          <button id="push-btn" title="push">Push</button>
          <button id="unshift-btn" title="unshift">Unshift</button>
          <button id="pop-btn" title="pop">Pop</button>
          <button id="shift-btn" title="shift">Shift</button>
          <button id="shuffle-btn" title="shuffle">Shuffle</button>
          <button id="sort-btn" title="sort">Sort</button>
        </div>

        <label>Insert or remove at index</label>
        <div class="row" style="gap:6px">
          <input id="index-input" type="number" placeholder="index" />
          <input id="at-value-input" type="text" placeholder='value to insert' />
          <button id="insert-btn">Insert</button>
          <button id="remove-index-btn">Remove at index</button>
        </div>

        <div style="margin-top:12px">
          <label>Splice (index, deleteCount, items...)</label>
          <div class="row">
            <input id="splice-index" type="number" placeholder="index" />
            <input id="splice-delete" type="number" placeholder="deleteCount" />
            <input id="splice-items" type="text" placeholder='items comma-separated' />
            <button id="splice-btn">Run splice</button>
          </div>
        </div>

        <div style="margin-top:12px">
          <label>Slice (start, end) — non-mutating</label>
          <div class="row">
            <input id="slice-start" type="number" placeholder="start" />
            <input id="slice-end" type="number" placeholder="end" />
            <button id="slice-btn">Slice</button>
          </div>
        </div>

      </div>

      <div class="section">
        <strong>Common operations (examples)</strong>
        <div style="margin-top:8px" class="grid-small">
          <button class="example-btn" id="map-btn">map (double)</button>
          <button class="example-btn" id="filter-btn">filter (even)</button>
          <button class="example-btn" id="reduce-btn">reduce (sum)</button>
          <button class="example-btn" id="find-btn">find (first > n)</button>
          <button class="example-btn" id="includes-btn">includes</button>
          <button class="example-btn" id="flat-btn">flat()</button>
        </div>

        <div style="margin-top:10px" class="row">
          <input id="find-threshold" type="number" placeholder="threshold (for find)" />
          <input id="includes-value" type="text" placeholder='value to check (includes)' />
          <button id="reset-btn" style="margin-left:auto">Reset to default</button>
        </div>
      </div>

      <div class="section">
        <strong>Cloning & reference behavior</strong>
        <div class="small" style="margin-top:8px">Demonstrates shallow copy vs reference for arrays that contain objects.</div>
        <div style="margin-top:10px" class="row">
          <button id="show-clone-btn">Show clone demo</button>
          <button id="mutate-clone-btn">Mutate clone (change nested prop)</button>
        </div>
      </div>

      <div class="section">
        <strong>Misc & advanced</strong>
        <div class="row" style="margin-top:8px;gap:6px">
          <button id="multi-btn">Show 2D array (matrix)</button>
          <button id="typed-btn">TypedArray demo</button>
          <button id="sparse-btn">Sparse array demo</button>
        </div>
      </div>

      <footer>
        Quick tips: Arrays are ordered, zero-indexed, can hold mixed types, and are objects (methods live on Array.prototype).
      </footer>
    </div>

    <!-- Right panel: Output, logs, code preview -->
    <div class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong>Output & Log</strong>
        <div class="muted">Interactive console (no network calls)</div>
      </div>

      <div style="margin-top:8px" class="log" id="log-area" aria-live="polite"></div>

      <div class="section">
        <strong>Preview: Code run for last action</strong>
        <textarea id="code-preview" readonly></textarea>
        <div style="margin-top:8px" class="muted">You can inspect the JS that was executed for the last operation.</div>
      </div>

      <div class="section">
        <strong>Custom snippet (optional)</strong>
        <div class="small" style="margin-top:8px">Write a small snippet that receives `arr` (the current array) and must return a value. The snippet runs in a safe wrapper.</div>
        <textarea id="custom-snippet">/* Example: return arr.map(x => (typeof x === "number" ? x*2 : x)); */</textarea>
        <div style="margin-top:8px" class="row">
          <button id="run-snippet-btn" class="primary">Run snippet</button>
          <button id="clear-log-btn">Clear log</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Initial array used by the playground
    let arr = [1, 2, 3, 4, 5];
    const initialArr = JSON.parse(JSON.stringify(arr)); // clone simple
    // For clone demo
    let objArr = [{id:1, tag:"a"}, {id:2, tag:"b"}];
    let clonedArr = null;

    // UI elements
    const visual = document.getElementById('visual');
    const lengthEl = document.getElementById('arr-length');
    const logArea = document.getElementById('log-area');
    const codePreview = document.getElementById('code-preview');

    function log(...args) {
      const text = args.map(a => {
        try { return typeof a === 'string' ? a : JSON.stringify(a, null, 2); }
        catch(e){ return String(a); }
      }).join(' ');
      const time = new Date().toLocaleTimeString();
      logArea.textContent = `[${time}] ${text}\n\n` + logArea.textContent;
    }

    function renderArray(a = arr) {
      visual.innerHTML = '';
      lengthEl.textContent = a.length;
      if (a.length === 0) {
        const empty = document.createElement('div');
        empty.className = 'muted';
        empty.textContent = '[] (empty array)';
        visual.appendChild(empty);
        return;
      }
      a.forEach((v,i) => {
        const el = document.createElement('div');
        el.className = 'cell';
        const ix = document.createElement('div');
        ix.className = 'index';
        ix.textContent = i;
        const val = document.createElement('div');
        val.textContent = typeof v === 'object' && v !== null ? JSON.stringify(v) : String(v);
        el.appendChild(ix);
        el.appendChild(val);
        visual.appendChild(el);
      });
    }

    // Helper: parse a user's "value" input into number, boolean or string
    function parseInputValue(s) {
      if (s === undefined || s === null) return s;
      s = String(s).trim();
      if (s === '') return '';
      if (s === 'null') return null;
      if (s === 'undefined') return undefined;
      if (s === 'true') return true;
      if (s === 'false') return false;
      // numeric?
      if (!isNaN(Number(s))) return Number(s);
      // try JSON parse for objects/arrays
      try {
        const j = JSON.parse(s);
        return j;
      } catch(e){}
      // otherwise string
      return s;
    }

    // Action wrapper to run code and display preview
    function action(codeStr, fn) {
      try {
        const before = JSON.parse(JSON.stringify(arr, (k,v) => (typeof v === 'function' ? String(v) : v)));
        fn();
        const after = JSON.parse(JSON.stringify(arr, (k,v) => (typeof v === 'function' ? String(v) : v)));
        codePreview.value = codeStr;
        log('Action executed:', codeStr);
        log('Before:', before);
        log('After:', after);
      } catch (err) {
        codePreview.value = codeStr;
        log('Error executing action:', String(err));
      } finally {
        renderArray();
      }
    }

    // Basic controls
    document.getElementById('push-btn').addEventListener('click', () => {
      const v = parseInputValue(document.getElementById('value-input').value);
      action(`arr.push(${JSON.stringify(v)})`, () => arr.push(v));
    });
    document.getElementById('unshift-btn').addEventListener('click', () => {
      const v = parseInputValue(document.getElementById('value-input').value);
      action(`arr.unshift(${JSON.stringify(v)})`, () => arr.unshift(v));
    });
    document.getElementById('pop-btn').addEventListener('click', () => {
      action(`arr.pop()`, () => {
        const r = arr.pop();
        log('pop ->', r);
      });
    });
    document.getElementById('shift-btn').addEventListener('click', () => {
      action(`arr.shift()`, () => {
        const r = arr.shift();
        log('shift ->', r);
      });
    });

    document.getElementById('shuffle-btn').addEventListener('click', () => {
      action(`arr.sort(() => Math.random() - 0.5)`, () => {
        // Fisher-Yates for better shuffle
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
      });
    });

    document.getElementById('sort-btn').addEventListener('click', () => {
      // Prompt for numeric vs lexicographic? Simple toggle: if all numbers, numeric
      const allNumbers = arr.every(v => typeof v === 'number');
      if (allNumbers) {
        action(`arr.sort((a,b)=>a-b)`, () => arr.sort((a,b)=>a-b));
      } else {
        action(`arr.sort() // lexicographic`, () => arr.sort());
      }
    });

    document.getElementById('insert-btn').addEventListener('click', () => {
      const idx = Number(document.getElementById('index-input').value);
      const val = parseInputValue(document.getElementById('at-value-input').value);
      const code = `arr.splice(${idx}, 0, ${JSON.stringify(val)})`;
      action(code, () => arr.splice(idx, 0, val));
    });

    document.getElementById('remove-index-btn').addEventListener('click', () => {
      const idx = Number(document.getElementById('index-input').value);
      const code = `arr.splice(${idx}, 1)`;
      action(code, () => {
        const removed = arr.splice(idx, 1);
        log('removed ->', removed);
      });
    });

    document.getElementById('splice-btn').addEventListener('click', () => {
      const idx = Number(document.getElementById('splice-index').value);
      const del = Number(document.getElementById('splice-delete').value) || 0;
      const itemsRaw = document.getElementById('splice-items').value;
      const items = itemsRaw === '' ? [] : itemsRaw.split(',').map(s => parseInputValue(s));
      const code = `arr.splice(${idx}, ${del}, ${items.map(i=>JSON.stringify(i)).join(', ')})`;
      action(code, () => {
        const removed = arr.splice(idx, del, ...items);
        log('splice removed ->', removed);
      });
    });

    document.getElementById('slice-btn').addEventListener('click', () => {
      const s = document.getElementById('slice-start').value;
      const e = document.getElementById('slice-end').value;
      const start = s === '' ? undefined : Number(s);
      const end = e === '' ? undefined : Number(e);
      const code = `arr.slice(${typeof start === 'number' ? start : ''}${typeof end === 'number' ? ', ' + end : ''})`;
      try {
        const res = arr.slice(start, end);
        codePreview.value = code;
        log('slice ->', res);
      } catch (err) {
        log('slice error:', err);
      } finally {
        renderArray();
      }
    });

    // Examples
    document.getElementById('map-btn').addEventListener('click', () => {
      const code = `arr = arr.map(x => (typeof x === "number" ? x*2 : x));`;
      action(code, () => {
        arr = arr.map(x => (typeof x === "number" ? x*2 : x));
      });
    });

    document.getElementById('filter-btn').addEventListener('click', () => {
      const code = `arr = arr.filter(x => typeof x === "number" && x % 2 === 0);`;
      action(code, () => {
        arr = arr.filter(x => typeof x === "number" && x % 2 === 0);
      });
    });

    document.getElementById('reduce-btn').addEventListener('click', () => {
      const code = `arr.reduce((sum, x) => sum + (typeof x === "number" ? x : 0), 0)`;
      try {
        const sum = arr.reduce((sum, x) => sum + (typeof x === "number" ? x : 0), 0);
        codePreview.value = code;
        log('reduce sum ->', sum);
      } catch (err) {
        log('reduce error:', err);
      }
    });

    document.getElementById('find-btn').addEventListener('click', () => {
      const thr = parseInputValue(document.getElementById('find-threshold').value);
      const code = `arr.find(x => typeof x === "number" && x > ${JSON.stringify(thr)})`;
      try {
        const found = arr.find(x => typeof x === "number" && x > thr);
        codePreview.value = code;
        log('find ->', found);
      } catch (err) {
        log('find error:', err);
      }
    });

    document.getElementById('includes-btn').addEventListener('click', () => {
      const val = parseInputValue(document.getElementById('includes-value').value);
      const code = `arr.includes(${JSON.stringify(val)})`;
      try {
        const inc = arr.includes(val);
        codePreview.value = code;
        log('includes ->', inc);
      } catch (err) {
        log('includes error:', err);
      }
    });

    document.getElementById('flat-btn').addEventListener('click', () => {
      const code = `arr = arr.flat();`;
      action(code, () => {
        arr = arr.flat();
      });
    });

    // Clone demo
    document.getElementById('show-clone-btn').addEventListener('click', () => {
      objArr = [{id:1, tag:"a"}, {id:2, tag:"b"}];
      clonedArr = objArr.slice(); // shallow clone
      codePreview.value = `const objArr = [{id:1,tag:"a"},{id:2,tag:"b"}];\nconst clonedArr = objArr.slice(); // shallow copy`;
      log('objArr ->', objArr);
      log('clonedArr (shallow) ->', clonedArr);
    });

    document.getElementById('mutate-clone-btn').addEventListener('click', () => {
      if (!clonedArr) {
        log('Run "Show clone demo" first.');
        return;
      }
      codePreview.value = `clonedArr[0].tag = "modified"; // modifies nested object in both arrays (shallow copy)`;
      clonedArr[0].tag = 'modified';
      log('After modifying clonedArr[0].tag ->');
      log('objArr ->', objArr);
      log('clonedArr ->', clonedArr);
    });

    // Multi-dimensional
    document.getElementById('multi-btn').addEventListener('click', () => {
      const matrix = [
        [1,2,3],
        [4,5,6],
        [7,8,9]
      ];
      codePreview.value = `const matrix = [[1,2,3],[4,5,6],[7,8,9]];\nconst center = matrix[1][1];`;
      log('matrix ->', matrix);
      log('matrix[1][1] ->', matrix[1][1]);
      // visualize matrix by flattening in visual with nested rows
      visual.innerHTML = '';
      lengthEl.textContent = matrix.length + 'x' + matrix[0].length;
      matrix.forEach((row,i) => {
        const rowWrap = document.createElement('div');
        rowWrap.style.display = 'flex';
        rowWrap.style.gap = '8px';
        rowWrap.style.marginBottom = '6px';
        row.forEach((v,j) => {
          const el = document.createElement('div');
          el.className = 'cell';
          const ix = document.createElement('div');
          ix.className = 'index';
          ix.textContent = `${i},${j}`;
          el.appendChild(ix);
          el.appendChild(document.createTextNode(String(v)));
          rowWrap.appendChild(el);
        });
        visual.appendChild(rowWrap);
      });
    });

    // Typed array demo
    document.getElementById('typed-btn').addEventListener('click', () => {
      const code = `const t = new Int16Array([1000, 2000, 3000]);\n// typed arrays have fixed element type and length`;
      codePreview.value = code;
      const t = new Int16Array([1000,2000,3000]);
      log('Int16Array ->', Array.from(t));
      renderArray();
    });

    // Sparse array demo
    document.getElementById('sparse-btn').addEventListener('click', () => {
      const sparse = [];
      sparse[2] = 'x';
      sparse[5] = 'y';
      const code = `const sparse = []; sparse[2] = "x"; sparse[5] = "y"; // length becomes 6 but many indices are empty`;
      codePreview.value = code;
      log('sparse ->', sparse);
      log('sparse length ->', sparse.length);
      // show in visual
      visual.innerHTML = '';
      for (let i = 0; i < sparse.length; i++) {
        const el = document.createElement('div');
        el.className = 'cell';
        const ix = document.createElement('div');
        ix.className = 'index';
        ix.textContent = i;
        const val = document.createElement('div');
        val.textContent = (i in sparse) ? String(sparse[i]) : '(empty)';
        val.style.fontWeight = '600';
        val.style.opacity = (i in sparse) ? '1' : '0.6';
        el.appendChild(ix);
        el.appendChild(val);
        visual.appendChild(el);
      }
      lengthEl.textContent = sparse.length;
    });

    // Reset
    document.getElementById('reset-btn').addEventListener('click', () => {
      arr = JSON.parse(JSON.stringify(initialArr));
      action('arr = [1,2,3,4,5]; // reset', () => {});
    });

    // Snippet runner
    document.getElementById('run-snippet-btn').addEventListener('click', () => {
      const code = document.getElementById('custom-snippet').value;
      // Run snippet in a wrapper that provides `arr` and returns result. Do not allow access to window/document from snippet easily:
      const wrapper = `(function(arr){\n  "use strict";\n  ${code}\n})(JSON.parse(${JSON.stringify(JSON.stringify(arr))}))`;
      try {
        // Use Function to avoid access to outer scope variables; but it's still powerful in browser — this demo assumes local safe use.
        const fn = new Function('arr', '"use strict";\n' + code);
        const res = fn(JSON.parse(JSON.stringify(arr)));
        codePreview.value = code;
        log('snippet result ->', res);
      } catch (err) {
        log('snippet error ->', String(err));
      }
    });

    document.getElementById('clear-log-btn').addEventListener('click', () => {
      logArea.textContent = '';
    });

    // Initial render and helpful logs
    renderArray();
    log('Welcome — this is an interactive demonstration of JavaScript arrays.');
    log('Try pushing values, splicing, mapping, filtering and exploring behaviors like shallow cloning and sparse arrays.');
    codePreview.value = '// Code for the last action will appear here';

    // Accessibility: keyboard shortcuts for convenience
    window.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        document.getElementById('reset-btn').click();
      }
    });

    // Expose arr to console for advanced users (developer console)
    window.demoArr = arr;
    log('Note: For advanced inspection you can open devtools and see window.demoArr (a snapshot reference).');

  </script>
</body>
</html>