<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Regression Visualizer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .controls {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f5e8;
            border-radius: 5px;
            font-family: monospace;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        .data-points {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 10px 0;
        }
        .point-input {
            display: flex;
            gap: 5px;
        }
        input[type="number"] {
            width: 60px;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Linear Regression Visualizer</h1>
        
        <div class="controls">
            <h3>Data Points</h3>
            <div id="pointContainer" class="data-points">
                <div class="point-input">
                    <input type="number" class="x-input" placeholder="X" value="1">
                    <input type="number" class="y-input" placeholder="Y" value="2">
                    <button onclick="removePoint(this)">×</button>
                </div>
                <div class="point-input">
                    <input type="number" class="x-input" placeholder="X" value="2">
                    <input type="number" class="y-input" placeholder="Y" value="4">
                    <button onclick="removePoint(this)">×</button>
                </div>
                <div class="point-input">
                    <input type="number" class="x-input" placeholder="X" value="3">
                    <input type="number" class="y-input" placeholder="Y" value="6">
                    <button onclick="removePoint(this)">×</button>
                </div>
            </div>
            <button onclick="addPoint()">Add Point</button>
            <button onclick="calculateRegression()">Calculate Regression</button>
            <button onclick="generateRandomData()">Generate Random Data</button>
            <button onclick="clearAll()">Clear All</button>
        </div>

        <div class="chart-container">
            <canvas id="regressionChart"></canvas>
        </div>

        <div id="results" class="results" style="display: none;">
            <h3>Regression Results</h3>
            <div id="equation"></div>
            <div id="stats"></div>
        </div>

        <div class="explanation">
            <h3>What is Linear Regression?</h3>
            <p>Linear regression is a statistical method used to model the relationship between a dependent variable (Y) and one or more independent variables (X). It finds the line of best fit through the data points by minimizing the sum of squared errors.</p>
            <p><strong>Formula:</strong> Y = mX + b</p>
            <p>Where:
                <ul>
                    <li>m = slope of the line</li>
                    <li>b = y-intercept</li>
                </ul>
            </p>
        </div>
    </div>

    <script>
        let chart = null;
        let dataPoints = [];

        // Initialize chart
        function initChart() {
            const ctx = document.getElementById('regressionChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Data Points',
                        data: [],
                        backgroundColor: 'rgba(54, 162, 235, 0.8)',
                        pointRadius: 8
                    }, {
                        label: 'Regression Line',
                        data: [],
                        type: 'line',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        pointRadius: 0,
                        fill: false,
                        showLine: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'X values'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Y values'
                            }
                        }
                    }
                }
            });
            updateChartData();
        }

        // Update chart with current data points
        function updateChartData() {
            dataPoints = getDataPoints();
            chart.data.datasets[0].data = dataPoints;
            chart.update();
        }

        // Get data points from input fields
        function getDataPoints() {
            const points = [];
            const pointInputs = document.querySelectorAll('.point-input');
            
            pointInputs.forEach(input => {
                const xInput = input.querySelector('.x-input');
                const yInput = input.querySelector('.y-input');
                
                if (xInput.value && yInput.value) {
                    points.push({
                        x: parseFloat(xInput.value),
                        y: parseFloat(yInput.value)
                    });
                }
            });
            
            return points;
        }

        // Calculate linear regression
        function calculateRegression() {
            const points = getDataPoints();
            
            if (points.length < 2) {
                alert('Please add at least 2 data points');
                return;
            }

            // Calculate means
            const n = points.length;
            const xSum = points.reduce((sum, point) => sum + point.x, 0);
            const ySum = points.reduce((sum, point) => sum + point.y, 0);
            const xMean = xSum / n;
            const yMean = ySum / n;

            // Calculate slope (m) and intercept (b)
            let numerator = 0;
            let denominator = 0;

            points.forEach(point => {
                numerator += (point.x - xMean) * (point.y - yMean);
                denominator += (point.x - xMean) * (point.x - xMean);
            });

            const m = numerator / denominator;
            const b = yMean - m * xMean;

            // Calculate R-squared
            let ssTotal = 0;
            let ssResidual = 0;

            points.forEach(point => {
                const yPredicted = m * point.x + b;
                ssTotal += Math.pow(point.y - yMean, 2);
                ssResidual += Math.pow(point.y - yPredicted, 2);
            });

            const rSquared = 1 - (ssResidual / ssTotal);

            // Update regression line
            const minX = Math.min(...points.map(p => p.x));
            const maxX = Math.max(...points.map(p => p.x));
            
            const lineData = [
                { x: minX, y: m * minX + b },
                { x: maxX, y: m * maxX + b }
            ];

            chart.data.datasets[1].data = lineData;
            chart.update();

            // Display results
            document.getElementById('results').style.display = 'block';
            document.getElementById('equation').innerHTML = 
                `<strong>Regression Equation:</strong> Y = ${m.toFixed(4)}X + ${b.toFixed(4)}`;
            document.getElementById('stats').innerHTML = 
                `<strong>R-squared:</strong> ${rSquared.toFixed(4)}<br>
                 <strong>Slope (m):</strong> ${m.toFixed(4)}<br>
                 <strong>Intercept (b):</strong> ${b.toFixed(4)}<br>
                 <strong>Number of points:</strong> ${n}`;
        }

        // Add new data point input
        function addPoint() {
            const container = document.getElementById('pointContainer');
            const newPoint = document.createElement('div');
            newPoint.className = 'point-input';
            newPoint.innerHTML = `
                <input type="number" class="x-input" placeholder="X">
                <input type="number" class="y-input" placeholder="Y">
                <button onclick="removePoint(this)">×</button>
            `;
            container.appendChild(newPoint);
        }

        // Remove data point input
        function removePoint(button) {
            if (document.querySelectorAll('.point-input').length > 1) {
                button.parentElement.remove();
                updateChartData();
            }
        }

        // Generate random data points
        function generateRandomData() {
            const container = document.getElementById('pointContainer');
            container.innerHTML = '';
            
            for (let i = 0; i < 10; i++) {
                const x = (Math.random() * 10).toFixed(2);
                const y = (parseFloat(x) * 2 + Math.random() * 4 - 2).toFixed(2);
                
                const pointDiv = document.createElement('div');
                pointDiv.className = 'point-input';
                pointDiv.innerHTML = `
                    <input type="number" class="x-input" placeholder="X" value="${x}">
                    <input type="number" class="y-input" placeholder="Y" value="${y}">
                    <button onclick="removePoint(this)">×</button>
                `;
                container.appendChild(pointDiv);
            }
            updateChartData();
        }

        // Clear all data points
        function clearAll() {
            const container = document.getElementById('pointContainer');
            container.innerHTML = '';
            addPoint(); // Add one empty point
            chart.data.datasets[1].data = [];
            chart.update();
            document.getElementById('results').style.display = 'none';
        }

        // Initialize when page loads
        window.onload = function() {
            initChart();
            updateChartData();
        };
    </script>
</body>
</html>