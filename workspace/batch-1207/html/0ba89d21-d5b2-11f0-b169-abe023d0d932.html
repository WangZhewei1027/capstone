<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red-Black Tree</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .tree {
            border: 1px solid black;
            border-collapse: collapse;
            width: 50%;
            margin: 20px auto;
        }
        .tree tr {
            border: 1px solid black;
            background-color: lightgray;
            padding: 10px;
            text-align: center;
        }
        .tree tr td {
            border: 1px solid black;
            width: 100%;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>Red-Black Tree</h1>
    <button id="insert-button">Insert</button>
    <button id="search-button">Search</button>
    <button id="delete-button">Delete</button>
    <button id="print-button">Print</button>
    <div id="tree"></div>

    <script>
        class Node {
            constructor(key, color, left, right) {
                this.key = key;
                this.color = color;
                this.left = left;
                this.right = right;
            }
        }

        class RedBlackTree {
            constructor() {
                this.root = null;
                this.colors = { red: 0, black: 1 };
            }

            insert(key) {
                let node = new Node(key, this.colors.red, null, null);
                if (this.root === null) {
                    this.root = node;
                    node.color = this.colors.red;
                    return;
                }

                let current = this.root;
                while (true) {
                    if (key < current.key) {
                        if (current.left === null) {
                            current.left = node;
                            node.color = this.colors.red;
                            break;
                        } else {
                            current = current.left;
                            if (current.left.color === this.colors.red) {
                                current.right = node;
                                node.color = this.colors.red;
                                break;
                            } else {
                                if (current.right.color === this.colors.red) {
                                    current.right = node;
                                    node.color = this.colors.red;
                                    break;
                                } else {
                                    current = current.right;
                                    current.left = node;
                                    node.color = this.colors.red;
                                    break;
                                }
                            }
                        }
                    } else {
                        if (current.right === null) {
                            current.right = node;
                            node.color = this.colors.red;
                            break;
                        } else {
                            current = current.right;
                            if (current.right.color === this.colors.red) {
                                current.left = node;
                                node.color = this.colors.red;
                                break;
                            } else {
                                if (current.left.color === this.colors.red) {
                                    current.left = node;
                                    node.color = this.colors.red;
                                    break;
                                } else {
                                    current = current.left;
                                    current.right = node;
                                    node.color = this.colors.red;
                                    break;
                                }
                            }
                        }
                    }
                }
            }

            search(key) {
                return this.searchRecursive(this.root, key);
            }

            searchRecursive(node, key) {
                if (node === null) {
                    return false;
                }

                if (key === node.key) {
                    return true;
                }

                if (key < node.key) {
                    return this.searchRecursive(node.left, key);
                } else {
                    return this.searchRecursive(node.right, key);
                }
            }

            delete(key) {
                this.root = this.deleteRecursive(this.root, key);
            }

            deleteRecursive(node, key) {
                if (node === null) {
                    return null;
                }

                if (key < node.key) {
                    node.left = this.deleteRecursive(node.left, key);
                    if (node.left === null) {
                        node.color = this.colors.black;
                        return node;
                    } else {
                        node.left.color = this.colors.red;
                        node.left = this.deleteRecursive(node.left.right, key);
                    }
                } else {
                    node.right = this.deleteRecursive(node.right, key);
                    if (node.right === null) {
                        node.color = this.colors.black;
                        return node;
                    } else {
                        node.right.color = this.colors.red;
                        node.right = this.deleteRecursive(node.right.left, key);
                    }
                }

                if (node.color === this.colors.red) {
                    if (node.left === null) {
                        return node.right;
                    } else {
                        return this.deleteRed(node);
                    }
                } else {
                    if (node.right === null) {
                        return node.left;
                    } else {
                        return this.deleteRed(node);
                    }
                }
            }

            deleteRed(node) {
                if (node.left === null && node.right === null) {
                    return null;
                }

                if (node.left === null) {
                    return node.right;
                } else if (node.right === null) {
                    return node.left;
                } else {
                    let successor = this.findMin(node.right);
                    node.key = successor.key;
                    node.right = this.deleteRed(node.right);
                    return node;
                }
            }

            findMin(node) {
                while (node.left !== null) {
                    node = node.left;
                }
                return node;
            }

            printTree() {
                this.printTreeRecursive(this.root, 0);
            }

            printTreeRecursive(node, level) {
                if (node !== null) {
                    this.printTreeRecursive(node.right, level + 1);
                    process.stdout.write(level + ' '.repeat(4 * level - 1) + ' -> ');
                    process.stdout.write(node.key + ' ');
                    this.printTreeRecursive(node.left, level + 1);
                }
            }
        }

        let tree = new RedBlackTree();
        tree.insert(50);
        tree.insert(30);
        tree.insert(20);
        tree.insert(40);
        tree.insert(70);
        tree.insert(60);
        tree.insert(80);

        console.log('Search: 50');
        console.log(tree.search(50));
        console.log('Search: 20');
        console.log(tree.search(20));
        console.log('Search: 100');
        console.log(tree.search(100));

        tree.delete(50);
        tree.printTree();

        console.log('Search: 50');
        console.log(tree.search(50));
        console.log('Search: 20');
        console.log(tree.search(20));
        console.log('Search: 100');
        console.log(tree.search(100));
    </script>
</body>
</html>