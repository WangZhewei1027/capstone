<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Binary Search Visualizer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f1724;
      --panel:#0b1220;
      --muted:#9aa7bb;
      --accent:#23c4ff;
      --good:#2dd670;
      --bad:#ff6b6b;
      --card:#071024;
    }
    html,body{height:100%; margin:0; font-family:Inter,Segoe UI,Roboto,system-ui,-apple-system,"Helvetica Neue",Arial; background:linear-gradient(180deg,#071026 0%, #071b2a 100%); color:#e6f0fb;}
    .container{max-width:1100px; margin:26px auto; padding:22px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; box-shadow: 0 10px 30px rgba(2,6,23,0.6);}
    header{display:flex; gap:20px; align-items:center; margin-bottom:16px;}
    h1{font-size:20px; margin:0;}
    p.lead{margin:0; color:var(--muted); font-size:13px;}
    .controls{display:flex; gap:12px; margin:12px 0 18px; flex-wrap:wrap; align-items:center;}
    .control{background:var(--panel); padding:10px; border-radius:8px; display:flex; gap:8px; align-items:center; color:var(--muted); font-size:13px;}
    .control label{font-size:12px; color:var(--muted);}
    input[type=number], input[type=text], select{background:#051522; border:1px solid rgba(255,255,255,0.04); color:#dff4ff; padding:6px 8px; border-radius:6px; outline:none; font-size:13px; width:100px;}
    input[type=range]{width:120px;}
    button{background:linear-gradient(180deg, #0ea5d9, #0284c7); color:#062235; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600;}
    button.ghost{background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); padding:8px 12px;}
    .main{display:flex; gap:18px;}
    .left, .right{flex:1; min-width:300px;}
    .panel{background:var(--card); padding:14px; border-radius:10px; border:1px solid rgba(255,255,255,0.02);}
    .array-row{display:flex; gap:8px; align-items:center; padding:16px 6px; justify-content:center; flex-wrap:wrap;}
    .box{width:54px; height:54px; border-radius:8px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); display:flex; flex-direction:column; align-items:center; justify-content:center; border:1px solid rgba(255,255,255,0.03); color:#cfeeff; position:relative; font-weight:700; transition:all 260ms ease;}
    .box .idx{position:absolute; top:6px; right:6px; font-size:11px; color:var(--muted); font-weight:500;}
    .box.small{width:46px;height:46px;}
    .box.faded{opacity:0.25; transform:scale(0.96);}
    .box.mid{box-shadow:0 6px 26px rgba(35,196,255,0.12); border:1px solid rgba(35,196,255,0.15); transform:translateY(-6px) scale(1.02);}
    .box.left-bound{box-shadow:0 6px 20px rgba(45,214,112,0.06); border:1px solid rgba(45,214,112,0.12);}
    .box.right-bound{box-shadow:0 6px 20px rgba(255,107,107,0.06); border:1px solid rgba(255,107,107,0.12);}
    .box.found{background:linear-gradient(180deg,#b8ffdf,#a9ffd0); color:#023b25; box-shadow:0 10px 30px rgba(39,186,115,0.12); border:1px solid rgba(6,38,18,0.08);}
    .box.elim{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); opacity:0.18; color:rgba(255,255,255,0.35); transform:scale(0.96);}
    .legend{display:flex; gap:8px; align-items:center; margin-top:10px; color:var(--muted); font-size:13px;}
    .legend .item{display:flex; gap:8px; align-items:center;}
    .swatch{width:16px; height:16px; border-radius:4px;}
    .stats{display:flex; gap:12px; margin-top:10px; color:var(--muted); font-size:13px;}
    .pseudocode{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace; font-size:13px; color:var(--muted); padding:10px; border-radius:8px; background:#00121a;}
    .code-line{padding:6px 8px; border-radius:6px;}
    .code-line.active{background:linear-gradient(90deg, rgba(35,196,255,0.09), rgba(35,196,255,0.02)); color:var(--accent); font-weight:700;}
    .log{margin-top:10px; height:120px; overflow:auto; background:#00131a; padding:10px; border-radius:8px; color:var(--muted); font-size:13px;}
    .footer{margin-top:14px; display:flex; gap:12px; justify-content:space-between; align-items:center; color:var(--muted); font-size:13px;}
    a { color:var(--accent); text-decoration:none; }
    @media (max-width:880px){
      .main{flex-direction:column;}
      .array-row{justify-content:flex-start; overflow:auto; padding:12px;}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Binary Search — Interactive Visualizer</h1>
        <p class="lead">Explore how binary search finds an item in a sorted array. Step through comparisons, watch indices move, and see the O(log n) behavior.</p>
      </div>
    </header>

    <div class="controls">
      <div class="control">
        <label>Array Size</label>
        <input id="size" type="number" min="3" max="60" value="15" />
      </div>

      <div class="control">
        <label>Max gap</label>
        <input id="maxGap" type="number" min="1" max="50" value="7" />
      </div>

      <div class="control">
        <label>Generate</label>
        <button id="gen">Random Sorted Array</button>
      </div>

      <div class="control">
        <label>Target</label>
        <input id="target" type="text" placeholder="Number to find" />
      </div>

      <div class="control">
        <label>Search</label>
        <button id="stepBtn" class="ghost">Step</button>
        <button id="playBtn">Auto Play</button>
        <button id="backBtn" class="ghost">Back</button>
        <button id="resetBtn" class="ghost">Reset</button>
      </div>

      <div class="control">
        <label>Speed</label>
        <input id="speed" type="range" min="100" max="2000" value="700" />
      </div>
    </div>

    <div class="main">
      <div class="left">
        <div class="panel">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <strong>Array (sorted)</strong>
            <div style="color:var(--muted); font-size:13px;">Click a value to set as target</div>
          </div>

          <div id="array" class="array-row" style="margin-top:12px;"></div>

          <div class="legend">
            <div class="item"><div class="swatch" style="background:linear-gradient(180deg,#b8ffdf,#a9ffd0);border:1px solid rgba(6,38,18,0.08)"></div> Found</div>
            <div class="item"><div class="swatch" style="background:linear-gradient(180deg, rgba(35,196,255,0.15), rgba(255,255,255,0.00))"></div> Mid</div>
            <div class="item"><div class="swatch" style="background:rgba(45,214,112,0.12);border-radius:4px"></div> Left bound</div>
            <div class="item"><div class="swatch" style="background:rgba(255,107,107,0.12);border-radius:4px"></div> Right bound</div>
            <div class="item"><div class="swatch" style="background:rgba(255,255,255,0.04);border-radius:4px"></div> Eliminated</div>
          </div>

          <div class="stats">
            <div id="status">Status: Ready</div>
            <div id="steps">Steps: 0</div>
            <div id="comparisons">Comparisons: 0</div>
          </div>

          <div class="footer" style="margin-top:12px;">
            <div style="max-width:60%;">
              <div style="font-weight:600">Time complexity:</div>
              <div style="font-size:13px; color:var(--muted)">O(log n) — each step halves the search range.</div>
            </div>
            <div style="text-align:right; font-size:13px; color:var(--muted)">
              Tip: Binary search works only on sorted arrays.
            </div>
          </div>
        </div>
      </div>

      <div class="right">
        <div class="panel" style="margin-bottom:12px;">
          <strong>Pseudocode</strong>
          <div class="pseudocode" id="pseudocode" style="margin-top:10px;">
            <div class="code-line" data-line="1">1: left = 0</div>
            <div class="code-line" data-line="2">2: right = n - 1</div>
            <div class="code-line" data-line="3">3: while left <= right:</div>
            <div class="code-line" data-line="4">4: &nbsp;&nbsp;&nbsp;mid = floor((left + right) / 2)</div>
            <div class="code-line" data-line="5">5: &nbsp;&nbsp;&nbsp;if A[mid] == target: return mid</div>
            <div class="code-line" data-line="6">6: &nbsp;&nbsp;&nbsp;elif A[mid] < target: left = mid + 1</div>
            <div class="code-line" data-line="7">7: &nbsp;&nbsp;&nbsp;else: right = mid - 1</div>
            <div class="code-line" data-line="8">8: return not found</div>
          </div>

          <div class="log" id="log"></div>
        </div>

        <div class="panel">
          <strong>Controls & Details</strong>
          <div style="margin-top:10px; color:var(--muted); font-size:13px;">
            Use Step to execute one comparison at a time. Auto Play will step automatically. You can click any value in the array to set it as the search target.
            <div style="margin-top:8px;"><strong>Current target:</strong> <span id="curTarget" style="color:var(--accent)">none</span></div>
          </div>
        </div>

      </div>
    </div>

    <div style="margin-top:12px; color:var(--muted); font-size:13px;">
      Built for learning — this demo shows the index movement (left, right, mid) and which elements get eliminated at each step.
    </div>
  </div>

  <script>
    // Binary Search Visualizer
    (function(){
      // Elements
      const arrayEl = document.getElementById('array');
      const genBtn = document.getElementById('gen');
      const sizeInput = document.getElementById('size');
      const maxGapInput = document.getElementById('maxGap');
      const stepBtn = document.getElementById('stepBtn');
      const playBtn = document.getElementById('playBtn');
      const backBtn = document.getElementById('backBtn');
      const resetBtn = document.getElementById('resetBtn');
      const targetInput = document.getElementById('target');
      const curTargetEl = document.getElementById('curTarget');
      const statusEl = document.getElementById('status');
      const stepsEl = document.getElementById('steps');
      const comparisonsEl = document.getElementById('comparisons');
      const logEl = document.getElementById('log');
      const speedInput = document.getElementById('speed');
      const pseudoEls = document.querySelectorAll('.code-line');

      // State
      let A = [];
      let n = 0;
      let target = null;

      // Search runtime state
      let left = 0, right = -1, mid = null;
      let comparisons = 0, steps = 0;
      let finished = false;
      let foundIndex = null;

      // History of snapshots for stepping back/forward
      let history = []; // each snapshot: {left,right,mid,comparisons,steps,found,desc,hl}
      let histIndex = -1;

      // Auto play
      let playing = false;
      let playTimer = null;

      // Utilities
      function log(msg) {
        const d = document.createElement('div');
        d.textContent = msg;
        logEl.prepend(d);
      }

      function clearLog() { logEl.innerHTML = ''; }

      function generateArray() {
        n = Math.max(3, Math.min(60, parseInt(sizeInput.value) || 15));
        const maxGap = Math.max(1, parseInt(maxGapInput.value) || 7);
        A = [];
        let cur = Math.floor(Math.random()*3) + 1;
        for (let i=0;i<n;i++){
          const gap = Math.floor(Math.random() * maxGap) + 1;
          cur += gap;
          A.push(cur);
        }
        // Reset search
        resetSearch();
        renderArray();
        log(`Generated array of length ${n}.`);
      }

      function renderArray(snapshot) {
        // snapshot optional: if provided, highlight according to it, else show default
        arrayEl.innerHTML = '';
        const s = snapshot || {left: left, right: right, mid: mid, found: (foundIndex !== null)};
        for (let i=0;i<A.length;i++){
          const b = document.createElement('div');
          b.className = 'box';
          b.innerHTML = `<div class="idx">${i}</div><div class="val">${A[i]}</div>`;
          b.title = `index ${i} → ${A[i]}`;
          // click to set as target
          b.addEventListener('click', () => {
            targetInput.value = A[i];
            setTargetFromInput();
          });

          if (s.found && s.mid === i) {
            b.classList.add('found');
          } else {
            if (s.mid === i) b.classList.add('mid');
            if (s.left !== null && i === s.left) b.classList.add('left-bound');
            if (s.right !== null && i === s.right) b.classList.add('right-bound');

            // eliminated if outside [left,right]
            if (s.left !== null && s.right !== null && (i < s.left || i > s.right)) {
              b.classList.add('elim','faded');
            }
          }

          arrayEl.appendChild(b);
        }

        // update status area
        statusEl.textContent = finished ? (foundIndex !== null ? `Found at index ${foundIndex}` : 'Not found') : 'Searching...';
        stepsEl.textContent = `Steps: ${steps}`;
        comparisonsEl.textContent = `Comparisons: ${comparisons}`;

        // highlight pseudocode
        highlightLine(snapshot && snapshot.hl ? snapshot.hl : (finished?8:3));
      }

      function highlightLine(lineNumber) {
        pseudoEls.forEach(el=>{
          const ln = parseInt(el.getAttribute('data-line'));
          if (ln === lineNumber) el.classList.add('active'); else el.classList.remove('active');
        });
      }

      function resetSearch() {
        left = 0;
        right = A.length - 1;
        mid = null;
        comparisons = 0;
        steps = 0;
        finished = false;
        foundIndex = null;
        history = [];
        histIndex = -1;
        clearLog();
        curTargetEl.textContent = (target===null ? 'none' : target);
        // initial snapshot
        pushSnapshot('Initialize search: left=0, right=n-1', 2);
        renderArray(history[histIndex]);
      }

      function pushSnapshot(desc, hl) {
        const snap = {
          left: left,
          right: right,
          mid: mid,
          comparisons: comparisons,
          steps: steps,
          found: (foundIndex !== null),
          desc: desc || '',
          hl: hl || 3
        };
        // If we've backed up and then make a new step, overwrite future history
        if (histIndex < history.length - 1) {
          history = history.slice(0, histIndex + 1);
        }
        history.push(snap);
        histIndex = history.length - 1;
      }

      function setTargetFromInput() {
        const raw = targetInput.value.trim();
        if (raw === '') {
          target = null;
          curTargetEl.textContent = 'none';
          return;
        }
        // allow only integer or float numbers
        const v = Number(raw);
        if (Number.isNaN(v)) {
          alert('Target must be a number.');
          return;
        }
        target = v;
        curTargetEl.textContent = target;
        log(`Target set to ${target}.`);
        resetSearch();
      }

      function stepOnce() {
        if (finished) {
          log('Search already finished. Reset to run again.');
          return;
        }
        if (target === null) {
          alert('Please set a numeric target before searching.');
          return;
        }

        // compute mid
        mid = Math.floor((left + right) / 2);
        steps++;
        comparisons++;
        pushSnapshot(`Compute mid=${mid}`, 4);
        renderArray(history[histIndex]);

        // small timeout to show mid before comparing
        setTimeout(()=> {
          const val = A[mid];
          if (val === target) {
            foundIndex = mid;
            finished = true;
            pushSnapshot(`Found target at index ${mid}`, 5);
            log(`Step ${steps}: A[${mid}] == ${target}. Found.`);
            renderArray(history[histIndex]);
            stopPlaying();
          } else if (val < target) {
            left = mid + 1;
            pushSnapshot(`A[${mid}] (${val}) < ${target} → move left to ${left}`, 6);
            log(`Step ${steps}: A[${mid}] (${val}) < ${target} → left = ${left}`);
            renderArray(history[histIndex]);
            // check termination
            if (left > right) {
              finished = true;
              pushSnapshot(`left > right → not found`, 8);
              log(`Terminated: left (${left}) > right (${right}). Not found.`);
              renderArray(history[histIndex]);
              stopPlaying();
            }
          } else {
            right = mid - 1;
            pushSnapshot(`A[${mid}] (${val}) > ${target} → move right to ${right}`, 7);
            log(`Step ${steps}: A[${mid}] (${val}) > ${target} → right = ${right}`);
            renderArray(history[histIndex]);
            if (left > right) {
              finished = true;
              pushSnapshot(`left > right → not found`, 8);
              log(`Terminated: left (${left}) > right (${right}). Not found.`);
              renderArray(history[histIndex]);
              stopPlaying();
            }
          }
        }, Math.max(120, Math.min(800, parseInt(speedInput.value) / 2)));
      }

      function backStep() {
        if (histIndex <= 0) {
          log('At the beginning - nothing to go back to.');
          return;
        }
        histIndex--;
        const s = history[histIndex];
        // restore from snapshot
        left = s.left;
        right = s.right;
        mid = s.mid;
        comparisons = s.comparisons;
        steps = s.steps;
        finished = s.found || false;
        foundIndex = s.found ? s.mid : null;
        renderArray(s);
        log(`Stepped back: ${s.desc || 'state restored'}`);
      }

      function resetAll() {
        stopPlaying();
        target = null;
        targetInput.value = '';
        curTargetEl.textContent = 'none';
        generateArray();
        clearLog();
        pushSnapshot('Reset search', 2);
        renderArray(history[histIndex]);
      }

      function startPlaying() {
        if (playing) return;
        playing = true;
        playBtn.textContent = 'Pause';
        const interval = Math.max(80, parseInt(speedInput.value));
        playTimer = setInterval(()=> {
          // If finished or no target, stop
          if (finished) {
            stopPlaying();
            return;
          }
          // If left > right -> finished
          if (left > right) {
            finished = true;
            pushSnapshot('left > right → not found', 8);
            renderArray(history[histIndex]);
            stopPlaying();
            return;
          }
          stepOnce();
        }, interval + 60);
      }

      function stopPlaying() {
        playing = false;
        playBtn.textContent = 'Auto Play';
        if (playTimer) {
          clearInterval(playTimer);
          playTimer = null;
        }
      }

      // Event handlers
      genBtn.addEventListener('click', ()=> {
        generateArray();
      });

      sizeInput.addEventListener('change', ()=> {
        generateArray();
      });

      maxGapInput.addEventListener('change', ()=> {
        generateArray();
      });

      targetInput.addEventListener('change', setTargetFromInput);
      targetInput.addEventListener('keydown', (e)=>{
        if (e.key === 'Enter') setTargetFromInput();
      });

      stepBtn.addEventListener('click', ()=>{
        stopPlaying();
        stepOnce();
      });

      playBtn.addEventListener('click', ()=>{
        if (playing) stopPlaying(); else startPlaying();
      });

      backBtn.addEventListener('click', ()=>{
        stopPlaying();
        backStep();
      });

      resetBtn.addEventListener('click', ()=>{
        resetAll();
      });

      speedInput.addEventListener('input', ()=>{
        if (playing) {
          stopPlaying();
          startPlaying();
        }
      });

      // Initialize first array
      generateArray();

      // expose for debugging (optional)
      window.bsViz = {
        A, generateArray, stepOnce, startPlaying, stopPlaying
      };

      // Accessibility: keyboard shortcuts
      document.addEventListener('keydown', (e)=>{
        if (e.key === ' ') { e.preventDefault(); stepBtn.click(); }
        if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) { playBtn.click(); }
      });

      // Make sure initial render highlights pseudocode line 2
      highlightLine(2);
    })();
  </script>
</body>
</html>