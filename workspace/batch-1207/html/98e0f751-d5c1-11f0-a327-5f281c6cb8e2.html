<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Interactive Demo: JavaScript Set (and set operations)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin: 20px; color: #111; }
    h1 { margin: 0 0 6px 0; font-size: 20px; }
    p.lead { margin: 4px 0 16px 0; color: #333; max-width: 60ch; }
    .container { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; align-items: start; }
    .card { border: 1px solid #ddd; padding: 12px; border-radius: 8px; background: #fafafa; }
    label { display:block; font-weight:600; margin-bottom:6px; }
    input[type="text"] { width:100%; padding:8px; box-sizing:border-box; border:1px solid #ccc; border-radius:6px; }
    .row { display:flex; gap:8px; margin-top:8px; flex-wrap:wrap; }
    button { padding:8px 10px; border-radius:6px; border:1px solid #bbb; background:#fff; cursor:pointer; }
    button.primary { background:#2b8cff; color:white; border-color:#1f6fd6; }
    button.warn { background:#fff3cd; border-color:#f0b429; }
    .output { margin-top:10px; font-family: monospace; white-space:pre-wrap; background:#fff; padding:10px; border-radius:6px; border:1px solid #eee; max-height:240px; overflow:auto; }
    .small { font-size:13px; color:#555; }
    .flex { display:flex; gap:10px; align-items:center; }
    .badge { background:#efefef; padding:3px 8px; border-radius:999px; font-weight:600; }
    footer { margin-top:18px; font-size:13px; color:#555; }
    .examples { display:flex; gap:8px; flex-wrap:wrap; }
    .chip { padding:6px 8px; border-radius:6px; background:#fff; border:1px solid #eee; cursor:pointer; }
    .muted { color:#666; font-size:13px; }
  </style>
</head>
<body>
  <h1>JavaScript Set — Interactive Demo</h1>
  <p class="lead">Play with JavaScript's Set object: create sets, see how duplicates are removed, try union/intersection/difference, and learn how Sets treat primitives and objects differently.</p>

  <div class="container">
    <div class="card">
      <label>Set A (comma-separated values)</label>
      <input id="inputA" placeholder="e.g. apple, banana, 3, 3, true" />
      <div class="row">
        <button class="primary" id="buildA">Build Set A</button>
        <button id="clearA">Clear A</button>
        <button id="addObjA">Add two identical objects to A</button>
        <button id="sampleA">Sample A (random)</button>
      </div>
      <div class="output" id="outA"></div>
    </div>

    <div class="card">
      <label>Set B (comma-separated values)</label>
      <input id="inputB" placeholder="e.g. banana, orange, 3, false" />
      <div class="row">
        <button class="primary" id="buildB">Build Set B</button>
        <button id="clearB">Clear B</button>
        <button id="addObjB">Add two identical objects to B</button>
        <button id="sampleB">Sample B (random)</button>
      </div>
      <div class="output" id="outB"></div>
    </div>

    <div class="card" style="grid-column: 1 / span 2;">
      <label>Set operations</label>
      <div class="row">
        <button id="showUnion" class="primary">Union (A ∪ B)</button>
        <button id="showInter">Intersection (A ∩ B)</button>
        <button id="showDiff">Difference (A \ B)</button>
        <button id="showDiffBA">Difference (B \ A)</button>
        <button id="showSym">Symmetric Diff (A Δ B)</button>
        <button id="toArray">Convert A → Array (remove duplicates)</button>
        <button id="copyA">Copy A (shallow)</button>
        <button id="iterateA">Iterate A (for..of)</button>
        <button id="clearBoth" class="warn">Clear Both</button>
      </div>
      <div class="output" id="outOps"></div>
    </div>

    <div class="card">
      <label>Quick examples</label>
      <div class="examples">
        <div class="chip" id="ex1">Array→Set (dedupe)</div>
        <div class="chip" id="ex2">Set of objects (reference equality)</div>
        <div class="chip" id="ex3">Set add/delete/has</div>
        <div class="chip" id="ex4">Preserves insertion order</div>
      </div>
      <div class="output" id="outExamples"></div>
    </div>

    <div class="card">
      <label>Notes & tips</label>
      <div class="muted">
        - Sets only store unique values. For primitives uniqueness is by value. For objects it's by reference.<br>
        - Use new Set(array) or spread [...new Set(array)] to remove duplicates from arrays.<br>
        - Set preserves insertion order when iterating.<br>
        - Sets are shallow: copied references are the same objects.
      </div>
    </div>
  </div>

  <footer>
    Tip: Try entering numbers (1, 2, 2) and strings ("1", 1) to see that "1" (string) and 1 (number) are distinct.
  </footer>

  <script>
    // Utility: parse comma-separated tokens into JS values (numbers, booleans, null, undefined, strings)
    function parseTokens(text) {
      if (!text) return [];
      return text.split(',').map(t => t.trim()).filter(t => t.length > 0).map(t => {
        // detect numeric literal (integers and floats)
        if (/^-?\d+(\.\d+)?$/.test(t)) return Number(t);
        if (/^(true|false)$/.test(t.toLowerCase())) return t.toLowerCase() === 'true';
        if (/^null$/i.test(t)) return null;
        if (/^undefined$/i.test(t)) return undefined;
        // quoted strings: "hello" or 'hello'
        const m = t.match(/^"(.*)"$|^'(.*)'$/);
        if (m) return m[1] ?? m[2];
        // otherwise keep as raw string
        return t;
      });
    }

    // Visual representation helper
    function repr(value) {
      if (value === null) return 'null';
      if (value === undefined) return 'undefined';
      if (typeof value === 'string') return '"' + value + '"';
      if (typeof value === 'object') {
        try { return JSON.stringify(value); } catch(e) { return String(value); }
      }
      return String(value);
    }

    // Show set contents
    function showSet(set) {
      const arr = [];
      for (const v of set) arr.push(repr(v) + ' (' + typeof v + ')');
      return '[' + arr.join(', ') + ']  size=' + set.size;
    }

    // Basic set operations
    function union(A, B) {
      return new Set([...A, ...B]);
    }
    function intersection(A, B) {
      return new Set([...A].filter(x => B.has(x)));
    }
    function difference(A, B) {
      return new Set([...A].filter(x => !B.has(x)));
    }
    function symmetricDiff(A, B) {
      return union(difference(A,B), difference(B,A));
    }

    // State
    let setA = new Set();
    let setB = new Set();

    // Elements
    const inputA = document.getElementById('inputA');
    const inputB = document.getElementById('inputB');
    const outA = document.getElementById('outA');
    const outB = document.getElementById('outB');
    const outOps = document.getElementById('outOps');
    const outExamples = document.getElementById('outExamples');

    // Buttons
    document.getElementById('buildA').addEventListener('click', () => {
      const values = parseTokens(inputA.value);
      setA = new Set(values);
      renderA();
      outOps.textContent = 'Built Set A from input.';
    });
    document.getElementById('buildB').addEventListener('click', () => {
      const values = parseTokens(inputB.value);
      setB = new Set(values);
      renderB();
      outOps.textContent = 'Built Set B from input.';
    });

    document.getElementById('clearA').addEventListener('click', () => {
      setA.clear();
      renderA();
      outOps.textContent = 'Cleared A.';
    });
    document.getElementById('clearB').addEventListener('click', () => {
      setB.clear();
      renderB();
      outOps.textContent = 'Cleared B.';
    });
    document.getElementById('clearBoth').addEventListener('click', () => {
      setA.clear(); setB.clear();
      renderA(); renderB();
      outOps.textContent = 'Cleared both sets.';
    });

    document.getElementById('sampleA').addEventListener('click', () => {
      const samples = ['apple', 'banana', 'orange', 1, 2, 3, true, '1'];
      setA = new Set([samples[Math.floor(Math.random()*samples.length)], samples[Math.floor(Math.random()*samples.length)], 'x', 'x', 2]);
      renderA();
      outOps.textContent = 'Sample A created (with duplicates removed).';
    });
    document.getElementById('sampleB').addEventListener('click', () => {
      const samples = ['banana','pear','lemon',3,4,false,'1'];
      setB = new Set([samples[Math.floor(Math.random()*samples.length)], samples[Math.floor(Math.random()*samples.length)], null, null]);
      renderB();
      outOps.textContent = 'Sample B created (with duplicates removed).';
    });

    // Add two identical-looking objects to show reference equality
    document.getElementById('addObjA').addEventListener('click', () => {
      const obj1 = { name: 'obj', x: 1 };
      const obj2 = { name: 'obj', x: 1 }; // same structure but different reference
      setA.add(obj1).add(obj2);
      renderA();
      outOps.textContent = 'Added two distinct object references (same properties) to A — both appear.';
    });
    document.getElementById('addObjB').addEventListener('click', () => {
      const obj1 = { name: 'obj', x: 1 };
      const obj2 = obj1; // same reference
      setB.add(obj1).add(obj2);
      renderB();
      outOps.textContent = 'Added the same object reference twice to B — only one item stored.';
    });

    // Operations
    document.getElementById('showUnion').addEventListener('click', () => {
      const u = union(setA, setB);
      outOps.textContent = 'Union (A ∪ B):\n' + showSet(u);
    });
    document.getElementById('showInter').addEventListener('click', () => {
      const i = intersection(setA, setB);
      outOps.textContent = 'Intersection (A ∩ B):\n' + showSet(i);
    });
    document.getElementById('showDiff').addEventListener('click', () => {
      const d = difference(setA, setB);
      outOps.textContent = 'Difference (A \\ B):\n' + showSet(d);
    });
    document.getElementById('showDiffBA').addEventListener('click', () => {
      const d = difference(setB, setA);
      outOps.textContent = 'Difference (B \\ A):\n' + showSet(d);
    });
    document.getElementById('showSym').addEventListener('click', () => {
      const s = symmetricDiff(setA, setB);
      outOps.textContent = 'Symmetric difference (A Δ B):\n' + showSet(s);
    });

    document.getElementById('toArray').addEventListener('click', () => {
      const arr = [...setA];
      outOps.textContent = 'A converted to array (duplicates removed if any):\n' + JSON.stringify(arr, null, 2) + '\n\nNote elements keep their types. Example: ' + showSet(setA);
    });
    document.getElementById('copyA').addEventListener('click', () => {
      const copy = new Set(setA);
      outOps.textContent = 'Shallow copy of A created. copy === setA ? (no) — but elements reference-equal for objects:';
      outOps.textContent += '\nOriginal A: ' + showSet(setA) + '\nCopy: ' + showSet(copy);
    });
    document.getElementById('iterateA').addEventListener('click', () => {
      let s = 'Iterating A with for..of:\n';
      for (const v of setA) s += '  - ' + repr(v) + ' (' + typeof v + ')\n';
      s += '\nAlso demonstrating forEach (Set.prototype.forEach):\n';
      setA.forEach((v, same, setRef) => { s += '  * forEach value: ' + repr(v) + '\\n'; });
      outOps.textContent = s;
    });

    // Example quick-chips
    document.getElementById('ex1').addEventListener('click', () => {
      const arr = [1,2,2,3,3,3,'a','a'];
      const dedup = [...new Set(arr)];
      outExamples.textContent = 'Array: ' + JSON.stringify(arr) + '\nAfter [...new Set(array)]: ' + JSON.stringify(dedup);
    });
    document.getElementById('ex2').addEventListener('click', () => {
      const a = {id:1}, b = {id:1}, c = a;
      const s = new Set([a,b,c]);
      outExamples.textContent = 'Objects a and b have same properties but are different references.\nSet([a,b,c]) results in size=' + s.size + '  (' + Array.from(s).map(repr).join(', ') + ')\nShows reference equality, not deep equality.';
    });
    document.getElementById('ex3').addEventListener('click', () => {
      const s = new Set();
      s.add(1);
      s.add(1);
      s.add('1');
      s.delete(1);
      outExamples.textContent = 'Demo add/delete/has:\nAdded 1 twice and "1". After delete(1): has(1)=' + s.has(1) + ', has("1")=' + s.has('1') + '\nSet contents: ' + showSet(s);
    });
    document.getElementById('ex4').addEventListener('click', () => {
      const s = new Set();
      s.add('first');
      s.add('second');
      s.add('third');
      s.delete('second');
      s.add('second'); // re-adding goes to the end (insertion order)
      outExamples.textContent = 'Insertion order preserved. Sequence after operations: ' + showSet(s);
    });

    // Rendering functions
    function renderA() {
      outA.textContent = 'A: ' + showSet(setA);
      // show entries on separate lines
      outA.textContent += '\n\nElements (in insertion order):\n';
      for (const v of setA) outA.textContent += '  - ' + repr(v) + ' (' + typeof v + ')\n';
    }
    function renderB() {
      outB.textContent = 'B: ' + showSet(setB);
      outB.textContent += '\n\nElements (in insertion order):\n';
      for (const v of setB) outB.textContent += '  - ' + repr(v) + ' (' + typeof v + ')\n';
    }

    // initial state
    inputA.value = 'apple, banana, 3, 3, true';
    inputB.value = 'banana, orange, 3, false';
    document.getElementById('buildA').click();
    document.getElementById('buildB').click();
    outOps.textContent = 'Built initial sample sets A and B. Try operations above.';
  </script>
</body>
</html>