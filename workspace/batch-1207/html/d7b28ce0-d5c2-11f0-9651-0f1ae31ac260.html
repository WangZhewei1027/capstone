<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hash Table Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 600px;
    margin: 2rem auto;
    padding: 1rem;
    background: #f9f9f9;
    color: #333;
  }
  h1 {
    text-align: center;
    margin-bottom: 1rem;
  }
  input, button {
    padding: 0.5rem;
    font-size: 1rem;
    margin: 0.25rem 0.5rem 0.75rem 0;
  }
  label {
    display: block;
    margin-top: 1rem;
  }
  .hashtable {
    margin-top: 1rem;
    border-collapse: collapse;
    width: 100%;
  }
  .hashtable th, .hashtable td {
    border: 1px solid #ccc;
    padding: 0.5rem;
    text-align: left;
    vertical-align: top;
  }
  .bucket {
    background-color: #eaeaea;
  }
  .key {
    font-weight: bold;
  }
  .controls {
    margin-bottom: 1rem;
    border: 1px solid #ddd;
    padding: 1rem;
    background: white;
    border-radius: 6px;
  }
  .output {
    background: #fff3cd;
    border: 1px solid #ffeeba;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    margin-bottom: 1rem;
    min-height: 1.5em;
  }
  small {
    color: #555;
  }
  footer {
    margin-top: 3rem;
    font-size: 0.85rem;
    color: #888;
    text-align: center;
  }
</style>
</head>
<body>
<h1>Hash Table Demonstration</h1>

<div class="controls">
  <label>
    Key (string):
    <input type="text" id="keyInput" placeholder="Enter key" />
  </label>
  <label>
    Value (string):
    <input type="text" id="valueInput" placeholder="Enter value" />
  </label>
  <button id="insertBtn">Insert / Update</button>
  <button id="getBtn">Get Value</button>
  <button id="removeBtn">Remove Key</button>
  <button id="clearBtn">Clear Table</button>
</div>

<div class="output" id="output"></div>

<table class="hashtable" id="tableDisplay" aria-label="Hash Table buckets and contents">
  <thead>
    <tr>
      <th>Bucket Index</th>
      <th>Key → Value Pairs</th>
    </tr>
  </thead>
  <tbody id="tableBody">
  </tbody>
</table>

<script>
  /*
   * Simple Hash Table with Separate Chaining in JavaScript
   */

  class HashTable {
    constructor(size = 16) {
      this.size = size;
      this.buckets = new Array(size).fill(null).map(() => []);
      this.count = 0;
    }

    // DJB2 hash function for strings
    hash(key) {
      let hash = 5381;
      for (let i = 0; i < key.length; i++) {
        hash = (hash * 33) ^ key.charCodeAt(i);
      }
      return Math.abs(hash) % this.size;
    }

    set(key, value) {
      const index = this.hash(key);
      const bucket = this.buckets[index];
      for (let i = 0; i < bucket.length; i++) {
        if (bucket[i][0] === key) {
          bucket[i][1] = value; // Update existing key
          return;
        }
      }
      bucket.push([key, value]);
      this.count++;
      // Simple resize check for demonstration (not implemented resizing here)
    }

    get(key) {
      const index = this.hash(key);
      const bucket = this.buckets[index];
      for (let i = 0; i < bucket.length; i++) {
        if (bucket[i][0] === key) {
          return bucket[i][1];
        }
      }
      return undefined;
    }

    remove(key) {
      const index = this.hash(key);
      const bucket = this.buckets[index];
      for (let i = 0; i < bucket.length; i++) {
        if (bucket[i][0] === key) {
          bucket.splice(i, 1);
          this.count--;
          return true;
        }
      }
      return false;
    }

    clear() {
      this.buckets = new Array(this.size).fill(null).map(() => []);
      this.count = 0;
    }
  }

  // Instantiate HashTable
  const hashTable = new HashTable(16);

  // UI Elements
  const keyInput = document.getElementById('keyInput');
  const valueInput = document.getElementById('valueInput');
  const insertBtn = document.getElementById('insertBtn');
  const getBtn = document.getElementById('getBtn');
  const removeBtn = document.getElementById('removeBtn');
  const clearBtn = document.getElementById('clearBtn');
  const output = document.getElementById('output');
  const tableBody = document.getElementById('tableBody');

  function updateTableDisplay() {
    tableBody.innerHTML = '';
    for (let i = 0; i < hashTable.size; i++) {
      const bucket = hashTable.buckets[i];
      const tr = document.createElement('tr');

      const idxTd = document.createElement('td');
      idxTd.textContent = i;
      idxTd.classList.add('bucket');
      tr.appendChild(idxTd);

      const kvTd = document.createElement('td');
      if (bucket.length === 0) {
        kvTd.textContent = '— (empty)';
        kvTd.style.fontStyle = 'italic';
        kvTd.style.color = '#999';
      } else {
        // Create list of key → value pairs
        const fragments = bucket.map(
          ([k, v]) => `${k} → ${v}`
        );
        kvTd.textContent = fragments.join(', ');
      }
      tr.appendChild(kvTd);

      tableBody.appendChild(tr);
    }
  }

  function showOutput(msg, isError = false) {
    output.textContent = msg;
    output.style.color = isError ? 'darkred' : 'black';
  }

  insertBtn.addEventListener('click', () => {
    const key = keyInput.value.trim();
    const value = valueInput.value.trim();
    if (!key) {
      showOutput('Please enter a valid key.', true);
      return;
    }
    hashTable.set(key, value);
    updateTableDisplay();
    showOutput(`Inserted/Updated key "${key}" with value "${value}".`);
  });

  getBtn.addEventListener('click', () => {
    const key = keyInput.value.trim();
    if (!key) {
      showOutput('Please enter a valid key.', true);
      return;
    }
    const val = hashTable.get(key);
    if (val === undefined) {
      showOutput(`Key "${key}" not found.`, true);
    } else {
      showOutput(`Value for key "${key}": "${val}".`);
    }
  });

  removeBtn.addEventListener('click', () => {
    const key = keyInput.value.trim();
    if (!key) {
      showOutput('Please enter a valid key.', true);
      return;
    }
    const removed = hashTable.remove(key);
    if (removed) {
      updateTableDisplay();
      showOutput(`Removed key "${key}" from the table.`);
    } else {
      showOutput(`Key "${key}" not found.`, true);
    }
  });

  clearBtn.addEventListener('click', () => {
    hashTable.clear();
    updateTableDisplay();
    showOutput('Hash table cleared.');
  });

  // Initialize display
  updateTableDisplay();
</script>

<footer>
  &copy; 2024 Hash Table Demo &mdash; Simple Separate Chaining Implementation
</footer>
</body>
</html>