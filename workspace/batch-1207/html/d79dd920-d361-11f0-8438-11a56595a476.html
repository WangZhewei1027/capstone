<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Recursion Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2rem;
    max-width: 600px;
  }
  h1 {
    text-align: center;
  }
  label, input, button {
    font-size: 1rem;
  }
  input {
    width: 100px;
    padding: 0.2rem;
  }
  button {
    padding: 0.3rem 1rem;
    margin-left: 0.5rem;
  }
  #output {
    margin-top: 1rem;
    padding: 1rem;
    background: #f0f0f0;
    white-space: pre-wrap;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  .stack-level {
    margin-left: 2rem;
    color: #555;
  }
</style>
</head>
<body>
  <h1>Recursion Demonstration</h1>
  <p>Calculate factorial using recursion and see the recursion call stack unfold.</p>

  <label for="number">Enter a number (0-12): </label>
  <input type="number" id="number" min="0" max="12" value="5" />
  <button id="calcBtn">Calculate Factorial</button>

  <div id="output" aria-live="polite"></div>

<script>
  // Recursive factorial function with trace of calls
  function factorial(n, depth = 0, trace = []) {
    trace.push(" ".repeat(depth * 2) + `factorial(${n}) called`);
    if (n === 0 || n === 1) {
      trace.push(" ".repeat(depth * 2) + `Base case reached, factorial(${n}) = 1`);
      return { value: 1, trace };
    }
    const result = factorial(n - 1, depth + 1, trace);
    const val = n * result.value;
    trace.push(" ".repeat(depth * 2) + `Return factorial(${n}) = ${n} * factorial(${n-1}) = ${val}`);
    return { value: val, trace };
  }

  function displayTrace(trace) {
    // Format output with indentation and arrows
    return trace.map(line => line).join("\n");
  }

  document.getElementById("calcBtn").addEventListener("click", () => {
    const input = document.getElementById("number");
    const output = document.getElementById("output");
    let n = parseInt(input.value, 10);
    if (isNaN(n) || n < 0 || n > 12) {
      output.textContent = "Please enter a valid number between 0 and 12.";
      return;
    }
    output.textContent = "Calculating...";
    setTimeout(() => {
      const { value, trace } = factorial(n);
      output.textContent = displayTrace(trace) + `\n\nFinal Result: factorial(${n}) = ${value}`;
    }, 100); // small delay to show "Calculating..."
  });
</script>
</body>
</html>