<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Regression Demonstration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .canvas-container {
            position: relative;
            margin: 20px 0;
        }
        canvas {
            border: 1px solid #ddd;
            background-color: #fafafa;
            cursor: crosshair;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        button {
            padding: 8px 15px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button.clear {
            background-color: #e74c3c;
        }
        button.clear:hover {
            background-color: #c0392b;
        }
        .equation {
            font-family: monospace;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .info {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f4f8;
            border-radius: 5px;
        }
        .dot-count {
            margin: 10px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Linear Regression Demonstration</h1>
        
        <div class="info">
            <p><strong>Linear Regression</strong> is a statistical method used to model the relationship between a dependent variable (y) and one or more independent variables (x).</p>
            <p><strong>Equation:</strong> y = mx + b, where m is the slope and b is the y-intercept.</p>
            <p><strong>Instructions:</strong> Click on the canvas to add data points. Watch as the linear regression line adjusts to best fit your data.</p>
        </div>
        
        <div class="dot-count">Data Points: <span id="pointCount">0</span></div>
        
        <div class="canvas-container">
            <canvas id="regressionCanvas" width="800" height="400"></canvas>
        </div>
        
        <div class="equation">
            <strong>Regression Line Equation: </strong>
            <span id="equationText">y = 0x + 0</span>
        </div>
        
        <div class="controls">
            <button id="addRandom">Add Random Points</button>
            <button id="clearPoints" class="clear">Clear All Points</button>
            <button id="showHelp">Show Explanation</button>
        </div>
        
        <div id="explanation" style="display: none;">
            <h3>How Linear Regression Works</h3>
            <p>Linear regression finds the line that minimizes the sum of squared differences between the actual data points and the predicted values on the line.</p>
            <p><strong>Formula for slope (m):</strong> m = Σ((x - x̄)(y - ȳ)) / Σ((x - x̄)²)</p>
            <p><strong>Formula for y-intercept (b):</strong> b = ȳ - m * x̄</p>
            <p>Where x̄ and ȳ are the mean values of x and y respectively.</p>
        </div>
    </div>

    <script>
        // Canvas and context
        const canvas = document.getElementById('regressionCanvas');
        const ctx = canvas.getContext('2d');
        
        // Data points
        let points = [];
        
        // Canvas dimensions
        const canvasWidth = canvas.width;
        const canvasHeight = canvas.height;
        
        // Draw coordinate system
        function drawCoordinateSystem() {
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);
            
            // Draw grid
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 0.5;
            
            // Vertical grid lines
            for (let x = 0; x <= canvasWidth; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvasHeight);
                ctx.stroke();
            }
            
            // Horizontal grid lines
            for (let y = 0; y <= canvasHeight; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvasWidth, y);
                ctx.stroke();
            }
            
            // Draw axes
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            
            // X-axis
            ctx.beginPath();
            ctx.moveTo(0, canvasHeight / 2);
            ctx.lineTo(canvasWidth, canvasHeight / 2);
            ctx.stroke();
            
            // Y-axis
            ctx.beginPath();
            ctx.moveTo(canvasWidth / 2, 0);
            ctx.lineTo(canvasWidth / 2, canvasHeight);
            ctx.stroke();
            
            // Draw axis labels
            ctx.fillStyle = '#000';
            ctx.font = '14px Arial';
            ctx.fillText('x', canvasWidth - 10, canvasHeight / 2 - 10);
            ctx.fillText('y', canvasWidth / 2 + 10, 10);
        }
        
        // Convert canvas coordinates to mathematical coordinates
        function toMathCoords(canvasX, canvasY) {
            const mathX = (canvasX - canvasWidth / 2) / 50;
            const mathY = (canvasHeight / 2 - canvasY) / 50;
            return { x: mathX, y: mathY };
        }
        
        // Convert mathematical coordinates to canvas coordinates
        function toCanvasCoords(mathX, mathY) {
            const canvasX = mathX * 50 + canvasWidth / 2;
            const canvasY = canvasHeight / 2 - mathY * 50;
            return { x: canvasX, y: canvasY };
        }
        
        // Draw data points
        function drawPoints() {
            points.forEach(point => {
                const canvasCoords = toCanvasCoords(point.x, point.y);
                
                ctx.fillStyle = '#e74c3c';
                ctx.beginPath();
                ctx.arc(canvasCoords.x, canvasCoords.y, 5, 0, 2 * Math.PI);
                ctx.fill();
            });
        }
        
        // Calculate linear regression
        function calculateRegression() {
            if (points.length < 2) return { m: 0, b: 0 };
            
            // Calculate mean of x and y
            const meanX = points.reduce((sum, point) => sum + point.x, 0) / points.length;
            const meanY = points.reduce((sum, point) => sum + point.y, 0) / points.length;
            
            // Calculate slope (m) and y-intercept (b)
            let numerator = 0;
            let denominator = 0;
            
            points.forEach(point => {
                numerator += (point.x - meanX) * (point.y - meanY);
                denominator += (point.x - meanX) * (point.x - meanX);
            });
            
            const m = denominator !== 0 ? numerator / denominator : 0;
            const b = meanY - m * meanX;
            
            return { m, b };
        }
        
        // Draw regression line
        function drawRegressionLine() {
            const { m, b } = calculateRegression();
            
            // Calculate endpoints of the line for the visible canvas
            const leftX = -canvasWidth / (2 * 50);  // Left edge in math coordinates
            const rightX = canvasWidth / (2 * 50);   // Right edge in math coordinates
            
            const leftY = m * leftX + b;
            const rightY = m * rightX + b;
            
            const leftCanvas = toCanvasCoords(leftX, leftY);
            const rightCanvas = toCanvasCoords(rightX, rightY);
            
            // Draw the line
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(leftCanvas.x, leftCanvas.y);
            ctx.lineTo(rightCanvas.x, rightCanvas.y);
            ctx.stroke();
            
            // Update equation text
            document.getElementById('equationText').textContent = 
                `y = ${m.toFixed(2)}x + ${b.toFixed(2)}`;
        }
        
        // Add a point at clicked location
        function addPoint(event) {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            const mathCoords = toMathCoords(x, y);
            points.push({ x: mathCoords.x, y: mathCoords.y });
            
            updateDisplay();
        }
        
        // Add random points
        function addRandomPoints() {
            for (let i = 0; i < 10; i++) {
                const x = (Math.random() - 0.5) * 10; // -5 to 5
                const y = (Math.random() - 0.5) * 10; // -5 to 5
                points.push({ x, y });
            }
            updateDisplay();
        }
        
        // Clear all points
        function clearPoints() {
            points = [];
            updateDisplay();
        }
        
        // Update the display
        function updateDisplay() {
            drawCoordinateSystem();
            drawPoints();
            
            if (points.length >= 2) {
                drawRegressionLine();
            }
            
            document.getElementById('pointCount').textContent = points.length;
        }
        
        // Toggle help explanation
        function toggleExplanation() {
            const explanation = document.getElementById('explanation');
            explanation.style.display = explanation.style.display === 'none' ? 'block' : 'none';
        }
        
        // Initialize
        drawCoordinateSystem();
        
        // Event listeners
        canvas.addEventListener('click', addPoint);
        document.getElementById('addRandom').addEventListener('click', addRandomPoints);
        document.getElementById('clearPoints').addEventListener('click', clearPoints);
        document.getElementById('showHelp').addEventListener('click', toggleExplanation);
    </script>
</body>
</html>