<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Binary Search Tree</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 24px;
            background-color: #f0f0f0;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .tree-container {
            border: 1px solid #ccc;
            padding: 16px;
            border-radius: 8px;
            background-color: #fff;
            position: relative;
            height: 400px;
            overflow: hidden;
        }
        .node {
            position: absolute;
            background: #4caf50;
            border-radius: 50%;
            color: white;
            width: 30px;
            height: 30px;
            text-align: center;
            line-height: 30px;
            transition: transform 0.3s ease;
        }
        .controls {
            text-align: center;
            margin: 16px 0;
        }
        .input-number {
            padding: 8px;
            font-size: 16px;
        }
        .button {
            margin-left: 8px;
            padding: 8px 12px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
        }
        .button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Interactive Binary Search Tree (BST)</h1>
        <p>Understand the structure and function of a Binary Search Tree through hands-on interaction.</p>

        <div class="controls">
            <input type="number" id="nodeValue" class="input-number" placeholder="Enter a number">
            <button class="button" onclick="insertNode()">Insert Node</button>
            <button class="button" onclick="resetTree()">Reset Tree</button>
        </div>

        <div class="tree-container" id="treeContainer"></div>
    </div>

    <script>
        class BSTNode {
            constructor(value) {
                this.value = value;
                this.left = null;
                this.right = null;
            }
        }

        class BST {
            constructor() {
                this.root = null;
            }
            insert(value) {
                const newNode = new BSTNode(value);
                if (!this.root) {
                    this.root = newNode;
                    return this;
                }
                let current = this.root;
                while (true) {
                    if (value < current.value) {
                        if (!current.left) {
                            current.left = newNode;
                            return this;
                        }
                        current = current.left;
                    } else {
                        if (!current.right) {
                            current.right = newNode;
                            return this;
                        }
                        current = current.right;
                    }
                }
            }
        }

        const bst = new BST();
        const treeContainer = document.getElementById('treeContainer');

        function insertNode() {
            const nodeValue = parseInt(document.getElementById('nodeValue').value);
            if (isNaN(nodeValue)) return alert("Please enter a valid number.");

            bst.insert(nodeValue);
            drawTree(bst.root, treeContainer.clientWidth / 2, 30, treeContainer.clientWidth / 4);
        }

        function drawTree(node, x, y, offset) {
            if (!node) return;

            const nodeDiv = document.createElement('div');
            nodeDiv.textContent = node.value;
            nodeDiv.className = 'node';
            nodeDiv.style.left = `${x}px`;
            nodeDiv.style.top = `${y}px`;
            treeContainer.appendChild(nodeDiv);

            const nodeOffset = offset / 2;

            if (node.left) {
                drawLine(x, y, x - offset, y + 60);
                drawTree(node.left, x - offset, y + 60, nodeOffset);
            }
            if (node.right) {
                drawLine(x, y, x + offset, y + 60);
                drawTree(node.right, x + offset, y + 60, nodeOffset);
            }
        }

        function drawLine(x1, y1, x2, y2) {
            const line = document.createElement('div');
            const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            line.style.position = 'absolute';
            line.style.left = `${x1}px`;
            line.style.top = `${y1}px`;
            line.style.width = `${length}px`;
            line.style.height = '2px';
            line.style.backgroundColor = '#000';
            line.style.transformOrigin = '0 0';
            line.style.transform = `rotate(${angle}deg)`;
            treeContainer.appendChild(line);
        }

        function resetTree() {
            bst.root = null;
            treeContainer.innerHTML = '';
        }
    </script>


  <script id="fsm" type="application/json">
    {
  "topic": "Interactive Application",
  "description": "Finite State Machine for an interactive Binary Search Tree (BST) web app that lets users insert nodes and reset the tree, with validation and rendering states.",
  "states": [
    {
      "name": "idle",
      "onEnter": "set_idle",
      "on": {
        "CLICK_INSERT": "validating_input",
        "CLICK_RESET": "tree_resetting"
      }
    },
    {
      "name": "validating_input",
      "onEnter": "parse_input_and_validate",
      "on": {
        "INPUT_INVALID": "error_alert",
        "INPUT_VALID": "inserting_node"
      }
    },
    {
      "name": "error_alert",
      "onEnter": "alert_invalid_number",
      "on": {
        "ALERT_DISMISSED": "idle"
      }
    },
    {
      "name": "inserting_node",
      "onEnter": "perform_bst_insert",
      "on": {
        "BST_INSERTED": "drawing_tree"
      }
    },
    {
      "name": "drawing_tree",
      "onEnter": "render_bst",
      "on": {
        "TREE_RENDERED": "idle"
      }
    },
    {
      "name": "tree_resetting",
      "onEnter": "reset_bst",
      "on": {
        "RESET_DONE": "idle"
      }
    }
  ],
  "events": [
    "CLICK_INSERT",
    "CLICK_RESET",
    "INPUT_VALID",
    "INPUT_INVALID",
    "ALERT_DISMISSED",
    "BST_INSERTED",
    "TREE_RENDERED",
    "RESET_DONE"
  ],
  "notes": "Mapping to code: CLICK_INSERT is triggered by the Insert Node button (onclick=insertNode). validating_input corresponds to reading document.getElementById('nodeValue').value, parseInt, and isNaN checks inside insertNode. INPUT_INVALID triggers error_alert, which onEnter calls alert('Please enter a valid number.') and transitions back to idle when the alert is dismissed (ALERT_DISMISSED). INPUT_VALID transitions to inserting_node, which onEnter runs bst.insert(nodeValue); BST_INSERTED fires when insertion returns. drawing_tree onEnter calls drawTree(bst.root, treeContainer.clientWidth/2, 30, treeContainer.clientWidth/4), which synchronously creates node and line elements (drawLine). TREE_RENDERED fires after drawTree finishes. CLICK_RESET triggers tree_resetting, which onEnter runs resetTree() (bst.root = null; treeContainer.innerHTML = '') and RESET_DONE then returns to idle. Rendering uses immediate DOM updates; there are no asynchronous animations, although .node has a CSS transition for transform that is not programmatically used. The FSM abstracts sequential steps inside insertNode into distinct states for clarity."
}
  </script>
</body>
</html>