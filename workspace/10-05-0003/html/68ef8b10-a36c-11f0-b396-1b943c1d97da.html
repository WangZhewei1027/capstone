<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Binary Search Visualizer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --accent: #60a5fa;
      --accent2: #22c55e;
      --warn: #f59e0b;
      --danger: #ef4444;
      --range: #1f2937;
      --out: #0b1020;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, #0b1225, var(--bg));
      color: var(--text);
    }
    header {
      padding: 20px 16px;
      text-align: center;
      border-bottom: 1px solid #1f2937;
      background: #0b1225ad;
      position: sticky;
      top: 0;
      backdrop-filter: blur(6px);
    }
    header h1 {
      margin: 0;
      font-size: 24px;
      letter-spacing: 0.5px;
    }
    header p {
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 14px;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px 16px 40px;
    }
    .card {
      background: var(--panel);
      border: 1px solid #1f2937;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.03);
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }
    .row .field {
      flex: 1 1 220px;
      min-width: 200px;
    }
    label {
      display: block;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
      letter-spacing: 0.2px;
    }
    input[type="text"], input[type="number"] {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #334155;
      background: #0b1020;
      color: var(--text);
      outline: none;
      transition: border-color 0.15s ease;
    }
    input[type="text"]:focus, input[type="number"]:focus {
      border-color: var(--accent);
    }
    .options {
      display: flex;
      gap: 14px;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 6px;
    }
    .checkbox {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: var(--muted);
      font-size: 13px;
      cursor: pointer;
    }
    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    button {
      border: 1px solid #334155;
      background: #0b1020;
      color: var(--text);
      padding: 8px 12px;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.05s ease, border-color 0.15s ease, background 0.15s ease;
      user-select: none;
    }
    button:hover { border-color: var(--accent); }
    button:active { transform: translateY(1px); }
    button.primary {
      background: linear-gradient(180deg, #1e3a8a, #0b2d63);
      border-color: #1d4ed8;
    }
    button.success {
      background: linear-gradient(180deg, #166534, #124c2b);
      border-color: #16a34a;
    }
    button.warn {
      background: linear-gradient(180deg, #92400e, #6b2f0a);
      border-color: #f59e0b;
    }
    button.danger {
      background: linear-gradient(180deg, #7f1d1d, #5b1212);
      border-color: #ef4444;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .speed {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: var(--muted);
      font-size: 12px;
      margin-left: auto;
    }
    input[type="range"] {
      width: 180px;
    }

    /* Visualizer */
    .array-wrap {
      overflow-x: auto;
      padding-bottom: 10px;
    }
    .array {
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: minmax(56px, 1fr);
      gap: 10px;
      align-items: end;
      margin-top: 8px;
      padding: 12px;
      border-radius: 14px;
      background: linear-gradient(180deg, #0b1020, #0d1224);
      border: 1px solid #1f2937;
    }
    .cell {
      position: relative;
      border-radius: 10px;
      padding: 10px 8px 18px;
      text-align: center;
      color: var(--text);
      background: var(--range);
      border: 2px solid transparent;
      transition: background 0.15s ease, transform 0.15s ease, border-color 0.1s ease, opacity 0.15s ease;
      min-height: 58px;
    }
    .cell .val {
      font-weight: 600;
      font-size: 16px;
    }
    .cell .idx {
      position: absolute;
      bottom: 4px;
      left: 0;
      right: 0;
      font-size: 11px;
      color: var(--muted);
    }
    .cell.out {
      background: var(--out);
      opacity: 0.5;
    }
    .cell.low::before, .cell.high::before {
      content: attr(data-flag);
      position: absolute;
      top: -10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      color: var(--accent);
      background: #0b1020;
      border: 1px solid #1f2937;
      padding: 2px 6px;
      border-radius: 10px;
    }
    .cell.low { border-color: #1d4ed8aa; }
    .cell.high { border-color: #1d4ed8aa; }
    .cell.mid {
      border-color: #22c55e;
      box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.35);
      transform: translateY(-2px);
    }
    .cell.found {
      background: #064e3b;
      border-color: var(--accent2);
      box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.6);
      transform: translateY(-4px) scale(1.03);
    }
    .legend {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin-top: 10px;
      color: var(--muted);
      font-size: 12px;
    }
    .legend .dot {
      width: 10px; height: 10px; border-radius: 50%;
      display: inline-block; margin-right: 6px; vertical-align: middle;
    }
    .dot-range { background: #1f2937; }
    .dot-out { background: #0b1020; }
    .dot-mid { background: #22c55e; }
    .dot-found { background: #16a34a; }

    /* Status and logs */
    .status {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin-top: 12px;
    }
    .status .item {
      background: #0b1020;
      border: 1px solid #1f2937;
      border-radius: 10px;
      padding: 10px;
      min-height: 56px;
    }
    .status .item .label {
      font-size: 11px;
      color: var(--muted);
    }
    .status .item .value {
      margin-top: 6px;
      font-size: 16px;
      font-weight: 600;
    }
    .log {
      max-height: 220px;
      overflow: auto;
      background: #0b1020;
      border: 1px solid #1f2937;
      border-radius: 10px;
      padding: 8px 10px;
      font-size: 13px;
    }
    .log p {
      margin: 6px 0;
      color: #cbd5e1;
    }
    .log .ok { color: #86efac; }
    .log .warn { color: #fbbf24; }
    .log .bad { color: #fca5a5; }

    .footer {
      color: var(--muted);
      font-size: 12px;
      margin-top: 8px;
    }
    .code {
      background: #0b1020;
      border: 1px solid #1f2937;
      border-radius: 10px;
      padding: 10px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      overflow: auto;
      max-height: 240px;
    }
    .inline-hint {
      color: var(--muted);
      font-size: 12px;
      margin-left: 6px;
    }
    .small {
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <header>
    <h1>Binary Search Visualizer</h1>
    <p>Step through the classic O(log n) search on a sorted array. Enter numbers and a target, then watch how low, high, and mid change.</p>
  </header>

  <div class="container">
    <div class="card">
      <div class="row">
        <div class="field" style="flex: 2 1 420px;">
          <label>Array (comma or space separated numbers)</label>
          <input id="arrayInput" type="text" placeholder="Example: 1, 4, 7, 9, 12, 20" />
          <div class="options">
            <label class="checkbox"><input id="sortChk" type="checkbox" checked /> Sort ascending automatically</label>
            <label class="checkbox"><input id="uniqueChk" type="checkbox" /> Enforce unique values</label>
            <span class="inline-hint">Binary search requires a sorted array.</span>
          </div>
        </div>
        <div class="field">
          <label>Target</label>
          <input id="targetInput" type="number" placeholder="Enter a number (e.g., 12)" />
        </div>
      </div>

      <div class="controls">
        <button id="randomBtn" class="warn">Randomize</button>
        <button id="buildBtn" class="primary">Build Array</button>
        <button id="startBtn" class="success">Start</button>
        <button id="stepBtn">Step</button>
        <button id="pauseBtn">Pause</button>
        <button id="resetBtn" class="danger">Reset</button>
        <span class="speed">
          Speed
          <input id="speedRange" type="range" min="100" max="1500" step="50" value="600" />
        </span>
      </div>
    </div>

    <div class="card">
      <div class="array-wrap">
        <div id="arrayView" class="array" aria-label="Array visualization"></div>
      </div>

      <div class="legend">
        <div><span class="dot dot-range"></span> Active search range</div>
        <div><span class="dot dot-out"></span> Discarded</div>
        <div><span class="dot dot-mid" style="box-shadow: 0 0 0 2px rgba(34,197,94,.5)"></span> Mid</div>
        <div><span class="dot dot-found"></span> Found</div>
      </div>

      <div class="status">
        <div class="item"><div class="label">low index</div><div id="lowVal" class="value">-</div></div>
        <div class="item"><div class="label">high index</div><div id="highVal" class="value">-</div></div>
        <div class="item"><div class="label">mid index</div><div id="midVal" class="value">-</div></div>
        <div class="item"><div class="label">mid value</div><div id="midValue" class="value">-</div></div>
        <div class="item"><div class="label">steps</div><div id="stepsVal" class="value">0</div></div>
      </div>
    </div>

    <div class="card">
      <div class="row" style="align-items:flex-start;">
        <div class="field" style="flex: 2 1 520px;">
          <label>Search Log</label>
          <div id="logView" class="log" aria-live="polite"></div>
        </div>
        <div class="field" style="flex: 1 1 320px;">
          <label>Binary Search (JavaScript)</label>
          <pre class="code">// Iterative binary search (ascending array)
function binarySearch(arr, target) {
  let low = 0;
  let high = arr.length - 1;
  while (low <= high) {
    // Safe mid calculation
    const mid = low + Math.floor((high - low) / 2);
    if (arr[mid] === target) return mid;
    if (arr[mid] < target) low = mid + 1;
    else high = mid - 1;
  }
  return -1;
}

// Complexity
// Time: O(log n)
// Space: O(1)</pre>
          <div class="footer">Tip: Binary search halves the range each step. If the array isn't sorted, the result is undefined.</div>
        </div>
      </div>
    </div>

    <div class="small">Keyboard: Enter to Build, Space to Start/Pause, Right Arrow to Step.</div>
  </div>

  <script>
    (function(){
      const el = id => document.getElementById(id);

      const state = {
        arr: [],
        target: null,
        low: null,
        high: null,
        mid: null,
        steps: 0,
        running: false,
        timer: null,
        speed: 600,
        foundIndex: -1,
        built: false
      };

      const arrayInput = el('arrayInput');
      const targetInput = el('targetInput');
      const sortChk = el('sortChk');
      const uniqueChk = el('uniqueChk');

      const arrayView = el('arrayView');
      const logView = el('logView');

      const lowVal = el('lowVal');
      const highVal = el('highVal');
      const midVal = el('midVal');
      const midValue = el('midValue');
      const stepsVal = el('stepsVal');

      const randomBtn = el('randomBtn');
      const buildBtn = el('buildBtn');
      const startBtn = el('startBtn');
      const stepBtn = el('stepBtn');
      const pauseBtn = el('pauseBtn');
      const resetBtn = el('resetBtn');
      const speedRange = el('speedRange');

      // Utility functions
      function parseArrayInput(text) {
        if (!text) return [];
        const parts = text.split(/[,\s]+/).filter(Boolean);
        const nums = [];
        for (const p of parts) {
          const n = Number(p);
          if (!Number.isFinite(n)) continue;
          nums.push(n);
        }
        return nums;
      }

      function uniqueSorted(arr) {
        const set = new Set(arr);
        return Array.from(set).sort((a,b)=>a-b);
      }

      function ensureSorted(arr) {
        return arr.slice().sort((a,b)=>a-b);
      }

      function renderArray() {
        arrayView.innerHTML = '';
        if (!state.arr.length) {
          const emptyMsg = document.createElement('div');
          emptyMsg.style.color = '#94a3b8';
          emptyMsg.style.padding = '12px';
          emptyMsg.textContent = 'No array built yet. Enter numbers above and press Build Array or Randomize.';
          arrayView.appendChild(emptyMsg);
          return;
        }
        state.arr.forEach((val, idx) => {
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.dataset.index = String(idx);
          cell.innerHTML = `
            <div class="val">${val}</div>
            <div class="idx">index ${idx}</div>
          `;
          arrayView.appendChild(cell);
        });
        updateRangeHighlights();
      }

      function updateRangeHighlights() {
        const cells = [...arrayView.children].filter(c => c.classList.contains('cell'));
        cells.forEach((cell, idx) => {
          cell.classList.remove('out', 'low', 'high', 'mid', 'found');
          cell.removeAttribute('data-flag');
          // Out of range
          if (state.low == null || state.high == null || idx < state.low || idx > state.high) {
            cell.classList.add('out');
          }
          // low/high flags inside range
          if (state.low != null && idx === state.low) {
            cell.classList.add('low');
            cell.setAttribute('data-flag', 'low');
          }
          if (state.high != null && idx === state.high) {
            cell.classList.add('high');
            cell.setAttribute('data-flag', 'high');
          }
          if (state.mid != null && idx === state.mid) {
            cell.classList.add('mid');
          }
          if (state.foundIndex !== -1 && idx === state.foundIndex) {
            cell.classList.add('found');
          }
        });

        lowVal.textContent = state.low == null ? '-' : String(state.low);
        highVal.textContent = state.high == null ? '-' : String(state.high);
        midVal.textContent = state.mid == null ? '-' : String(state.mid);
        midValue.textContent = (state.mid == null || state.mid < 0 || state.mid >= state.arr.length) ? '-' : String(state.arr[state.mid]);
        stepsVal.textContent = String(state.steps);
      }

      function log(msg, cls) {
        const p = document.createElement('p');
        if (cls) p.classList.add(cls);
        p.textContent = msg;
        logView.appendChild(p);
        logView.scrollTop = logView.scrollHeight;
      }

      // Binary search step
      function nextStep() {
        if (!state.arr.length || state.target == null) {
          log('Provide an array and a target first.', 'bad');
          return;
        }
        if (state.foundIndex !== -1) {
          log(`Search already finished: found ${state.target} at index ${state.foundIndex}.`, 'ok');
          stopRunning();
          return;
        }
        if (state.low > state.high) {
          log(`Stopped: low (${state.low}) > high (${state.high}). Target ${state.target} not found.`, 'bad');
          stopRunning();
          return;
        }

        state.mid = state.low + Math.floor((state.high - state.low) / 2);
        const midVal = state.arr[state.mid];
        state.steps += 1;
        updateRangeHighlights();

        if (midVal === state.target) {
          log(`Step ${state.steps}: mid=${state.mid} value=${midVal} → FOUND!`, 'ok');
          state.foundIndex = state.mid;
          updateRangeHighlights();
          stopRunning();
          return;
        }

        if (midVal < state.target) {
          log(`Step ${state.steps}: mid=${state.mid} value=${midVal} < target=${state.target} → discard left half (low=mid+1).`, 'warn');
          state.low = state.mid + 1;
        } else {
          log(`Step ${state.steps}: mid=${state.mid} value=${midVal} > target=${state.target} → discard right half (high=mid-1).`, 'warn');
          state.high = state.mid - 1;
        }

        updateRangeHighlights();

        if (state.low > state.high) {
          log(`Now low (${state.low}) > high (${state.high}). Target ${state.target} not found.`, 'bad');
          stopRunning();
        }
      }

      // Controls
      function startRunning() {
        if (state.running) return;
        if (!state.arr.length) {
          log('Build an array before starting.', 'bad');
          return;
        }
        if (state.target == null || !Number.isFinite(state.target)) {
          log('Enter a valid numeric target.', 'bad');
          return;
        }
        state.running = true;
        updateButtons();
        state.timer = setInterval(() => {
          nextStep();
          if (state.foundIndex !== -1 || state.low > state.high) {
            stopRunning();
          }
        }, state.speed);
      }

      function stopRunning() {
        state.running = false;
        if (state.timer) {
          clearInterval(state.timer);
          state.timer = null;
        }
        updateButtons();
      }

      function resetAll(hard=false) {
        stopRunning();
        state.low = null;
        state.high = null;
        state.mid = null;
        state.steps = 0;
        state.foundIndex = -1;
        if (hard) {
          state.arr = [];
          state.target = null;
          arrayInput.value = '';
          targetInput.value = '';
          state.built = false;
        }
        renderArray();
        logView.innerHTML = '';
        updateButtons();
      }

      function buildFromInputs() {
        const nums = parseArrayInput(arrayInput.value);
        if (!nums.length) {
          log('Please enter at least one valid number.', 'bad');
          return;
        }
        let arr = nums.slice();
        if (uniqueChk.checked) arr = uniqueSorted(arr);
        if (sortChk.checked) arr = ensureSorted(arr);

        // Initialize search bounds
        state.arr = arr;
        state.low = 0;
        state.high = arr.length - 1;
        state.mid = null;
        state.steps = 0;
        state.foundIndex = -1;
        state.built = true;
        renderArray();

        // Parse target
        const tgt = Number(targetInput.value);
        state.target = Number.isFinite(tgt) ? tgt : null;

        logView.innerHTML = '';
        log(`Array built: [${state.arr.join(', ')}]`, 'ok');
        if (state.target != null) {
          log(`Target set to ${state.target}. Press Start or Step.`, 'ok');
        } else {
          log('No target yet. Enter a target number and press Start or Step.', 'warn');
        }
        updateButtons();
      }

      function randomize() {
        stopRunning();
        const len = Math.floor(Math.random() * 9) + 7; // 7..15
        const base = Math.floor(Math.random() * 20);
        const stepMin = 1;
        const stepMax = 12;
        // Build strictly increasing sequence
        const arr = [];
        let curr = base;
        for (let i = 0; i < len; i++) {
          curr += Math.floor(Math.random() * (stepMax - stepMin + 1)) + stepMin;
          arr.push(curr);
        }
        arrayInput.value = arr.join(', ');
        // Choose a target that is sometimes in array and sometimes not
        const chooseExisting = Math.random() < 0.7;
        const target = chooseExisting ? arr[Math.floor(Math.random() * arr.length)]
                                      : arr[0] - 1 + Math.floor(Math.random()*20);
        targetInput.value = target;
        sortChk.checked = true;
        uniqueChk.checked = true;

        buildFromInputs();
      }

      function updateButtons() {
        startBtn.disabled = !state.built || state.running || state.foundIndex !== -1 || (state.low != null && state.low > state.high);
        stepBtn.disabled  = !state.built || state.running || state.foundIndex !== -1 || (state.low != null && state.low > state.high);
        pauseBtn.disabled = !state.running;
      }

      // Event bindings
      randomBtn.addEventListener('click', randomize);
      buildBtn.addEventListener('click', buildFromInputs);

      startBtn.addEventListener('click', startRunning);
      stepBtn.addEventListener('click', nextStep);
      pauseBtn.addEventListener('click', stopRunning);
      resetBtn.addEventListener('click', () => resetAll(true));

      speedRange.addEventListener('input', () => {
        state.speed = Number(speedRange.value);
        if (state.running) {
          stopRunning();
          startRunning();
        }
      });

      arrayInput.addEventListener('input', () => { state.built = false; updateButtons(); });
      targetInput.addEventListener('input', () => {
        const t = Number(targetInput.value);
        state.target = Number.isFinite(t) ? t : null;
      });

      // Keyboard shortcuts
      document.addEventListener('keydown', (e) => {
        const tag = e.target.tagName.toLowerCase();
        const typing = tag === 'input' || tag === 'textarea';
        if (e.key === 'Enter' && !typing) {
          e.preventDefault();
          buildFromInputs();
        } else if (e.key === ' ' && !typing) {
          e.preventDefault();
          if (state.running) stopRunning(); else startRunning();
        } else if (e.key === 'ArrowRight' && !typing) {
          e.preventDefault();
          nextStep();
        }
      });

      // Initialize with a demo array
      function initDemo() {
        const demo = [2, 5, 7, 11, 14, 18, 21, 24, 30, 33, 39];
        arrayInput.value = demo.join(', ');
        targetInput.value = 24;
        sortChk.checked = true;
        uniqueChk.checked = true;
        buildFromInputs();
      }
      initDemo();
    })();
  </script>
</body>
</html>