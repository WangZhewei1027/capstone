<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Selection Sort Visualizer</title>
<style>
  :root {
    --bg: #0f1420;
    --panel: #151d2c;
    --accent: #4db5ff;
    --text: #e6edf3;
    --muted: #9fb0c3;
    --sorted: #4caf50;
    --current: #1976d2;
    --min: #e53935;
    --scan: #fb8c00;
    --bar: #90a4ae;
    --swap: #ff5370;
  }
  * { box-sizing: border-box; }
  body {
    margin: 0; padding: 16px;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
    background: linear-gradient(180deg, #0d1220, #0f1420);
    color: var(--text);
  }
  h1 {
    font-weight: 700; letter-spacing: 0.2px; margin: 0 0 8px 0;
  }
  .sub {
    color: var(--muted); margin-bottom: 16px; font-size: 14px;
  }
  .container {
    display: grid; gap: 12px;
    grid-template-columns: 1fr;
    max-width: 1000px; margin: 0 auto;
  }
  .panel {
    background: var(--panel);
    border: 1px solid #1f2a42;
    border-radius: 12px;
    padding: 12px;
  }
  .controls {
    display: grid; gap: 8px;
    grid-template-columns: repeat(12, 1fr);
    align-items: center;
  }
  .controls .wide { grid-column: span 12; }
  .controls .half { grid-column: span 6; }
  .controls .third { grid-column: span 4; }
  .controls .two { grid-column: span 2; }
  .controls .three { grid-column: span 3; }
  .controls label {
    font-size: 12px; color: var(--muted);
  }
  input[type="text"], input[type="number"], input[type="range"], select {
    width: 100%; padding: 8px; border-radius: 8px;
    border: 1px solid #27324a; background: #0f1626; color: var(--text);
  }
  .btn {
    width: 100%; padding: 10px 12px; border-radius: 10px; border: none;
    background: #203555; color: var(--text); cursor: pointer;
    transition: transform 0.05s ease, filter 0.1s ease;
  }
  .btn:hover { filter: brightness(1.15); }
  .btn:active { transform: scale(0.98); }
  .btn.primary { background: #2563eb; }
  .btn.warn { background: #e53935; }
  .btn.secondary { background: #11519c; }
  .row { display: flex; gap: 8px; align-items: center; }
  .stats {
    display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;
  }
  .stat {
    background: #0f1626; border: 1px solid #27324a; border-radius: 10px;
    padding: 10px;
  }
  .stat .k { font-size: 12px; color: var(--muted); }
  .stat .v { font-size: 16px; font-weight: 700; }
  .viz-wrap {
    display: grid; grid-template-columns: 1fr; gap: 12px;
  }
  .bar-legend { display: flex; gap: 12px; flex-wrap: wrap; font-size: 12px; color: var(--muted); }
  .legend-item { display: inline-flex; align-items: center; gap: 6px; }
  .dot { width: 14px; height: 14px; border-radius: 4px; display: inline-block; }
  .bars {
    position: relative;
    height: 300px;
    background: #0c1322;
    border: 1px solid #1f2a42;
    border-radius: 12px;
    overflow: hidden;
    padding: 8px;
    display: flex;
    align-items: flex-end;
    gap: 4px;
  }
  .bar {
    flex: 1 1 auto;
    min-width: 16px;
    display: flex; align-items: flex-end; justify-content: center;
    position: relative;
    transition: transform 0.2s ease;
  }
  .bar-rect {
    width: 100%;
    border-radius: 6px 6px 0 0;
    background: var(--bar);
    transition: height 0.25s ease, background 0.15s ease, filter 0.1s ease, transform 0.2s ease;
  }
  .bar-label {
    position: absolute; bottom: 0; transform: translateY(100%);
    font-size: 12px; color: var(--muted);
    background: rgba(0,0,0,0.25); padding: 2px 6px; border-radius: 8px;
  }
  .bar.sorted .bar-rect { background: var(--sorted); }
  .bar.i .bar-rect { background: var(--current); }
  .bar.min .bar-rect { background: var(--min); }
  .bar.j .bar-rect { background: var(--scan); }
  .bar.swap .bar-rect { background: var(--swap); }
  .explain {
    font-size: 13px; color: var(--muted);
  }
  .explain ul { margin: 8px 0 0 18px; }
  .code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    background: #0c1322; border: 1px solid #1f2a42; border-radius: 12px;
    padding: 10px; font-size: 12px; color: #cbd5e1;
    white-space: pre;
  }
  .code .hl { background: rgba(66, 165, 245, 0.2); border-left: 3px solid #42a5f5; padding-left: 6px; }
  .footer {
    font-size: 12px; color: var(--muted); text-align: center; margin-top: 8px;
  }
  @media (max-width: 700px) {
    .controls .half, .controls .third, .controls .two, .controls .three { grid-column: span 12; }
    .stats { grid-template-columns: repeat(2, 1fr); }
  }
</style>
</head>
<body>
  <div class="container">
    <div class="panel">
      <h1>Selection Sort</h1>
      <div class="sub">Visual demonstration of the Selection Sort algorithm with step-by-step controls.</div>
      <div class="controls">
        <div class="wide">
          <label for="arrayInput">Array (comma or space separated)</label>
          <input id="arrayInput" type="text" placeholder="e.g. 64, 25, 12, 22, 11"/>
        </div>
        <div class="three">
          <label for="sizeInput">Size</label>
          <input id="sizeInput" type="number" min="3" max="50" value="12"/>
        </div>
        <div class="three">
          <label for="rangeInput">Max value</label>
          <input id="rangeInput" type="number" min="10" max="999" value="99"/>
        </div>
        <div class="three">
          <label>&nbsp;</label>
          <button id="randomBtn" class="btn">Random</button>
        </div>
        <div class="three">
          <label>&nbsp;</label>
          <button id="setBtn" class="btn secondary">Set Array</button>
        </div>
        <div class="three">
          <label for="speed">Speed</label>
          <input id="speed" type="range" min="0" max="100" value="50"/>
        </div>
        <div class="three">
          <label>&nbsp;</label>
          <button id="playPauseBtn" class="btn primary">Play</button>
        </div>
        <div class="three">
          <label>&nbsp;</label>
          <button id="stepBtn" class="btn">Step</button>
        </div>
        <div class="three">
          <label>&nbsp;</label>
          <button id="resetBtn" class="btn warn">Reset</button>
        </div>
      </div>
    </div>

    <div class="panel">
      <div class="stats">
        <div class="stat">
          <div class="k">Outer pass (i)</div>
          <div class="v" id="statI">0</div>
        </div>
        <div class="stat">
          <div class="k">Current scan (j)</div>
          <div class="v" id="statJ">—</div>
        </div>
        <div class="stat">
          <div class="k">Min index</div>
          <div class="v" id="statMin">—</div>
        </div>
        <div class="stat">
          <div class="k">Phase</div>
          <div class="v" id="statPhase">idle</div>
        </div>
        <div class="stat">
          <div class="k">Comparisons</div>
          <div class="v" id="statCmp">0</div>
        </div>
        <div class="stat">
          <div class="k">Swaps</div>
          <div class="v" id="statSwp">0</div>
        </div>
        <div class="stat">
          <div class="k">Array length</div>
          <div class="v" id="statN">0</div>
        </div>
        <div class="stat">
          <div class="k">Done</div>
          <div class="v" id="statDone">no</div>
        </div>
      </div>
    </div>

    <div class="panel viz-wrap">
      <div class="bar-legend">
        <span class="legend-item"><span class="dot" style="background: var(--sorted)"></span> Sorted</span>
        <span class="legend-item"><span class="dot" style="background: var(--current)"></span> Position i</span>
        <span class="legend-item"><span class="dot" style="background: var(--min)"></span> Current min</span>
        <span class="legend-item"><span class="dot" style="background: var(--scan)"></span> Scanning j</span>
        <span class="legend-item"><span class="dot" style="background: var(--swap)"></span> Swapping</span>
      </div>
      <div id="bars" class="bars" aria-label="Bars visualization"></div>
      <div class="explain">
        Selection Sort repeatedly selects the smallest remaining element and places it at the front.
        <ul>
          <li>Maintain position i where the next smallest element should go.</li>
          <li>Scan the unsorted tail [i+1..n-1] to find the minimum.</li>
          <li>Swap the found minimum with position i.</li>
          <li>Time complexity: O(n²), Space complexity: O(1), Not stable.</li>
        </ul>
      </div>
      <div class="code" id="code">
for i = 0 .. n-1:
    min = i
    for j = i+1 .. n-1:
        if A[j] < A[min]:
            min = j
    swap A[i], A[min]
      </div>
      <div class="footer">Tip: Edit the array, click Set Array or generate random, then Play or Step to watch the algorithm.</div>
    </div>
  </div>

<script>
(function(){
  "use strict";

  // State and configuration
  let initialArr = [];
  let arr = [];
  let playing = false;
  let timer = null;
  let speedMs = 250;
  const minDelay = 30, maxDelay = 900;

  const state = {
    i: 0,
    j: null,
    minIndex: null,
    phase: "idle", // idle | initPass | scan | updateMin | swap | done
    comparisons: 0,
    swaps: 0,
    done: false,
    lastActionSwapPair: null, // [i, minIndex] when swapping
  };

  // DOM elements
  const el = {
    arrayInput: document.getElementById("arrayInput"),
    sizeInput: document.getElementById("sizeInput"),
    rangeInput: document.getElementById("rangeInput"),
    randomBtn: document.getElementById("randomBtn"),
    setBtn: document.getElementById("setBtn"),
    playPauseBtn: document.getElementById("playPauseBtn"),
    stepBtn: document.getElementById("stepBtn"),
    resetBtn: document.getElementById("resetBtn"),
    speed: document.getElementById("speed"),
    bars: document.getElementById("bars"),
    statI: document.getElementById("statI"),
    statJ: document.getElementById("statJ"),
    statMin: document.getElementById("statMin"),
    statPhase: document.getElementById("statPhase"),
    statCmp: document.getElementById("statCmp"),
    statSwp: document.getElementById("statSwp"),
    statN: document.getElementById("statN"),
    statDone: document.getElementById("statDone"),
    code: document.getElementById("code"),
  };

  // Utility
  function clamp(x, a, b) { return Math.max(a, Math.min(b, x)); }
  function randInt(a, b){ return a + Math.floor(Math.random() * (b - a + 1)); }
  function parseArray(str) {
    const parts = str.split(/[, \t\n]+/).filter(Boolean);
    const nums = parts.map(p => Number(p)).filter(n => Number.isFinite(n));
    return nums;
  }
  function resetState() {
    state.i = 0;
    state.j = null;
    state.minIndex = null;
    state.phase = arr.length <= 1 ? "done" : "idle";
    state.comparisons = 0;
    state.swaps = 0;
    state.done = arr.length <= 1;
    state.lastActionSwapPair = null;
    updateStats();
    render();
  }

  // Visualization
  function render() {
    el.bars.innerHTML = "";
    const n = arr.length, maxVal = Math.max(...arr, 1);
    const minHeight = 6;
    const containerH = el.bars.clientHeight || 300;

    for (let idx = 0; idx < n; idx++) {
      const h = Math.round((arr[idx] / maxVal) * (containerH - 30)) + minHeight;

      const bar = document.createElement("div");
      bar.className = "bar";
      const rect = document.createElement("div");
      rect.className = "bar-rect";
      rect.style.height = h + "px";
      const label = document.createElement("div");
      label.className = "bar-label";
      label.textContent = arr[idx];

      // Color coding
      const classes = [];
      if (state.phase === "swap" && state.lastActionSwapPair &&
          (idx === state.lastActionSwapPair[0] || idx === state.lastActionSwapPair[1])) {
        classes.push("swap");
      } else {
        if (state.done || state.i >= arr.length - 1) {
          classes.push("sorted");
        } else {
          if (idx < state.i) classes.push("sorted");
          if (idx === state.i) classes.push("i");
          if (idx === state.minIndex) classes.push("min");
          if (idx === state.j) classes.push("j");
        }
      }

      bar.className += " " + classes.join(" ");
      bar.appendChild(rect);
      bar.appendChild(label);
      el.bars.appendChild(bar);
    }

    updateStats();
    highlightCode();
  }

  function updateStats() {
    el.statI.textContent = state.i ?? 0;
    el.statJ.textContent = state.j ?? "—";
    el.statMin.textContent = state.minIndex ?? "—";
    el.statPhase.textContent = state.phase;
    el.statCmp.textContent = state.comparisons;
    el.statSwp.textContent = state.swaps;
    el.statN.textContent = arr.length;
    el.statDone.textContent = state.done ? "yes" : "no";
  }

  function highlightCode() {
    // Simple heuristic: wrap lines with spans and mark one or two lines as highlighted based on phase.
    // Build content once and then adjust classes.
    if (!el.code.dataset.enhanced) {
      const lines = el.code.textContent.split("\n");
      el.code.innerHTML = lines.map((ln, i) => `<div data-l="${i+1}">${ln || "&nbsp;"}</div>`).join("");
      el.code.dataset.enhanced = "1";
    }
    const children = Array.from(el.code.children);
    children.forEach(ch => ch.classList.remove("hl"));

    const mapPhaseToLines = () => {
      // Lines:
      // 1: for i = 0 .. n-1:
      // 2:     min = i
      // 3:     for j = i+1 .. n-1:
      // 4:         if A[j] < A[min]:
      // 5:             min = j
      // 6:     swap A[i], A[min]
      switch (state.phase) {
        case "idle": return [1];
        case "initPass": return [1,2];
        case "scan": return [3,4];
        case "updateMin": return [5];
        case "swap": return [6];
        case "done": return [1];
        default: return [1];
      }
    };
    const lines = mapPhaseToLines();
    lines.forEach(l => {
      const node = children.find(ch => ch.dataset.l == String(l));
      if (node) node.classList.add("hl");
    });
  }

  // Selection sort step engine
  function startPass() {
    if (state.i >= arr.length - 1) {
      state.done = true;
      state.phase = "done";
      state.j = null;
      state.minIndex = null;
      return;
    }
    state.minIndex = state.i;
    state.j = state.i + 1;
    state.phase = "initPass";
  }

  function step() {
    if (state.done) return false;

    // If idle, initialize first pass
    if (state.phase === "idle") {
      startPass();
      render();
      return true;
    }

    // After initPass, move to scanning
    if (state.phase === "initPass") {
      state.phase = "scan";
      render();
      return true;
    }

    // Scan phase: compare A[j] with A[minIndex]
    if (state.phase === "scan") {
      if (state.j >= arr.length) {
        state.phase = "swap";
        state.lastActionSwapPair = [state.i, state.minIndex];
        render();
        return true;
      } else {
        // do one comparison
        state.comparisons++;
        if (arr[state.j] < arr[state.minIndex]) {
          state.minIndex = state.j;
          state.phase = "updateMin";
          render();
          return true;
        } else {
          state.j++;
          render();
          return true;
        }
      }
    }

    // Update min step is a visualization beat
    if (state.phase === "updateMin") {
      // After showing min update, continue scanning
      state.j++;
      state.phase = "scan";
      render();
      return true;
    }

    // Swap phase
    if (state.phase === "swap") {
      if (state.minIndex !== state.i) {
        // perform swap
        const t = arr[state.i];
        arr[state.i] = arr[state.minIndex];
        arr[state.minIndex] = t;
        state.swaps++;
      }
      // progress i
      state.i++;
      state.phase = "initPass";
      state.lastActionSwapPair = null;

      if (state.i >= arr.length - 1) {
        state.done = true;
        state.phase = "done";
        state.j = null;
        state.minIndex = null;
      } else {
        state.j = state.i + 1;
        state.minIndex = state.i;
      }

      render();
      return true;
    }

    return false;
  }

  // Controls
  function updateSpeedFromSlider() {
    const v = Number(el.speed.value); // 0..100
    // Map to delay (ms): faster towards 0
    const t = Math.round(maxDelay - (v/100)*(maxDelay - minDelay));
    speedMs = clamp(t, minDelay, maxDelay);
  }

  function play() {
    if (playing || state.done) return;
    playing = true;
    el.playPauseBtn.textContent = "Pause";
    tickLoop();
  }
  function pause() {
    playing = false;
    el.playPauseBtn.textContent = "Play";
    if (timer) { clearTimeout(timer); timer = null; }
  }
  function tickLoop() {
    if (!playing) return;
    const haveMore = step();
    if (!haveMore || state.done) {
      pause();
      render();
      return;
    }
    timer = setTimeout(tickLoop, speedMs);
  }
  function stepOnce() {
    pause();
    step();
  }

  function setArray(a) {
    initialArr = a.slice();
    arr = a.slice();
    resetState();
  }

  function randomArray(n, maxV) {
    const out = [];
    for (let i = 0; i < n; i++) {
      out.push(randInt(1, maxV));
    }
    return out;
  }

  function resetToInitial() {
    arr = initialArr.slice();
    pause();
    resetState();
  }

  // Wire events
  el.randomBtn.addEventListener("click", () => {
    const n = clamp(Number(el.sizeInput.value) || 12, 3, 50);
    const maxV = clamp(Number(el.rangeInput.value) || 99, 10, 999);
    const a = randomArray(n, maxV);
    el.arrayInput.value = a.join(", ");
    setArray(a);
  });

  el.setBtn.addEventListener("click", () => {
    const nums = parseArray(el.arrayInput.value);
    if (!nums.length) {
      alert("Please enter at least one number.");
      return;
    }
    setArray(nums);
  });

  el.playPauseBtn.addEventListener("click", () => {
    if (playing) pause(); else play();
  });

  el.stepBtn.addEventListener("click", () => stepOnce());

  el.resetBtn.addEventListener("click", () => resetToInitial());

  el.speed.addEventListener("input", () => {
    updateSpeedFromSlider();
  });

  // Init demo
  function initDemo() {
    updateSpeedFromSlider();
    const demo = [64, 25, 12, 22, 11, 90, 3, 78, 45, 19, 5, 37];
    el.arrayInput.value = demo.join(", ");
    setArray(demo);
  }

  // Start
  initDemo();
})();
</script>
</body>
</html>