<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Visualization</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 15px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        button:hover:not(:disabled) {
            background-color: #2980b9;
        }
        
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        
        .array-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 300px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        .array-bar {
            width: 20px;
            background-color: #3498db;
            margin: 0 2px;
            transition: all 0.3s ease;
        }
        
        .array-bar.being-compared {
            background-color: #e74c3c;
        }
        
        .array-bar.swapped {
            background-color: #f39c12;
        }
        
        .array-bar.sorted {
            background-color: #2ecc71;
        }
        
        .info-panel {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .details {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .complexity {
            flex: 1;
            min-width: 200px;
        }
        
        .explanation {
            flex: 2;
            min-width: 300px;
        }
        
        h2 {
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .step-counter {
            text-align: center;
            padding: 10px;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Bubble Sort Algorithm Visualization</h1>
    
    <div class="container">
        <div class="controls">
            <button id="generate-btn">Generate New Array</button>
            <button id="start-btn">Start Bubble Sort</button>
            <button id="reset-btn">Reset</button>
            <button id="step-btn">Step By Step</button>
        </div>
        
        <div class="step-counter">
            Current Step: <span id="step-count">0</span>
        </div>
        
        <div class="array-container" id="array-container"></div>
        
        <div class="info-panel">
            <h2>Algorithm Information</h2>
            
            <div class="details">
                <div class="complexity">
                    <h3>Time Complexity</h3>
                    <ul>
                        <li>Best Case: O(n) - when the array is already sorted</li>
                        <li>Average Case: O(n²)</li>
                        <li>Worst Case: O(n²)</li>
                    </ul>
                    
                    <h3>Space Complexity</h3>
                    <p>O(1) - In-place algorithm requiring only a constant amount of extra space</p>
                </div>
                
                <div class="explanation">
                    <h3>How Bubble Sort Works</h3>
                    <p>Bubble Sort is a simple sorting algorithm that repeatedly steps through the list, compares adjacent elements and swaps them if they are in the wrong order.</p>
                    
                    <p>The algorithm works as follows:</p>
                    <ol>
                        <li>Start from the beginning of the array</li>
                        <li>Compare the first two elements</li>
                        <li>If the first element is greater than the second, swap them</li>
                        <li>Move to the next pair and continue until the end of the array</li>
                        <li>Repeat this process for each element in the array</li>
                        <li>The largest elements "bubble up" to the end of the array with each pass</li>
                    </ol>
                    
                    <p>The visualization above shows how Bubble Sort works in practice:</p>
                    <ul>
                        <li><span style="background-color: #e74c3c; padding: 2px 5px; color: white;">Red</span> bars are currently being compared</li>
                        <li><span style="background-color: #f39c12; padding: 2px 5px; color: white;">Orange</span> bars are being swapped</li>
                        <li><span style="background-color: #2ecc71; padding: 2px 5px; color: white;">Green</span> bars are in their correct sorted position</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // DOM elements
        const arrayContainer = document.getElementById('array-container');
        const generateBtn = document.getElementById('generate-btn');
        const startBtn = document.getElementById('start-btn');
        const resetBtn = document.getElementById('reset-btn');
        const stepBtn = document.getElementById('step-btn');
        const stepCountDisplay = document.getElementById('step-count');
        
        // Variables
        let array = [];
        let sortedArray = [];
        let stepCount = 0;
        let isSorting = false;
        let animationSpeed = 100; // milliseconds
        
        // Initialize the array on page load
        generateNewArray();
        
        // Event listeners
        generateBtn.addEventListener('click', function() {
            if (!isSorting) {
                generateNewArray();
            }
        });
        
        startBtn.addEventListener('click', function() {
            if (!isSorting && array.length > 0) {
                startSorting();
            }
        });
        
        resetBtn.addEventListener('click', function() {
            resetArray();
        });
        
        stepBtn.addEventListener('click', function() {
            if (!isSorting && array.length > 0) {
                performStep();
            }
        });
        
        // Generate a new random array
        function generateNewArray() {
            array = [];
            sortedArray = [];
            arrayContainer.innerHTML = '';
            stepCount = 0;
            stepCountDisplay.textContent = stepCount;
            
            // Generate random array of 20 elements
            for (let i = 0; i < 20; i++) {
                array.push(Math.floor(Math.random() * 100) + 10); // Values between 10 and 110
            }
            
            // Copy array for reset functionality
            sortedArray = [...array];
            
            // Display the array
            displayArray(array);
        }
        
        // Display the array as bars
        function displayArray(arr) {
            arrayContainer.innerHTML = '';
            const maxValue = Math.max(...arr);
            
            arr.forEach(value => {
                const bar = document.createElement('div');
                bar.classList.add('array-bar');
                bar.style.height = `${(value / maxValue) * 250}px`; // Scale to fit container
                arrayContainer.appendChild(bar);
            });
        }
        
        // Start the sorting process
        function startSorting() {
            isSorting = true;
            disableControls();
            
            bubbleSort(array, 0).then(() => {
                isSorting = false;
                enableControls();
                highlightAllSorted();
            });
        }
        
        // Bubble Sort algorithm with visualization
        async function bubbleSort(arr, startIndex) {
            const n = arr.length;
            let swapped;
            
            do {
                swapped = false;
                for (let i = 0; i < n - 1; i++) {
                    // Highlight the elements being compared
                    highlightComparison(i, i+1);
                    
                    // Wait for visualization
                    await new Promise(resolve => setTimeout(resolve, animationSpeed));
                    
                    stepCount++;
                    stepCountDisplay.textContent = stepCount;
                    
                    if (arr[i] > arr[i+1]) {
                        // Swap elements
                        [arr[i], arr[i+1]] = [arr[i+1], arr[i]];
                        
                        // Visualize the swap
                        highlightSwap(i, i+1);
                        
                        // Wait for visualization
                        await new Promise(resolve => setTimeout(resolve, animationSpeed));
                        
                        // Update display
                        displayArray(arr);
                        
                        swapped = true;
                    }
                    
                    // Clear comparison highlighting
                    clearHighlights();
                }
            } while (swapped);
            
            return arr;
        }
        
        // Perform a single step of the algorithm
        async function performStep() {
            if (isSorted(array)) {
                return;
            }
            
            const n = array.length;
            let swapped = false;
            let i = 0;
            
            while (i < n - 1 && swapped === false) {
                // Highlight the elements being compared
                highlightComparison(i, i+1);
                
                if (array[i] > array[i+1]) {
                    // Swap elements
                    [array[i], array[i+1]] = [array[i+1], array[i]];
                    
                    // Visualize the swap
                    highlightSwap(i, i+1);
                    
                    // Update display
                    displayArray(array);
                    
                    swapped = true;
                }
                
                stepCount++;
                stepCountDisplay.textContent = stepCount;
                i++;
            }
            
            // If no swaps were made, the array is sorted
            if (!swapped) {
                highlightAllSorted();
            }
        }
        
        // Reset the array to its initial state
        function resetArray() {
            if (isSorting) {
                return;
            }
            
            array = [...sortedArray];
            stepCount = 0;
            stepCountDisplay.textContent = stepCount;
            displayArray(array);
            
            // Clear any highlights
            clearHighlights();
        }
        
        // Helper functions for visualization
        function highlightComparison(index1, index2) {
            const bars = document.querySelectorAll('.array-bar');
            bars[index1].classList.add('being-compared');
            bars[index2].classList.add('being-compared');
        }
        
        function highlightSwap(index1, index2) {
            const bars = document.querySelectorAll('.array-bar');
            bars[index1].classList.remove('being-compared');
            bars[index2].classList.remove('being-compared');
            bars[index1].classList.add('swapped');
            bars[index2].classList.add('swapped');
        }
        
        function clearHighlights() {
            const bars = document.querySelectorAll('.array-bar');
            bars.forEach(bar => {
                bar.classList.remove('being-compared', 'swapped');
            });
        }
        
        function highlightAllSorted() {
            const bars = document.querySelectorAll('.array-bar');
            bars.forEach(bar => {
                bar.classList.add('sorted');
            });
        }
        
        function disableControls() {
            generateBtn.disabled = true;
            startBtn.disabled = true;
            resetBtn.disabled = true;
            stepBtn.disabled = true;
        }
        
        function enableControls() {
            generateBtn.disabled = false;
            startBtn.disabled = false;
            resetBtn.disabled = false;
            stepBtn.disabled = false;
        }
        
        // Check if array is sorted
        function isSorted(arr) {
            for (let i = 0; i < arr.length - 1; i++) {
                if (arr[i] > arr[i+1]) {
                    return false;
                }
            }
            return true;
        }
    </script>
</body>
</html>