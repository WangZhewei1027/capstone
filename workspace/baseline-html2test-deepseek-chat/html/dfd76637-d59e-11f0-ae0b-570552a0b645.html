<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Counting Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .input-section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .visualization {
            margin-top: 40px;
        }
        .array-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .element {
            width: 60px;
            height: 60px;
            margin: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .input-element {
            background-color: #4CAF50;
            color: white;
        }
        .count-element {
            background-color: #2196F3;
            color: white;
        }
        .output-element {
            background-color: #FF9800;
            color: white;
        }
        .step-info {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 16px;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            margin: 0 5px;
            font-size: 16px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        input[type="text"] {
            padding: 10px;
            font-size: 16px;
            width: 300px;
            margin-right: 10px;
        }
        .legend {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            gap: 20px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0 10px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Counting Sort Algorithm Visualization</h1>
        
        <div class="input-section">
            <h3>Enter numbers to sort (comma-separated, non-negative integers only):</h3>
            <input type="text" id="arrayInput" value="4,2,2,8,3,3,1">
            <button onclick="initializeSort()">Start Sorting</button>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4CAF50;"></div>
                <span>Input Array</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #2196F3;"></div>
                <span>Count Array</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #FF9800;"></div>
                <span>Output Array</span>
            </div>
        </div>

        <div class="visualization">
            <div id="stepInfo" class="step-info"></div>
            
            <h3>Input Array:</h3>
            <div id="inputArray" class="array-container"></div>
            
            <h3>Count Array:</h3>
            <div id="countArray" class="array-container"></div>
            
            <h3>Output Array:</h3>
            <div id="outputArray" class="array-container"></div>
            
            <div class="controls">
                <button id="prevBtn" onclick="prevStep()" disabled>Previous Step</button>
                <button id="nextBtn" onclick="nextStep()" disabled>Next Step</button>
                <button id="autoBtn" onclick="toggleAutoPlay()">Auto Play</button>
                <button onclick="reset()">Reset</button>
            </div>
        </div>
        
        <div style="margin-top: 30px;">
            <h3>About Counting Sort:</h3>
            <p>Counting Sort is a non-comparison-based sorting algorithm that works by counting the number of occurrences of each distinct element in the input array. It's efficient when the range of potential items (k) is not significantly larger than the number of items (n).</p>
            <p><strong>Time Complexity:</strong> O(n + k) where n is the number of elements and k is the range of input</p>
            <p><strong>Space Complexity:</strong> O(n + k)</p>
            <p><strong>Stable:</strong> Yes (maintains relative order of equal elements)</p>
        </div>
    </div>

    <script>
        let originalArray = [];
        let countArray = [];
        let outputArray = [];
        let stepHistory = [];
        let currentStep = 0;
        let autoPlayInterval = null;
        let isAutoPlaying = false;

        function initializeSort() {
            const input = document.getElementById('arrayInput').value;
            const numbers = input.split(',').map(num => parseInt(num.trim())).filter(num => !isNaN(num) && num >= 0);
            
            if (numbers.length === 0) {
                alert('Please enter valid non-negative integers');
                return;
            }
            
            originalArray = [...numbers];
            resetVisualization();
            performCountingSort(numbers);
            updateVisualization();
            enableControls();
        }

        function performCountingSort(arr) {
            stepHistory = [];
            const max = Math.max(...arr);
            
            // Step 1: Initialize count array
            countArray = new Array(max + 1).fill(0);
            stepHistory.push({
                step: 'Initialize Count Array',
                inputArray: [...arr],
                countArray: [...countArray],
                outputArray: [],
                description: `Created count array of size ${max + 1} (max value + 1) initialized with zeros`
            });
            
            // Step 2: Count occurrences of each number
            for (let i = 0; i < arr.length; i++) {
                countArray[arr[i]]++;
                stepHistory.push({
                    step: 'Count Occurrences',
                    inputArray: [...arr],
                    countArray: [...countArray],
                    outputArray: [],
                    description: `Increment count for value ${arr[i]} at index ${i} of input array`,
                    highlighted: { input: i, count: arr[i] }
                });
            }
            
            // Step 3: Modify count array to store cumulative counts
            for (let i = 1; i <= max; i++) {
                countArray[i] += countArray[i - 1];
                stepHistory.push({
                    step: 'Calculate Cumulative Counts',
                    inputArray: [...arr],
                    countArray: [...countArray],
                    outputArray: [],
                    description: `Add count of ${countArray[i - 1]} to count of ${i}, making it ${countArray[i]}`,
                    highlighted: { count: i }
                });
            }
            
            // Initialize output array
            outputArray = new Array(arr.length);
            stepHistory.push({
                step: 'Initialize Output Array',
                inputArray: [...arr],
                countArray: [...countArray],
                outputArray: [...outputArray],
                description: `Created output array of size ${arr.length}`
            });
            
            // Step 4: Build the output array
            for (let i = arr.length - 1; i >= 0; i--) {
                const value = arr[i];
                outputArray[countArray[value] - 1] = value;
                countArray[value]--;
                
                const tempOutput = [...outputArray];
                stepHistory.push({
                    step: 'Build Output Array',
                    inputArray: [...arr],
                    countArray: [...countArray],
                    outputArray: [...tempOutput],
                    description: `Placed value ${value} from input index ${i} into output index ${tempOutput.indexOf(value)}`,
                    highlighted: { input: i, output: tempOutput.indexOf(value), count: value }
                });
            }
            
            // Final step: Sorting complete
            stepHistory.push({
                step: 'Sorting Complete',
                inputArray: [...arr],
                countArray: [...countArray],
                outputArray: [...outputArray],
                description: 'Counting sort completed successfully!',
                highlighted: {}
            });
        }

        function updateVisualization() {
            const step = stepHistory[currentStep];
            const stepInfo = document.getElementById('stepInfo');
            const inputArrayDiv = document.getElementById('inputArray');
            const countArrayDiv = document.getElementById('countArray');
            const outputArrayDiv = document.getElementById('outputArray');
            
            // Update step information
            stepInfo.innerHTML = `<strong>Step ${currentStep + 1}/${stepHistory.length}:</strong> ${step.step}<br>${step.description}`;
            
            // Render input array
            inputArrayDiv.innerHTML = '';
            step.inputArray.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'element input-element';
                element.textContent = value;
                element.style.opacity = step.highlighted && step.highlighted.input === index ? '1' : '0.8';
                element.style.boxShadow = step.highlighted && step.highlighted.input === index ? '0 0 10px yellow' : 'none';
                element.title = `Input value: ${value}`;
                inputArrayDiv.appendChild(element);
            });
            
            // Render count array
            countArrayDiv.innerHTML = '';
            step.countArray.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'element count-element';
                element.textContent = value;
                element.style.opacity = step.highlighted && (step.highlighted.count === index) ? '1' : '0.8';
                element.style.boxShadow = step.highlighted && (step.highlighted.count === index) ? '0 0 10px yellow' : 'none';
                element.title = `Count for value ${index}: ${value}`;
                countArrayDiv.appendChild(element);
            });
            
            // Render output array
            outputArrayDiv.innerHTML = '';
            step.outputArray.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'element output-element';
                element.textContent = value !== undefined ? value : '';
                element.style.opacity = step.highlighted && step.highlighted.output === index ? '1' : '0.8';
                element.style.boxShadow = step.highlighted && step.highlighted.output === index ? '0 0 10px yellow' : 'none';
                element.title = value !== undefined ? `Output value: ${value}` : 'Empty position';
                outputArrayDiv.appendChild(element);
            });
            
            // Update button states
            document.getElementById('prevBtn').disabled = currentStep === 0;
            document.getElementById('nextBtn').disabled = currentStep === stepHistory.length - 1;
            
            // Update auto play button text
            document.getElementById('autoBtn').textContent = isAutoPlaying ? 'Pause' : 'Auto Play';
        }

        function nextStep() {
            if (currentStep < stepHistory.length - 1) {
                currentStep++;
                updateVisualization();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                updateVisualization();
            }
        }

        function toggleAutoPlay() {
            if (isAutoPlaying) {
                clearInterval(autoPlayInterval);
                isAutoPlaying = false;
            } else {
                autoPlayInterval = setInterval(() => {
                    if (currentStep < stepHistory.length - 1) {
                        nextStep();
                    } else {
                        clearInterval(autoPlayInterval);
                        isAutoPlaying = false;
                        document.getElementById('autoBtn').textContent = 'Auto Play';
                    }
                }, 1500);
                isAutoPlaying = true;
            }
            updateVisualization();
        }

        function enableControls() {
            document.getElementById('prevBtn').disabled = false;
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('autoBtn').disabled = false;
        }

        function reset() {
            clearInterval(autoPlayInterval);
            isAutoPlaying = false;
            currentStep = 0;
            resetVisualization();
        }

        function resetVisualization() {
            const stepInfo = document.getElementById('stepInfo');
            const inputArrayDiv = document.getElementById('inputArray');
            const countArrayDiv = document.getElementById('countArray');
            const outputArrayDiv = document.getElementById('outputArray');
            
            stepInfo.innerHTML = 'Enter numbers and click "Start Sorting" to begin the visualization.';
            inputArrayDiv.innerHTML = '';
            countArrayDiv.innerHTML = '';
            outputArrayDiv.innerHTML = '';
            
            document.getElementById('prevBtn').disabled = true;
            document.getElementById('nextBtn').disabled = true;
            document.getElementById('autoBtn').textContent = 'Auto Play';
        }

        // Initialize with default values
        window.onload = function() {
            initializeSort();
        };
    </script>
</body>
</html>