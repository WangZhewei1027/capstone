<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Divide and Conquer - Merge Sort</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 800px; margin: 0 auto; }
        .input-section { margin: 20px 0; }
        input, button { padding: 10px; margin: 5px; }
        .result { margin: 20px 0; padding: 15px; background: #f5f5f5; border-radius: 5px; }
        .step { margin: 10px 0; padding: 10px; background: #e8f4fd; border-left: 4px solid #2196F3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Divide and Conquer: Merge Sort Visualization</h1>
        
        <div class="input-section">
            <label for="numbers">Enter numbers (comma-separated):</label>
            <input type="text" id="numbers" value="5,2,8,1,9,3,7" size="40">
            <button onclick="runMergeSort()">Run Merge Sort</button>
        </div>

        <div id="result" class="result"></div>

        <script>
            function mergeSort(arr, depth = 0) {
                const steps = [];
                
                // Base case: array with 0 or 1 element is already sorted
                if (arr.length <= 1) {
                    steps.push({
                        action: 'BASE_CASE',
                        array: [...arr],
                        depth: depth
                    });
                    return { sortedArray: arr, steps: steps };
                }

                // Divide step: split array into two halves
                const mid = Math.floor(arr.length / 2);
                const left = arr.slice(0, mid);
                const right = arr.slice(mid);

                steps.push({
                    action: 'DIVIDE',
                    left: [...left],
                    right: [...right],
                    depth: depth
                });

                // Conquer step: recursively sort both halves
                const leftResult = mergeSort(left, depth + 1);
                const rightResult = mergeSort(right, depth + 1);
                
                steps.push(...leftResult.steps, ...rightResult.steps);

                // Combine step: merge the sorted halves
                const merged = merge(leftResult.sortedArray, rightResult.sortedArray);
                
                steps.push({
                    action: 'MERGE',
                    left: [...leftResult.sortedArray],
                    right: [...rightResult.sortedArray],
                    merged: [...merged],
                    depth: depth
                });

                return { sortedArray: merged, steps: steps };
            }

            function merge(left, right) {
                let result = [];
                let leftIndex = 0;
                let rightIndex = 0;

                // Compare elements and merge in sorted order
                while (leftIndex < left.length && rightIndex < right.length) {
                    if (left[leftIndex] < right[rightIndex]) {
                        result.push(left[leftIndex]);
                        leftIndex++;
                    } else {
                        result.push(right[rightIndex]);
                        rightIndex++;
                    }
                }

                // Add remaining elements
                return result.concat(left.slice(leftIndex)).concat(right.slice(rightIndex));
            }

            function displaySteps(steps) {
                const resultDiv = document.getElementById('result');
                resultDiv.innerHTML = '<h3>Sorting Process:</h3>';
                
                steps.forEach((step, index) => {
                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'step';
                    
                    const indent = '&nbsp;'.repeat(step.depth * 4);
                    
                    switch (step.action) {
                        case 'DIVIDE':
                            stepDiv.innerHTML = `${indent}ðŸ”€ DIVIDE: [${step.left}] | [${step.right}]`;
                            break;
                        case 'MERGE':
                            stepDiv.innerHTML = `${indent}ðŸ”„ MERGE: [${step.left}] + [${step.right}] â†’ [${step.merged}]`;
                            break;
                        case 'BASE_CASE':
                            stepDiv.innerHTML = `${indent}âœ… BASE CASE: [${step.array}] (already sorted)`;
                            break;
                    }
                    
                    resultDiv.appendChild(stepDiv);
                });
            }

            function runMergeSort() {
                const input = document.getElementById('numbers').value;
                const numbers = input.split(',').map(num => parseInt(num.trim()));
                
                const result = mergeSort(numbers);
                
                const resultDiv = document.getElementById('result');
                resultDiv.innerHTML = `
                    <h3>Final Result:</h3>
                    <p><strong>Original array:</strong> [${numbers.join(', ')}]</p>
                    <p><strong>Sorted array:</strong> [${result.sortedArray.join(', ')}]</p>
                `;
                
                displaySteps(result.steps);
            }
        </script>
    </div>
</body>
</html>