<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merge Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .input-section {
            margin-bottom: 20px;
        }
        input[type="text"] {
            padding: 8px;
            width: 200px;
            margin-right: 10px;
        }
        button {
            padding: 8px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .visualization {
            border: 1px solid #ddd;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        .step {
            margin: 10px 0;
            padding: 10px;
            background-color: #fff;
            border-left: 4px solid #4CAF50;
        }
        .array-display {
            font-family: monospace;
            font-size: 16px;
            margin: 5px 0;
        }
        .current-processing {
            background-color: #e8f5e8;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .sorted {
            color: #4CAF50;
            font-weight: bold;
        }
        .comparison {
            color: #ff9800;
        }
        .merging {
            color: #2196F3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Merge Sort Visualization</h1>
        
        <div class="input-section">
            <label for="array-input">Enter numbers (comma separated):</label>
            <input type="text" id="array-input" value="38,27,43,3,9,82,10">
            <button id="sort-btn">Sort</button>
            <button id="reset-btn">Reset</button>
        </div>
        
        <div class="visualization">
            <h3>Sorting Process:</h3>
            <div id="steps-container"></div>
        </div>
    </div>

    <script>
        class MergeSortVisualizer {
            constructor() {
                this.steps = [];
                this.currentStep = 0;
                this.isSorting = false;
                
                this.sortBtn = document.getElementById('sort-btn');
                this.resetBtn = document.getElementById('reset-btn');
                this.arrayInput = document.getElementById('array-input');
                this.stepsContainer = document.getElementById('steps-container');
                
                this.initializeEventListeners();
            }
            
            initializeEventListeners() {
                this.sortBtn.addEventListener('click', () => this.startSorting());
                this.resetBtn.addEventListener('click', () => this.reset());
            }
            
            startSorting() {
                if (this.isSorting) return;
                
                const input = this.arrayInput.value;
                const array = input.split(',').map(num => parseInt(num.trim())).filter(num => !isNaN(num));
                
                if (array.length === 0) {
                    alert('Please enter valid numbers');
                    return;
                }
                
                this.isSorting = true;
                this.sortBtn.disabled = true;
                this.steps = [];
                this.currentStep = 0;
                this.stepsContainer.innerHTML = '';
                
                this.addStep(`Initial array: [${array.join(', ')}]`);
                
                const sortedArray = this.mergeSort(array.slice(), 0, array.length - 1, 0);
                
                this.addStep(`Final sorted array: [${sortedArray.join(', ')}]`, true);
                this.isSorting = false;
                this.sortBtn.disabled = false;
                this.displaySteps();
            }
            
            mergeSort(arr, left, right, depth) {
                if (left >= right) {
                    return arr;
                }
                
                const mid = Math.floor((left + right) / 2);
                
                this.addStep(`${'  '.repeat(depth)}Splitting: [${arr.slice(left, right + 1).join(', ')}]`);
                
                // Recursively sort both halves
                this.mergeSort(arr, left, mid, depth + 1);
                this.mergeSort(arr, mid + 1, right, depth + 1);
                
                // Merge the sorted halves
                this.merge(arr, left, mid, right, depth);
                
                return arr;
            }
            
            merge(arr, left, mid, right, depth) {
                const leftArr = arr.slice(left, mid + 1);
                const rightArr = arr.slice(mid + 1, right + 1);
                
                this.addStep(`${'  '.repeat(depth)}Merging: [${leftArr.join(', ')}] and [${rightArr.join(', ')}]`);
                
                let i = 0, j = 0, k = left;
                
                while (i < leftArr.length && j < rightArr.length) {
                    this.addStep(`${'  '.repeat(depth)}Comparing ${leftArr[i]} and ${rightArr[j]}`);
                    
                    if (leftArr[i] <= rightArr[j]) {
                        arr[k] = leftArr[i];
                        this.addStep(`${'  '.repeat(depth)}Taking ${leftArr[i]} from left array`);
                        i++;
                    } else {
                        arr[k] = rightArr[j];
                        this.addStep(`${'  '.repeat(depth)}Taking ${rightArr[j]} from right array`);
                        j++;
                    }
                    k++;
                }
                
                while (i < leftArr.length) {
                    arr[k] = leftArr[i];
                    this.addStep(`${'  '.repeat(depth)}Copying remaining ${leftArr[i]} from left array`);
                    i++;
                    k++;
                }
                
                while (j < rightArr.length) {
                    arr[k] = rightArr[j];
                    this.addStep(`${'  '.repeat(depth)}Copying remaining ${rightArr[j]} from right array`);
                    j++;
                    k++;
                }
                
                this.addStep(`${'  '.repeat(depth)}Merged result: [${arr.slice(left, right + 1).join(', ')}]`);
            }
            
            addStep(description, isFinal = false) {
                this.steps.push({ description, isFinal });
            }
            
            displaySteps() {
                this.stepsContainer.innerHTML = '';
                
                this.steps.forEach((step, index) => {
                    const stepElement = document.createElement('div');
                    stepElement.className = 'step';
                    
                    if (step.isFinal) {
                        stepElement.innerHTML = `<div class="array-display sorted">${step.description}</div>`;
                    } else if (step.description.includes('Comparing')) {
                        stepElement.innerHTML = `<div class="array-display comparison">${step.description}</div>`;
                    } else if (step.description.includes('Merging') || step.description.includes('Merged')) {
                        stepElement.innerHTML = `<div class="array-display merging">${step.description}</div>`;
                    } else {
                        stepElement.innerHTML = `<div class="array-display">${step.description}</div>`;
                    }
                    
                    this.stepsContainer.appendChild(stepElement);
                });
            }
            
            reset() {
                this.isSorting = false;
                this.sortBtn.disabled = false;
                this.steps = [];
                this.currentStep = 0;
                this.stepsContainer.innerHTML = '';
                this.arrayInput.value = '38,27,43,3,9,82,10';
            }
        }
        
        // Initialize the visualizer when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new MergeSortVisualizer();
        });
        
        // Additional explanation of Merge Sort algorithm
        console.log(`
        Merge Sort Algorithm Explanation:
        
        Merge Sort is a divide-and-conquer algorithm that works as follows:
        
        1. DIVIDE: Recursively split the array into two halves until each subarray has only one element
        2. CONQUER: Sort each subarray (trivial when subarray has only one element)
        3. COMBINE: Merge the sorted subarrays back together
        
        Time Complexity: O(n log n) in all cases
        Space Complexity: O(n) due to the temporary arrays used during merging
        
        Key characteristics:
        - Stable algorithm (maintains relative order of equal elements)
        - Not in-place (requires additional memory)
        - Excellent for linked lists
        - Well-suited for external sorting (when data doesn't fit in memory)
        `);
    </script>
</body>
</html>