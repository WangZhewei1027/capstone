{
  "meta": {
    "concept": "Deque",
    "topic": "Double-Ended Queue (interactive demo)",
    "educational_goal": "Demonstrate deque operations (pushFront, pushBack, popFront, popBack, peekFront, peekBack), rendering and logging of state changes, and random operation sequences",
    "expected_interactions": [
      "pushFront",
      "pushBack",
      "popFront",
      "popBack",
      "peekFront",
      "peekBack",
      "clear",
      "random",
      "keyboard"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "idle",
      "type": "idle",
      "entry_actions": [
        "render()",
        "updateMetadataLabels()",
        "enableButtons()",
        "announceReady()"
      ],
      "exit_actions": []
    },
    {
      "id": "S1_Pushing",
      "label": "pushing",
      "type": "atomic",
      "entry_actions": [
        "readInputValue()",
        "disableButtons()",
        "performPush(direction)",
        "clearInput()",
        "logPush()",
        "render()"
      ],
      "exit_actions": [
        "enableButtons()"
      ]
    },
    {
      "id": "S2_PushInputEmpty",
      "label": "push_input_empty_error",
      "type": "atomic",
      "entry_actions": [
        "log(\"Enter a value to push (front/back).\", 'err')",
        "focus(\"#valueInput\")"
      ],
      "exit_actions": []
    },
    {
      "id": "S3_Popping",
      "label": "popping",
      "type": "atomic",
      "entry_actions": [
        "disableButtons()",
        "performPop(direction)",
        "logPopResult()",
        "render()"
      ],
      "exit_actions": [
        "enableButtons()"
      ]
    },
    {
      "id": "S4_PopEmpty",
      "label": "pop_empty",
      "type": "atomic",
      "entry_actions": [
        "log(\"popFront()/popBack() → undefined (deque empty)\", 'err')",
        "render()"
      ],
      "exit_actions": []
    },
    {
      "id": "S5_Peeking",
      "label": "peeking",
      "type": "atomic",
      "entry_actions": [
        "performPeek(direction)",
        "logPeekResult()"
      ],
      "exit_actions": []
    },
    {
      "id": "S6_Clearing",
      "label": "clearing",
      "type": "atomic",
      "entry_actions": [
        "dq.clear()",
        "log('clear()')",
        "render()"
      ],
      "exit_actions": []
    },
    {
      "id": "S7_RandomPlaying",
      "label": "random_playing",
      "type": "atomic",
      "entry_actions": [
        "startRandomSequence()",
        "disableButtons()",
        "performRandomStep()"
      ],
      "exit_actions": [
        "enableButtons()",
        "clearRandomInterval()"
      ]
    },
    {
      "id": "S8_Init",
      "label": "initializing",
      "type": "atomic",
      "entry_actions": [
        "log('Deque demo ready. Enter a value and use the buttons or press Enter.')",
        "seedExampleData()",
        "render()"
      ],
      "exit_actions": []
    }
  ],
  "events": [
    {
      "id": "USER_CLICK_PUSH_FRONT",
      "event_type": "user_action",
      "description": "User clicks the Push Front button"
    },
    {
      "id": "USER_CLICK_PUSH_BACK",
      "event_type": "user_action",
      "description": "User clicks the Push Back button"
    },
    {
      "id": "USER_CLICK_POP_FRONT",
      "event_type": "user_action",
      "description": "User clicks the Pop Front button"
    },
    {
      "id": "USER_CLICK_POP_BACK",
      "event_type": "user_action",
      "description": "User clicks the Pop Back button"
    },
    {
      "id": "USER_CLICK_PEEK_FRONT",
      "event_type": "user_action",
      "description": "User clicks the Peek Front button"
    },
    {
      "id": "USER_CLICK_PEEK_BACK",
      "event_type": "user_action",
      "description": "User clicks the Peek Back button"
    },
    {
      "id": "USER_CLICK_CLEAR",
      "event_type": "user_action",
      "description": "User clicks the Clear button (or presses Escape)"
    },
    {
      "id": "USER_CLICK_RANDOM",
      "event_type": "user_action",
      "description": "User clicks the Random ops button"
    },
    {
      "id": "KEYBOARD_ENTER_PUSH_BACK",
      "event_type": "user_action",
      "description": "User presses Enter in input to pushBack"
    },
    {
      "id": "KEYBOARD_SHIFT_ENTER_PUSH_FRONT",
      "event_type": "user_action",
      "description": "User presses Shift+Enter in input to pushFront"
    },
    {
      "id": "KEYBOARD_ESCAPE_CLEAR",
      "event_type": "user_action",
      "description": "User presses Escape in input to clear"
    },
    {
      "id": "RANDOM_STEP",
      "event_type": "system_event",
      "description": "One random operation step performed during random sequence"
    },
    {
      "id": "RANDOM_SEQUENCE_COMPLETE",
      "event_type": "system_event",
      "description": "Random ops sequence finished"
    },
    {
      "id": "INIT_COMPLETE",
      "event_type": "system_event",
      "description": "Demo initialization complete"
    }
  ],
  "transitions": [
    {
      "from": "S8_Init",
      "to": "S0_Idle",
      "event": "INIT_COMPLETE",
      "guard": "true",
      "actions": [
        "render()"
      ],
      "triggers": "#dequeRow, #log, #sizeLabel",
      "expected_observables": [
        "dom:#dequeRow",
        "dom:#log"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S1_Pushing",
      "event": "USER_CLICK_PUSH_FRONT",
      "guard": "inputNotEmpty",
      "actions": [
        "v = document.getElementById('valueInput').value.trim()",
        "dq.pushFront(v)",
        "log(`pushFront(${v})`)",
        "document.getElementById('valueInput').value = ''",
        "render()"
      ],
      "triggers": "#pushFrontBtn, #valueInput",
      "expected_observables": [
        "dom:#pushFrontBtn:click",
        "dom:#dequeRow .node.front",
        "dom:#log div"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S1_Pushing",
      "event": "USER_CLICK_PUSH_BACK",
      "guard": "inputNotEmpty",
      "actions": [
        "v = document.getElementById('valueInput').value.trim()",
        "dq.pushBack(v)",
        "log(`pushBack(${v})`)",
        "document.getElementById('valueInput').value = ''",
        "render()"
      ],
      "triggers": "#pushBackBtn, #valueInput",
      "expected_observables": [
        "dom:#pushBackBtn:click",
        "dom:#dequeRow .node.back",
        "dom:#log div"
      ],
      "timeout": 1000
    },
    {
      "from": "S0_Idle",
      "to": "S2_PushInputEmpty",
      "event": "USER_CLICK_PUSH_FRONT",
      "guard": "inputEmpty",
      "actions": [
        "log('Enter a value to push (front).', 'err')",
        "document.getElementById('valueInput').focus()"
      ],
      "triggers": "#pushFrontBtn, #valueInput",
      "expected_observables": [
        "dom:#log div.err",
        "dom:#valueInput:focus"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S2_PushInputEmpty",
      "event": "USER_CLICK_PUSH_BACK",
      "guard": "inputEmpty",
      "actions": [
        "log('Enter a value to push (back).', 'err')",
        "document.getElementById('valueInput').focus()"
      ],
      "triggers": "#pushBackBtn, #valueInput",
      "expected_observables": [
        "dom:#log div.err",
        "dom:#valueInput:focus"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S3_Popping",
      "event": "USER_CLICK_POP_FRONT",
      "guard": "dequeNotEmpty",
      "actions": [
        "v = dq.popFront()",
        "log(`popFront() → ${v}`)",
        "render()"
      ],
      "triggers": "#popFrontBtn",
      "expected_observables": [
        "dom:#popFrontBtn:click",
        "dom:#dequeRow .node",
        "dom:#log div"
      ],
      "timeout": 800
    },
    {
      "from": "S0_Idle",
      "to": "S4_PopEmpty",
      "event": "USER_CLICK_POP_FRONT",
      "guard": "dequeEmpty",
      "actions": [
        "v = dq.popFront()",
        "log('popFront() → undefined (deque empty)', 'err')",
        "render()"
      ],
      "triggers": "#popFrontBtn",
      "expected_observables": [
        "dom:#log div",
        "dom:#dequeRow"
      ],
      "timeout": 600
    },
    {
      "from": "S0_Idle",
      "to": "S3_Popping",
      "event": "USER_CLICK_POP_BACK",
      "guard": "dequeNotEmpty",
      "actions": [
        "v = dq.popBack()",
        "log(`popBack() → ${v}`)",
        "render()"
      ],
      "triggers": "#popBackBtn",
      "expected_observables": [
        "dom:#popBackBtn:click",
        "dom:#dequeRow .node",
        "dom:#log div"
      ],
      "timeout": 800
    },
    {
      "from": "S0_Idle",
      "to": "S4_PopEmpty",
      "event": "USER_CLICK_POP_BACK",
      "guard": "dequeEmpty",
      "actions": [
        "v = dq.popBack()",
        "log('popBack() → undefined (deque empty)', 'err')",
        "render()"
      ],
      "triggers": "#popBackBtn",
      "expected_observables": [
        "dom:#log div",
        "dom:#dequeRow"
      ],
      "timeout": 600
    },
    {
      "from": "S0_Idle",
      "to": "S5_Peeking",
      "event": "USER_CLICK_PEEK_FRONT",
      "guard": "true",
      "actions": [
        "v = dq.peekFront()",
        "if(v === undefined) log('peekFront() → undefined (deque empty)', 'err') else log(`peekFront() → ${v}`)"
      ],
      "triggers": "#peekFrontBtn",
      "expected_observables": [
        "dom:#peekFrontBtn:click",
        "dom:#log div"
      ],
      "timeout": 400
    },
    {
      "from": "S0_Idle",
      "to": "S5_Peeking",
      "event": "USER_CLICK_PEEK_BACK",
      "guard": "true",
      "actions": [
        "v = dq.peekBack()",
        "if(v === undefined) log('peekBack() → undefined (deque empty)', 'err') else log(`peekBack() → ${v}`)"
      ],
      "triggers": "#peekBackBtn",
      "expected_observables": [
        "dom:#peekBackBtn:click",
        "dom:#log div"
      ],
      "timeout": 400
    },
    {
      "from": "S0_Idle",
      "to": "S6_Clearing",
      "event": "USER_CLICK_CLEAR",
      "guard": "true",
      "actions": [
        "dq.clear()",
        "log('clear()')",
        "render()"
      ],
      "triggers": "#clearBtn, #valueInput",
      "expected_observables": [
        "dom:#clearBtn:click",
        "dom:#dequeRow",
        "dom:#log div"
      ],
      "timeout": 700
    },
    {
      "from": "S0_Idle",
      "to": "S7_RandomPlaying",
      "event": "USER_CLICK_RANDOM",
      "guard": "true",
      "actions": [
        "startRandomSequence()",
        "disableButtons()"
      ],
      "triggers": "#randomBtn",
      "expected_observables": [
        "dom:#randomBtn:click",
        "dom:#log div"
      ],
      "timeout": 200
    },
    {
      "from": "S7_RandomPlaying",
      "to": "S7_RandomPlaying",
      "event": "RANDOM_STEP",
      "guard": "sequenceNotFinished",
      "actions": [
        "performRandomStep()",
        "render()"
      ],
      "triggers": "#randomBtn",
      "expected_observables": [
        "dom:#log div",
        "dom:#dequeRow .node"
      ],
      "timeout": 400
    },
    {
      "from": "S7_RandomPlaying",
      "to": "S0_Idle",
      "event": "RANDOM_SEQUENCE_COMPLETE",
      "guard": "true",
      "actions": [
        "clearRandomInterval()",
        "enableButtons()",
        "render()",
        "log('random ops: complete')"
      ],
      "triggers": "#randomBtn",
      "expected_observables": [
        "dom:#log div",
        "dom:#dequeRow"
      ],
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S1_Pushing",
      "event": "KEYBOARD_ENTER_PUSH_BACK",
      "guard": "inputNotEmpty",
      "actions": [
        "document.getElementById('pushBackBtn').click()"
      ],
      "triggers": "#valueInput",
      "expected_observables": [
        "dom:#valueInput:keyDown(Enter)",
        "dom:#pushBackBtn:click"
      ],
      "timeout": 300
    },
    {
      "from": "S0_Idle",
      "to": "S1_Pushing",
      "event": "KEYBOARD_SHIFT_ENTER_PUSH_FRONT",
      "guard": "inputNotEmpty",
      "actions": [
        "document.getElementById('pushFrontBtn').click()"
      ],
      "triggers": "#valueInput",
      "expected_observables": [
        "dom:#valueInput:keyDown(Shift+Enter)",
        "dom:#pushFrontBtn:click"
      ],
      "timeout": 300
    },
    {
      "from": "S0_Idle",
      "to": "S6_Clearing",
      "event": "KEYBOARD_ESCAPE_CLEAR",
      "guard": "true",
      "actions": [
        "document.getElementById('clearBtn').click()"
      ],
      "triggers": "#valueInput",
      "expected_observables": [
        "dom:#valueInput:keyDown(Escape)",
        "dom:#clearBtn:click"
      ],
      "timeout": 300
    }
  ],
  "components": [
    "#valueInput",
    "#pushFrontBtn",
    "#pushBackBtn",
    "#popFrontBtn",
    "#popBackBtn",
    "#peekFrontBtn",
    "#peekBackBtn",
    "#clearBtn",
    "#randomBtn",
    "#dequeRow",
    "#log",
    "#sizeLabel",
    "#frontIdx",
    "#backIdx",
    ".node",
    ".node.front",
    ".node.back",
    ".node.empty",
    ".deque-row",
    ".controls",
    ".log"
  ]
}