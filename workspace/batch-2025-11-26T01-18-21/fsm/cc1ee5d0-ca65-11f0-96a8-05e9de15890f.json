{
  "meta": {
    "concept": "LongestCommonSubsequence",
    "topic": "Longest Common Subsequence Visualizer",
    "educational_goal": "Interactively compute DP table for LCS, visualize deterministic backtrack, animate backtracking, and enumerate all distinct LCS up to a cap",
    "expected_interactions": [
      "compute",
      "randomize",
      "clear",
      "step_backtrack",
      "play_backtrack",
      "reset_highlight",
      "find_all",
      "change_tiebreaker",
      "toggle_autoplay",
      "change_speed",
      "click_cell"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "Idle",
      "type": "idle",
      "entry_actions": [],
      "exit_actions": []
    },
    {
      "id": "S1_ComputingDP",
      "label": "ComputingDP",
      "type": "atomic",
      "entry_actions": [
        "computeDP()",
        "renderTable()",
        "deterministicBacktrack()",
        "buildPathForHighlight()"
      ],
      "exit_actions": []
    },
    {
      "id": "S2_DPComputed",
      "label": "DPComputed",
      "type": "atomic",
      "entry_actions": [
        "updateLengthBadge()",
        "updateOneLCSDisplay()",
        "renderPathList()"
      ],
      "exit_actions": []
    },
    {
      "id": "S3_AutoPlaying",
      "label": "AutoPlaying",
      "type": "atomic",
      "entry_actions": [
        "startAutoPlayHighlight()",
        "markPathCellsProgressively()"
      ],
      "exit_actions": [
        "stopAutoPlayHighlight()"
      ]
    },
    {
      "id": "S4_Playing",
      "label": "Playing",
      "type": "atomic",
      "entry_actions": [
        "playBacktrack()",
        "setPlayButtonText('Stop')"
      ],
      "exit_actions": [
        "stopBacktrackInterval()",
        "setPlayButtonText('Play')"
      ]
    },
    {
      "id": "S5_Paused",
      "label": "Paused",
      "type": "atomic",
      "entry_actions": [
        "stopBacktrackInterval()"
      ],
      "exit_actions": []
    },
    {
      "id": "S6_Stepping",
      "label": "Stepping",
      "type": "atomic",
      "entry_actions": [
        "stepBacktrack()"
      ],
      "exit_actions": []
    },
    {
      "id": "S7_ResetHighlights",
      "label": "ResetHighlights",
      "type": "atomic",
      "entry_actions": [
        "resetHighlights()",
        "clearHighlights()"
      ],
      "exit_actions": []
    },
    {
      "id": "S8_AllLCSComputing",
      "label": "AllLCSComputing",
      "type": "atomic",
      "entry_actions": [
        "showAllResultsComputing()",
        "computeAllLCSAsync()"
      ],
      "exit_actions": []
    },
    {
      "id": "S9_AllLCSDisplayed",
      "label": "AllLCSDisplayed",
      "type": "atomic",
      "entry_actions": [
        "renderAllResults()"
      ],
      "exit_actions": []
    },
    {
      "id": "S10_Randomizing",
      "label": "Randomizing",
      "type": "atomic",
      "entry_actions": [
        "randomizeInputs()",
        "computeDP()"
      ],
      "exit_actions": []
    },
    {
      "id": "S11_Cleared",
      "label": "Cleared",
      "type": "atomic",
      "entry_actions": [
        "clearState()",
        "clearDisplays()"
      ],
      "exit_actions": []
    },
    {
      "id": "S12_TieBreakerUpdated",
      "label": "TieBreakerUpdated",
      "type": "atomic",
      "entry_actions": [
        "deterministicBacktrack()",
        "buildPathForHighlight()",
        "renderPathList()",
        "resetHighlights()"
      ],
      "exit_actions": []
    },
    {
      "id": "S13_CellHighlighted",
      "label": "CellHighlighted",
      "type": "atomic",
      "entry_actions": [
        "clearHighlights()",
        "addCurrentClassToCell()"
      ],
      "exit_actions": []
    }
  ],
  "events": [
    {
      "id": "CLICK_COMPUTE",
      "event_type": "user_action",
      "description": "User clicks the Compute DP Table button",
      "triggers": "#compute"
    },
    {
      "id": "DP_COMPUTE_COMPLETE",
      "event_type": "system_event",
      "description": "Synchronous DP computation finished and table rendered"
    },
    {
      "id": "AUTO_PLAY_TRIGGERED",
      "event_type": "system_event",
      "description": "Auto-play backtrack starts automatically after compute if autoplay is checked"
    },
    {
      "id": "CLICK_RANDOM",
      "event_type": "user_action",
      "description": "User clicks Random Strings button",
      "triggers": "#random"
    },
    {
      "id": "CLICK_CLEAR",
      "event_type": "user_action",
      "description": "User clicks Clear button",
      "triggers": "#clear"
    },
    {
      "id": "CLICK_STEP",
      "event_type": "user_action",
      "description": "User clicks Step Backtrack button",
      "triggers": "#step"
    },
    {
      "id": "CLICK_PLAY",
      "event_type": "user_action",
      "description": "User clicks Play/Stop button",
      "triggers": "#play"
    },
    {
      "id": "CLICK_RESET_HIGHLIGHT",
      "event_type": "user_action",
      "description": "User clicks Reset highlights button",
      "triggers": "#resetHighlight"
    },
    {
      "id": "CLICK_FIND_ALL",
      "event_type": "user_action",
      "description": "User clicks Find All LCS button",
      "triggers": "#findAll"
    },
    {
      "id": "ALL_LCS_COMPUTE_COMPLETE",
      "event_type": "system_event",
      "description": "All-LCS enumeration finished and results ready"
    },
    {
      "id": "CHANGE_TIEBREAKER",
      "event_type": "user_action",
      "description": "User changes tie-breaker select",
      "triggers": "#tiebreaker"
    },
    {
      "id": "TOGGLE_AUTOPLAY",
      "event_type": "user_action",
      "description": "User toggles autoplay checkbox",
      "triggers": "#autoplay"
    },
    {
      "id": "CHANGE_SPEED",
      "event_type": "user_action",
      "description": "User changes speed slider",
      "triggers": "#speed"
    },
    {
      "id": "CLICK_TABLE_CELL",
      "event_type": "user_action",
      "description": "User clicks a DP table cell",
      "triggers": "table.lcs td, #tableContainer td"
    },
    {
      "id": "CLICK_PATH_ITEM",
      "event_type": "user_action",
      "description": "User clicks an item in the pathDisplay list",
      "triggers": "#pathDisplay div"
    }
  ],
  "transitions": [
    {
      "from": "S0_Idle",
      "to": "S1_ComputingDP",
      "event": "CLICK_COMPUTE",
      "guard": "true",
      "actions": [
        "computeDP()",
        "clearHighlights()"
      ],
      "expected_observables": [
        "dom:#compute:click",
        "dom:#tableContainer:innerHTML_changed",
        "dom:#lengthBadge:text_updated",
        "dom:#oneLCS:text_updated"
      ],
      "triggers": "#compute",
      "timeout": 5000
    },
    {
      "from": "S1_ComputingDP",
      "to": "S2_DPComputed",
      "event": "DP_COMPUTE_COMPLETE",
      "guard": "true",
      "actions": [
        "renderTable()",
        "updateLengthBadge()",
        "updateOneLCSDisplay()",
        "buildPathForHighlight()",
        "renderPathList()"
      ],
      "expected_observables": [
        "dom:table.lcs:exists",
        "dom:#lengthBadge:text_updated",
        "dom:#oneLCS:text_updated"
      ],
      "triggers": "internal",
      "timeout": 100
    },
    {
      "from": "S2_DPComputed",
      "to": "S3_AutoPlaying",
      "event": "AUTO_PLAY_TRIGGERED",
      "guard": "document.querySelector('#autoplay').checked === true",
      "actions": [
        "startAutoPlayHighlight()"
      ],
      "expected_observables": [
        "dom:table.lcs td.path:added",
        "dom:#play:text_changed_to_Stop"
      ],
      "triggers": "#autoplay, internal"
    },
    {
      "from": "S3_AutoPlaying",
      "to": "S2_DPComputed",
      "event": "AUTO_PLAY_TRIGGERED",
      "guard": "auto-play finished or stopped",
      "actions": [
        "stopAutoPlayHighlight()"
      ],
      "expected_observables": [
        "dom:table.lcs td.path:fully_marked",
        "dom:#play:text_changed_to_Play"
      ],
      "triggers": "#autoplay, internal",
      "timeout": 60000
    },
    {
      "from": "S2_DPComputed",
      "to": "S10_Randomizing",
      "event": "CLICK_RANDOM",
      "guard": "true",
      "actions": [
        "randomizeInputs()",
        "computeDP()"
      ],
      "expected_observables": [
        "dom:#random:click",
        "dom:#a:value_changed",
        "dom:#b:value_changed"
      ],
      "triggers": "#random",
      "timeout": 2000
    },
    {
      "from": "S0_Idle",
      "to": "S10_Randomizing",
      "event": "CLICK_RANDOM",
      "guard": "true",
      "actions": [
        "randomizeInputs()",
        "computeDP()"
      ],
      "expected_observables": [
        "dom:#random:click",
        "dom:#a:value_changed",
        "dom:#b:value_changed"
      ],
      "triggers": "#random",
      "timeout": 2000
    },
    {
      "from": "S2_DPComputed",
      "to": "S11_Cleared",
      "event": "CLICK_CLEAR",
      "guard": "true",
      "actions": [
        "clearState()"
      ],
      "expected_observables": [
        "dom:#clear:click",
        "dom:#tableContainer:innerHTML_cleared",
        "dom:#lengthBadge:text_reset",
        "dom:#oneLCS:text_reset"
      ],
      "triggers": "#clear",
      "timeout": 500
    },
    {
      "from": "S0_Idle",
      "to": "S11_Cleared",
      "event": "CLICK_CLEAR",
      "guard": "true",
      "actions": [
        "clearState()"
      ],
      "expected_observables": [
        "dom:#clear:click",
        "dom:#tableContainer:innerHTML_cleared"
      ],
      "triggers": "#clear",
      "timeout": 500
    },
    {
      "from": "S2_DPComputed",
      "to": "S6_Stepping",
      "event": "CLICK_STEP",
      "guard": "path.length > 0 || (dp && dp.length>0)",
      "actions": [
        "if(path.length===0) path = buildPathForHighlight(document.querySelector('#tiebreaker').value",
        "stepBacktrack()"
      ],
      "expected_observables": [
        "dom:#step:click",
        "dom:td.current:added",
        "dom:td.path:added"
      ],
      "triggers": "#step",
      "timeout": 2000
    },
    {
      "from": "S6_Stepping",
      "to": "S2_DPComputed",
      "event": "CLICK_STEP",
      "guard": "step completed",
      "actions": [
        "noop"
      ],
      "expected_observables": [
        "dom:td.current:changes"
      ],
      "triggers": "#step"
    },
    {
      "from": "S2_DPComputed",
      "to": "S4_Playing",
      "event": "CLICK_PLAY",
      "guard": "playInterval === null && dp && dp.length>0",
      "actions": [
        "if(path.length===0) path = buildPathForHighlight(document.querySelector('#tiebreaker').value)",
        "playBacktrack()"
      ],
      "expected_observables": [
        "dom:#play:click",
        "dom:#play:text_changed_to_Stop",
        "dom:td.path:being_added_over_time"
      ],
      "triggers": "#play",
      "timeout": 60000
    },
    {
      "from": "S4_Playing",
      "to": "S5_Paused",
      "event": "CLICK_PLAY",
      "guard": "playInterval !== null",
      "actions": [
        "playBacktrack()"
      ],
      "expected_observables": [
        "dom:#play:click",
        "dom:#play:text_changed_to_Play",
        "dom:interval_cleared"
      ],
      "triggers": "#play"
    },
    {
      "from": "S5_Paused",
      "to": "S4_Playing",
      "event": "CLICK_PLAY",
      "guard": "playInterval === null && dp && dp.length>0",
      "actions": [
        "playBacktrack()"
      ],
      "expected_observables": [
        "dom:#play:click",
        "dom:#play:text_changed_to_Stop"
      ],
      "triggers": "#play"
    },
    {
      "from": "S2_DPComputed",
      "to": "S7_ResetHighlights",
      "event": "CLICK_RESET_HIGHLIGHT",
      "guard": "true",
      "actions": [
        "resetHighlights()",
        "clearHighlights()"
      ],
      "expected_observables": [
        "dom:#resetHighlight:click",
        "dom:td.path:removed",
        "dom:td.current:removed"
      ],
      "triggers": "#resetHighlight",
      "timeout": 500
    },
    {
      "from": "S4_Playing",
      "to": "S7_ResetHighlights",
      "event": "CLICK_RESET_HIGHLIGHT",
      "guard": "true",
      "actions": [
        "resetHighlights()"
      ],
      "expected_observables": [
        "dom:#resetHighlight:click",
        "dom:interval_cleared"
      ],
      "triggers": "#resetHighlight"
    },
    {
      "from": "S2_DPComputed",
      "to": "S8_AllLCSComputing",
      "event": "CLICK_FIND_ALL",
      "guard": "dp && dp.length>0",
      "actions": [
        "showAllResultsComputing()",
        "computeAllLCSAsync()"
      ],
      "expected_observables": [
        "dom:#findAll:click",
        "dom:#allResults:text_'Computing...'"
      ],
      "triggers": "#findAll",
      "timeout": 50
    },
    {
      "from": "S8_AllLCSComputing",
      "to": "S9_AllLCSDisplayed",
      "event": "ALL_LCS_COMPUTE_COMPLETE",
      "guard": "true",
      "actions": [
        "renderAllResults()"
      ],
      "expected_observables": [
        "dom:#allResults:children_added",
        "dom:#allResults:text_changed"
      ],
      "triggers": "internal",
      "timeout": 5000
    },
    {
      "from": "S2_DPComputed",
      "to": "S12_TieBreakerUpdated",
      "event": "CHANGE_TIEBREAKER",
      "guard": "true",
      "actions": [
        "deterministicBacktrack(document.querySelector('#tiebreaker').value)",
        "buildPathForHighlight(document.querySelector('#tiebreaker').value)",
        "renderPathList()",
        "resetHighlights()"
      ],
      "expected_observables": [
        "dom:#tiebreaker:change",
        "dom:#oneLCS:text_updated"
      ],
      "triggers": "#tiebreaker"
    },
    {
      "from": "S2_DPComputed",
      "to": "S2_DPComputed",
      "event": "TOGGLE_AUTOPLAY",
      "guard": "true",
      "actions": [
        "no-op (autoplay flag changed)"
      ],
      "expected_observables": [
        "dom:#autoplay:change"
      ],
      "triggers": "#autoplay"
    },
    {
      "from": "S2_DPComputed",
      "to": "S2_DPComputed",
      "event": "CHANGE_SPEED",
      "guard": "true",
      "actions": [
        "no-op (speed affects interval timing only)"
      ],
      "expected_observables": [
        "dom:#speed:input"
      ],
      "triggers": "#speed"
    },
    {
      "from": "S2_DPComputed",
      "to": "S13_CellHighlighted",
      "event": "CLICK_TABLE_CELL",
      "guard": "true",
      "actions": [
        "clearHighlights()",
        "addCurrentClassToCell(event.target)"
      ],
      "expected_observables": [
        "dom:table.lcs td:click",
        "dom:td.current:added"
      ],
      "triggers": "table.lcs td, #tableContainer td"
    },
    {
      "from": "S2_DPComputed",
      "to": "S13_CellHighlighted",
      "event": "CLICK_PATH_ITEM",
      "guard": "true",
      "actions": [
        "clearHighlights()",
        "highlightCellCorrespondingToPathItem(event.target)"
      ],
      "expected_observables": [
        "dom:#pathDisplay div:click",
        "dom:td.current:added"
      ],
      "triggers": "#pathDisplay div"
    },
    {
      "from": "S10_Randomizing",
      "to": "S2_DPComputed",
      "event": "DP_COMPUTE_COMPLETE",
      "guard": "true",
      "actions": [
        "renderTable()",
        "buildPathForHighlight()",
        "renderPathList()"
      ],
      "expected_observables": [
        "dom:#a:value_changed",
        "dom:#b:value_changed",
        "dom:table.lcs:exists"
      ],
      "triggers": "internal"
    },
    {
      "from": "S11_Cleared",
      "to": "S0_Idle",
      "event": "CLICK_COMPUTE",
      "guard": "true",
      "actions": [
        "computeDP()"
      ],
      "expected_observables": [
        "dom:#compute:click"
      ],
      "triggers": "#compute"
    }
  ],
  "components": [
    "#a",
    "#b",
    "#compute",
    "#random",
    "#clear",
    "#findAll",
    "#limit",
    "#tiebreaker",
    "#autoplay",
    "#speed",
    "#lengthBadge",
    "#oneLCS",
    "#step",
    "#play",
    "#resetHighlight",
    "#tableContainer",
    "#pathDisplay",
    "#allResults",
    "table.lcs td",
    "table.lcs th",
    ".controls button.secondary",
    "button.small",
    ".resultList"
  ]
}