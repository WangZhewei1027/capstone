<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Selection Sort Visualizer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f1724;
      --panel:#0b1220;
      --accent:#4f46e5;
      --muted:#94a3b8;
      --good:#10b981;
      --bad:#ef4444;
      --bar:#60a5fa;
      --bar-min:#f59e0b;
      --bar-compare:#ef4444;
      --bar-sorted:#34d399;
      --text:#e6eef8;
      --shadow: rgba(2,6,23,0.6);
    }
    *{box-sizing:border-box;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#061029 120%);color:var(--text);}
    .app{max-width:1100px;margin:24px auto;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;box-shadow:0 6px 30px var(--shadow);}
    header{display:flex;align-items:center;gap:12px;margin-bottom:12px;}
    header h1{font-size:20px;margin:0;}
    .controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:12px;}
    .controls > *{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:8px;color:var(--text);}
    .controls button{cursor:pointer;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));}
    .controls button:active{transform:translateY(1px);}
    .controls .seg{display:inline-flex;gap:8px;align-items:center;}
    .row{display:flex;gap:12px;}
    .left{flex:1;min-width:320px;}
    .right{width:420px;}
    .vis{background:linear-gradient(135deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));height:320px;border-radius:10px;padding:12px;display:flex;align-items:flex-end;gap:6px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);}
    .bar{flex:1;margin:0 3px;background:var(--bar);border-radius:6px;display:flex;align-items:flex-end;justify-content:center;color:#021129;font-weight:600;transition:height 250ms ease, background-color 150ms ease, transform 180ms ease;}
    .bar span{font-size:12px;padding:6px 4px;color:var(--text);text-shadow: 0 1px 0 rgba(0,0,0,0.2);}
    .bar.compare{background:var(--bar-compare);transform:translateY(-6px) scale(1.03);z-index:2;}
    .bar.min{background:var(--bar-min);transform:translateY(-6px) scale(1.04);z-index:3;}
    .bar.iidx{box-shadow:0 0 0 3px rgba(79,70,229,0.06) inset;}
    .bar.swap{background:linear-gradient(90deg,var(--good), #60a5fa);transform:translateY(-6px) scale(1.05);}
    .bar.sorted{background:var(--bar-sorted);transform:translateY(-2px);}
    .stats{margin-top:10px;display:flex;gap:14px;align-items:center;color:var(--muted);font-size:13px;}
    .stats b{color:var(--text);}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);color:var(--muted);}
    .pseudo{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:rgba(0,0,0,0.04);padding:8px;border-radius:8px;white-space:pre;line-height:1.5;margin-top:8px;font-size:13px;}
    .pseudo .line{display:block;padding:4px 6px;border-radius:6px;}
    .pseudo .active{background:linear-gradient(90deg, rgba(79,70,229,0.12), rgba(79,70,229,0.06));color:var(--text);}
    .small{font-size:13px;color:var(--muted);}
    .controls input[type=range]{width:160px;}
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;color:var(--muted);font-size:13px;}
    .legend{display:flex;gap:8px;align-items:center;}
    .legend .item{display:flex;align-items:center;gap:6px;font-size:13px;}
    .swatch{width:12px;height:12px;border-radius:3px;}
    .code-panel{max-height:320px;overflow:auto;}
    @media (max-width:880px){
      .row{flex-direction:column;}
      .right{width:100%;}
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Selection sort visualizer">
    <header>
      <h1>Selection Sort Visualizer</h1>
      <div class="small">Interactive step-by-step demonstration</div>
    </header>

    <div class="controls">
      <div class="seg">
        <label class="small" for="size">Array size</label>
        <input id="size" type="range" min="4" max="60" value="20" />
        <span id="sizeVal" class="small">20</span>
      </div>

      <div class="seg">
        <label class="small">Order</label>
        <select id="order" title="Choose ascending or descending">
          <option value="asc">Ascending</option>
          <option value="desc">Descending</option>
        </select>
      </div>

      <button id="randomBtn" title="Generate new random array">Randomize</button>
      <button id="startBtn" title="Play">Play ▶</button>
      <button id="pauseBtn" title="Pause" disabled>Pause ❚❚</button>
      <button id="stepF" title="Step forward">Step ▶</button>
      <button id="stepB" title="Step back">Step ◀</button>
      <button id="resetBtn" title="Reset to initial">Reset ⟲</button>

      <div class="seg">
        <label class="small" for="delay">Delay (ms)</label>
        <input id="delay" type="range" min="50" max="1200" value="350" />
        <span id="delayVal" class="small">350ms</span>
      </div>
    </div>

    <div class="row">
      <div class="left">
        <div class="vis panel" id="vis" aria-live="polite" aria-label="Array visualization"></div>

        <div class="stats">
          <div>Step: <b id="stepCounter">0</b>/<span id="maxStep">0</span></div>
          <div>Comparisons: <b id="compCount">0</b></div>
          <div>Swaps: <b id="swapCount">0</b></div>
          <div id="message" style="margin-left:auto;" class="small"></div>
        </div>
      </div>

      <div class="right">
        <div class="panel code-panel" style="margin-bottom:12px;">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <strong>Selection Sort (pseudocode)</strong>
            <div class="small">Complexity: O(n²)</div>
          </div>
          <pre class="pseudo" id="pseudocode" aria-hidden="false">
<span class="line" data-line="1">for i = 0 to n-2            // select position</span>
<span class="line" data-line="2">    minIndex = i</span>
<span class="line" data-line="3">    for j = i+1 to n-1      // find smallest/largest in remainder</span>
<span class="line" data-line="4">        if A[j] < A[minIndex]    // (or > for descending)</span>
<span class="line" data-line="5">            minIndex = j</span>
<span class="line" data-line="6">    if minIndex != i</span>
<span class="line" data-line="7">        swap A[i] and A[minIndex]</span>
          </pre>
        </div>

        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
            <strong>Controls / Info</strong>
            <div class="small">Click bars to edit value</div>
          </div>
          <div class="small" id="explain">
            Selection sort repeatedly selects the minimum (or maximum) element from the unsorted portion and swaps it into position.
          </div>

          <div style="margin-top:10px;">
            <div class="legend">
              <div class="item"><div class="swatch" style="background:var(--bar)"></div> Unsorted</div>
              <div class="item"><div class="swatch" style="background:var(--bar-min)"></div> Current min</div>
              <div class="item"><div class="swatch" style="background:var(--bar-compare)"></div> Comparing</div>
              <div class="item"><div class="swatch" style="background:var(--bar-sorted)"></div> Sorted</div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="footer">
      <div class="small">You can change array size, order, delay, and step through the algorithm.</div>
      <div class="small">© Selection Sort Demo</div>
    </div>
  </div>

  <script>
    // Selection Sort Visualizer
    (function(){
      const vis = document.getElementById('vis');
      const sizeInput = document.getElementById('size');
      const sizeVal = document.getElementById('sizeVal');
      const randomBtn = document.getElementById('randomBtn');
      const startBtn = document.getElementById('startBtn');
      const pauseBtn = document.getElementById('pauseBtn');
      const stepF = document.getElementById('stepF');
      const stepB = document.getElementById('stepB');
      const resetBtn = document.getElementById('resetBtn');
      const delayInput = document.getElementById('delay');
      const delayVal = document.getElementById('delayVal');
      const orderSel = document.getElementById('order');

      const stepCounter = document.getElementById('stepCounter');
      const maxStep = document.getElementById('maxStep');
      const compCount = document.getElementById('compCount');
      const swapCount = document.getElementById('swapCount');
      const message = document.getElementById('message');
      const pseudocode = document.getElementById('pseudocode');

      let array = [];
      let initialArray = [];
      let snapshots = [];
      let current = 0;
      let playing = false;
      let timer = null;

      function randArray(n){
        const arr = [];
        for(let i=0;i<n;i++){
          arr.push(Math.floor(Math.random()*90)+10); // values 10..99
        }
        return arr;
      }

      function renderArray(arrState){
        // arrState: {arr, i, j, minIndex, comparingIdx, swapped, sortedIndices}
        vis.innerHTML = '';
        const arr = arrState.arr;
        const max = Math.max(...arr, 100);
        const n = arr.length;
        arr.forEach((v, idx) => {
          const bar = document.createElement('div');
          bar.className = 'bar';
          bar.style.height = Math.max(12, (v / max) * 100) + '%';
          bar.title = String(v);
          const span = document.createElement('span');
          span.textContent = v;
          bar.appendChild(span);

          // classes
          if (arrState.sortedIndices && arrState.sortedIndices.has(idx)) bar.classList.add('sorted');
          if (arrState.i === idx) bar.classList.add('iidx');
          if (arrState.minIndex === idx) bar.classList.add('min');
          if (arrState.comparingIdx === idx) bar.classList.add('compare');
          if (arrState.swapped && arrState.swapped.includes(idx)) bar.classList.add('swap');

          // click to edit value
          bar.style.cursor = 'pointer';
          bar.addEventListener('click', () => {
            const val = prompt('Enter new value (integer):', String(v));
            if (val === null) return;
            const num = parseInt(val, 10);
            if (!isFinite(num)) return alert('Invalid number');
            array[idx] = num;
            initialArray = array.slice();
            rebuildSnapshots();
            applySnapshot(0);
          });

          vis.appendChild(bar);
        });
      }

      function highlightLine(line){
        const lines = pseudocode.querySelectorAll('.line');
        lines.forEach(el => {
          if (Number(el.dataset.line) === line) el.classList.add('active'); else el.classList.remove('active');
        });
      }

      function generateSnapshots(arrOrig, ascending){
        const arr = arrOrig.slice();
        const n = arr.length;
        const snaps = [];
        let comparisons = 0;
        let swaps = 0;
        const sortedIndices = new Set();

        const pushSnap = (opts={}) => {
          snaps.push({
            arr: arr.slice(),
            i: opts.i != null ? opts.i : null,
            j: opts.j != null ? opts.j : null,
            minIndex: opts.minIndex != null ? opts.minIndex : null,
            comparingIdx: opts.comparingIdx != null ? opts.comparingIdx : null,
            swapped: opts.swapped ? opts.swapped.slice() : null,
            sortedIndices: new Set(sortedIndices),
            comparisons,
            swaps,
            msg: opts.msg || '',
            line: opts.line || 0
          });
        };

        // initial
        pushSnap({msg: 'Initial array', line: 0});

        for (let i = 0; i < n-1; i++){
          let minIndex = i;
          pushSnap({i, minIndex, msg: `Select position ${i}`, line: 1});
          pushSnap({i, minIndex, msg: `Assume index ${i} is current min`, line:2});

          for (let j = i+1; j < n; j++){
            // compare
            comparisons++;
            pushSnap({i, j, minIndex, comparingIdx: j, msg: `Compare A[${j}] with A[${minIndex}]`, line:3});
            pushSnap({i, j, minIndex, comparingIdx: j, msg: `Comparison`, line:4});

            const isBetter = ascending ? (arr[j] < arr[minIndex]) : (arr[j] > arr[minIndex]);
            if (isBetter){
              minIndex = j;
              pushSnap({i, j, minIndex, comparingIdx: j, msg: `New min at index ${j}`, line:5});
            }
          }

          // after inner loop
          if (minIndex !== i){
            // swap
            swaps++;
            pushSnap({i, minIndex, swapped: [i, minIndex], msg:`Swap A[${i}] and A[${minIndex}]`, line:6});
            // perform swap
            const tmp = arr[i]; arr[i] = arr[minIndex]; arr[minIndex] = tmp;
            pushSnap({arr: arr.slice(), i, minIndex, swapped: [i,minIndex], msg:`After swap`, line:7});
          } else {
            pushSnap({i, minIndex, msg:`No swap needed for position ${i}`, line:6});
          }

          sortedIndices.add(i);
          pushSnap({i:null, minIndex:null, msg:`Position ${i} fixed`, line:1});
        }

        // final mark
        sortedIndices.add(n-1);
        pushSnap({arr: arr.slice(), msg:`Array sorted`, line:0, sortedIndices: new Set(sortedIndices)});
        // ensure comparisons/swaps counters on last snapshot
        snaps.forEach(s => { s.comparisons = comparisons; s.swaps = swaps; });

        return snaps;
      }

      function rebuildSnapshots(){
        snapshots = generateSnapshots(initialArray, orderSel.value === 'asc');
        current = 0;
        stepCounter.textContent = 0;
        maxStep.textContent = snapshots.length - 1;
        compCount.textContent = snapshots[0].comparisons || 0;
        swapCount.textContent = snapshots[0].swaps || 0;
      }

      function applySnapshot(idx){
        if (idx < 0) idx = 0;
        if (idx >= snapshots.length) idx = snapshots.length - 1;
        current = idx;
        const s = snapshots[current];
        renderArray(s);
        stepCounter.textContent = current;
        maxStep.textContent = snapshots.length - 1;
        compCount.textContent = s.comparisons;
        swapCount.textContent = s.swaps;
        message.textContent = s.msg || '';
        highlightLine(s.line || 0);

        // disable/enable controls logically
        pauseBtn.disabled = !playing;
        startBtn.disabled = playing;
      }

      function play(){
        if (playing) return;
        playing = true;
        startBtn.disabled = true;
        pauseBtn.disabled = false;
        const delay = Number(delayInput.value) || 300;

        timer = setInterval(() => {
          if (current < snapshots.length - 1){
            applySnapshot(current + 1);
          } else {
            stop();
          }
        }, delay);
      }

      function stop(){
        playing = false;
        startBtn.disabled = false;
        pauseBtn.disabled = true;
        if (timer){ clearInterval(timer); timer = null; }
      }

      // Event bindings
      sizeInput.addEventListener('input', () => {
        sizeVal.textContent = sizeInput.value;
      });

      sizeInput.addEventListener('change', () => {
        array = randArray(Number(sizeInput.value));
        initialArray = array.slice();
        rebuildSnapshots();
        applySnapshot(0);
      });

      randomBtn.addEventListener('click', () => {
        array = randArray(Number(sizeInput.value));
        initialArray = array.slice();
        rebuildSnapshots();
        applySnapshot(0);
      });

      orderSel.addEventListener('change', () => {
        rebuildSnapshots();
        applySnapshot(0);
      });

      delayInput.addEventListener('input', () => {
        delayVal.textContent = delayInput.value + 'ms';
        if (playing){
          stop(); play();
        }
      });

      startBtn.addEventListener('click', () => {
        play();
      });

      pauseBtn.addEventListener('click', () => {
        stop();
      });

      stepF.addEventListener('click', () => {
        stop();
        applySnapshot(current + 1);
      });

      stepB.addEventListener('click', () => {
        stop();
        applySnapshot(current - 1);
      });

      resetBtn.addEventListener('click', () => {
        stop();
        initialArray = array.slice();
        rebuildSnapshots();
        applySnapshot(0);
      });

      // initialize
      array = randArray(Number(sizeInput.value));
      initialArray = array.slice();
      rebuildSnapshots();
      applySnapshot(0);

      // keyboard shortcuts
      window.addEventListener('keydown', (e) => {
        if (e.key === ' ') { e.preventDefault(); if (playing) stop(); else play(); }
        if (e.key === 'ArrowRight') { e.preventDefault(); stepF.click(); }
        if (e.key === 'ArrowLeft') { e.preventDefault(); stepB.click(); }
        if (e.key === 'r') randomBtn.click();
      });

    })();
  </script>
</body>
</html>