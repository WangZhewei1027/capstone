<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Linked List Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background: #f9fafb;
  }
  h1 {
    color: #333;
  }
  #visualization {
    margin-top: 20px;
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    min-height: 80px;
  }
  .node {
    border: 2px solid #007acc;
    background-color: #e0f0ff;
    border-radius: 5px;
    width: 60px;
    height: 60px;
    position: relative;
    margin: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    font-size: 1.2em;
    user-select: none;
  }
  /* Arrow between nodes */
  .arrow {
    width: 40px;
    height: 2px;
    background-color: #007acc;
    position: relative;
    margin: 0 5px;
  }
  .arrow::after {
    content: '';
    position: absolute;
    right: 0;
    top: -5px;
    border: 7px solid transparent;
    border-left-color: #007acc;
  }
  form {
    margin-top: 20px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
  }
  label {
    font-weight: bold;
    margin-right: 5px;
  }
  input[type="number"], input[type="text"] {
    padding: 5px;
    font-size: 1em;
    width: 100px;
  }
  button {
    padding: 8px 15px;
    font-size: 1em;
    background-color: #007acc;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }
  button:hover {
    background-color: #005fa3;
  }
  #status {
    margin-top: 20px;
    min-height: 24px;
    font-style: italic;
    color: #666;
  }
</style>
</head>
<body>
<h1>Singly Linked List Visualization & Demo</h1>
<form id="operations-form">
  <label for="value-input">Value:</label>
  <input type="text" id="value-input" required />
  
  <label for="index-input" title="Index is optional and used for insert/remove at position (0-based).">Index (optional):</label>
  <input type="number" id="index-input" min="0" />
  
  <button type="button" id="append-btn" title="Add node at the end">Append</button>
  <button type="button" id="prepend-btn" title="Add node at the start">Prepend</button>
  <button type="button" id="insert-btn" title="Insert node at index">Insert at Index</button>
  <button type="button" id="remove-btn" title="Remove node at index">Remove at Index</button>
  <button type="button" id="pop-btn" title="Remove last node">Pop</button>
  <button type="button" id="shift-btn" title="Remove first node">Shift</button>
  <button type="button" id="clear-btn" title="Clear the entire list">Clear List</button>
</form>

<div id="status"></div>

<div id="visualization" aria-label="Linked list visualization" role="region"></div>

<script>
  /*
    Singly Linked List Implementation with Visualization
  */
  class Node {
    constructor(value) {
      this.value = value;
      this.next = null;
    }
  }

  class LinkedList {
    constructor() {
      this.head = null;
      this.length = 0;
    }

    append(value) {
      const newNode = new Node(value);
      if (!this.head) {
        this.head = newNode;
      } else {
        let current = this.head;
        while(current.next) {
          current = current.next;
        }
        current.next = newNode;
      }
      this.length++;
    }

    prepend(value) {
      const newNode = new Node(value);
      newNode.next = this.head;
      this.head = newNode;
      this.length++;
    }

    insert(value, index) {
      if (index < 0 || index > this.length) {
        return false;
      }
      if (index === 0) {
        this.prepend(value);
        return true;
      } 
      if (index === this.length) {
        this.append(value);
        return true;
      }
      const newNode = new Node(value);
      let current = this.head;
      let previous = null;
      let i = 0;
      while(i < index) {
        previous = current;
        current = current.next;
        i++;
      }
      previous.next = newNode;
      newNode.next = current;
      this.length++;
      return true;
    }

    remove(index) {
      if(index < 0 || index >= this.length || !this.head) {
        return null;
      }
      let removedValue;
      if(index === 0) {
        removedValue = this.head.value;
        this.head = this.head.next;
        this.length--;
        return removedValue;
      }

      let current = this.head;
      let previous = null;
      let i = 0;
      while(i < index) {
        previous = current;
        current = current.next;
        i++;
      }
      removedValue = current.value;
      previous.next = current.next;
      this.length--;
      return removedValue;
    }

    pop() {
      if (!this.head) return null;
      if(this.length === 1) {
        const val = this.head.value;
        this.head = null;
        this.length--;
        return val;
      }
      let current = this.head;
      while(current.next.next) {
        current = current.next;
      }
      const val = current.next.value;
      current.next = null;
      this.length--;
      return val;
    }

    shift() {
      if(!this.head) return null;
      const val = this.head.value;
      this.head = this.head.next;
      this.length--;
      return val;
    }

    clear() {
      this.head = null;
      this.length = 0;
    }

    toArray() {
      let arr = [];
      let current = this.head;
      while(current) {
        arr.push(current.value);
        current = current.next;
      }
      return arr;
    }
  }

  // Visualization & UI logic

  const list = new LinkedList();

  const visualContainer = document.getElementById('visualization');
  const statusEl = document.getElementById('status');
  const valueInput = document.getElementById('value-input');
  const indexInput = document.getElementById('index-input');

  function clearStatus() {
    statusEl.textContent = '';
  }

  function setStatus(msg, error=false) {
    statusEl.textContent = msg;
    statusEl.style.color = error ? 'red' : '#666';
  }

  // Render the linked list nodes and arrows
  function renderList() {
    visualContainer.innerHTML = '';
    let current = list.head;
    let i = 0;
    if (!current) {
      visualContainer.textContent = '(empty list)';
      return;
    }
    while(current) {
      const nodeEl = document.createElement('div');
      nodeEl.className = 'node';
      nodeEl.textContent = current.value;

      // Add aria-label for accessibility
      nodeEl.setAttribute('aria-label', `Node ${i}: value ${current.value}`);

      visualContainer.appendChild(nodeEl);

      if(current.next !== null) {
        const arrowEl = document.createElement('div');
        arrowEl.className = 'arrow';
        // Adding aria-hidden for decorative arrows
        arrowEl.setAttribute('aria-hidden', 'true');
        visualContainer.appendChild(arrowEl);
      }
      current = current.next;
      i++;
    }
  }

  // Helpers to get and validate index
  function getIndexInput() {
    const val = indexInput.value.trim();
    if(val === '') return null;
    const num = Number(val);
    if(Number.isInteger(num) && num >= 0) return num;
    return null;
  }

  // Bind buttons
  document.getElementById('append-btn').addEventListener('click', () => {
    clearStatus();
    const val = valueInput.value.trim();
    if(val === '') {
      setStatus('Please enter a value to append.', true);
      return;
    }
    list.append(val);
    renderList();
    setStatus(`Appended "${val}" to the end of the list.`);
  });

  document.getElementById('prepend-btn').addEventListener('click', () => {
    clearStatus();
    const val = valueInput.value.trim();
    if(val === '') {
      setStatus('Please enter a value to prepend.', true);
      return;
    }
    list.prepend(val);
    renderList();
    setStatus(`Prepended "${val}" to the start of the list.`);
  });

  document.getElementById('insert-btn').addEventListener('click', () => {
    clearStatus();
    const val = valueInput.value.trim();
    if(val === '') {
      setStatus('Please enter a value to insert.', true);
      return;
    }
    const index = getIndexInput();
    if(index === null) {
      setStatus('Please enter a valid index (0 or greater) to insert at.', true);
      return;
    }
    if(index > list.length) {
      setStatus(`Index out of bounds. List length is ${list.length}.`, true);
      return;
    }
    list.insert(val, index);
    renderList();
    setStatus(`Inserted "${val}" at index ${index}.`);
  });

  document.getElementById('remove-btn').addEventListener('click', () => {
    clearStatus();
    const index = getIndexInput();
    if(index === null) {
      setStatus('Please enter a valid index (0 or greater) to remove.', true);
      return;
    }
    if(index >= list.length) {
      setStatus(`Index out of bounds. List length is ${list.length}.`, true);
      return;
    }
    const removed = list.remove(index);
    renderList();
    setStatus(`Removed node with value "${removed}" at index ${index}.`);
  });

  document.getElementById('pop-btn').addEventListener('click', () => {
    clearStatus();
    const removed = list.pop();
    if(removed === null) {
      setStatus('List is empty, nothing to pop.', true);
      return;
    }
    renderList();
    setStatus(`Popped last node with value "${removed}".`);
  });

  document.getElementById('shift-btn').addEventListener('click', () => {
    clearStatus();
    const removed = list.shift();
    if(removed === null) {
      setStatus('List is empty, nothing to remove from start.', true);
      return;
    }
    renderList();
    setStatus(`Removed first node with value "${removed}".`);
  });

  document.getElementById('clear-btn').addEventListener('click', () => {
    clearStatus();
    list.clear();
    renderList();
    setStatus('Cleared the entire list.');
  });

  // Initial render:
  renderList();
</script>
</body>
</html>