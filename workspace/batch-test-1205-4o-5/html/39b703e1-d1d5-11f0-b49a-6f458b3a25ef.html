<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red-Black Tree Visualization</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .tree { display: flex; justify-content: center; }
        .node { border: 1px solid black; border-radius: 5px; margin: 5px; padding: 10px; background-color: red; color: white; }
        .black { background-color: black; }
        .input-area { margin: 20px; }
    </style>
</head>
<body>

<h1>Red-Black Tree Visualization</h1>
<div class="input-area">
    <input type="number" id="value" placeholder="Enter a number" />
    <button id="insertButton">Insert</button>
</div>
<div class="tree" id="treeContainer"></div>

<script>
    class Node {
        constructor(data) {
            this.data = data;
            this.color = 'red'; // New nodes are red
            this.left = null;
            this.right = null;
            this.parent = null;
        }
    }

    class RedBlackTree {
        constructor() {
            this.root = null;
        }

        insert(value) {
            let newNode = new Node(value);
            this.root = this._insert(this.root, newNode);
            this.fixViolation(newNode);
        }

        _insert(root, newNode) {
            if (root === null) {
                return newNode;
            }
            if (newNode.data < root.data) {
                root.left = this._insert(root.left, newNode);
                root.left.parent = root;
            } else {
                root.right = this._insert(root.right, newNode);
                root.right.parent = root;
            }
            return root;
        }

        fixViolation(node) {
            while (node !== this.root && node.parent.color === 'red') {
                const grandparent = node.parent.parent;
                if (node.parent === grandparent.left) {
                    const uncle = grandparent.right;
                    if (uncle && uncle.color === 'red') {
                        node.parent.color = 'black';
                        uncle.color = 'black';
                        grandparent.color = 'red';
                        node = grandparent;
                    } else {
                        if (node === node.parent.right) {
                            this.rotateLeft(node.parent);
                            node = node.left;
                        }
                        this.rotateRight(grandparent);
                        [grandparent.color, node.parent.color] = [node.parent.color, grandparent.color];
                    }
                } else {
                    const uncle = grandparent.left;
                    if (uncle && uncle.color === 'red') {
                        node.parent.color = 'black';
                        uncle.color = 'black';
                        grandparent.color = 'red';
                        node = grandparent;
                    } else {
                        if (node === node.parent.left) {
                            this.rotateRight(node.parent);
                            node = node.right;
                        }
                        this.rotateLeft(grandparent);
                        [grandparent.color, node.parent.color] = [node.parent.color, grandparent.color];
                    }
                }
            }
            this.root.color = 'black';
        }

        rotateLeft(node) {
            const rightChild = node.right;
            node.right = rightChild.left;
            if (rightChild.left !== null) {
                rightChild.left.parent = node;
            }
            rightChild.parent = node.parent;
            if (node.parent === null) {
                this.root = rightChild;
            } else if (node === node.parent.left) {
                node.parent.left = rightChild;
            } else {
                node.parent.right = rightChild;
            }
            rightChild.left = node;
            node.parent = rightChild;
        }

        rotateRight(node) {
            const leftChild = node.left;
            node.left = leftChild.right;
            if (leftChild.right !== null) {
                leftChild.right.parent = node;
            }
            leftChild.parent = node.parent;
            if (node.parent === null) {
                this.root = leftChild;
            } else if (node === node.parent.left) {
                node.parent.left = leftChild;
            } else {
                node.parent.right = leftChild;
            }
            leftChild.right = node;
            node.parent = leftChild;
        }

        display() {
            const container = document.getElementById('treeContainer');
            container.innerHTML = '';
            this._display(this.root, container);
        }

        _display(node, container) {
            if (!node) return;
            const nodeDiv = document.createElement('div');
            nodeDiv.className = `node ${node.color}`;
            nodeDiv.innerText = node.data;
            container.appendChild(nodeDiv);
            const subContainer = document.createElement('div');
            subContainer.className = 'tree';
            this._display(node.left, subContainer);
            this._display(node.right, subContainer);
            container.appendChild(subContainer);
        }
    }

    const rbTree = new RedBlackTree();

    document.getElementById('insertButton').addEventListener('click', () => {
        const value = parseInt(document.getElementById('value').value);
        if (!isNaN(value)) {
            rbTree.insert(value);
            rbTree.display();
            document.getElementById('value').value = '';
        }
    });
</script>

</body>
</html>