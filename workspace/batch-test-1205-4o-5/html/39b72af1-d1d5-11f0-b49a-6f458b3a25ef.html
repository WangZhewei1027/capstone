<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph Visualization</title>
    <style>
        #graph-container {
            width: 100%;
            height: 500px;
            border: 1px solid #ccc;
            position: relative;
            overflow: hidden;
        }
        .node {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #4CAF50;
            position: absolute;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }
        .edge {
            position: absolute;
            width: 2px;
            background-color: black;
            transform-origin: 0 0;
        }
    </style>
</head>
<body>

<h1>Graph Visualization</h1>
<div id="graph-container"></div>
<button id="addNode">Add Node</button>
<button id="addEdge">Add Edge</button>
<button id="clearGraph">Clear Graph</button>

<script>
    const graphContainer = document.getElementById('graph-container');
    const nodes = {};
    const edges = [];
    let nodeCount = 0;

    function addNode() {
        nodeCount++;
        const nodeId = `node${nodeCount}`;
        const nodeDiv = document.createElement('div');
        nodeDiv.classList.add('node');
        nodeDiv.id = nodeId;
        nodeDiv.innerText = nodeCount;
        nodeDiv.style.left = Math.random() * (graphContainer.clientWidth - 30) + 'px';
        nodeDiv.style.top = Math.random() * (graphContainer.clientHeight - 30) + 'px';
        
        nodeDiv.onclick = () => selectNode(nodeId);
        
        nodes[nodeId] = { element: nodeDiv };
        graphContainer.appendChild(nodeDiv);
    }

    let selectedNode = null;
    function selectNode(nodeId) {
        if (selectedNode) {
            selectedNode.classList.remove('selected');
            selectedNode = null;
        }

        selectedNode = document.getElementById(nodeId);
        selectedNode.classList.add('selected');
    }

    function addEdge() {
        if (!selectedNode) {
            alert('Please select a node first.');
            return;
        }

        const targetNode = prompt("Enter the id of target node (e.g. node1, node2):");
        if (targetNode && nodes[targetNode]) {
            const edgeDiv = document.createElement('div');
            edgeDiv.classList.add('edge');
            const x1 = parseFloat(selectedNode.style.left) + 15;
            const y1 = parseFloat(selectedNode.style.top) + 15;
            const x2 = parseFloat(nodes[targetNode].element.style.left) + 15;
            const y2 = parseFloat(nodes[targetNode].element.style.top) + 15;

            const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
            edgeDiv.style.width = length + 'px';
            edgeDiv.style.transform = `rotate(${Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI}deg)`;
            edgeDiv.style.left = x1 + 'px';
            edgeDiv.style.top = y1 + 'px';
            graphContainer.appendChild(edgeDiv);
            edges.push({ from: selectedNode.id, to: targetNode, element: edgeDiv });
        } else {
            alert('Invalid target node id.');
        }
    }

    function clearGraph() {
        nodes = {};
        edges = [];
        nodeCount = 0;
        graphContainer.innerHTML = '';
    }

    document.getElementById('addNode').onclick = addNode;
    document.getElementById('addEdge').onclick = addEdge;
    document.getElementById('clearGraph').onclick = clearGraph;
</script>

</body>
</html>