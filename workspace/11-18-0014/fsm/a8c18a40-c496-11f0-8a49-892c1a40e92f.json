{
  "topic": "Bubble Sort Visualization",
  "description": "Finite State Machine for the interactive Bubble Sort visualization UI and its algorithm runner/animation lifecycle.",
  "states": [
    {
      "name": "idle",
      "onEnter": "render",
      "onExit": "noop",
      "on": {
        "START_CLICKED": "running",
        "SHUFFLE_CLICKED": "shuffling",
        "RESET_CLICKED": "resetting",
        "SIZE_INPUT": "idle",
        "SIZE_CHANGED": "idle",
        "SPEED_INPUT": "idle",
        "ORDER_CHANGED": "idle",
        "WINDOW_RESIZE": "idle"
      }
    },
    {
      "name": "running",
      "onEnter": "runGenerator",
      "onExit": "noop",
      "on": {
        "PAUSE_CLICKED": "paused",
        "STEP_CLICKED": "stepping",
        "SHUFFLE_CLICKED": "shuffling",
        "RESET_CLICKED": "resetting",
        "SIZE_CHANGED": "idle",
        "ORDER_CHANGED": "idle",
        "SPEED_INPUT": "running",
        "GENERATOR_PASS_START": "pass",
        "GENERATOR_COMPARE": "comparing",
        "GENERATOR_SWAP": "swapping",
        "GENERATOR_AFTER_COMPARE": "running",
        "GENERATOR_PASS_END": "running",
        "GENERATOR_DONE": "done",
        "WINDOW_RESIZE": "running"
      }
    },
    {
      "name": "paused",
      "onEnter": "pauseAlgorithm",
      "onExit": "noop",
      "on": {
        "START_CLICKED": "running",
        "STEP_CLICKED": "stepping",
        "SHUFFLE_CLICKED": "shuffling",
        "RESET_CLICKED": "resetting",
        "SIZE_CHANGED": "idle",
        "ORDER_CHANGED": "idle",
        "SPEED_INPUT": "paused",
        "WINDOW_RESIZE": "paused"
      }
    },
    {
      "name": "stepping",
      "onEnter": "runOneStep",
      "onExit": "noop",
      "on": {
        "GENERATOR_COMPARE": "comparing",
        "GENERATOR_SWAP": "swapping",
        "GENERATOR_AFTER_COMPARE": "paused",
        "GENERATOR_PASS_END": "paused",
        "STEP_EXECUTED": "paused",
        "START_CLICKED": "running",
        "SHUFFLE_CLICKED": "shuffling",
        "RESET_CLICKED": "resetting",
        "WINDOW_RESIZE": "stepping"
      }
    },
    {
      "name": "comparing",
      "onEnter": "markCompare; increment comparisons; highlight(2); waitDelay",
      "onExit": "unmarkPair",
      "on": {
        "GENERATOR_AFTER_COMPARE": "running",
        "STEP_EXECUTED": "paused",
        "WINDOW_RESIZE": "comparing"
      }
    },
    {
      "name": "swapping",
      "onEnter": "animateSwap",
      "onExit": "unmarkPair",
      "on": {
        "ANIMATION_COMPLETE": "running",
        "STEP_EXECUTED": "paused",
        "WINDOW_RESIZE": "swapping"
      }
    },
    {
      "name": "pass",
      "onEnter": "highlight(1); update passCount",
      "onExit": "noop",
      "on": {
        "GENERATOR_PASS_END": "running",
        "WINDOW_RESIZE": "pass"
      }
    },
    {
      "name": "done",
      "onEnter": "markAllSorted; highlight(6)",
      "onExit": "noop",
      "on": {
        "START_CLICKED": "running",
        "SHUFFLE_CLICKED": "shuffling",
        "RESET_CLICKED": "resetting",
        "SIZE_CHANGED": "idle",
        "WINDOW_RESIZE": "done"
      }
    },
    {
      "name": "shuffling",
      "onEnter": "initArray(array.length); resetStats; render; stopAlgorithm",
      "onExit": "idle",
      "on": {
        "SHUFFLE_COMPLETED": "idle",
        "START_CLICKED": "running",
        "WINDOW_RESIZE": "shuffling"
      }
    },
    {
      "name": "resetting",
      "onEnter": "initArray(array.length, true); resetStats; render; stopAlgorithm",
      "onExit": "idle",
      "on": {
        "RESET_COMPLETED": "idle",
        "START_CLICKED": "running",
        "WINDOW_RESIZE": "resetting"
      }
    }
  ],
  "events": [
    "START_CLICKED",
    "PAUSE_CLICKED",
    "STEP_CLICKED",
    "SHUFFLE_CLICKED",
    "RESET_CLICKED",
    "SIZE_INPUT",
    "SIZE_CHANGED",
    "SPEED_INPUT",
    "ORDER_CHANGED",
    "WINDOW_RESIZE",
    "GENERATOR_PASS_START",
    "GENERATOR_COMPARE",
    "GENERATOR_SWAP",
    "GENERATOR_AFTER_COMPARE",
    "GENERATOR_PASS_END",
    "GENERATOR_DONE",
    "ANIMATION_COMPLETE",
    "STEP_EXECUTED",
    "SHUFFLE_COMPLETED",
    "RESET_COMPLETED"
  ],
  "triggers": {
    "START_CLICKED": "#startBtn",
    "PAUSE_CLICKED": "#pauseBtn",
    "STEP_CLICKED": "#stepBtn",
    "SHUFFLE_CLICKED": "#shuffleBtn",
    "RESET_CLICKED": "#resetBtn",
    "SIZE_INPUT": "#size",
    "SIZE_CHANGED": "#size",
    "SPEED_INPUT": "#speed",
    "ORDER_CHANGED": "#order",
    "WINDOW_RESIZE": "window",
    "GENERATOR_PASS_START": "#viz",
    "GENERATOR_COMPARE": "#viz",
    "GENERATOR_SWAP": "#viz",
    "GENERATOR_AFTER_COMPARE": "#viz",
    "GENERATOR_PASS_END": "#viz",
    "GENERATOR_DONE": "#viz",
    "ANIMATION_COMPLETE": "#viz",
    "STEP_EXECUTED": "#stepBtn, #startBtn",
    "SHUFFLE_COMPLETED": "#shuffleBtn",
    "RESET_COMPLETED": "#resetBtn"
  },
  "notes": "Extracted selectors: #startBtn (button.btn-primary), #pauseBtn, #stepBtn, #shuffleBtn, #resetBtn, #size (input[type=range]), #sizeVal, #speed (input[type=range]), #speedVal, #order (select), #viz (visualization container), .bar, .bar-label, #pcode .line[data-line], .panel, .controls, .buttons. UI events map to the button/input/select selectors above. Generator/animation events are associated with the #viz visualization element."
}