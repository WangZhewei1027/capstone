<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Counting Sort Interactive Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 24px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 8px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 32px;
            font-size: 1.1em;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            justify-content: center;
            margin-bottom: 32px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 12px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .primary-btn {
            background: #667eea;
            color: white;
        }

        .primary-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .secondary-btn {
            background: #e2e8f0;
            color: #4a5568;
        }

        .secondary-btn:hover {
            background: #cbd5e0;
        }

        .secondary-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .speed-slider {
            width: 150px;
        }

        .visualization {
            margin-bottom: 32px;
        }

        .array-container {
            display: flex;
            justify-content: center;
            margin: 24px 0;
            min-height: 70px;
            align-items: center;
        }

        .array-element {
            width: 50px;
            height: 50px;
            margin: 0 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #e2e8f0;
            border-radius: 8px;
            font-size: 20px;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
        }

        .array-element.highlight {
            background: #4299e1;
            color: white;
            transform: scale(1.1);
        }

        .array-element.sorted {
            background: #48bb78;
            color: white;
        }

        .array-element.processing {
            background: #ed8936;
            color: white;
        }

        .count-element {
            width: 60px;
            height: 60px;
            margin: 0 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #f7fafc;
            border: 2px solid #cbd5e0;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .count-element.active {
            background: #bee3f8;
            border-color: #4299e1;
            transform: scale(1.1);
        }

        .count-label {
            font-size: 12px;
            color: #718096;
            margin-bottom: 4px;
        }

        .count-value {
            font-size: 24px;
            font-weight: bold;
            color: #2d3748;
        }

        .step-description {
            text-align: center;
            padding: 20px;
            background: #edf2f7;
            border-radius: 12px;
            margin: 24px 0;
            font-size: 18px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .section-label {
            text-align: center;
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 12px;
        }

        .info-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 32px;
        }

        .info-card {
            padding: 20px;
            background: #f7fafc;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .info-card h3 {
            color: #4a5568;
            margin-bottom: 12px;
        }

        .info-card p {
            color: #718096;
            line-height: 1.6;
        }

        .custom-input {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .custom-input input {
            padding: 8px 12px;
            border: 2px solid #cbd5e0;
            border-radius: 6px;
            font-size: 16px;
            width: 200px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            .array-element, .count-element {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .info-panel {
                grid-template-columns: 1fr;
            }

            .controls {
                padding: 16px;
            }
        }

        .moving-element {
            position: absolute;
            transition: all 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Counting Sort Visualization</h1>
        <p class="subtitle">A non-comparison based sorting algorithm for integers</p>

        <div class="controls">
            <button class="primary-btn" onclick="generateRandomArray()">Generate Random Array</button>
            <div class="custom-input">
                <input type="text" id="customArray" placeholder="e.g., 3,1,4,1,5,9,2,6">
                <button class="secondary-btn" onclick="useCustomArray()">Use Custom</button>
            </div>
            <button class="secondary-btn" id="stepBtn" onclick="nextStep()" disabled>Next Step</button>
            <button class="secondary-btn" id="prevBtn" onclick="prevStep()" disabled>Previous Step</button>
            <button class="secondary-btn" id="autoBtn" onclick="toggleAuto()">Auto Play</button>
            <div class="speed-control">
                <label>Speed:</label>
                <input type="range" class="speed-slider" id="speedSlider" min="100" max="2000" value="1000" step="100">
                <span id="speedValue">1000ms</span>
            </div>
        </div>

        <div class="visualization">
            <div class="section-label">Original Array</div>
            <div class="array-container" id="originalArray"></div>

            <div class="section-label">Count Array (0-9)</div>
            <div class="array-container" id="countArray"></div>

            <div class="section-label">Sorted Array</div>
            <div class="array-container" id="sortedArray"></div>
        </div>

        <div class="step-description" id="stepDescription">
            Click "Generate Random Array" to begin!
        </div>

        <div class="info-panel">
            <div class="info-card">
                <h3>Time Complexity</h3>
                <p><strong>O(n + k)</strong> where n is the number of elements and k is the range of values. This makes it very efficient when k is small relative to n.</p>
            </div>
            <div class="info-card">
                <h3>Best Use Cases</h3>
                <p>Ideal for sorting integers within a known, limited range. Commonly used for sorting grades (0-100), ages, or small positive integers.</p>
            </div>
        </div>
    </div>

    <script>
        let originalArray = [];
        let countArray = [];
        let sortedArray = [];
        let currentStep = -1;
        let steps = [];
        let autoPlay = false;
        let autoPlayInterval = null;

        const speedSlider = document.getElementById('speedSlider');
        const speedValue = document.getElementById('speedValue');
        
        speedSlider.addEventListener('input', (e) => {
            speedValue.textContent = `${e.target.value}ms`;
            if (autoPlay) {
                stopAuto();
                startAuto();
            }
        });

        function generateRandomArray() {
            const size = 10;
            originalArray = [];
            for (let i = 0; i < size; i++) {
                originalArray.push(Math.floor(Math.random() * 10));
            }
            initializeSort();
        }

        function useCustomArray() {
            const input = document.getElementById('customArray').value;
            const numbers = input.split(',').map(n => parseInt(n.trim())).filter(n => !isNaN(n) && n >= 0 && n <= 9);
            if (numbers.length > 0) {
                originalArray = numbers;
                initializeSort();
            } else {
                alert('Please enter valid numbers between 0 and 9, separated by commas');
            }
        }

        function initializeSort() {
            countArray = new Array(10).fill(0);
            sortedArray = new Array(originalArray.length);
            currentStep = -1;
            steps = [];
            stopAuto();
            
            generateSteps();
            renderArrays();
            
            document.getElementById('stepBtn').disabled = false;
            document.getElementById('prevBtn').disabled = true;
            document.getElementById('stepDescription').textContent = 'Ready to start! Click "Next Step" to begin.';
        }

        function generateSteps() {
            steps = [];
            
            // Initial state
            steps.push({
                phase: 'initial',
                description: 'Initial array ready for sorting',
                highlights: []
            });

            // Counting phase
            for (let i = 0; i < originalArray.length; i++) {
                steps.push({
                    phase: 'counting',
                    index: i,
                    value: originalArray[i],
                    description: `Counting occurrence of ${originalArray[i]} at position ${i}`,
                    highlights: [i]
                });
            }

            // Show complete count
            steps.push({
                phase: 'count-complete',
                description: 'Counting phase complete! Each count[i] shows how many times digit i appears',
                highlights: []
            });

            // Accumulation phase
            const tempCount = [...countArray];
            for (let i = 0; i < originalArray.length; i++) {
                tempCount[originalArray[i]]++;
            }
            
            const cumulative = [...tempCount];
            for (let i = 1; i < 10; i++) {
                cumulative[i] += cumulative[i - 1];
                steps.push({
                    phase: 'accumulating',
                    index: i,
                    description: `Accumulating: count[${i}] = count[${i}] + count[${i-1}] = ${cumulative[i]}`,
                    cumulative: [...cumulative]
                });
            }

            // Placement phase
            const placement = [...cumulative];
            for (let i = originalArray.length - 1; i >= 0; i--) {
                const value = originalArray[i];
                placement[value]--;
                steps.push({
                    phase: 'placing',
                    index: i,
                    value: value,
                    position: placement[value],
                    description: `Placing ${value} from position ${i} to sorted position ${placement[value]}`,
                    highlights: [i]
                });
            }

            // Final state
            steps.push({
                phase: 'complete',
                description: 'Sorting complete! The array is now sorted in ascending order.',
                highlights: []
            });
        }

        function renderArrays() {
            // Render original array
            const origContainer = document.getElementById('originalArray');
            origContainer.innerHTML = '';
            originalArray.forEach((val, idx) => {
                const elem = document.createElement('div');
                elem.className = 'array-element';
                elem.textContent = val;
                elem.id = `orig-${idx}`;
                origContainer.appendChild(elem);
            });

            // Render count array
            const countContainer = document.getElementById('countArray');
            countContainer.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const elem = document.createElement('div');
                elem.className = 'count-element';
                elem.id = `count-${i}`;
                elem.innerHTML = `
                    <div class="count-label">${i}</div>
                    <div class="count-value" id="count-value-${i}">0</div>
                `;
                countContainer.appendChild(elem);
            }

            // Render sorted array
            const sortedContainer = document.getElementById('sortedArray');
            sortedContainer.innerHTML = '';
            for (let i = 0; i < originalArray.length; i++) {
                const elem = document.createElement('div');
                elem.className = 'array-element';
                elem.id = `sorted-${i}`;
                sortedContainer.appendChild(elem);
            }
        }

        function nextStep() {
            if (currentStep < steps.length - 1) {
                currentStep++;
                executeStep();
                updateButtons();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                resetToStep();
                updateButtons();
            }
        }

        function updateButtons() {
            document.getElementById('stepBtn').disabled = currentStep >= steps.length - 1;
            document.getElementById('prevBtn').disabled = currentStep <= 0;
        }

        function executeStep() {
            const step = steps[currentStep];
            document.getElementById('stepDescription').textContent = step.description;

            // Clear all highlights
            document.querySelectorAll('.array-element').forEach(elem => {
                elem.classList.remove('highlight', 'processing');
            });
            document.querySelectorAll('.count-element').forEach(elem => {
                elem.classList.remove('active');
            });

            switch (step.phase) {
                case 'counting':
                    document.getElementById(`orig-${step.index}`).classList.add('highlight');
                    document.getElementById(`count-${step.value}`).classList.add('active');
                    const currentCount = parseInt(document.getElementById(`count-value-${step.value}`).textContent);
                    document.getElementById(`count-value-${step.value}`).textContent = currentCount + 1;
                    break;

                case 'accumulating':
                    document.getElementById(`count-${step.index}`).classList.add('active');
                    if (step.index > 0) {
                        document.getElementById(`count-${step.index - 1}`).classList.add('active');
                    }
                    for (let i = 0; i < 10; i++) {
                        document.getElementById(`count-value-${i}`).textContent = step.cumulative[i];
                    }
                    break;

                case 'placing':
                    document.getElementById(`orig-${step.index}`).classList.add('processing');
                    const sortedElem = document.getElementById(`sorted-${step.position}`);
                    sortedElem.textContent = step.value;
                    sortedElem.classList.add('sorted');
                    
                    // Update count array to show position decrement
                    const posCount = parseInt(document.getElementById(`count-value-${step.value}`).textContent);
                    document.getElementById(`count-value-${step.value}`).textContent = posCount - 1;
                    document.getElementById(`count-${step.value}`).classList.add('active');
                    break;

                case 'complete':
                    document.querySelectorAll('#sortedArray .array-element').forEach(elem => {
                        elem.classList.add('sorted');
                    });
                    break;
            }

            // Highlight elements mentioned in step
            if (step.highlights) {
                step.highlights.forEach(idx => {
                    document.getElementById(`orig-${idx}`).classList.add('highlight');
                });
            }
        }

        function resetToStep() {
            // Reset everything and replay up to current step
            document.querySelectorAll('.count-value').forEach(elem => {
                elem.textContent = '0';
            });
            document.querySelectorAll('#sortedArray .array-element').forEach(elem => {
                elem.textContent = '';
                elem.classList.remove('sorted');
            });

            const tempStep = currentStep;
            currentStep = -1;
            
            for (let i = 0; i <= tempStep; i++) {
                currentStep = i;
                executeStep();
            }
        }

        function toggleAuto() {
            autoPlay = !autoPlay;
            document.getElementById('autoBtn').textContent = autoPlay ? 'Stop' : 'Auto Play';
            
            if (autoPlay) {
                startAuto();
            } else {
                stopAuto();
            }
        }

        function startAuto() {
            autoPlayInterval = setInterval(() => {
                if (currentStep < steps.length - 1) {
                    nextStep();
                } else {
                    stopAuto();
                }
            }, parseInt(speedSlider.value));
        }

        function stopAuto() {
            if (autoPlayInterval) {
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
            }
            autoPlay = false;
            document.getElementById('autoBtn').textContent = 'Auto Play';
        }

        // Initialize with a random array on load
        window.onload = () => {
            generateRandomArray();
        };
    </script>
</body>
</html>