<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sliding Window Algorithm - Interactive Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f5f7fa;
            color: #2c3e50;
            line-height: 1.6;
            padding: 24px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 32px;
        }

        h1 {
            font-size: 2.5rem;
            color: #3498db;
            margin-bottom: 8px;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #7f8c8d;
        }

        .controls {
            display: flex;
            gap: 24px;
            align-items: center;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        label {
            font-weight: 500;
            color: #34495e;
        }

        select, input[type="range"] {
            padding: 8px 12px;
            border: 2px solid #bdc3c7;
            border-radius: 6px;
            font-size: 1rem;
            background-color: white;
            transition: border-color 0.3s;
        }

        select:focus, input[type="range"]:focus {
            outline: none;
            border-color: #3498db;
        }

        input[type="range"] {
            width: 120px;
            padding: 0;
        }

        .visualization-area {
            background: white;
            border-radius: 12px;
            padding: 48px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
        }

        .array-container {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 24px;
            position: relative;
            padding: 20px 0;
        }

        .array-element {
            width: 60px;
            height: 60px;
            border: 2px solid #34495e;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            background-color: white;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            z-index: 2;
        }

        .array-element:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .array-element.in-window {
            background-color: #3498db;
            color: white;
            border-color: #2980b9;
        }

        .array-element.processing {
            background-color: #f39c12;
            color: white;
            border-color: #d68910;
        }

        .window-overlay {
            position: absolute;
            height: 80px;
            background-color: rgba(52, 152, 219, 0.2);
            border: 3px solid #3498db;
            border-radius: 12px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1;
            pointer-events: none;
        }

        .window-info {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #2c3e50;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.4s;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 32px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            background-color: #3498db;
            color: white;
            min-width: 44px;
            min-height: 44px;
        }

        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        button.secondary {
            background-color: #ecf0f1;
            color: #34495e;
        }

        button.secondary:hover {
            background-color: #bdc3c7;
        }

        .stats-panel {
            background-color: #ecf0f1;
            border-radius: 12px;
            padding: 24px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
        }

        .stat-card {
            text-align: center;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
        }

        .stat-value.efficient {
            color: #27ae60;
        }

        .stat-value.inefficient {
            color: #e74c3c;
        }

        .code-snippet {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 24px;
            border-radius: 12px;
            margin-top: 32px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            display: none;
        }

        .code-snippet.visible {
            display: block;
        }

        .code-toggle {
            text-align: center;
            margin-top: 24px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .controls {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .array-element {
                width: 50px;
                height: 50px;
                font-size: 1rem;
            }

            .visualization-area {
                padding: 24px;
            }

            .action-buttons {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>The Sliding Window Technique</h1>
            <p class="subtitle">Efficient Array/String Processing Algorithm</p>
        </header>

        <div class="controls">
            <div class="control-group">
                <label for="problem-select">Problem:</label>
                <select id="problem-select">
                    <option value="max-sum">Maximum Sum of K Elements</option>
                    <option value="unique-chars">Longest Unique Substring</option>
                    <option value="distinct-count">Distinct Elements Count</option>
                </select>
            </div>

            <div class="control-group">
                <label for="window-size">Window Size:</label>
                <input type="range" id="window-size" min="2" max="6" value="3">
                <span id="window-size-display">3</span>
            </div>

            <div class="control-group">
                <label for="speed">Animation Speed:</label>
                <input type="range" id="speed" min="100" max="2000" value="1000">
            </div>
        </div>

        <div class="visualization-area">
            <div class="array-container" id="array-container">
                <div class="window-overlay" id="window-overlay">
                    <div class="window-info" id="window-info">Sum: 0</div>
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button id="prev-btn" onclick="previousStep()">Previous</button>
            <button id="play-btn" onclick="togglePlay()">Play</button>
            <button id="next-btn" onclick="nextStep()">Next</button>
            <button class="secondary" onclick="reset()">Reset</button>
        </div>

        <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-label">Naive Approach</div>
                <div class="stat-value inefficient" id="naive-ops">0</div>
                <div class="stat-label">Operations (O(nÂ²))</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Sliding Window</div>
                <div class="stat-value efficient" id="sliding-ops">0</div>
                <div class="stat-label">Operations (O(n))</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Current Result</div>
                <div class="stat-value" id="current-result">0</div>
                <div class="stat-label" id="result-label">Maximum Sum</div>
            </div>
        </div>

        <div class="code-toggle">
            <button class="secondary" onclick="toggleCode()">Toggle Code Example</button>
        </div>

        <pre class="code-snippet" id="code-snippet">
// Sliding Window - Maximum Sum of K Elements
function maxSumSubarray(arr, k) {
    let maxSum = 0;
    let windowSum = 0;
    
    // Calculate sum of first window
    for (let i = 0; i < k; i++) {
        windowSum += arr[i];
    }
    maxSum = windowSum;
    
    // Slide the window
    for (let i = k; i < arr.length; i++) {
        windowSum = windowSum - arr[i - k] + arr[i];
        maxSum = Math.max(maxSum, windowSum);
    }
    
    return maxSum;
}
        </pre>
    </div>

    <script>
        // State management
        let array = [1, 3, 2, 6, -1, 4, 1, 8, 2];
        let windowSize = 3;
        let windowStart = 0;
        let currentProblem = 'max-sum';
        let isPlaying = false;
        let playInterval = null;
        let results = [];

        // DOM elements
        const arrayContainer = document.getElementById('array-container');
        const windowOverlay = document.getElementById('window-overlay');
        const windowInfo = document.getElementById('window-info');
        const windowSizeSlider = document.getElementById('window-size');
        const windowSizeDisplay = document.getElementById('window-size-display');
        const speedSlider = document.getElementById('speed');
        const playBtn = document.getElementById('play-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const problemSelect = document.getElementById('problem-select');
        const codeSnippet = document.getElementById('code-snippet');

        // Initialize
        function init() {
            createArrayElements();
            updateWindow();
            updateStats();
            updateButtons();
        }

        // Create array elements
        function createArrayElements() {
            arrayContainer.innerHTML = '<div class="window-overlay" id="window-overlay"><div class="window-info" id="window-info">Sum: 0</div></div>';
            
            array.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'array-element';
                element.textContent = value;
                element.dataset.index = index;
                element.onclick = () => editElement(index);
                arrayContainer.appendChild(element);
            });

            // Re-get window overlay reference
            windowOverlay = document.getElementById('window-overlay');
            windowInfo = document.getElementById('window-info');
        }

        // Edit array element
        function editElement(index) {
            const newValue = prompt('Enter new value:', array[index]);
            if (newValue !== null && !isNaN(newValue)) {
                array[index] = parseInt(newValue);
                reset();
            }
        }

        // Update window position and highlighting
        function updateWindow() {
            const elements = document.querySelectorAll('.array-element');
            const windowEnd = Math.min(windowStart + windowSize, array.length);
            
            // Clear previous highlighting
            elements.forEach(el => el.classList.remove('in-window', 'processing'));
            
            // Highlight window elements
            for (let i = windowStart; i < windowEnd; i++) {
                elements[i].classList.add('in-window');
            }
            
            // Update overlay position and size
            if (windowStart < elements.length && windowEnd <= elements.length) {
                const firstElement = elements[windowStart];
                const lastElement = elements[windowEnd - 1];
                const containerRect = arrayContainer.getBoundingClientRect();
                const firstRect = firstElement.getBoundingClientRect();
                const lastRect = lastElement.getBoundingClientRect();
                
                windowOverlay.style.left = (firstRect.left - containerRect.left - 10) + 'px';
                windowOverlay.style.width = (lastRect.right - firstRect.left + 20) + 'px';
                windowOverlay.style.top = '10px';
                
                // Update window info
                updateWindowInfo();
            }
        }

        // Update window information display
        function updateWindowInfo() {
            const windowEnd = Math.min(windowStart + windowSize, array.length);
            let info = '';
            
            switch (currentProblem) {
                case 'max-sum':
                    const sum = array.slice(windowStart, windowEnd).reduce((a, b) => a + b, 0);
                    info = `Sum: ${sum}`;
                    break;
                case 'unique-chars':
                    const unique = new Set(array.slice(windowStart, windowEnd)).size;
                    info = `Unique: ${unique}`;
                    break;
                case 'distinct-count':
                    const distinct = new Set(array.slice(windowStart, windowEnd)).size;
                    info = `Distinct: ${distinct}`;
                    break;
            }
            
            windowInfo.textContent = info;
        }

        // Calculate results
        function calculateResult() {
            results = [];
            const maxWindow = array.length - windowSize + 1;
            
            for (let i = 0; i < maxWindow; i++) {
                const window = array.slice(i, i + windowSize);
                let result;
                
                switch (currentProblem) {
                    case 'max-sum':
                        result = window.reduce((a, b) => a + b, 0);
                        break;
                    case 'unique-chars':
                        result = new Set(window).size;
                        break;
                    case 'distinct-count':
                        result = new Set(window).size;
                        break;
                }
                
                results.push(result);
            }
        }

        // Update statistics
        function updateStats() {
            calculateResult();
            
            // Naive approach operations
            const naiveOps = array.length * windowSize;
            document.getElementById('naive-ops').textContent = naiveOps;
            
            // Sliding window operations
            const slidingOps = array.length + windowSize - 1;
            document.getElementById('sliding-ops').textContent = slidingOps;
            
            // Current result
            let currentResult = 0;
            let resultLabel = '';
            
            if (results.length > 0) {
                switch (currentProblem) {
                    case 'max-sum':
                        currentResult = Math.max(...results.slice(0, windowStart + 1));
                        resultLabel = 'Maximum Sum';
                        break;
                    case 'unique-chars':
                        currentResult = Math.max(...results.slice(0, windowStart + 1));
                        resultLabel = 'Max Unique Count';
                        break;
                    case 'distinct-count':
                        currentResult = results[windowStart] || 0;
                        resultLabel = 'Distinct Elements';
                        break;
                }
            }
            
            document.getElementById('current-result').textContent = currentResult;
            document.getElementById('result-label').textContent = resultLabel;
        }

        // Navigation functions
        function nextStep() {
            if (windowStart < array.length - windowSize) {
                windowStart++;
                updateWindow();
                updateStats();
                updateButtons();
            }
        }

        function previousStep() {
            if (windowStart > 0) {
                windowStart--;
                updateWindow();
                updateStats();
                updateButtons();
            }
        }

        function reset() {
            windowStart = 0;
            stopPlay();
            init();
        }

        // Play/pause functionality
        function togglePlay() {
            if (isPlaying) {
                stopPlay();
            } else {
                startPlay();
            }
        }

        function startPlay() {
            isPlaying = true;
            playBtn.textContent = 'Pause';
            const speed = 2100 - speedSlider.value;
            
            playInterval = setInterval(() => {
                if (windowStart >= array.length - windowSize) {
                    stopPlay();
                } else {
                    nextStep();
                }
            }, speed);
        }

        function stopPlay() {
            isPlaying = false;
            playBtn.textContent = 'Play';
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
            }
        }

        // Update button states
        function updateButtons() {
            prevBtn.disabled = windowStart === 0;
            nextBtn.disabled = windowStart >= array.length - windowSize;
            if (windowStart >= array.length - windowSize && isPlaying) {
                stopPlay();
            }
        }

        // Toggle code snippet
        function toggleCode() {
            codeSnippet.classList.toggle('visible');
            
            // Update code based on current problem
            const codeExamples = {
                'max-sum': `// Sliding Window - Maximum Sum of K Elements
function maxSumSubarray(arr, k) {
    let maxSum = 0;
    let windowSum = 0;
    
    // Calculate sum of first window
    for (let i = 0; i < k; i++) {
        windowSum += arr[i];
    }
    maxSum = windowSum;
    
    // Slide the window
    for (let i = k; i < arr.length; i++) {
        windowSum = windowSum - arr[i - k] + arr[i];
        maxSum = Math.max(maxSum, windowSum);
    }
    
    return maxSum;
}`,
                'unique-chars': `// Sliding Window - Longest Substring with Unique Characters
function longestUniqueSubstring(str) {
    let start = 0, maxLen = 0;
    let charMap = new Map();
    
    for (let end = 0; end < str.length; end++) {
        if (charMap.has(str[end])) {
            start = Math.max(start, charMap.get(str[end]) + 1);
        }
        charMap.set(str[end], end);
        maxLen = Math.max(maxLen, end - start + 1);
    }
    
    return maxLen;
}`,
                'distinct-count': `// Sliding Window - Count Distinct Elements in Window
function countDistinct(arr, k) {
    let result = [];
    let freq = new Map();
    
    // First window
    for (let i = 0; i < k; i++) {
        freq.set(arr[i], (freq.get(arr[i]) || 0) + 1);
    }
    result.push(freq.size);
    
    // Slide the window
    for (let i = k; i < arr.length; i++) {
        // Remove the outgoing element
        let outgoing = arr[i - k];
        if (freq.get(outgoing) === 1) {
            freq.delete(outgoing);
        } else {
            freq.set(outgoing, freq.get(outgoing) - 1);
        }
        
        // Add the incoming element
        freq.set(arr[i], (freq.get(arr[i]) || 0) + 1);
        result.push(freq.size);
    }
    
    return result;
}`
            };
            
            codeSnippet.textContent = codeExamples[currentProblem];
        }

        // Event listeners
        windowSizeSlider.addEventListener('input', (e) => {
            windowSize = parseInt(e.target.value);
            windowSizeDisplay.textContent = windowSize;
            reset();
        });

        problemSelect.addEventListener('change', (e) => {
            currentProblem = e.target.value;
            reset();
            
            // Update array for string problems
            if (currentProblem === 'unique-chars') {
                array = [1, 2, 3, 1, 4, 2, 3, 5, 1];
            } else {
                array = [1, 3, 2, 6, -1, 4, 1, 8, 2];
            }
            init();
        });

        speedSlider.addEventListener('input', () => {
            if (isPlaying) {
                stopPlay();
                startPlay();
            }
        });

        // Initialize on load
        init();
    </script>
</body>
</html>