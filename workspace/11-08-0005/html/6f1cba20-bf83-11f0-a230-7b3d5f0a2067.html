<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Hash Map Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            min-height: 100vh;
            padding: 24px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 24px;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 12px;
            color: #2c3e50;
        }

        .description {
            color: #666;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .control-panel {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: #555;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        button {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-insert {
            background-color: #4CAF50;
            color: white;
        }

        .btn-insert:hover {
            background-color: #45a049;
        }

        .btn-search {
            background-color: #2196F3;
            color: white;
        }

        .btn-search:hover {
            background-color: #1976D2;
        }

        .btn-delete {
            background-color: #f44336;
            color: white;
        }

        .btn-delete:hover {
            background-color: #d32f2f;
        }

        .hash-display {
            margin-top: 20px;
            padding: 16px;
            background-color: #fff;
            border-radius: 6px;
            border: 2px solid #e0e0e0;
        }

        .hash-display h3 {
            font-size: 14px;
            margin-bottom: 8px;
            color: #666;
        }

        .hash-calculation {
            font-family: monospace;
            font-size: 16px;
            color: #2c3e50;
            min-height: 24px;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        .visualization {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
        }

        .buckets-container {
            display: flex;
            gap: 16px;
            min-height: 300px;
            padding-bottom: 20px;
        }

        .bucket {
            flex: 1;
            min-width: 120px;
            background-color: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            transition: all 0.3s;
        }

        .bucket.active {
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        .bucket.searching {
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
        }

        .bucket-header {
            font-weight: 600;
            font-size: 14px;
            color: #666;
            margin-bottom: 12px;
            text-align: center;
        }

        .bucket-items {
            min-height: 200px;
        }

        .hash-item {
            background-color: #e8f5e9;
            border: 1px solid #c8e6c9;
            border-radius: 4px;
            padding: 8px;
            margin-bottom: 8px;
            font-size: 13px;
            opacity: 0;
            transform: translateY(-10px);
            animation: slideIn 0.3s forwards;
            position: relative;
        }

        .hash-item.deleting {
            animation: slideOut 0.3s forwards;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideOut {
            to {
                opacity: 0;
                transform: translateX(20px);
            }
        }

        .hash-item::after {
            content: "↓";
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            color: #999;
            font-size: 16px;
        }

        .hash-item:last-child::after {
            display: none;
        }

        .key-value {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .key {
            font-weight: 600;
            color: #2c3e50;
        }

        .value {
            color: #666;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }

        .stat-card {
            background-color: #f8f9fa;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
        }

        .message {
            position: fixed;
            top: 40px;
            right: 40px;
            padding: 12px 24px;
            border-radius: 6px;
            color: white;
            font-weight: 500;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s;
            z-index: 1000;
        }

        .message.show {
            opacity: 1;
            transform: translateY(0);
        }

        .message.success {
            background-color: #4CAF50;
        }

        .message.error {
            background-color: #f44336;
        }

        .message.info {
            background-color: #2196F3;
        }

        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
            }

            .buckets-container {
                flex-wrap: wrap;
            }

            .bucket {
                min-width: calc(50% - 8px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Interactive Hash Map Visualization</h1>
        <p class="description">
            Explore how hash maps achieve O(1) average time complexity for insertion, search, and deletion operations. 
            Watch as keys are hashed to array indices and see how collisions are resolved using chaining.
        </p>

        <div class="main-layout">
            <div class="control-panel">
                <div class="control-group">
                    <label for="keyInput">Key:</label>
                    <input type="text" id="keyInput" placeholder="Enter a key">
                </div>
                
                <div class="control-group">
                    <label for="valueInput">Value:</label>
                    <input type="text" id="valueInput" placeholder="Enter a value">
                </div>

                <div class="button-group">
                    <button class="btn-insert" onclick="insertItem()">Insert</button>
                    <button class="btn-search" onclick="searchItem()">Search</button>
                    <button class="btn-delete" onclick="deleteItem()">Delete</button>
                </div>

                <div class="hash-display">
                    <h3>Hash Calculation:</h3>
                    <div class="hash-calculation" id="hashCalculation"></div>
                </div>
            </div>

            <div class="visualization">
                <div class="buckets-container" id="bucketsContainer">
                    <!-- Buckets will be dynamically generated -->
                </div>
            </div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-label">Total Items</div>
                <div class="stat-value" id="totalItems">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Load Factor</div>
                <div class="stat-value" id="loadFactor">0.00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Collisions</div>
                <div class="stat-value" id="collisions">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Buckets Used</div>
                <div class="stat-value" id="bucketsUsed">0</div>
            </div>
        </div>
    </div>

    <div class="message" id="message"></div>

    <script>
        class HashMap {
            constructor(size = 8) {
                this.buckets = new Array(size).fill(null).map(() => []);
                this.size = size;
                this.itemCount = 0;
                this.collisionCount = 0;
            }

            hash(key) {
                let hash = 0;
                for (let i = 0; i < key.length; i++) {
                    hash = (hash * 31 + key.charCodeAt(i)) % this.size;
                }
                return Math.abs(hash);
            }

            insert(key, value) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                
                // Check if key already exists
                const existingIndex = bucket.findIndex(item => item.key === key);
                if (existingIndex !== -1) {
                    bucket[existingIndex].value = value;
                    return { index, updated: true };
                }
                
                // Track collisions
                if (bucket.length > 0) {
                    this.collisionCount++;
                }
                
                bucket.push({ key, value });
                this.itemCount++;
                return { index, updated: false };
            }

            search(key) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                const item = bucket.find(item => item.key === key);
                return { index, found: item ? item.value : null };
            }

            delete(key) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                const itemIndex = bucket.findIndex(item => item.key === key);
                
                if (itemIndex !== -1) {
                    bucket.splice(itemIndex, 1);
                    this.itemCount--;
                    if (bucket.length === 0 && this.buckets[index].length > 1) {
                        this.collisionCount--;
                    }
                    return { index, deleted: true };
                }
                
                return { index, deleted: false };
            }

            getStats() {
                const bucketsUsed = this.buckets.filter(bucket => bucket.length > 0).length;
                const loadFactor = (this.itemCount / this.size).toFixed(2);
                return {
                    totalItems: this.itemCount,
                    loadFactor,
                    collisions: this.collisionCount,
                    bucketsUsed
                };
            }
        }

        // Initialize hash map
        const hashMap = new HashMap(8);

        // Initialize visualization
        function initializeVisualization() {
            const container = document.getElementById('bucketsContainer');
            container.innerHTML = '';
            
            for (let i = 0; i < hashMap.size; i++) {
                const bucket = document.createElement('div');
                bucket.className = 'bucket';
                bucket.id = `bucket-${i}`;
                
                const header = document.createElement('div');
                header.className = 'bucket-header';
                header.textContent = `Bucket ${i}`;
                
                const items = document.createElement('div');
                items.className = 'bucket-items';
                items.id = `bucket-items-${i}`;
                
                bucket.appendChild(header);
                bucket.appendChild(items);
                container.appendChild(bucket);
            }
            
            updateStats();
        }

        function showHashCalculation(key) {
            const calcElement = document.getElementById('hashCalculation');
            const hash = hashMap.hash(key);
            
            let calculation = `"${key}" → `;
            for (let i = 0; i < key.length; i++) {
                if (i > 0) calculation += ' + ';
                calculation += `${key.charCodeAt(i)}`;
            }
            calculation += ` → ${hash}`;
            
            calcElement.style.animation = 'none';
            setTimeout(() => {
                calcElement.textContent = calculation;
                calcElement.style.animation = 'fadeIn 0.5s forwards';
            }, 10);
        }

        function updateBucketVisualization(index, items) {
            const bucketItems = document.getElementById(`bucket-items-${index}`);
            bucketItems.innerHTML = '';
            
            items.forEach((item, i) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'hash-item';
                itemElement.style.animationDelay = `${i * 0.1}s`;
                
                const keyValue = document.createElement('div');
                keyValue.className = 'key-value';
                
                const key = document.createElement('span');
                key.className = 'key';
                key.textContent = item.key;
                
                const value = document.createElement('span');
                value.className = 'value';
                value.textContent = item.value;
                
                keyValue.appendChild(key);
                keyValue.appendChild(value);
                itemElement.appendChild(keyValue);
                bucketItems.appendChild(itemElement);
            });
        }

        function highlightBucket(index, type = 'active') {
            const bucket = document.getElementById(`bucket-${index}`);
            bucket.classList.add(type);
            setTimeout(() => {
                bucket.classList.remove(type);
            }, 1500);
        }

        function showMessage(text, type = 'info') {
            const message = document.getElementById('message');
            message.textContent = text;
            message.className = `message ${type}`;
            message.classList.add('show');
            
            setTimeout(() => {
                message.classList.remove('show');
            }, 3000);
        }

        function updateStats() {
            const stats = hashMap.getStats();
            document.getElementById('totalItems').textContent = stats.totalItems;
            document.getElementById('loadFactor').textContent = stats.loadFactor;
            document.getElementById('collisions').textContent = stats.collisions;
            document.getElementById('bucketsUsed').textContent = stats.bucketsUsed;
        }

        function insertItem() {
            const key = document.getElementById('keyInput').value.trim();
            const value = document.getElementById('valueInput').value.trim();
            
            if (!key || !value) {
                showMessage('Please enter both key and value', 'error');
                return;
            }
            
            showHashCalculation(key);
            const result = hashMap.insert(key, value);
            
            highlightBucket(result.index, 'active');
            updateBucketVisualization(result.index, hashMap.buckets[result.index]);
            updateStats();
            
            if (result.updated) {
                showMessage(`Updated value for key "${key}"`, 'info');
            } else {
                showMessage(`Inserted "${key}" → "${value}"`, 'success');
            }
            
            // Clear inputs
            document.getElementById('keyInput').value = '';
            document.getElementById('valueInput').value = '';
        }

        function searchItem() {
            const key = document.getElementById('keyInput').value.trim();
            
            if (!key) {
                showMessage('Please enter a key to search', 'error');
                return;
            }
            
            showHashCalculation(key);
            const result = hashMap.search(key);
            
            highlightBucket(result.index, 'searching');
            
            if (result.found) {
                showMessage(`Found: "${key}" → "${result.found}"`, 'success');
                document.getElementById('valueInput').value = result.found;
            } else {
                showMessage(`Key "${key}" not found`, 'error');
            }
        }

        function deleteItem() {
            const key = document.getElementById('keyInput').value.trim();
            
            if (!key) {
                showMessage('Please enter a key to delete', 'error');
                return;
            }
            
            showHashCalculation(key);
            const result = hashMap.delete(key);
            
            if (result.deleted) {
                highlightBucket(result.index, 'active');
                
                // Animate deletion
                const bucketItems = document.getElementById(`bucket-items-${result.index}`);
                const items = bucketItems.querySelectorAll('.hash-item');
                items.forEach(item => {
                    const itemKey = item.querySelector('.key').textContent;
                    if (itemKey === key) {
                        item.classList.add('deleting');
                    }
                });
                
                setTimeout(() => {
                    updateBucketVisualization(result.index, hashMap.buckets[result.index]);
                }, 300);
                
                updateStats();
                showMessage(`Deleted key "${key}"`, 'success');
            } else {
                showMessage(`Key "${key}" not found`, 'error');
            }
            
            document.getElementById('keyInput').value = '';
            document.getElementById('valueInput').value = '';
        }

        // Initialize on load
        initializeVisualization();

        // Add some sample data
        const sampleData = [
            { key: 'name', value: 'John' },
            { key: 'age', value: '25' },
            { key: 'city', value: 'NYC' }
        ];

        setTimeout(() => {
            sampleData.forEach((item, index) => {
                setTimeout(() => {
                    document.getElementById('keyInput').value = item.key;
                    document.getElementById('valueInput').value = item.value;
                    insertItem();
                }, index * 1000);
            });
        }, 500);
    </script>
</body>
</html>