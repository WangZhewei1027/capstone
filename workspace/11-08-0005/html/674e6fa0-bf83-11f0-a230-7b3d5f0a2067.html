<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hash Table Visualizer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f7fa;
            color: #2d3748;
            padding: 24px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 32px;
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            color: #1a365d;
            margin-bottom: 8px;
        }

        .subtitle {
            color: #64748b;
            font-size: 1.1rem;
        }

        .load-factor {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 80px;
            height: 80px;
        }

        .load-factor-circle {
            fill: none;
            stroke: #e2e8f0;
            stroke-width: 8;
        }

        .load-factor-progress {
            fill: none;
            stroke: #3b82f6;
            stroke-width: 8;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: center;
            transition: stroke-dashoffset 0.3s ease;
        }

        .load-factor-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.9rem;
            font-weight: bold;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 3fr;
            gap: 32px;
            margin-bottom: 32px;
        }

        .control-panel {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .input-group {
            margin-bottom: 16px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #475569;
        }

        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 24px;
        }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            min-height: 44px;
        }

        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn-insert {
            background: #10b981;
            color: white;
        }

        .btn-search {
            background: #3b82f6;
            color: white;
        }

        .btn-delete {
            background: #ef4444;
            color: white;
        }

        .hash-display {
            margin-top: 24px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .hash-calculation {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #64748b;
            word-break: break-all;
        }

        .hash-result {
            font-size: 1.2rem;
            font-weight: bold;
            color: #1a365d;
            margin-top: 8px;
        }

        .visualization-panel {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: relative;
            min-height: 400px;
        }

        .hash-table-viz {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .bucket {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            min-height: 80px;
            position: relative;
            transition: all 0.3s;
        }

        .bucket:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .bucket-index {
            position: absolute;
            top: -10px;
            left: 8px;
            background: white;
            padding: 0 8px;
            font-size: 0.8rem;
            font-weight: bold;
            color: #64748b;
        }

        .bucket-content {
            margin-top: 8px;
        }

        .bucket-item {
            background: white;
            padding: 8px;
            margin-bottom: 8px;
            border-radius: 4px;
            font-size: 0.9rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            animation: slideIn 0.3s ease-out;
        }

        .bucket-item:last-child {
            margin-bottom: 0;
        }

        .bucket-key {
            font-weight: 600;
            color: #1a365d;
        }

        .bucket-value {
            color: #64748b;
            font-size: 0.85rem;
        }

        .stats-panel {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #1a365d;
        }

        .stat-label {
            color: #64748b;
            font-size: 0.9rem;
            margin-top: 4px;
        }

        .operation-log {
            margin-top: 24px;
            max-height: 200px;
            overflow-y: auto;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .log-entry {
            padding: 8px;
            margin-bottom: 8px;
            border-radius: 4px;
            animation: fadeIn 0.3s ease-out;
        }

        .log-success {
            background: #d1fae5;
            color: #065f46;
        }

        .log-error {
            background: #fee2e2;
            color: #991b1b;
        }

        .log-info {
            background: #dbeafe;
            color: #1e40af;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes highlight {
            0%, 100% {
                background-color: transparent;
            }
            50% {
                background-color: #fbbf24;
            }
        }

        .highlighting {
            animation: highlight 1s ease-in-out;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .load-factor {
                position: static;
                margin: 20px auto 0;
                transform: none;
            }
            
            .button-group {
                grid-template-columns: 1fr;
            }
            
            .hash-table-viz {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Hash Table Visualizer</h1>
            <p class="subtitle">Explore how hash tables efficiently store and retrieve key-value pairs</p>
            <div class="load-factor">
                <svg width="80" height="80">
                    <circle cx="40" cy="40" r="32" class="load-factor-circle"></circle>
                    <circle cx="40" cy="40" r="32" class="load-factor-progress"
                            stroke-dasharray="201" stroke-dashoffset="201"></circle>
                </svg>
                <div class="load-factor-text">0%</div>
            </div>
        </header>

        <div class="main-content">
            <div class="control-panel">
                <div class="input-group">
                    <label for="key-input">Key:</label>
                    <input type="text" id="key-input" placeholder="Enter a key...">
                </div>
                <div class="input-group">
                    <label for="value-input">Value:</label>
                    <input type="text" id="value-input" placeholder="Enter a value...">
                </div>
                
                <div class="button-group">
                    <button class="btn-insert" onclick="insertItem()">Insert</button>
                    <button class="btn-search" onclick="searchItem()">Search</button>
                    <button class="btn-delete" onclick="deleteItem()">Delete</button>
                </div>

                <div class="hash-display">
                    <div class="hash-calculation" id="hash-calc">Hash calculation will appear here...</div>
                    <div class="hash-result" id="hash-result"></div>
                </div>

                <div class="operation-log" id="operation-log"></div>
            </div>

            <div class="visualization-panel">
                <h3>Hash Table Buckets</h3>
                <div class="hash-table-viz" id="hash-table-viz"></div>
            </div>
        </div>

        <div class="stats-panel">
            <div class="stat-item">
                <div class="stat-value" id="total-elements">0</div>
                <div class="stat-label">Total Elements</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="collision-count">0</div>
                <div class="stat-label">Collisions</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="avg-chain-length">0</div>
                <div class="stat-label">Avg Chain Length</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="table-size">8</div>
                <div class="stat-label">Table Size</div>
            </div>
        </div>
    </div>

    <script>
        class HashTable {
            constructor(size = 8) {
                this.buckets = new Array(size);
                for (let i = 0; i < size; i++) {
                    this.buckets[i] = [];
                }
                this.size = size;
                this.count = 0;
                this.collisions = 0;
            }

            hash(key) {
                let hash = 0;
                for (let i = 0; i < key.length; i++) {
                    hash = (hash + key.charCodeAt(i) * (i + 1)) % this.size;
                }
                return hash;
            }

            insert(key, value) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                
                const existingIndex = bucket.findIndex(item => item.key === key);
                if (existingIndex >= 0) {
                    bucket[existingIndex].value = value;
                    return { success: true, index, collision: false, updated: true };
                }
                
                const collision = bucket.length > 0;
                if (collision) this.collisions++;
                
                bucket.push({ key, value });
                this.count++;
                
                return { success: true, index, collision, updated: false };
            }

            search(key) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                const item = bucket.find(item => item.key === key);
                
                return { 
                    found: !!item, 
                    value: item?.value, 
                    index,
                    position: bucket.findIndex(item => item.key === key)
                };
            }

            delete(key) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                const position = bucket.findIndex(item => item.key === key);
                
                if (position >= 0) {
                    bucket.splice(position, 1);
                    this.count--;
                    return { success: true, index };
                }
                
                return { success: false, index };
            }

            getLoadFactor() {
                return this.count / this.size;
            }

            getAverageChainLength() {
                const nonEmptyBuckets = this.buckets.filter(b => b.length > 0).length;
                return nonEmptyBuckets > 0 ? (this.count / nonEmptyBuckets).toFixed(2) : 0;
            }
        }

        let hashTable = new HashTable();

        function updateVisualization() {
            const viz = document.getElementById('hash-table-viz');
            viz.innerHTML = '';
            
            hashTable.buckets.forEach((bucket, index) => {
                const bucketDiv = document.createElement('div');
                bucketDiv.className = 'bucket';
                bucketDiv.innerHTML = `
                    <div class="bucket-index">${index}</div>
                    <div class="bucket-content">
                        ${bucket.map(item => `
                            <div class="bucket-item">
                                <div class="bucket-key">${item.key}</div>
                                <div class="bucket-value">${item.value}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                viz.appendChild(bucketDiv);
            });
            
            updateStats();
        }

        function updateStats() {
            document.getElementById('total-elements').textContent = hashTable.count;
            document.getElementById('collision-count').textContent = hashTable.collisions;
            document.getElementById('avg-chain-length').textContent = hashTable.getAverageChainLength();
            document.getElementById('table-size').textContent = hashTable.size;
            
            const loadFactor = hashTable.getLoadFactor();
            const loadFactorPercent = Math.round(loadFactor * 100);
            document.querySelector('.load-factor-text').textContent = `${loadFactorPercent}%`;
            
            const circle = document.querySelector('.load-factor-progress');
            const circumference = 2 * Math.PI * 32;
            circle.style.strokeDashoffset = circumference - (circumference * loadFactor);
            
            if (loadFactor > 0.7) {
                circle.style.stroke = '#ef4444';
            } else if (loadFactor > 0.5) {
                circle.style.stroke = '#f59e0b';
            } else {
                circle.style.stroke = '#3b82f6';
            }
        }

        function showHashCalculation(key) {
            const calcDiv = document.getElementById('hash-calc');
            const resultDiv = document.getElementById('hash-result');
            
            if (!key) {
                calcDiv.textContent = 'Hash calculation will appear here...';
                resultDiv.textContent = '';
                return;
            }
            
            let calculation = '';
            let sum = 0;
            for (let i = 0; i < key.length; i++) {
                const charCode = key.charCodeAt(i);
                const contribution = charCode * (i + 1);
                sum += contribution;
                calculation += `'${key[i]}' (${charCode}) × ${i + 1} = ${contribution}`;
                if (i < key.length - 1) calculation += ' + ';
            }
            
            const hash = sum % hashTable.size;
            calcDiv.innerHTML = calculation;
            resultDiv.innerHTML = `Sum: ${sum} % ${hashTable.size} = <strong>${hash}</strong>`;
            
            return hash;
        }

        function logOperation(message, type = 'info') {
            const log = document.getElementById('operation-log');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            log.insertBefore(entry, log.firstChild);
            
            if (log.children.length > 10) {
                log.removeChild(log.lastChild);
            }
        }

        function highlightBucket(index) {
            const buckets = document.querySelectorAll('.bucket');
            if (buckets[index]) {
                buckets[index].classList.add('highlighting');
                setTimeout(() => {
                    buckets[index].classList.remove('highlighting');
                }, 1000);
            }
        }

        function insertItem() {
            const key = document.getElementById('key-input').value.trim();
            const value = document.getElementById('value-input').value.trim();
            
            if (!key || !value) {
                logOperation('Please enter both key and value', 'error');
                return;
            }
            
            const result = hashTable.insert(key, value);
            updateVisualization();
            highlightBucket(result.index);
            
            if (result.updated) {
                logOperation(`Updated value for key "${key}"`, 'info');
            } else if (result.collision) {
                logOperation(`Inserted "${key}" → "${value}" (collision at bucket ${result.index})`, 'success');
            } else {
                logOperation(`Inserted "${key}" → "${value}" at bucket ${result.index}`, 'success');
            }
            
            document.getElementById('key-input').value = '';
            document.getElementById('value-input').value = '';
        }

        function searchItem() {
            const key = document.getElementById('key-input').value.trim();
            
            if (!key) {
                logOperation('Please enter a key to search', 'error');
                return;
            }
            
            const result = hashTable.search(key);
            highlightBucket(result.index);
            
            if (result.found) {
                document.getElementById('value-input').value = result.value;
                logOperation(`Found "${key}" → "${result.value}" at bucket ${result.index}`, 'success');
            } else {
                logOperation(`Key "${key}" not found (checked bucket ${result.index})`, 'error');
            }
        }

        function deleteItem() {
            const key = document.getElementById('key-input').value.trim();
            
            if (!key) {
                logOperation('Please enter a key to delete', 'error');
                return;
            }
            
            const result = hashTable.delete(key);
            updateVisualization();
            highlightBucket(result.index);
            
            if (result.success) {
                logOperation(`Deleted key "${key}" from bucket ${result.index}`, 'success');
                document.getElementById('key-input').value = '';
                document.getElementById('value-input').value = '';
            } else {
                logOperation(`Key "${key}" not found (checked bucket ${result.index})`, 'error');
            }
        }

        // Initialize
        updateVisualization();

        // Real-time hash calculation
        document.getElementById('key-input').addEventListener('input', (e) => {
            showHashCalculation(e.target.value);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                if (document.getElementById('key-input').value && document.getElementById('value-input').value) {
                    insertItem();
                } else if (document.getElementById('key-input').value) {
                    searchItem();
                }
            }
        });
    </script>
</body>
</html>