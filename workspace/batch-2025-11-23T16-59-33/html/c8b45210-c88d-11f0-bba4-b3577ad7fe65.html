<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Linked List Visualization and Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
  }
  h1 {
    text-align: center;
  }
  #controls {
    margin-bottom: 20px;
    text-align: center;
  }
  #controls input[type="number"] {
    width: 80px;
    padding: 5px;
    font-size: 1rem;
  }
  #controls button {
    padding: 7px 15px;
    margin-left: 5px;
    font-size: 1rem;
    cursor: pointer;
  }
  #listDisplay {
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: center;
    min-height: 80px;
    overflow-x: auto;
    border: 2px solid #007BFF;
    border-radius: 8px;
    padding: 10px;
  }
  .node {
    background-color: #007BFF;
    color: white;
    min-width: 60px;
    height: 60px;
    line-height: 60px;
    border-radius: 10px;
    margin: 0 5px;
    position: relative;
    font-weight: bold;
    text-align: center;
    user-select: none;
  }
  .arrow {
    width: 40px;
    height: 20px;
    margin: 0 5px;
    position: relative;
  }
  .arrow:after {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 3px;
    background: #555;
    transform: translateY(-50%);
  }
  .arrow:before {
    content: '';
    position: absolute;
    top: 50%;
    right: 0;
    border: 8px solid transparent;
    border-left-color: #555;
    border-right: 0;
    transform: translateY(-50%);
  }
  #log {
    margin-top: 30px;
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid #ccc;
    padding: 10px;
    font-family: monospace;
    background: #f9f9f9;
    border-radius: 6px;
  }
  #log p {
    margin: 0 0 6px 0;
  }
</style>
</head>
<body>
<h1>Interactive Linked List Demo</h1>
<div id="controls">
  <input type="number" id="valueInput" placeholder="Value" />
  <button id="insertHeadBtn" title="Insert at head">Insert Head</button>
  <button id="insertTailBtn" title="Insert at tail">Insert Tail</button>
  <input type="number" id="indexInput" placeholder="Index" min="0" style="width:60px;" />
  <button id="insertAtIndexBtn" title="Insert at index">Insert at Index</button>
  <input type="number" id="removeIndexInput" placeholder="Index" min="0" style="width:60px;" />
  <button id="removeAtIndexBtn" title="Remove at index">Remove at Index</button>
  <button id="clearBtn" style="margin-left: 20px;">Clear List</button>
</div>
<div id="listDisplay" aria-label="Linked List visual representation" role="list"></div>
<div id="log" aria-live="polite" aria-atomic="true"></div>

<script>
  class Node {
    constructor(value) {
      this.value = value;
      this.next = null;
    }
  }

  class LinkedList {
    constructor() {
      this.head = null;
      this.length = 0;
    }

    insertAtHead(value) {
      const node = new Node(value);
      node.next = this.head;
      this.head = node;
      this.length++;
      return node;
    }

    insertAtTail(value) {
      const node = new Node(value);
      if (!this.head) {
        this.head = node;
      } else {
        let current = this.head;
        while (current.next) {
          current = current.next;
        }
        current.next = node;
      }
      this.length++;
      return node;
    }

    insertAtIndex(index, value) {
      if (index < 0 || index > this.length) {
        throw new Error("Index out of bounds");
      }
      if (index === 0) {
        return this.insertAtHead(value);
      }
      let current = this.head;
      let prev = null;
      let i = 0;
      while (i < index) {
        prev = current;
        current = current.next;
        i++;
      }
      const node = new Node(value);
      prev.next = node;
      node.next = current;
      this.length++;
      return node;
    }

    removeAtIndex(index) {
      if (index < 0 || index >= this.length) {
        throw new Error("Index out of bounds");
      }
      let removedValue;
      if (index === 0) {
        removedValue = this.head.value;
        this.head = this.head.next;
        this.length--;
        return removedValue;
      }
      let current = this.head;
      let prev = null;
      let i = 0;
      while (i < index) {
        prev = current;
        current = current.next;
        i++;
      }
      removedValue = current.value;
      prev.next = current.next;
      this.length--;
      return removedValue;
    }

    clear() {
      this.head = null;
      this.length = 0;
    }

    toArray() {
      const arr = [];
      let current = this.head;
      while (current) {
        arr.push(current.value);
        current = current.next;
      }
      return arr;
    }
  }

  // Instantiate linked list:
  const list = new LinkedList();

  // Elements:
  const listDisplay = document.getElementById('listDisplay');
  const valueInput = document.getElementById('valueInput');
  const indexInput = document.getElementById('indexInput');
  const removeIndexInput = document.getElementById('removeIndexInput');
  const insertHeadBtn = document.getElementById('insertHeadBtn');
  const insertTailBtn = document.getElementById('insertTailBtn');
  const insertAtIndexBtn = document.getElementById('insertAtIndexBtn');
  const removeAtIndexBtn = document.getElementById('removeAtIndexBtn');
  const clearBtn = document.getElementById('clearBtn');
  const log = document.getElementById('log');

  function logAction(message) {
    const p = document.createElement('p');
    p.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
    log.prepend(p);
  }

  function createNodeElement(value) {
    const nodeEl = document.createElement('div');
    nodeEl.className = 'node';
    nodeEl.textContent = value;
    return nodeEl;
  }

  function createArrowElement() {
    const arrowEl = document.createElement('div');
    arrowEl.className = 'arrow';
    arrowEl.setAttribute('aria-hidden', 'true');
    return arrowEl;
  }

  function renderList() {
    listDisplay.innerHTML = '';
    const values = list.toArray();
    values.forEach((val, i) => {
      const nodeEl = createNodeElement(val);
      nodeEl.setAttribute('role', 'listitem');
      listDisplay.appendChild(nodeEl);
      if (i < values.length - 1) {
        listDisplay.appendChild(createArrowElement());
      }
    });
    if (values.length === 0) {
      const emptyMsg = document.createElement('div');
      emptyMsg.textContent = 'List is empty';
      emptyMsg.style.color = '#777';
      emptyMsg.style.fontStyle = 'italic';
      listDisplay.appendChild(emptyMsg);
    }
  }

  function getInputValue(input) {
    const val = input.value.trim();
    if (val === '') throw new Error("Value input cannot be empty.");
    return val;
  }

  function getInputIndex(input) {
    const val = input.value.trim();
    if (val === '') throw new Error("Index input cannot be empty.");
    const num = Number(val);
    if (isNaN(num) || !Number.isInteger(num) || num < 0) {
      throw new Error("Index must be a non-negative integer.");
    }
    return num;
  }

  insertHeadBtn.addEventListener('click', () => {
    try {
      const value = getInputValue(valueInput);
      list.insertAtHead(value);
      logAction(`Inserted "${value}" at head.`);
      renderList();
      valueInput.value = '';
      valueInput.focus();
    } catch (e) {
      alert(e.message);
    }
  });

  insertTailBtn.addEventListener('click', () => {
    try {
      const value = getInputValue(valueInput);
      list.insertAtTail(value);
      logAction(`Inserted "${value}" at tail.`);
      renderList();
      valueInput.value = '';
      valueInput.focus();
    } catch (e) {
      alert(e.message);
    }
  });

  insertAtIndexBtn.addEventListener('click', () => {
    try {
      const value = getInputValue(valueInput);
      const index = getInputIndex(indexInput);
      list.insertAtIndex(index, value);
      logAction(`Inserted "${value}" at index ${index}.`);
      renderList();
      valueInput.value = '';
      indexInput.value = '';
      valueInput.focus();
    } catch (e) {
      alert(e.message);
    }
  });

  removeAtIndexBtn.addEventListener('click', () => {
    try {
      const index = getInputIndex(removeIndexInput);
      const removedValue = list.removeAtIndex(index);
      logAction(`Removed node "${removedValue}" at index ${index}.`);
      renderList();
      removeIndexInput.value = '';
      removeIndexInput.focus();
    } catch (e) {
      alert(e.message);
    }
  });

  clearBtn.addEventListener('click', () => {
    if (confirm("Are you sure you want to clear the entire list?")) {
      list.clear();
      logAction('Cleared the linked list.');
      renderList();
    }
  });

  // Initial render
  renderList();
</script>
</body>
</html>