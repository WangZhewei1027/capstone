<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insertion Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        .array-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .bar {
            width: 30px;
            margin: 0 2px;
            background-color: #3498db;
            transition: height 0.3s;
        }
    </style>
</head>
<body>

<h1>Insertion Sort Visualization</h1>
<div class="array-container" id="arrayContainer"></div>
<button id="startSort">Start Insertion Sort</button>

<script>
    const arrayContainer = document.getElementById('arrayContainer');
    const startSortButton = document.getElementById('startSort');
    let array = [5, 2, 9, 1, 5, 6];

    function drawArray(arr) {
        arrayContainer.innerHTML = '';
        for (let i = 0; i < arr.length; i++) {
            const bar = document.createElement('div');
            bar.className = 'bar';
            bar.style.height = arr[i] * 20 + 'px'; // Scale for visibility
            arrayContainer.appendChild(bar);
        }
    }

    async function insertionSort(arr) {
        for (let i = 1; i < arr.length; i++) {
            let key = arr[i];
            let j = i - 1;

            // Visualize the movement
            await highlightIndex(i, 'orange');

            // Move elements of arr[0..i-1], that are greater than key,
            // to one position ahead of their current position
            while (j >= 0 && arr[j] > key) {
                await highlightIndex(j, 'red');
                arr[j + 1] = arr[j];
                j--;
                drawArray(arr);
                await sleep(500); // Delay for visualization
                resetHighlight(j + 1);
            }
            arr[j + 1] = key;
            drawArray(arr);
            await sleep(500); // Delay for visualization
            resetHighlight(i);
        }
        await highlightArray('green');
    }

    function highlightIndex(index, color) {
        return new Promise((resolve) => {
            const bars = arrayContainer.getElementsByClassName('bar');
            bars[index].style.backgroundColor = color;
            setTimeout(() => {
                resolve();
            }, 500);
        });
    }

    function resetHighlight(index) {
        const bars = arrayContainer.getElementsByClassName('bar');
        bars[index].style.backgroundColor = '#3498db';
    }

    function highlightArray(color) {
        return new Promise((resolve) => {
            const bars = arrayContainer.getElementsByClassName('bar');
            for (let i = 0; i < bars.length; i++) {
                bars[i].style.backgroundColor = color;
            }
            setTimeout(() => {
                resolve();
            }, 500);
        });
    }

    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    startSortButton.addEventListener('click', () => {
        drawArray(array);
        insertionSort(array);
    });

    drawArray(array); // Initial drawing of the array
</script>

</body>
</html>