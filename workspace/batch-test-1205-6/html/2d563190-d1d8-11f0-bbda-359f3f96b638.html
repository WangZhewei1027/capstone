<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red-Black Tree Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        #tree {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .node {
            margin: 5px;
            padding: 10px;
            border-radius: 5px;
            color: white;
            text-align: center;
            position: relative;
        }
        .red {
            background-color: red;
        }
        .black {
            background-color: black;
        }
        .edge {
            position: absolute;
            border: 1px solid gray;
            width: 1px;
        }
    </style>
</head>
<body>

<h1>Red-Black Tree Visualization</h1>
<div id="tree"></div>
<input type="number" id="value" placeholder="Enter a number">
<button onclick="insertNode()">Insert Node</button>

<script>
    class Node {
        constructor(data) {
            this.data = data;
            this.color = 'red';
            this.left = null;
            this.right = null;
            this.parent = null;
        }
    }

    class RedBlackTree {
        constructor() {
            this.root = null;
        }

        insert(data) {
            const node = new Node(data);
            if (this.root === null) {
                this.root = node;
                this.root.color = 'black'; // Root must be black
            } else {
                this.insertNode(this.root, node);
                this.fixViolation(node);
            }
            this.render();
        }

        // Insert the node
        insertNode(root, node) {
            if (node.data < root.data) {
                if (root.left === null) {
                    root.left = node;
                    node.parent = root;
                } else {
                    this.insertNode(root.left, node);
                }
            } else {
                if (root.right === null) {
                    root.right = node;
                    node.parent = root;
                } else {
                    this.insertNode(root.right, node);
                }
            }
        }

        // Fix any violations of the Red-Black Tree properties
        fixViolation(node) {
            while (node !== this.root && node.parent.color === 'red') {
                // Uncle node
                let uncle = node.parent === node.parent.parent.left ? node.parent.parent.right : node.parent.parent.left;
                if (uncle && uncle.color === 'red') {
                    node.parent.color = 'black';
                    uncle.color = 'black';
                    node.parent.parent.color = 'red';
                    node = node.parent.parent;
                } else {
                    if (node === node.parent.right && node.parent === node.parent.parent.left) {
                        this.rotateLeft(node.parent);
                        node = node.left;
                    }
                    node.parent.color = 'black';
                    node.parent.parent.color = 'red';
                    this.rotateRight(node.parent.parent);
                }
            }
            this.root.color = 'black';
        }

        rotateLeft(node) {
            let temp = node.right;
            node.right = temp.left;

            if (temp.left !== null) {
                temp.left.parent = node;
            }

            temp.parent = node.parent;

            if (node.parent === null) {
                this.root = temp;
            } else if (node === node.parent.left) {
                node.parent.left = temp;
            } else {
                node.parent.right = temp;
            }

            temp.left = node;
            node.parent = temp;
        }

        rotateRight(node) {
            let temp = node.left;
            node.left = temp.right;

            if (temp.right !== null) {
                temp.right.parent = node;
            }

            temp.parent = node.parent;

            if (node.parent === null) {
                this.root = temp;
            } else if (node === node.parent.right) {
                node.parent.right = temp;
            } else {
                node.parent.left = temp;
            }

            temp.right = node;
            node.parent = temp;
        }

        render() {
            const treeDiv = document.getElementById('tree');
            treeDiv.innerHTML = '';
            this.renderNode(this.root, treeDiv);
        }

        renderNode(node, parentDiv) {
            if (!node) return;

            const nodeDiv = document.createElement('div');
            nodeDiv.className = `node ${node.color}`;
            nodeDiv.innerText = node.data;

            const edgeDiv = document.createElement('div');
            edgeDiv.className = 'edge';
            nodeDiv.appendChild(edgeDiv);

            parentDiv.appendChild(nodeDiv);

            const leftDiv = document.createElement('div');
            const rightDiv = document.createElement('div');

            leftDiv.style.marginLeft = '20px';
            rightDiv.style.marginLeft = '20px';

            this.renderNode(node.left, leftDiv);
            this.renderNode(node.right, rightDiv);

            parentDiv.appendChild(leftDiv);
            parentDiv.appendChild(rightDiv);
        }
    }

    const tree = new RedBlackTree();

    function insertNode() {
        const value = document.getElementById('value').value;
        if (value) {
            tree.insert(parseInt(value));
            document.getElementById('value').value = '';
        }
    }
</script>

</body>
</html>