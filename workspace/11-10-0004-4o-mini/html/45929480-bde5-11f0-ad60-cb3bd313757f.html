<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Nearest Neighbors Interactive Module</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 24px;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            text-align: center;
        }
        #canvas {
            width: 100%;
            height: 60vh;
            border: 2px solid #333;
            background-color: #fff;
            position: relative;
        }
        .controls {
            margin-top: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .controls input[type=range] {
            width: 90%;
        }
        .result {
            margin-top: 16px;
        }
        button {
            margin: 8px 0;
        }
    </style>
</head>
<body>

    <h1>Understanding K-Nearest Neighbors (KNN)</h1>
    <div id="canvas"></div>

    <div class="controls">
        <label for="kValue">Select K (number of neighbors):</label>
        <input type="range" id="kValue" min="1" max="10" value="3">
        <button id="classifyBtn">Classify</button>
        <div class="result">
            <strong>Classification Result:</strong>
            <p id="resultText">N/A</p>
        </div>
    </div>

    <script>
        let points = [];
        let canvas = document.getElementById("canvas");
        let ctx = canvas.getContext("2d");

        const drawPoint = (x, y, color) => {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, Math.PI * 2);
            ctx.fill();
        };

        canvas.addEventListener("click", (event) => {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            points.push({ x, y });
            drawPoint(x, y, 'blue');
        });

        document.getElementById("classifyBtn").addEventListener("click", () => {
            const k = parseInt(document.getElementById("kValue").value);
            if (points.length < k) {
                alert("Please add at least K points.");
                return;
            }
            
            const newPoint = { x: Math.random() * canvas.width, y: Math.random() * canvas.height };
            drawPoint(newPoint.x, newPoint.y, 'red');

            const distances = points.map(point => ({
                point: point,
                distance: Math.sqrt(Math.pow(point.x - newPoint.x, 2) + Math.pow(point.y - newPoint.y, 2))
            }));

            distances.sort((a, b) => a.distance - b.distance);
            const neighbors = distances.slice(0, k);

            neighbors.forEach(neighbor => {
                setTimeout(() => {
                    drawPoint(neighbor.point.x, neighbor.point.y, 'green');
                }, 300);
            });

            const resultColor = neighbors.length > 0 ? "Classified with K=" + k : "N/A";
            document.getElementById("resultText").innerText = resultColor;
        });
    </script>

</body>
</html>