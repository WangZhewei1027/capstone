{
  "id": "d80abf22-d1c9-11f0-9efc-d1db1618a544",
  "timestamp": "2025-12-05T11:04:24.504Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Merge Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Merge Sort Visualization</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n  <style>\n    :root{\n      --bg:#0f1724; --panel:#0b1220; --accent:#38bdf8; --muted:#94a3b8; --success:#34d399;\n      --danger:#fb7185; --bar:#60a5fa;\n    }\n    html,body{height:100%; margin:0; font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,\"Helvetica Neue\",Arial; background:linear-gradient(180deg,#071024 0%, #071430 100%); color:#e6eef8;}\n    .app{max-width:1100px; margin:24px auto; padding:18px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; box-shadow:0 6px 30px rgba(2,6,23,0.6);}\n    h1{margin:0 0 8px 0; font-size:20px; color:var(--accent);}\n    .top{display:flex; gap:16px; align-items:center; flex-wrap:wrap;}\n    .controls{display:flex; gap:8px; align-items:center; flex-wrap:wrap;}\n    button{background:#081026; border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:8px 12px; border-radius:8px; cursor:pointer;}\n    button.primary{background:linear-gradient(90deg,var(--accent),#7dd3fc); color:#022; border:none;}\n    button.danger{background:linear-gradient(90deg,var(--danger),#fb8fa3); color:#2d0211; border:none;}\n    button:disabled{opacity:0.45; cursor:default;}\n    .slider{display:flex; gap:8px; align-items:center;}\n    input[type=range]{accent-color:var(--accent);}\n    .main{display:flex; gap:16px; margin-top:16px;}\n    .visual{flex:2; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02)); padding:12px; border-radius:10px; min-height:320px; display:flex; flex-direction:column;}\n    .bars{display:flex; align-items:flex-end; gap:4px; height:260px; padding:12px; border-radius:8px; background:linear-gradient(180deg, rgba(6,10,20,0.6), rgba(6,10,30,0.4));}\n    .bar{flex:1; background:var(--bar); border-radius:4px 4px 0 0; position:relative; transition:height 200ms ease, transform 150ms ease; display:flex; align-items:end; justify-content:center; color:rgba(3,7,18,0.9); font-size:11px; font-weight:600;}\n    .bar .val{padding-bottom:6px; color:rgba(255,255,255,0.95); text-shadow:0 1px 0 rgba(0,0,0,0.2);}\n    .bar.compare{background:linear-gradient(180deg,var(--accent),#1e6ea4); transform:scaleY(1.02); box-shadow:0 6px 22px rgba(56,189,248,0.08);}\n    .bar.source{background:linear-gradient(180deg,var(--success),#0ea5a0);}\n    .bar.target{background:linear-gradient(180deg,var(--danger),#ef4444);}\n    .info{flex:1; padding:12px; border-radius:10px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02)); min-width:300px; max-height:520px; overflow:auto;}\n    .row{display:flex; justify-content:space-between; align-items:center; gap:8px; margin-bottom:8px;}\n    .stats{display:flex; gap:12px; flex-wrap:wrap;}\n    .stat{background:rgba(255,255,255,0.02); padding:8px 10px; border-radius:8px; font-weight:600; color:var(--muted); }\n    .legend{display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;}\n    .legend .item{display:flex; gap:6px; align-items:center; font-size:13px; color:var(--muted);}\n    .swatch{width:18px; height:14px; border-radius:4px;}\n    pre{background:rgba(2,6,23,0.6); padding:10px; border-radius:8px; color:#dbeafe; overflow:auto; font-size:13px;}\n    .pseudocode{margin-top:12px;}\n    .code-line{padding:4px 6px; border-radius:6px;}\n    .code-line.active{background:linear-gradient(90deg, rgba(56,189,248,0.12), rgba(32,197,220,0.04)); color:var(--accent); font-weight:700;}\n    footer{margin-top:12px; color:var(--muted); font-size:13px;}\n    @media (max-width:900px){ .main{flex-direction:column;} .visual{order:2} .info{order:1}}\n  </style>\n</head>\n<body>\n  <div class=\"app\" role=\"application\" aria-label=\"Merge Sort Visualizer\">\n    <div class=\"top\">\n      <div>\n        <h1>Merge Sort â€” Interactive Visualization</h1>\n        <div style=\"color:var(--muted);font-size:13px;margin-top:6px;\">\n          Watch how Merge Sort splits the array, compares elements, and merges subarrays back into sorted order.\n        </div>\n      </div>\n      <div style=\"flex:1\"></div>\n      <div class=\"controls\" aria-hidden=\"false\">\n        <label style=\"color:var(--muted);font-size:13px;\">Size:\n          <input id=\"sizeRange\" type=\"range\" min=\"6\" max=\"80\" value=\"30\" style=\"vertical-align:middle;margin-left:8px;\">\n        </label>\n        <label style=\"color:var(--muted);font-size:13px;\">Speed:\n          <input id=\"speedRange\" type=\"range\" min=\"1\" max=\"1000\" value=\"300\" style=\"vertical-align:middle;margin-left:8px;\">\n        </label>\n        <button id=\"newBtn\">New Array</button>\n        <button id=\"shuffleBtn\">Shuffle</button>\n        <button id=\"startBtn\" class=\"primary\">Start</button>\n        <button id=\"pauseBtn\" disabled>Pause</button>\n        <button id=\"stepBtn\">Step</button>\n        <button id=\"stopBtn\" class=\"danger\" disabled>Reset</button>\n      </div>\n    </div>\n\n    <div class=\"main\">\n      <div class=\"visual\" aria-live=\"polite\">\n        <div class=\"bars\" id=\"bars\" aria-hidden=\"false\"></div>\n        <div style=\"display:flex;justify-content:space-between;align-items:center;margin-top:12px;\">\n          <div style=\"color:var(--muted);font-size:13px;\">Array visualization (bars represent values). Values shown on bars.</div>\n          <div style=\"color:var(--muted);font-size:13px;\">Speed controls the delay between animation steps (lower = faster)</div>\n        </div>\n      </div>\n\n      <div class=\"info\">\n        <div class=\"row\">\n          <div class=\"stats\">\n            <div class=\"stat\">Comparisons: <span id=\"cmpCount\">0</span></div>\n            <div class=\"stat\">Writes: <span id=\"writeCount\">0</span></div>\n            <div class=\"stat\">Array Size: <span id=\"arrSize\">30</span></div>\n          </div>\n        </div>\n\n        <div class=\"legend\">\n          <div class=\"item\"><div class=\"swatch\" style=\"background:linear-gradient(180deg,var(--accent),#1e6ea4)\"></div> Comparing</div>\n          <div class=\"item\"><div class=\"swatch\" style=\"background:linear-gradient(180deg,var(--success),#0ea5a0)\"></div> Source element</div>\n          <div class=\"item\"><div class=\"swatch\" style=\"background:linear-gradient(180deg,var(--danger),#ef4444)\"></div> Target position write</div>\n          <div class=\"item\"><div class=\"swatch\" style=\"background:linear-gradient(180deg,var(--bar),#3b82f6)\"></div> Idle</div>\n        </div>\n\n        <div class=\"pseudocode\">\n          <div style=\"font-weight:700;color:var(--muted);margin-bottom:8px;\">Pseudocode (highlights active phase)</div>\n          <pre id=\"pseudocode\" aria-hidden=\"false\" style=\"height:220px;\">\n<span class=\"code-line\" data-line=\"1\">function mergeSort(arr, l, r):</span>\n<span class=\"code-line\" data-line=\"2\">  if r - l &lt;= 1: return</span>\n<span class=\"code-line\" data-line=\"3\">  mid = (l + r) // 2</span>\n<span class=\"code-line\" data-line=\"4\">  mergeSort(arr, l, mid)            // split left</span>\n<span class=\"code-line\" data-line=\"5\">  mergeSort(arr, mid, r)            // split right</span>\n<span class=\"code-line\" data-line=\"6\">  // merge two sorted halves</span>\n<span class=\"code-line\" data-line=\"7\">  i = l; j = mid; k = l</span>\n<span class=\"code-line\" data-line=\"8\">  while i &lt; mid and j &lt; r:</span>\n<span class=\"code-line\" data-line=\"9\">    if arr[i] &lt;= arr[j]: tmp[k++] = arr[i++]   // pick left</span>\n<span class=\"code-line\" data-line=\"10\">    else: tmp[k++] = arr[j++]                 // pick right</span>\n<span class=\"code-line\" data-line=\"11\">  while i &lt; mid: tmp[k++] = arr[i++]</span>\n<span class=\"code-line\" data-line=\"12\">  while j &lt; r: tmp[k++] = arr[j++]</span>\n<span class=\"code-line\" data-line=\"13\">  copy tmp[l:r] back to arr[l:r]</span>\n          </pre>\n        </div>\n\n        <footer>\n          Complexity: O(n log n) time, O(n) extra space. Stable sort. Use Merge Sort to reliably sort large data sets in predictable time.\n        </footer>\n      </div>\n    </div>\n  </div>\n\n  <script>\n    // Merge Sort Visualizer\n    (function(){\n      const barsContainer = document.getElementById('bars');\n      const newBtn = document.getElementById('newBtn');\n      const shuffleBtn = document.getElementById('shuffleBtn');\n      const startBtn = document.getElementById('startBtn');\n      const pauseBtn = document.getElementById('pauseBtn');\n      const stepBtn = document.getElementById('stepBtn');\n      const stopBtn = document.getElementById('stopBtn');\n      const sizeRange = document.getElementById('sizeRange');\n      const speedRange = document.getElementById('speedRange');\n      const cmpCountEl = document.getElementById('cmpCount');\n      const writeCountEl = document.getElementById('writeCount');\n      const arrSizeEl = document.getElementById('arrSize');\n      const pseudocode = document.getElementById('pseudocode');\n\n      let array = [];\n      let bars = [];\n      let actions = []; // recorded actions for animation\n      let cmpCount = 0, writeCount = 0;\n      let playing = false;\n      let paused = false;\n      let actionIndex = 0;\n      let delay = Number(speedRange.value); // ms between actions\n      let currentSize = Number(sizeRange.value);\n\n      // Helper: create random array\n      function createArray(n){\n        array = [];\n        for(let i=0;i<n;i++) array.push(Math.floor(Math.random()*100)+5);\n        return array;\n      }\n\n      // Render bars\n      function renderArray(){\n        barsContainer.innerHTML = '';\n        bars = [];\n        const max = Math.max(...array);\n        const n = array.length;\n        for(let i=0;i<n;i++){\n          const b = document.createElement('div');\n          b.className = 'bar';\n          b.style.height = (array[i]/max*100) + '%';\n          b.dataset.index = i;\n          const val = document.createElement('div');\n          val.className = 'val';\n          val.textContent = array[i];\n          b.appendChild(val);\n          barsContainer.appendChild(b);\n          bars.push(b);\n        }\n        arrSizeEl.textContent = n;\n      }\n\n      // Utilities to mark lines in pseudocode\n      function highlightLine(line){\n        const lines = pseudocode.querySelectorAll('.code-line');\n        lines.forEach(l=>l.classList.toggle('active', Number(l.dataset.line) === line));\n      }\n\n      // Record actions by running instrumented merge sort\n      function recordMergeSort(arr){\n        actions = [];\n        cmpCount = 0; writeCount = 0;\n        const tmp = new Array(arr.length);\n        function ms(l,r){\n          if(r - l <= 1){\n            actions.push({type:'idleRange', l, r});\n            return;\n          }\n          const mid = Math.floor((l + r)/2);\n          actions.push({type:'split', l, mid, r});\n          ms(l,mid);\n          ms(mid,r);\n          actions.push({type:'mergeStart', l, mid, r});\n          let i=l, j=mid, k=l;\n          while(i<mid && j<r){\n            actions.push({type:'compare', i, j});\n            if(arr[i] <= arr[j]){\n              actions.push({type:'take', from:i, to:k, value:arr[i]});\n              tmp[k++] = arr[i++];\n            } else {\n              actions.push({type:'take', from:j, to:k, value:arr[j]});\n              tmp[k++] = arr[j++];\n            }\n          }\n          while(i<mid){\n            actions.push({type:'take', from:i, to:k, value:arr[i]});\n            tmp[k++] = arr[i++];\n          }\n          while(j<r){\n            actions.push({type:'take', from:j, to:k, value:arr[j]});\n            tmp[k++] = arr[j++];\n          }\n          // copy back\n          for(let t=l; t<r; t++){\n            actions.push({type:'writeBack', index:t, value:tmp[t]});\n            arr[t] = tmp[t];\n          }\n          actions.push({type:'mergeEnd', l, mid, r});\n        }\n        // Use a copy to avoid modifying original until animation plays writes back\n        ms(0, arr.length);\n        // final done\n        actions.push({type:'done'});\n      }\n\n      // Animation engine\n      function resetCounts(){\n        cmpCount=0; writeCount=0;\n        cmpCountEl.textContent = '0';\n        writeCountEl.textContent = '0';\n      }\n\n      function enableControls(enabled){\n        newBtn.disabled = !enabled;\n        shuffleBtn.disabled = !enabled;\n        sizeRange.disabled = !enabled;\n        startBtn.disabled = !enabled;\n      }\n\n      function play(){\n        if(playing) return;\n        playing = true;\n        paused = false;\n        pauseBtn.disabled = false;\n        stopBtn.disabled = false;\n        newBtn.disabled = true;\n        shuffleBtn.disabled = true;\n        sizeRange.disabled = true;\n        startBtn.disabled = true;\n        stepBtn.disabled = true;\n        runActions();\n      }\n\n      function pause(){\n        paused = true;\n        pauseBtn.disabled = true;\n        startBtn.disabled = false;\n        stepBtn.disabled = false;\n      }\n      function resume(){\n        if(!playing) play();\n        paused = false;\n        pauseBtn.disabled = false;\n        startBtn.disabled = true;\n        stepBtn.disabled = true;\n        runActions();\n      }\n\n      function stop(){\n        playing = false;\n        paused = false;\n        actionIndex = 0;\n        actions = [];\n        resetCounts();\n        renderArray();\n        highlightLine(null);\n        pauseBtn.disabled = true;\n        startBtn.disabled = false;\n        stopBtn.disabled = true;\n        newBtn.disabled = false;\n        shuffleBtn.disabled = false;\n        sizeRange.disabled = false;\n        stepBtn.disabled = false;\n      }\n\n      function stepOnce(){\n        if(actionIndex >= actions.length) return;\n        executeAction(actions[actionIndex++]);\n      }\n\n      async function runActions(){\n        while(playing && actionIndex < actions.length){\n          if(paused) break;\n          const act = actions[actionIndex++];\n          executeAction(act);\n          // when 'compare' or similar we might want different delays\n          await sleep(delay);\n        }\n        if(actionIndex >= actions.length){\n          playing = false;\n          pauseBtn.disabled = true;\n          stopBtn.disabled = true;\n          startBtn.disabled = true;\n          stepBtn.disabled = true;\n          highlightLine(13);\n        }\n      }\n\n      function sleep(ms){\n        return new Promise(res => setTimeout(res, ms));\n      }\n\n      // Execute and animate a single recorded action\n      function executeAction(action){\n        clearAllHighlights();\n        switch(action.type){\n          case 'idleRange':\n            highlightRange(action.l, action.r, 'idle');\n            highlightLine(2);\n            break;\n          case 'split':\n            highlightRange(action.l, action.mid, 'source');\n            highlightRange(action.mid, action.r, 'target');\n            highlightLine(4);\n            break;\n          case 'mergeStart':\n            highlightRange(action.l, action.r, 'merging');\n            highlightLine(6);\n            break;\n          case 'compare':\n            cmpCount++;\n            cmpCountEl.textContent = cmpCount;\n            markBar(action.i, 'compare');\n            markBar(action.j, 'compare');\n            highlightLine(8);\n            break;\n          case 'take':\n            // show source highlighted and target index highlighted\n            markBar(action.from, 'source');\n            markBar(action.to, 'target');\n            // visually move by updating height and text (but don't commit final array until writeBack)\n            // We'll reflect immediately to keep animation intuitive\n            setBarValue(action.to, action.value);\n            writeCount++;\n            writeCountEl.textContent = writeCount;\n            highlightLine(action.from < action.to ? 9 : 10);\n            break;\n          case 'writeBack':\n            // commit final write (already shown by take step, but ensure correct)\n            setBarValue(action.index, action.value);\n            markBar(action.index, 'target');\n            writeCount++;\n            writeCountEl.textContent = writeCount;\n            highlightLine(13);\n            break;\n          case 'mergeEnd':\n            // mark merged range as sorted (use source color)\n            highlightRange(action.l, action.r, 'merged');\n            highlightLine(13);\n            break;\n          case 'done':\n            for(let i=0;i<bars.length;i++){\n              markBar(i, 'source');\n            }\n            highlightLine(13);\n            break;\n        }\n      }\n\n      // Visual helpers\n      function setBarValue(idx, val){\n        if(!bars[idx]) return;\n        const max = Math.max(...array, val);\n        array[idx] = val; // keep local array in sync\n        bars[idx].style.height = (val / Math.max(...array) * 100) + '%';\n        bars[idx].querySelector('.val').textContent = val;\n      }\n\n      function markBar(i, cls){\n        if(!bars[i]) return;\n        bars[i].classList.add(cls === 'compare' ? 'compare' : cls === 'source' ? 'source' : cls === 'target' ? 'target' : '');\n      }\n\n      function highlightRange(l, r, kind){\n        for(let i=l;i<r;i++){\n          if(!bars[i]) continue;\n          if(kind === 'source') { bars[i].classList.add('source'); }\n          else if(kind === 'target') { bars[i].classList.add('target'); }\n          else if(kind === 'merged'){ bars[i].classList.add('source'); }\n          else if(kind === 'merging'){ bars[i].classList.add('compare'); }\n          else { /* idle */ }\n        }\n      }\n\n      function clearAllHighlights(){\n        bars.forEach(b => { b.classList.remove('compare','source','target'); });\n        highlightLine(null);\n      }\n\n      // Event wiring\n      newBtn.addEventListener('click', ()=>{\n        currentSize = Number(sizeRange.value);\n        array = createArray(currentSize);\n        resetCounts();\n        renderArray();\n      });\n\n      shuffleBtn.addEventListener('click', ()=>{\n        // Fisher-Yates shuffle\n        for(let i=array.length-1;i>0;i--){\n          const j = Math.floor(Math.random()*(i+1));\n          [array[i], array[j]] = [array[j], array[i]];\n        }\n        resetCounts();\n        renderArray();\n      });\n\n      startBtn.addEventListener('click', ()=>{\n        // prepare actions\n        resetCounts();\n        // Use a copy for recording algorithm steps\n        const copy = array.slice();\n        recordMergeSort(copy);\n        actionIndex = 0;\n        play();\n      });\n\n      pauseBtn.addEventListener('click', ()=>{\n        if(!playing) return;\n        if(!paused) {\n          pause();\n        } else {\n          resume();\n        }\n      });\n\n      stepBtn.addEventListener('click', ()=>{\n        if(!playing){\n          // prepare if first step\n          resetCounts();\n          const copy = array.slice();\n          recordMergeSort(copy);\n          playing = true;\n          paused = true;\n          pauseBtn.disabled = false;\n          stopBtn.disabled = false;\n        }\n        if(actionIndex < actions.length){\n          stepOnce();\n        }\n      });\n\n      stopBtn.addEventListener('click', ()=>{\n        stop();\n      });\n\n      sizeRange.addEventListener('input', ()=>{\n        currentSize = Number(sizeRange.value);\n        arrSizeEl.textContent = currentSize;\n      });\n\n      speedRange.addEventListener('input', ()=>{\n        delay = Number(speedRange.value);\n      });\n\n      // initialize\n      currentSize = Number(sizeRange.value);\n      array = createArray(currentSize);\n      renderArray();\n\n      // Accessibility: allow keyboard space to start/stop\n      document.addEventListener('keydown', (e)=>{\n        if(e.code === 'Space'){\n          e.preventDefault();\n          if(!playing) startBtn.click();\n          else if(!paused) pauseBtn.click();\n          else resume();\n        }\n      });\n\n      // small improvement: when window resized recompute heights for accurate scale\n      window.addEventListener('resize', ()=>{\n        // re-render heights to reflect max scaling\n        const max = Math.max(...array);\n        bars.forEach((b, i) => {\n          b.style.height = (array[i]/max*100) + '%';\n        });\n      });\n    })();\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Merge Sort"
    }
  ],
  "topic": "Merge Sort",
  "hasFSM": false,
  "hasTest": true
}