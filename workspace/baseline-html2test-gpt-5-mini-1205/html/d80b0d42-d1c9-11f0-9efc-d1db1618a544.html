<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Linear Search Interactive Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#06b6d4;
      --muted:#93a2b8;
      --ok:#16a34a;
      --danger:#ef4444;
      --glass: rgba(255,255,255,0.04);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: dark;
    }
    html,body{height:100%; margin:0; background:linear-gradient(180deg,#071024 0%, #07182b 50%); color:#e6eef6;}
    .wrap{max-width:1100px;margin:28px auto;padding:20px;}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    header h1{font-size:20px;margin:0}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); border-radius:12px; padding:16px;}
    .controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    label{font-size:13px;color:var(--muted)}
    input[type="text"], input[type="number"]{background:var(--glass);border:1px solid rgba(255,255,255,0.03);padding:8px 10px;border-radius:8px;color:inherit}
    button{background:var(--accent);border:none;color:#042027;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    button.warn{background:var(--danger); color:white}
    .row{display:flex;gap:12px;align-items:center}
    .visual{margin-top:20px;padding:18px; border-radius:12px; display:flex; flex-direction:column; gap:14px; min-height:160px; justify-content:center; background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005))}
    .array{display:flex;gap:8px;justify-content:center;flex-wrap:wrap}
    .cell{width:66px;height:66px;border-radius:10px;background:rgba(255,255,255,0.02);display:flex;flex-direction:column;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.03);position:relative;transition:transform .18s, background .18s, border-color .18s}
    .cell .idx{position:absolute;top:6px;right:8px;font-size:11px;color:var(--muted)}
    .cell .val{font-size:18px;font-weight:700}
    .cell.current{background:linear-gradient(180deg,var(--accent),#0ea5a3); color:#002428; transform:translateY(-6px); border-color:rgba(255,255,255,0.12)}
    .cell.found{background:linear-gradient(180deg,var(--ok),#059669); color:#002715}
    .cell.checked{opacity:0.55}
    .status{display:flex;gap:16px;align-items:center;flex-wrap:wrap}
    .badge{background:rgba(255,255,255,0.02);padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);font-size:13px}
    .log{max-height:140px;overflow:auto;padding:10px;border-radius:8px;background:rgba(255,255,255,0.01);font-family:monospace;font-size:13px;color:var(--muted)}
    .pseudocode{padding:12px;border-radius:8px;background:rgba(255,255,255,0.01);font-family:monospace}
    .code-line{padding:6px 8px;border-radius:6px}
    .code-line.active{background:rgba(6,182,212,0.12);border-left:3px solid var(--accent);color:var(--accent);font-weight:600}
    .footer{margin-top:14px;display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
    .small{font-size:13px;color:var(--muted)}
    .slider{width:160px}
    @media(max-width:720px){
      .cell{width:56px;height:56px}
      .wrap{padding:12px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Linear Search — Interactive Demo</h1>
      <div class="small">Step through how linear search checks each element until the target is found (or array ends).</div>
    </header>

    <div class="panel">
      <div class="controls">
        <div style="min-width:260px">
          <label for="arrayInput">Array (comma or space separated)</label><br/>
          <input id="arrayInput" type="text" value="7, 3, 9, 1, 4, 5, 2" style="width:100%" />
        </div>

        <div>
          <label for="targetInput">Target value</label><br/>
          <input id="targetInput" type="text" value="4" style="width:120px" />
        </div>

        <div>
          <label for="lengthRand">Randomize</label><br/>
          <div class="row">
            <input id="lengthRand" type="number" value="8" min="1" max="30" style="width:70px" />
            <input id="maxRand" type="number" value="20" min="1" max="999" style="width:70px" />
            <button id="randBtn" title="Generate random array">Generate</button>
          </div>
        </div>

        <div>
          <label>&nbsp;</label><br/>
          <div class="row">
            <button id="startBtn">Start Search</button>
            <button id="stepBtn" class="ghost">Step</button>
            <button id="autoBtn" class="ghost">Auto Play</button>
            <button id="resetBtn" class="ghost">Reset</button>
          </div>
        </div>

        <div>
          <label for="speed">Speed</label><br/>
          <input id="speed" class="slider" type="range" min="200" max="1500" step="100" value="650" />
        </div>
      </div>

      <div class="visual">
        <div class="array" id="arrayArea" aria-live="polite"></div>

        <div class="status">
          <div class="badge">Current index: <strong id="currentIndex">—</strong></div>
          <div class="badge">Comparisons: <strong id="comparisons">0</strong></div>
          <div class="badge">Result: <strong id="result">—</strong></div>
        </div>

        <div style="display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap">
          <div style="flex:1;min-width:260px">
            <div style="margin-top:8px;font-weight:600">Trace / Log</div>
            <div class="log" id="log"></div>
          </div>

          <div style="width:360px;min-width:220px">
            <div style="margin-top:8px;font-weight:600">Pseudocode</div>
            <div class="pseudocode" id="pseudocode">
              <div class="code-line" data-line="1">function linearSearch(array, target):</div>
              <div class="code-line" data-line="2">&nbsp;&nbsp;for i from 0 to array.length - 1:</div>
              <div class="code-line" data-line="3">&nbsp;&nbsp;&nbsp;&nbsp;if array[i] == target:</div>
              <div class="code-line" data-line="4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return i  // found</div>
              <div class="code-line" data-line="5">&nbsp;&nbsp;end for</div>
              <div class="code-line" data-line="6">&nbsp;&nbsp;return -1 // not found</div>
            </div>
            <div style="margin-top:8px" class="small">
              Time complexity: O(n) — worst case checks every element. Best case O(1) if first element is target.
            </div>
          </div>
        </div>

        <div class="footer">
          <div class="small">Tip: Use "Step" to manually advance, "Auto Play" to animate. "Reset" clears highlights but keeps current inputs.</div>
          <div class="small">This demo returns the first match found.</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // UI elements
      const arrayInput = document.getElementById('arrayInput');
      const targetInput = document.getElementById('targetInput');
      const randBtn = document.getElementById('randBtn');
      const lengthRand = document.getElementById('lengthRand');
      const maxRand = document.getElementById('maxRand');
      const startBtn = document.getElementById('startBtn');
      const stepBtn = document.getElementById('stepBtn');
      const autoBtn = document.getElementById('autoBtn');
      const resetBtn = document.getElementById('resetBtn');
      const speed = document.getElementById('speed');

      const arrayArea = document.getElementById('arrayArea');
      const currentIndexEl = document.getElementById('currentIndex');
      const comparisonsEl = document.getElementById('comparisons');
      const resultEl = document.getElementById('result');
      const logEl = document.getElementById('log');
      const pseudocode = document.getElementById('pseudocode');

      // State
      let arr = [];
      let target = null;
      let i = -1;
      let comparisons = 0;
      let running = false;
      let autoInterval = null;
      let foundIndex = -1;
      let started = false;

      // Helpers
      function parseArrayInput(text){
        if(!text.trim()) return [];
        // split by comma or whitespace
        const tokens = text.split(/[,\\s]+/).filter(s=>s.length);
        // try parse numbers, but keep strings if not numeric
        return tokens.map(t=>{
          if(/^[-+]?\\d+$/.test(t)) return parseInt(t,10);
          if(/^[-+]?\\d*\\.\\d+$/.test(t)) return parseFloat(t);
          return t;
        });
      }

      function renderArray(){
        arrayArea.innerHTML = '';
        arr.forEach((val, idx)=>{
          const c = document.createElement('div');
          c.className = 'cell';
          c.setAttribute('data-idx', idx);
          c.innerHTML = '<div class="idx">'+idx+'</div><div class="val">'+String(val)+'</div>';
          arrayArea.appendChild(c);
        });
      }

      function setStatus(){
        currentIndexEl.textContent = (i>=0 && i < arr.length) ? i : '—';
        comparisonsEl.textContent = comparisons;
        if(foundIndex !== -1) {
          resultEl.innerHTML = 'Found at index ' + foundIndex;
          resultEl.style.color = 'var(--ok)';
        } else if (started && i >= arr.length) {
          resultEl.innerHTML = 'Not found';
          resultEl.style.color = 'var(--muted)';
        } else {
          resultEl.innerHTML = '—';
          resultEl.style.color = '';
        }
      }

      function log(msg){
        const t = document.createElement('div');
        t.textContent = msg;
        logEl.prepend(t);
      }

      function highlightLine(n){
        const lines = pseudocode.querySelectorAll('.code-line');
        lines.forEach(l=> l.classList.toggle('active', Number(l.getAttribute('data-line')) === n));
      }

      function clearHighlights(){
        const cells = arrayArea.querySelectorAll('.cell');
        cells.forEach(c=>{
          c.classList.remove('current','found','checked');
        });
        highlightLine(null);
      }

      function updateCells(){
        const cells = arrayArea.querySelectorAll('.cell');
        cells.forEach(c=>{
          const idx = Number(c.getAttribute('data-idx'));
          c.classList.remove('current','found','checked');
          if(foundIndex === idx) c.classList.add('found');
          else if (i > idx) c.classList.add('checked');
          if (i === idx && foundIndex === -1 && i < arr.length) c.classList.add('current');
        });
      }

      function stepSearch(){
        if(!started) {
          // initialize
          arr = parseArrayInput(arrayInput.value);
          target = parseNumberOrString(targetInput.value);
          i = 0;
          comparisons = 0;
          foundIndex = -1;
          started = true;
          running = true;
          log('Search started. Target = ' + stringify(target) + '. Array length = ' + arr.length);
        }
        if(foundIndex !== -1 || i >= arr.length){
          // already finished
          running = false;
          stopAuto();
          if(foundIndex === -1 && i >= arr.length){
            log('End of array reached. Target not found.');
            highlightLine(6);
          }
          setStatus();
          updateCells();
          return;
        }

        // highlight for the current step
        highlightLine(2); // entering loop
        updateCells();
        setStatus();

        // inspect element at i
        highlightLine(3);
        comparisons++;
        setStatus();
        log('Compare array['+i+'] ('+stringify(arr[i])+') with target '+ stringify(target) );
        updateCells();

        // check equality (strict equality for numbers and strings)
        if(equals(arr[i], target)){
          foundIndex = i;
          log('Match found at index ' + i);
          highlightLine(4);
          // mark found cell
          updateCells();
          setStatus();
          running = false;
          stopAuto();
          return;
        } else {
          // not found at this index
          log('Not a match at index ' + i);
          highlightLine(5);
        }

        // move to next index
        i++;
        updateCells();
        setStatus();

        if(i >= arr.length){
          // finished
          log('Reached end of array. Target not found.');
          highlightLine(6);
          running = false;
          stopAuto();
        }
      }

      function equals(a,b){
        // compare numbers and strings strictly; other objects compare with JSON fallback
        if(typeof a === typeof b) return a === b;
        // special: if both can be converted to numbers and both numeric strings
        if(typeof a === 'string' && typeof b === 'number') return Number(a) === b && !Number.isNaN(Number(a));
        if(typeof b === 'string' && typeof a === 'number') return Number(b) === a && !Number.isNaN(Number(b));
        return String(a) === String(b);
      }

      function parseNumberOrString(s){
        s = s.trim();
        if(s === '') return s;
        if(/^[-+]?\\d+$/.test(s)) return parseInt(s,10);
        if(/^[-+]?\\d*\\.\\d+$/.test(s)) return parseFloat(s);
        return s;
      }

      function stringify(x){
        if (typeof x === 'string') return '"' + x + '"';
        return String(x);
      }

      function startAuto(){
        if(autoInterval) return;
        autoBtn.textContent = 'Pause';
        autoBtn.classList.add('ghost');
        const delay = Number(speed.value);
        autoInterval = setInterval(()=>{
          if(!running) {
            // if not running but not finished, ensure started
            if(!started) stepSearch();
            if(!running) stopAuto();
            return;
          }
          stepSearch();
        }, delay);
      }

      function stopAuto(){
        if(autoInterval) {
          clearInterval(autoInterval);
          autoInterval = null;
          autoBtn.textContent = 'Auto Play';
        }
        autoBtn.classList.remove('active');
      }

      function resetDemo(){
        stopAuto();
        started = false;
        running = false;
        i = -1;
        comparisons = 0;
        foundIndex = -1;
        currentIndexEl.textContent = '—';
        comparisonsEl.textContent = '0';
        resultEl.textContent = '—';
        log('Reset demo.');
        clearHighlights();
        updateCells();
      }

      // initial render
      arr = parseArrayInput(arrayInput.value);
      renderArray();
      resetDemo();

      // UI events
      randBtn.addEventListener('click', ()=>{
        const n = Math.max(1, Math.min(200, Number(lengthRand.value) || 8));
        const max = Math.max(1, Number(maxRand.value) || 20);
        const values = Array.from({length:n}, ()=> Math.floor(Math.random()*max)+1);
        arrayInput.value = values.join(', ');
        arr = parseArrayInput(arrayInput.value);
        renderArray();
        resetDemo();
      });

      startBtn.addEventListener('click', ()=>{
        // start a fresh search if not started
        if(!started){
          arr = parseArrayInput(arrayInput.value);
          renderArray();
        }
        // initialize and run until finish or found
        started = true;
        running = true;
        foundIndex = -1;
        i = 0;
        comparisons = 0;
        log('Starting full search (will run until found or end).');
        setStatus();
        updateCells();
        // run loop quickly but allow UI updates using setTimeout
        function runOne(){
          if(!running) return;
          stepSearch();
          // continue in next event loop to keep UI responsive
          if(running) setTimeout(runOne, Number(speed.value)/4);
        }
        runOne();
      });

      stepBtn.addEventListener('click', ()=>{
        // perform one step
        if(!started || (!running && foundIndex === -1 && i >= arr.length)){
          // reinitialize
          arr = parseArrayInput(arrayInput.value);
          renderArray();
          started = false;
        }
        if(!started) {
          started = true;
          i = 0;
          comparisons = 0;
          foundIndex = -1;
          log('Search started for target ' + stringify(parseNumberOrString(targetInput.value)));
        }
        running = true;
        stepSearch();
      });

      autoBtn.addEventListener('click', ()=>{
        if(autoInterval){
          stopAuto();
        } else {
          // start auto
          // if not started, initialize state
          if(!started){
            arr = parseArrayInput(arrayInput.value);
            renderArray();
            i = 0;
            comparisons = 0;
            foundIndex = -1;
            started = true;
            running = true;
            log('Auto search started.');
          } else {
            running = true;
          }
          startAuto();
        }
      });

      resetBtn.addEventListener('click', ()=>{
        resetDemo();
      });

      // allow pressing Enter in inputs to start
      [arrayInput, targetInput].forEach(el=>{
        el.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter') {
            e.preventDefault();
            resetDemo();
            arr = parseArrayInput(arrayInput.value);
            renderArray();
            stepBtn.click();
          }
        });
      });

      // when array text changes, update render
      arrayInput.addEventListener('change', ()=>{
        arr = parseArrayInput(arrayInput.value);
        renderArray();
        resetDemo();
      });

      // helper: when speed changed, if auto running restart interval with new delay
      speed.addEventListener('change', ()=>{
        if(autoInterval){
          stopAuto();
          startAuto();
        }
      });

      // keyboard shortcuts for convenience
      document.addEventListener('keydown', (e)=>{
        if(e.key === ' ' && !/input|textarea/i.test(document.activeElement.tagName)){
          e.preventDefault();
          stepBtn.click();
        } else if (e.key.toLowerCase() === 'a' && !/input|textarea/i.test(document.activeElement.tagName)){
          e.preventDefault();
          autoBtn.click();
        } else if (e.key.toLowerCase() === 'r' && !/input|textarea/i.test(document.activeElement.tagName)){
          e.preventDefault();
          resetBtn.click();
        }
      });

      // small accessibility: announce when value found (via log)
      const observer = new MutationObserver(()=>{/* no-op, kept for potential future use */});
      observer.observe(logEl, {childList:true});

      // Small utility to ensure cells reflect initial state
      updateCells();
      setStatus();

    })();
  </script>
</body>
</html>