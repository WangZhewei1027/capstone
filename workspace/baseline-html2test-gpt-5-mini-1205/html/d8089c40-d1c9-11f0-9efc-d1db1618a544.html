<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Array Playground — Interactive JavaScript Array Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin: 18px; color:#111 }
    h1 { margin: 0 0 8px 0; font-size: 20px; }
    .row { display:flex; gap:12px; align-items:center; margin:10px 0; flex-wrap:wrap; }
    .col { display:flex; flex-direction:column; gap:8px; }
    input[type="text"], textarea, select { font-family: inherit; font-size: 13px; padding:6px 8px; border:1px solid #ccc; border-radius:6px; }
    button { background:#0366d6; color:white; border:0; padding:7px 10px; border-radius:6px; cursor:pointer; }
    button.secondary { background:#6c757d; }
    button.small { padding:6px 8px; font-size:13px; }
    pre { background:#f6f8fa; padding:10px; border-radius:6px; overflow:auto; max-height:220px; }
    .panel { border:1px solid #e1e4e8; padding:12px; border-radius:8px; background:white; }
    label { font-size:12px; color:#333; }
    table { border-collapse:collapse; margin-top:8px; width:100%; }
    td, th { border:1px solid #eee; padding:6px 8px; font-family: monospace; font-size:13px; }
    .controls { display:flex; gap:8px; flex-wrap:wrap; }
    .mutate { background:#0b6623; }
    .result { background:#333; }
    .explain { color:#333; font-size:13px; }
    .small-note { font-size:12px; color:#555; }
    .flex-between { display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .foot { font-size:12px; color:#444; margin-top:12px; }
  </style>
</head>
<body>
  <h1>Array Playground — Interactive JavaScript Array Demo</h1>
  <div class="panel">
    <div class="flex-between">
      <div>
        <label>Create array (enter JSON or comma-separated values):</label><br>
        <input id="arrayInput" type="text" style="width:420px" placeholder='e.g. [1,2,3]  or  a,b,3,true,{"x":1}'>
        <button id="createBtn" class="small">Create</button>
        <button id="samplesBtn" class="small secondary">Load Samples</button>
      </div>
      <div>
        <label>Samples:</label><br>
        <select id="sampleSelect">
          <option value="numbers">Numbers [1,2,3,4]</option>
          <option value="strings">Strings ["a","b","c"]</option>
          <option value="mixed">Mixed [1,"two",true,null]</option>
          <option value="nested">Nested [[1,2],[3,4]]</option>
          <option value="objects">Objects [{id:1},{id:2}]</option>
        </select>
        <button id="loadSample" class="small">Load</button>
      </div>
    </div>

    <div style="margin-top:10px;" class="row">
      <div style="flex:1" class="panel">
        <strong>Current array</strong>
        <div id="arrayView" style="margin-top:8px;"></div>
        <div style="margin-top:8px;">
          <button id="copyBtn" class="small">Copy JSON</button>
          <button id="cloneBtn" class="small secondary">Clone (shallow)</button>
          <button id="clearBtn" class="small secondary">Clear</button>
        </div>
      </div>

      <div style="width:480px" class="panel">
        <strong>Quick operations</strong>
        <div class="row" style="margin-top:8px;">
          <input id="valueInput" type="text" placeholder='value e.g. 42 or "x" or {"a":1}' style="width:220px;">
          <button id="pushBtn" class="small mutate">push()</button>
          <button id="popBtn" class="small mutate">pop()</button>
          <button id="shiftBtn" class="small mutate">shift()</button>
          <button id="unshiftBtn" class="small mutate">unshift()</button>
        </div>

        <div style="margin-top:8px;">
          <label>splice(start, deleteCount, ...items)</label>
          <div class="row">
            <input id="spliceStart" type="text" placeholder="start" style="width:60px;">
            <input id="spliceDel" type="text" placeholder="deleteCount" style="width:60px;">
            <input id="spliceItems" type="text" placeholder='items e.g. 7,8 or ["x"]' style="width:180px;">
            <button id="spliceBtn" class="small mutate">splice()</button>
          </div>
        </div>

        <div style="margin-top:8px;">
          <label>slice(start, end)</label>
          <div class="row">
            <input id="sliceStart" type="text" placeholder="start" style="width:80px;">
            <input id="sliceEnd" type="text" placeholder="end" style="width:80px;">
            <button id="sliceBtn" class="small result">slice()</button>
            <button id="applySlice" class="small mutate">apply result</button>
          </div>
        </div>

        <div style="margin-top:8px;">
          <label>map / filter / reduce examples</label>
          <div class="row">
            <button id="mapDouble" class="small">map(x =&gt; x*2)</button>
            <button id="filterEven" class="small">filter(x =&gt; x % 2 === 0)</button>
            <button id="reduceSum" class="small">reduce((a,b)=>a+b,0)</button>
            <button id="applyResult" class="small mutate">apply last result</button>
          </div>
        </div>

      </div>
    </div>

    <div style="margin-top:12px;" class="row">
      <div style="flex:1" class="panel">
        <strong>Array inspector</strong>
        <div id="itemsTable"></div>
      </div>

      <div style="width:520px" class="panel">
        <strong>Results & code</strong>
        <div id="resultArea" style="margin-top:8px;"><em class="small-note">No operation yet.</em></div>
        <pre id="codeArea"></pre>
      </div>
    </div>

    <div style="margin-top:12px;" class="panel">
      <strong>Custom JS (sandboxed-ish)</strong>
      <div class="small-note">You can access the current array via variable arr. Return a value to show it. If you want to replace the current array with the returned value check "Apply result". Example: return arr.map(x =&gt; x*2)</div>
      <textarea id="customCode" rows="5" style="width:100%;"></textarea>
      <div style="margin-top:8px;" class="row">
        <button id="runCustom" class="small">Run</button>
        <label><input type="checkbox" id="applyCustom"> Apply result</label>
        <button id="resetSnap" class="small secondary">Revert to last saved</button>
      </div>
      <div id="customResult" style="margin-top:8px;"></div>
    </div>

    <div class="foot">
      Quick references: push/pop/shift/unshift mutate the array. slice/map/filter/reduce return new values. Arrays are objects — assignment copies a reference; use spread [...] or Array.from to clone.
    </div>
  </div>

  <script>
    // Utility helpers
    function tryParse(value) {
      // Try JSON parse, fallback to comma-separated tokens parsing
      if (value === undefined || value === null) return undefined;
      value = value.trim();
      if (value === '') return undefined;
      // If it looks like an array or object -> JSON
      if (/^[\[{]/.test(value) || (/^".*"$/.test(value) || /^'.*'$/.test(value))) {
        try { return JSON.parse(value); } catch(e) { /* fallthrough */ }
      }
      // single token: try JSON.parse (to get true,false,null,number)
      try {
        return JSON.parse(value);
      } catch(e) {
        // Try CSV split for multiple values
        const parts = value.split(',').map(s => s.trim()).filter(s => s !== '');
        if (parts.length === 1) {
          // Could be a plain word string -> return as string (without quotes)
          return parts[0];
        }
        return parts.map(p => {
          try { return JSON.parse(p); } catch(e) { return p; }
        });
      }
    }

    function toDisplay(v) {
      try { return JSON.stringify(v, null, 2); } catch(e) { return String(v); }
    }

    // State
    let arr = [];
    let lastResult = undefined;
    let snapshot = null;

    // Elements
    const arrayInput = document.getElementById('arrayInput');
    const createBtn = document.getElementById('createBtn');
    const arrayView = document.getElementById('arrayView');
    const itemsTable = document.getElementById('itemsTable');
    const resultArea = document.getElementById('resultArea');
    const codeArea = document.getElementById('codeArea');
    const copyBtn = document.getElementById('copyBtn');
    const cloneBtn = document.getElementById('cloneBtn');
    const clearBtn = document.getElementById('clearBtn');
    const samplesBtn = document.getElementById('samplesBtn');
    const sampleSelect = document.getElementById('sampleSelect');
    const loadSample = document.getElementById('loadSample');

    const valueInput = document.getElementById('valueInput');
    const pushBtn = document.getElementById('pushBtn');
    const popBtn = document.getElementById('popBtn');
    const shiftBtn = document.getElementById('shiftBtn');
    const unshiftBtn = document.getElementById('unshiftBtn');

    const spliceStart = document.getElementById('spliceStart');
    const spliceDel = document.getElementById('spliceDel');
    const spliceItems = document.getElementById('spliceItems');
    const spliceBtn = document.getElementById('spliceBtn');

    const sliceStart = document.getElementById('sliceStart');
    const sliceEnd = document.getElementById('sliceEnd');
    const sliceBtn = document.getElementById('sliceBtn');
    const applySlice = document.getElementById('applySlice');

    const mapDouble = document.getElementById('mapDouble');
    const filterEven = document.getElementById('filterEven');
    const reduceSum = document.getElementById('reduceSum');
    const applyResult = document.getElementById('applyResult');

    const customCode = document.getElementById('customCode');
    const runCustom = document.getElementById('runCustom');
    const applyCustom = document.getElementById('applyCustom');
    const customResult = document.getElementById('customResult');
    const resetSnap = document.getElementById('resetSnap');

    // Render functions
    function renderArray() {
      arrayView.innerHTML = '<pre style="margin:0; white-space:pre-wrap">' + toDisplay(arr) + '</pre>';
      renderItems();
    }

    function renderItems() {
      if (!Array.isArray(arr)) {
        itemsTable.innerHTML = '<div class="small-note">Current value is not an Array.</div>';
        return;
      }
      let html = '<table><thead><tr><th>index</th><th>value</th><th>type</th></tr></thead><tbody>';
      arr.forEach((v, i) => {
        let t = Array.isArray(v) ? 'array' : (v === null ? 'null' : typeof v);
        html += '<tr><td>' + i + '</td><td><pre style="margin:0">' + safeString(v) + '</pre></td><td>' + t + '</td></tr>';
      });
      html += '</tbody></table>';
      itemsTable.innerHTML = html;
    }

    function safeString(v) {
      try { return JSON.stringify(v); } catch(e) { return String(v); }
    }

    function setResult(res, code) {
      lastResult = res;
      resultArea.innerHTML = '<strong>Result</strong><div style="margin-top:8px"><pre style="margin:0">' + toDisplay(res) + '</pre></div>';
      codeArea.innerText = code || '';
    }

    function setCodeOnly(code) {
      codeArea.innerText = code || '';
    }

    // Handlers
    createBtn.addEventListener('click', () => {
      const v = tryParse(arrayInput.value);
      if (Array.isArray(v)) {
        arr = v;
      } else if (v === undefined) {
        alert('Enter an array or comma-separated values. Example: 1,2,3 or ["a", "b"]');
        return;
      } else {
        // If user typed single token, wrap as array
        arr = Array.isArray(v) ? v : [v];
      }
      snapshot = JSON.parse(JSON.stringify(arr));
      renderArray();
      setResult('Array created', 'Created from input');
    });

    samplesBtn.addEventListener('click', () => {
      alert('Select a sample from the dropdown and click Load.');
    });

    loadSample.addEventListener('click', () => {
      const sel = sampleSelect.value;
      if (sel === 'numbers') arr = [1,2,3,4];
      else if (sel === 'strings') arr = ['a','b','c'];
      else if (sel === 'mixed') arr = [1,'two', true, null];
      else if (sel === 'nested') arr = [[1,2],[3,4]];
      else if (sel === 'objects') arr = [{id:1},{id:2}];
      snapshot = JSON.parse(JSON.stringify(arr));
      renderArray();
      setResult('Sample loaded', 'Loaded sample: ' + sel);
    });

    copyBtn.addEventListener('click', () => {
      const txt = toDisplay(arr);
      navigator.clipboard?.writeText(txt).then(() => {
        setResult('Copied to clipboard', 'JSON copied');
      }, ()=> {
        alert('Copy failed');
      });
    });

    cloneBtn.addEventListener('click', () => {
      // Shallow clone
      const cloned = arr.slice();
      setResult(cloned, 'const cloned = arr.slice(); // shallow copy');
    });

    clearBtn.addEventListener('click', () => {
      if (!confirm('Clear the array? This will set it to []')) return;
      arr = [];
      renderArray();
      setResult('Cleared', 'arr = []');
    });

    // Quick ops
    pushBtn.addEventListener('click', () => {
      const v = tryParse(valueInput.value);
      if (v === undefined && valueInput.value.trim() === '') {
        alert('Enter a value to push.');
        return;
      }
      arr.push(v);
      renderArray();
      setResult(arr.length, 'arr.push(' + JSON.stringify(v) + '); // new length');
    });

    popBtn.addEventListener('click', () => {
      const r = arr.pop();
      renderArray();
      setResult(r, 'const popped = arr.pop();');
    });

    shiftBtn.addEventListener('click', () => {
      const r = arr.shift();
      renderArray();
      setResult(r, 'const shifted = arr.shift();');
    });

    unshiftBtn.addEventListener('click', () => {
      const v = tryParse(valueInput.value);
      if (v === undefined && valueInput.value.trim() === '') {
        alert('Enter a value to unshift.');
        return;
      }
      arr.unshift(v);
      renderArray();
      setResult(arr.length, 'arr.unshift(' + JSON.stringify(v) + '); // new length');
    });

    spliceBtn.addEventListener('click', () => {
      const s = spliceStart.value.trim() === '' ? 0 : Number(spliceStart.value);
      const d = spliceDel.value.trim() === '' ? 0 : Number(spliceDel.value);
      const items = tryParse(spliceItems.value);
      const itemsList = Array.isArray(items) ? items : (items === undefined ? [] : [items]);
      const removed = arr.splice(s, d, ...itemsList);
      renderArray();
      setResult({removed, arr}, 'arr.splice(' + s + ', ' + d + ', ' + JSON.stringify(itemsList) + ');');
    });

    sliceBtn.addEventListener('click', () => {
      const s = sliceStart.value.trim() === '' ? undefined : Number(sliceStart.value);
      const e = sliceEnd.value.trim() === '' ? undefined : Number(sliceEnd.value);
      const res = arr.slice(s, e);
      setResult(res, 'const res = arr.slice(' + (s===undefined? '' : s) + (e===undefined? '' : ', ' + e) + ');');
    });

    applySlice.addEventListener('click', () => {
      if (lastResult === undefined) return alert('No last result to apply.');
      if (!Array.isArray(lastResult)) return alert('Last result is not an array.');
      arr = lastResult;
      renderArray();
      setResult(arr, 'Applied last result to arr');
    });

    // map/filter/reduce
    mapDouble.addEventListener('click', () => {
      try {
        const res = arr.map(x => {
          if (typeof x === 'number') return x*2;
          return x;
        });
        setResult(res, 'const res = arr.map(x => typeof x === "number" ? x*2 : x);');
      } catch (e) {
        setResult('Error: ' + e.message);
      }
    });

    filterEven.addEventListener('click', () => {
      try {
        const res = arr.filter(x => typeof x === 'number' && x % 2 === 0);
        setResult(res, 'const res = arr.filter(x => typeof x === "number" && x % 2 === 0);');
      } catch (e) {
        setResult('Error: ' + e.message);
      }
    });

    reduceSum.addEventListener('click', () => {
      try {
        const res = arr.reduce((a,b) => (typeof a === 'number' ? a : 0) + (typeof b === 'number' ? b : 0), 0);
        setResult(res, 'const res = arr.reduce((a,b)=>a+b,0);');
      } catch (e) {
        setResult('Error: ' + e.message);
      }
    });

    applyResult.addEventListener('click', () => {
      if (lastResult === undefined) return alert('No last result.');
      arr = lastResult;
      renderArray();
      setResult(arr, 'Applied last result to arr');
    });

    // Custom JS runner
    runCustom.addEventListener('click', () => {
      const code = customCode.value || 'return arr;';
      snapshot = JSON.parse(JSON.stringify(arr)); // save snapshot for revert
      try {
        // Create a function with arr in scope. This is the simplest local sandbox.
        // Note: This is not secure for untrusted code. It's for demo purposes.
        const fn = new Function('arr', '"use strict";\n' + code);
        const res = fn(arr);
        customResult.innerHTML = '<pre style="margin:0">' + toDisplay(res) + '</pre>';
        setCodeOnly('// Custom code executed\n' + code);
        lastResult = res;
        if (applyCustom.checked) {
          if (Array.isArray(res)) {
            arr = res;
            renderArray();
          } else {
            if (confirm('Result is not an array. Replace arr anyway?')) {
              arr = res;
              renderArray();
            }
          }
        }
      } catch (e) {
        customResult.innerHTML = '<div style="color:crimson">Error: ' + (e && e.message) + '</div>';
      }
    });

    resetSnap.addEventListener('click', () => {
      if (snapshot !== null) {
        arr = JSON.parse(JSON.stringify(snapshot));
        renderArray();
        setResult('Reverted', 'Reverted to saved snapshot');
      } else {
        alert('No snapshot saved yet. Create or run something to save.');
      }
    });

    // small helpers
    function ensureArrayCheck() {
      if (!Array.isArray(arr)) {
        alert('Current value is not an Array.');
        return false;
      }
      return true;
    }

    // initialize
    arr = [1,2,3];
    snapshot = JSON.parse(JSON.stringify(arr));
    renderArray();
    setResult('Initial sample [1,2,3]', '// demo start');

    // Extra: keyboard shortcuts for convenience
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'Enter') {
        runCustom.click();
      }
    });

    // Informational examples in code area
    codeArea.innerText = [
      '// Examples you can try in the Custom JS box:',
      '// return arr.map(x => x * 2);',
      '// return arr.filter(x => typeof x === "number");',
      '// return arr.reduce((a,b)=>a+b, 0);',
      '// arr.push(9); return arr; // mutates the array',
    ].join('\n');

  </script>
</body>
</html>