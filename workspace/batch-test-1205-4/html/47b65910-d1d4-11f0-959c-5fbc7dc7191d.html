<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merge Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .array {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .bar {
            width: 20px;
            margin: 0 2px;
            background-color: teal;
            transition: height 0.5s;
        }
    </style>
</head>
<body>
    <h1>Merge Sort Visualization</h1>
    <div>
        <button id="sortButton">Generate and Sort Random Array</button>
    </div>
    <div class="array" id="arrayContainer"></div>

    <script>
        const arrayContainer = document.getElementById('arrayContainer');

        function generateRandomArray(size = 10) {
            const array = Array.from({ length: size }, () => Math.floor(Math.random() * 100));
            return array;
        }

        function createBars(array) {
            arrayContainer.innerHTML = '';
            array.forEach(value => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${value * 3}px`; // Scale height for better visibility
                bar.style.backgroundColor = 'teal';
                arrayContainer.appendChild(bar);
            });
        }

        function mergeSort(arr) {
            if (arr.length <= 1) return arr;
            const mid = Math.floor(arr.length / 2);
            const left = mergeSort(arr.slice(0, mid));
            const right = mergeSort(arr.slice(mid));
            return merge(left, right);
        }

        function merge(left, right) {
            const sortedArray = [];
            let leftIndex = 0;
            let rightIndex = 0;

            while (leftIndex < left.length && rightIndex < right.length) {
                if (left[leftIndex] < right[rightIndex]) {
                    sortedArray.push(left[leftIndex]);
                    leftIndex++;
                } else {
                    sortedArray.push(right[rightIndex]);
                    rightIndex++;
                }
            }

            return [...sortedArray, ...left.slice(leftIndex), ...right.slice(rightIndex)];
        }

        async function visualizeMergeSort(array) {
            createBars(array);
            await sleep(1000); // Initial wait before sorting

            const sortedArray = await sort(array);
            createBars(sortedArray);
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        async function sort(arr) {
            if (arr.length <= 1) return arr;
            const mid = Math.floor(arr.length / 2);
            const left = await sort(arr.slice(0, mid));
            const right = await sort(arr.slice(mid));
            const merged = merge(left, right);
            await updateBars(arr, merged);
            return merged;
        }

        async function updateBars(originalArray, newArray) {
            for (let i = 0; i < originalArray.length; i++) {
                const bars = document.querySelectorAll('.bar');
                bars[i].style.height = `${newArray[i] * 3}px`;
                bars[i].style.backgroundColor = 'lightblue'; // Indicate sorting
                await sleep(300);
                bars[i].style.backgroundColor = 'teal'; // Reset color
            }
        }

        document.getElementById('sortButton').addEventListener('click', () => {
            const randomArray = generateRandomArray(10);
            visualizeMergeSort(randomArray);
        });
    </script>
</body>
</html>