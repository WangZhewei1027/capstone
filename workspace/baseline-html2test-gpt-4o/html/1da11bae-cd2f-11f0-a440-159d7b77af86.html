<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Regression Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f0f0f0;
        }
        #plot {
            margin-top: 20px;
        }
        canvas {
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>Linear Regression Demonstration</h1>
    <button id="generate">Generate Random Points</button>
    <button id="calculate">Calculate Line of Best Fit</button>
    <div id="plot">
        <canvas id="canvas" width="500" height="500"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const margin = 40;
        const width = canvas.width - 2 * margin;
        const height = canvas.height - 2 * margin;
        const points = [];

        document.getElementById('generate').addEventListener('click', () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawAxes();
            points.length = 0;
            
            for (let i = 0; i < 10; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                points.push({ x: x + margin, y: canvas.height - (y + margin) });
                drawPoint(x + margin, canvas.height - (y + margin));
            }
        });

        document.getElementById('calculate').addEventListener('click', () => {
            if (points.length === 0) return;

            const line = linearRegression(points);
            drawLine(line);
        });

        function drawAxes() {
            ctx.strokeStyle = '#000';
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, canvas.height - margin);
            ctx.lineTo(canvas.width - margin, canvas.height - margin);
            ctx.stroke();
        }

        function drawPoint(x, y) {
            ctx.fillStyle = '#ff0000';
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawLine({ slope, intercept }) {
            const x0 = margin, y0 = canvas.height - (slope * margin + intercept) - margin;
            const x1 = canvas.width - margin, y1 = canvas.height - (slope * (canvas.width - margin) + intercept) - margin;

            ctx.strokeStyle = '#0000ff';
            ctx.beginPath();
            ctx.moveTo(x0, y0);
            ctx.lineTo(x1, y1);
            ctx.stroke();
        }

        function linearRegression(points) {
            const n = points.length;
            const sumX = points.reduce((sum, p) => sum + p.x, 0);
            const sumY = points.reduce((sum, p) => sum + p.y, 0);
            const sumXY = points.reduce((sum, p) => sum + p.x * p.y, 0);
            const sumX2 = points.reduce((sum, p) => sum + p.x * p.x, 0);

            const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
            const intercept = (sumY - slope * sumX) / n;

            return { slope, intercept };
        }

        drawAxes();
    </script>
</body>
</html>