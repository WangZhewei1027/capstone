<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactive Module — Linear Search</title>
  <style>
    :root{
      --safe-margin: 24px;
      --gap: 16px;
      --bg: #0f1720;
      --pane: #0b1220;
      --muted: #98a0b3;
      --accent: #60a5fa;
      --success: #34d399;
      --danger: #fb7185;
      --glass: rgba(255,255,255,0.03);
      --cell-size: 64px;
      --cell-gap: 12px;
    }

    /* Safe area margins */
    html,body{height:100%;}
    body{
      margin:0;
      padding:var(--safe-margin);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#071023,#071428 60%);
      color: #e6eef8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      box-sizing:border-box;
    }

    *{box-sizing:inherit;}

    /* Layout container */
    .container{
      display:grid;
      grid-template-columns: 360px 1fr;
      gap: var(--gap);
      align-items:start;
      max-width:1300px;
      margin: 0 auto;
    }

    /* Responsive: stack on small widths */
    @media (max-width:920px){
      .container{grid-template-columns: 1fr; padding-bottom:40px;}
    }

    /* Left control panel */
    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius:12px;
      padding:20px;
      min-height:200px;
      box-shadow: 0 6px 20px rgba(2,6,23,0.6);
      display:flex;
      flex-direction:column;
      gap:var(--gap);
    }

    h1{
      margin:0;
      font-size:20px;
      color:var(--accent);
      letter-spacing:0.2px;
    }
    .meta{color:var(--muted); font-size:13px; margin-top:2px;}

    .controls{ display:flex; flex-direction:column; gap:var(--gap); }

    label{font-size:13px; color:var(--muted); display:block; margin-bottom:8px;}
    .row{display:flex; gap:var(--gap); align-items:center; flex-wrap:wrap;}

    input[type="number"], input[type="text"], select{
      background:var(--glass);
      border:1px solid rgba(255,255,255,0.04);
      color:inherit;
      padding:10px 12px;
      border-radius:8px;
      min-width:0;
      outline:none;
    }
    input[type="range"]{width:100%;}
    .btn{
      background:linear-gradient(180deg,var(--accent), #2b80d8);
      color:#042233;
      border:none;
      padding:10px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      box-shadow: 0 6px 16px rgba(35,88,159,0.18);
    }
    .btn.ghost{
      background:transparent;
      color:var(--accent);
      border:1px solid rgba(96,165,250,0.14);
      box-shadow:none;
    }
    .btn.warn{ background:linear-gradient(180deg,#fb7185,#ef445f); color:white; box-shadow:none; }
    .btn.small{ padding:8px 10px; font-size:13px; }

    .inline-controls{ display:flex; gap:var(--gap); align-items:center; flex-wrap:wrap; }

    /* Visual pane */
    .visual{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;
      padding:20px;
      min-height:420px;
      box-shadow: 0 6px 20px rgba(2,6,23,0.6);
      display:flex;
      flex-direction:column;
      gap:var(--gap);
    }

    /* Top info row: target and status */
    .info{
      display:flex;
      justify-content:space-between;
      gap:var(--gap);
      align-items:center;
      flex-wrap:wrap;
    }

    .target-box{
      display:flex;
      gap:var(--gap);
      align-items:center;
      background:rgba(255,255,255,0.02);
      padding:12px;
      border-radius:10px;
      min-width:180px;
    }
    .target-box .lbl{font-size:13px; color:var(--muted);}
    .target-box .val{
      font-weight:700;
      font-size:20px;
      color:var(--accent);
    }

    .status{
      display:flex;
      gap:var(--gap);
      align-items:center;
      color:var(--muted);
      font-size:13px;
    }

    /* Array visualization */
    .array-wrap{
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
      padding:16px;
      border-radius:10px;
      min-height:140px;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      overflow:auto;
    }

    .array{
      display:flex;
      gap:var(--cell-gap);
      padding:8px;
      align-items:end;
    }

    .cell{
      width:var(--cell-size);
      height:var(--cell-size);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      border-radius:10px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:18px;
      color:#e7f2ff;
      position:relative;
      transition: transform 300ms cubic-bezier(.2,.9,.3,1), background 300ms, box-shadow 200ms;
      user-select:none;
    }

    .cell.index{ font-size:12px; color:var(--muted); font-weight:600; }

    .cell .idx{
      position:absolute; bottom:-22px; font-size:12px; color:var(--muted);
    }

    .cell.checking{
      background: linear-gradient(180deg,#fff6d9,#fff1c3);
      color:#6b4a00;
      transform:translateY(-8px) scale(1.04);
      box-shadow: 0 8px 24px rgba(0,0,0,0.35);
    }

    .cell.match{
      background: linear-gradient(180deg, rgba(52,211,153,0.9), rgba(16,185,129,0.9));
      color:#042233;
      transform:translateY(-10px) scale(1.06);
      box-shadow: 0 10px 30px rgba(16,185,129,0.12);
    }

    .cell.miss{
      background: linear-gradient(180deg, rgba(251,113,133,0.12), rgba(251,113,133,0.06));
      color:var(--muted);
      transform:translateY(-4px);
      opacity:0.92;
    }

    /* Pointer arrow */
    .pointer{
      position:absolute;
      top:8px;
      width:0;height:0;
      border-left:14px solid transparent;
      border-right:14px solid transparent;
      border-bottom:18px solid rgba(96,165,250,0.98);
      transform-origin:center top;
      transition: transform 350ms cubic-bezier(.2,.9,.3,1), left 350ms;
      filter:drop-shadow(0 6px 14px rgba(96,165,250,0.12));
      z-index:2;
    }

    /* Comparison counter bar */
    .meter{
      height:10px;
      background:rgba(255,255,255,0.03);
      border-radius:6px;
      overflow:hidden;
      width:100%;
      min-width:120px;
    }
    .meter > i{
      display:block;
      height:100%;
      width:0%;
      background:linear-gradient(90deg,var(--accent), #34d399);
      transition:width 350ms ease;
    }

    .controls-row{ display:flex; gap:var(--gap); flex-wrap:wrap; }

    /* Footer result */
    .result{
      padding:12px;
      border-radius:10px;
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
      display:flex;
      gap:var(--gap);
      align-items:center;
      justify-content:space-between;
    }
    .result .text{font-size:14px; color:var(--muted); }
    .result .out{font-weight:800; color:var(--accent); font-size:15px;}

    /* Small helpers */
    .muted{color:var(--muted); font-size:13px;}
    .kbd{background:rgba(255,255,255,0.03); border-radius:6px; padding:6px 8px; font-weight:700; font-size:13px; color:var(--muted);}

    /* Focus styles */
    button:focus, input:focus { outline: 3px solid rgba(96,165,250,0.12); outline-offset:2px; }

    /* Ensure 16px min spacing between interactive elements (already set via gap var) */
    .panel .controls > * { margin-bottom:0; }
  </style>
</head>
<body>
  <div class="container" role="main" aria-labelledby="title">
    <!-- Left Panel -->
    <section class="panel" aria-labelledby="title">
      <div>
        <h1 id="title">Linear Search — Interactive Exploration</h1>
        <div class="meta">A step-by-step, visual introduction to the linear search algorithm.</div>
      </div>

      <div class="controls" aria-hidden="false">
        <div>
          <label class="muted">Learning Objective</label>
          <div class="muted" style="line-height:1.35">
            After using this module you will be able to explain how linear search scans elements one-by-one, count comparisons, and observe best/worst/average-case behaviors.
          </div>
        </div>

        <div>
          <label for="size" class="muted">Array size</label>
          <div class="row">
            <input id="size" type="range" min="2" max="20" value="8" aria-label="Array size slider">
            <div class="kbd" id="sizeVal">8</div>
          </div>
        </div>

        <div>
          <label class="muted">Array controls</label>
          <div class="inline-controls">
            <button class="btn" id="randomize">Randomize</button>
            <button class="btn ghost" id="editToggle">Edit elements</button>
            <button class="btn small" id="sortBtn" title="Sort for easier testing">Sort</button>
          </div>
          <div class="muted" style="font-size:12px; margin-top:8px;">Edit mode: click a cell to change its value. Press Enter to confirm a typed number.</div>
        </div>

        <div>
          <label for="targetInput" class="muted">Target value to search</label>
          <div class="row">
            <input id="targetInput" type="text" inputmode="numeric" aria-label="Target value" placeholder="e.g., 42">
            <button class="btn" id="startBtn">Search</button>
            <button class="btn ghost" id="stepBtn">Step</button>
          </div>
          <div class="muted" style="font-size:12px; margin-top:8px;">Use "Step" to move one comparison at a time. "Search" runs continuously.</div>
        </div>

        <div>
          <label class="muted">Playback & speed</label>
          <div class="row">
            <button class="btn small" id="prevBtn">&larr; Prev</button>
            <button class="btn small" id="nextBtn">Next &rarr;</button>
            <button class="btn ghost" id="autoToggle">Auto: Off</button>
          </div>
          <div style="margin-top:8px;">
            <label class="muted">Speed</label>
            <input type="range" id="speed" min="100" max="1200" value="600" aria-label="Animation speed">
          </div>
        </div>

        <div>
          <label class="muted">Reset & examples</label>
          <div class="row">
            <button class="btn warn" id="resetBtn">Reset</button>
            <button class="btn ghost" id="exampleNotFound">Example: Not Found</button>
          </div>
        </div>

        <div style="margin-top:4px;">
          <label class="muted">Interaction help</label>
          <div class="muted" style="font-size:13px">
            Shortcuts: Space = Step, Enter in target = Search. Edit mode: click cell to change value.
          </div>
        </div>
      </div>
    </section>

    <!-- Right Visual Panel -->
    <section class="visual" aria-live="polite">
      <div class="info">
        <div class="target-box" aria-hidden="false" role="group" aria-label="Target display">
          <div>
            <div class="lbl">Target</div>
            <div class="val" id="targetDisplay">—</div>
          </div>
        </div>

        <div style="display:flex; gap:var(--gap); align-items:center; flex-wrap:wrap;">
          <div class="status" aria-hidden="false">
            <div class="muted">Comparisons</div>
            <div style="font-weight:800; color:var(--accent);" id="compCount">0</div>
          </div>
          <div style="min-width:160px;">
            <div class="muted">Progress</div>
            <div class="meter" aria-hidden="true" title="Progress">
              <i id="meterBar" style="width:0%"></i>
            </div>
          </div>
        </div>
      </div>

      <div class="array-wrap" id="arrayWrap">
        <div class="pointer" id="pointer" aria-hidden="true" style="left:20px; display:none;"></div>
        <div class="array" id="array" role="list" aria-label="Array elements">
          <!-- Cells inserted by JS -->
        </div>
      </div>

      <div class="controls-row">
        <div class="muted">State: <span id="stateLabel">Idle</span></div>
        <div style="flex:1"></div>
        <div class="muted">Index under check: <span id="currentIdx">—</span></div>
      </div>

      <div class="result" role="status">
        <div class="text">Outcome</div>
        <div class="out" id="resultText">No search yet</div>
      </div>

      <div style="margin-top:8px;">
        <h2 style="font-size:14px; margin:0 0 8px 0; color:var(--accent)">Interaction Design</h2>
        <div class="muted" style="font-size:13px; line-height:1.45">
          - Use the array size slider to change how many elements are in the array. Click "Randomize" to fill with random numbers.<br>
          - Enter a target value and press "Search" to run linear search automatically, or use "Step" to advance one comparison at a time.<br>
          - Edit mode toggles allowing direct clicks on cells to change values.<br>
          - Visual feedback: the pointer arrow moves above the current cell; the cell transitions to "checking" color while compared, then becomes "match" if equal or "miss" if not. The comparisons counter and progress bar update in real time. When found, the animation highlights success and displays index and total comparisons.
        </div>

        <h2 style="font-size:14px; margin:12px 0 8px 0; color:var(--accent)">Layout Description</h2>
        <div class="muted" style="font-size:13px; line-height:1.45">
          - Safe margins of 24px are applied to the page. Controls are in a left panel and the interactive visualization on the right (stacked vertically on small screens).<br>
          - Minimum spacing of 16px is enforced between interactive elements using the layout gaps. The array visualization occupies the main focus area with clear labels for comparisons, index, and outcome. Interactive elements are keyboard accessible and use clear focus styles.
        </div>
      </div>
    </section>
  </div>

  <script>
    // Linear Search Interactive Module - Vanilla JS
    (function(){
      const sizeEl = document.getElementById('size');
      const sizeVal = document.getElementById('sizeVal');
      const arrayEl = document.getElementById('array');
      const pointer = document.getElementById('pointer');
      const targetInput = document.getElementById('targetInput');
      const startBtn = document.getElementById('startBtn');
      const stepBtn = document.getElementById('stepBtn');
      const randomizeBtn = document.getElementById('randomize');
      const editToggle = document.getElementById('editToggle');
      const compCountEl = document.getElementById('compCount');
      const meterBar = document.getElementById('meterBar');
      const stateLabel = document.getElementById('stateLabel');
      const resultText = document.getElementById('resultText');
      const targetDisplay = document.getElementById('targetDisplay');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const autoToggle = document.getElementById('autoToggle');
      const speedEl = document.getElementById('speed');
      const resetBtn = document.getElementById('resetBtn');
      const exampleNotFound = document.getElementById('exampleNotFound');
      const sortBtn = document.getElementById('sortBtn');

      let arr = [];
      let current = -1;
      let comparisons = 0;
      let running = false;
      let auto = false;
      let timer = null;
      let speed = 600;
      let editing = false;
      let lastTarget = null;

      // Utility
      function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

      function makeArray(n){
        arr = [];
        for(let i=0;i<n;i++) arr.push(randInt(1,99));
        renderArray();
        resetState();
      }

      function renderArray(){
        arrayEl.innerHTML = '';
        arr.forEach((v,i)=>{
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.setAttribute('role','listitem');
          cell.dataset.index = i;
          cell.innerHTML = `<div class="val">${v}</div><div class="idx">${i}</div>`;
          cell.tabIndex = 0;
          // Click to edit if in edit mode
          cell.addEventListener('click', (e)=>{
            if(!editing) return;
            enterEditCell(cell, i);
          });
          cell.addEventListener('keydown', (e)=>{
            if(!editing) return;
            if(e.key === 'Enter') enterEditCell(cell, i);
          });
          arrayEl.appendChild(cell);
        });
        placePointerAt(-1);
      }

      function enterEditCell(cell,i){
        const prev = arr[i];
        const input = document.createElement('input');
        input.type = 'number';
        input.value = prev;
        input.style.width = '100%';
        input.style.height = '100%';
        input.style.border = 'none';
        input.style.textAlign = 'center';
        input.style.fontWeight = '700';
        input.style.fontSize = '18px';
        input.style.background = 'transparent';
        cell.innerHTML = '';
        cell.appendChild(input);
        input.focus();
        input.select();
        function finish(){
          const v = Number(input.value) || 0;
          arr[i] = v;
          renderArray();
        }
        input.addEventListener('blur', finish);
        input.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter'){ finish(); }
        });
      }

      function placePointerAt(index){
        const cells = Array.from(arrayEl.children);
        if(index < 0 || index >= cells.length){
          pointer.style.display = 'none';
          document.getElementById('currentIdx').textContent = '—';
          return;
        }
        const targetCell = cells[index];
        const rect = targetCell.getBoundingClientRect();
        const parentRect = arrayEl.getBoundingClientRect();
        const left = targetCell.offsetLeft + targetCell.offsetWidth/2 - 14 + arrayEl.offsetLeft;
        pointer.style.display = 'block';
        // Position pointer relative to arrayWrap (absolute)
        const wrap = document.getElementById('arrayWrap');
        const wrapRect = wrap.getBoundingClientRect();
        const leftPos = targetCell.offsetLeft + targetCell.offsetWidth/2 + arrayEl.offsetLeft - wrap.offsetLeft - 14;
        pointer.style.left = Math.max(8, leftPos) + 'px';
        document.getElementById('currentIdx').textContent = index;
      }

      function resetState(){
        stopAuto();
        running = false;
        current = -1;
        comparisons = 0;
        compCountEl.textContent = comparisons;
        stateLabel.textContent = 'Idle';
        resultText.textContent = 'No search yet';
        meterBar.style.width = '0%';
        placePointerAt(-1);
        clearCellStates();
      }

      function clearCellStates(){
        Array.from(arrayEl.children).forEach(c=>{
          c.classList.remove('checking','match','miss');
        });
      }

      function updateMeter(){
        const pct = arr.length ? Math.min(100, Math.round((comparisons/arr.length)*100)) : 0;
        meterBar.style.width = pct + '%';
      }

      function stepOnce(){
        if(current >= arr.length) return;
        if(current === -1){
          current = 0;
        } else {
          // clear previous checking state unless it was match
          const prev = arrayEl.children[current];
          if(prev) prev.classList.remove('checking');
          current++;
        }
        if(current < arr.length){
          compareAt(current);
        } else {
          // finished, not found
          finishNotFound();
        }
      }

      function compareAt(idx){
        clearCellStates();
        const cell = arrayEl.children[idx];
        if(!cell) return;
        placePointerAt(idx);
        cell.classList.add('checking');
        stateLabel.textContent = 'Comparing';
        comparisons++;
        compCountEl.textContent = comparisons;
        updateMeter();
        // slight delay to show checking before reading equality
        setTimeout(()=> {
          const val = arr[idx];
          const target = toNumberSafe(lastTarget);
          if(val === target){
            cell.classList.remove('checking');
            cell.classList.add('match');
            stateLabel.textContent = 'Found';
            resultText.textContent = `Found at index ${idx} (comparisons: ${comparisons})`;
            stopAuto();
            running = false;
            current = idx;
            placePointerAt(idx);
          } else {
            cell.classList.remove('checking');
            cell.classList.add('miss');
            // Continue if auto mode
            if(auto){
              if(current < arr.length - 1){
                // schedule next
                timer = setTimeout(()=> stepOnce(), speed);
              } else {
                finishNotFound();
              }
            } else {
              // idle, allow manual next
              stateLabel.textContent = 'Idle';
            }
          }
        }, Math.max(120, speed/4));
      }

      function finishNotFound(){
        stateLabel.textContent = 'Completed';
        resultText.textContent = `Not found (comparisons: ${comparisons})`;
        stopAuto();
        running = false;
      }

      function startSearch(){
        const t = targetInput.value.trim();
        if(t === '') return;
        lastTarget = t;
        targetDisplay.textContent = t;
        // prepare
        clearCellStates();
        comparisons = 0;
        compCountEl.textContent = comparisons;
        stateLabel.textContent = 'Running';
        current = -1;
        running = true;
        // if auto is on start auto loop else step once
        if(auto){
          stepOnce();
        } else {
          stepOnce(); // still single step initial comparison
        }
      }

      function toNumberSafe(v){
        const n = Number(String(v).trim());
        return Number.isNaN(n) ? String(v) : n;
      }

      // Buttons and handlers
      sizeEl.addEventListener('input', ()=>{
        sizeVal.textContent = sizeEl.value;
        makeArray(Number(sizeEl.value));
      });

      randomizeBtn.addEventListener('click', ()=> {
        makeArray(Number(sizeEl.value));
      });

      editToggle.addEventListener('click', ()=>{
        editing = !editing;
        editToggle.classList.toggle('ghost', !editing);
        editToggle.textContent = editing ? 'Editing: On' : 'Edit elements';
        editToggle.setAttribute('aria-pressed', editing);
      });

      startBtn.addEventListener('click', ()=>{
        auto = true;
        autoToggle.textContent = 'Auto: On';
        speed = Number(speedEl.value);
        startSearch();
      });

      stepBtn.addEventListener('click', ()=>{
        // manual step
        auto = false;
        stopAuto();
        if(lastTarget == null && targetInput.value.trim() !== ''){
          lastTarget = targetInput.value.trim();
          targetDisplay.textContent = lastTarget;
        }
        if(lastTarget == null) return;
        stepOnce();
      });

      nextBtn.addEventListener('click', ()=>{
        auto = false;
        stopAuto();
        if(lastTarget == null && targetInput.value.trim() !== ''){
          lastTarget = targetInput.value.trim();
          targetDisplay.textContent = lastTarget;
        }
        stepOnce();
      });

      prevBtn.addEventListener('click', ()=>{
        auto = false;
        stopAuto();
        // move back one step for exploration
        if(current <= 0){
          current = -1;
          clearCellStates();
          comparisons = 0;
          compCountEl.textContent = comparisons;
          updateMeter();
          placePointerAt(-1);
          resultText.textContent = 'No search yet';
          stateLabel.textContent = 'Idle';
          return;
        }
        // revert a comparison: decrement comparisons, remove state from current cell
        const cell = arrayEl.children[current];
        if(cell) cell.classList.remove('checking','miss','match');
        current--;
        comparisons = Math.max(0, comparisons-1);
        compCountEl.textContent = comparisons;
        updateMeter();
        placePointerAt(current);
        stateLabel.textContent = 'Idle';
        resultText.textContent = 'Stepped back';
      });

      autoToggle.addEventListener('click', ()=>{
        auto = !auto;
        autoToggle.textContent = auto ? 'Auto: On' : 'Auto: Off';
        if(auto && running){
          // ensure loop continues
          stepOnce();
        }
      });

      speedEl.addEventListener('input', ()=>{
        speed = Number(speedEl.value);
      });

      resetBtn.addEventListener('click', ()=> {
        makeArray(Number(sizeEl.value));
        targetInput.value = '';
        lastTarget = null;
        targetDisplay.textContent = '—';
      });

      exampleNotFound.addEventListener('click', ()=>{
        // create an array that doesn't contain 999
        const n = Number(sizeEl.value);
        arr = [];
        for(let i=0;i<n;i++) arr.push(i+1);
        renderArray();
        targetInput.value = '999';
        lastTarget = null;
        targetDisplay.textContent = '—';
      });

      sortBtn.addEventListener('click', ()=>{
        arr.sort((a,b)=>a-b);
        renderArray();
      });

      function stopAuto(){
        auto = false;
        autoToggle.textContent = 'Auto: Off';
        if(timer) clearTimeout(timer);
        timer = null;
      }

      // Keyboard shortcuts
      window.addEventListener('keydown', (e)=>{
        if(e.key === ' '){
          e.preventDefault();
          stepBtn.click();
        } else if(e.key === 'Enter' && document.activeElement === targetInput){
          startBtn.click();
        }
      });

      // Initialize
      sizeVal.textContent = sizeEl.value;
      makeArray(Number(sizeEl.value));

      // Accessibility: update aria labels if needed in the future
      // Resize handling: reposition pointer on layout changes
      window.addEventListener('resize', ()=> {
        placePointerAt(current);
      });

      // When user types target, update display
      targetInput.addEventListener('input', ()=>{
        targetDisplay.textContent = targetInput.value.trim() || '—';
      });

      // Make sure pointer appears above array on first compare
      // Ensure transitions and animations remain smooth with CSS above
    })();
  </script>
</body>
</html>