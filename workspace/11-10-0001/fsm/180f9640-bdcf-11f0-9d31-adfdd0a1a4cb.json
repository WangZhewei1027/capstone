{
  "topic": "Knapsack Interactive Application",
  "description": "Finite state machine modeling user interactions, animations, and data-processing phases of the 0/1 knapsack interactive visualization (item selection, drag/drop, capacity changes, DP compute animation and result application).",
  "states": [
    {
      "name": "idle",
      "onEnter": "renderItems",
      "onExit": "noop",
      "on": {
        "SELECT_ITEM": "selected",
        "START_DRAG": "dragging",
        "PRESS_COMPUTE": "computing_filling",
        "PRESS_REGEN": "regenerating",
        "PRESS_RESET": "resetting",
        "PRESS_CLEAR": "clearing",
        "PRESS_ADD": "adding",
        "PRESS_REMOVE": "removing",
        "CHANGE_CAPACITY": "changing_capacity",
        "OPEN_HELP": "help_open",
        "DRAG_START": "dragging"
      }
    },
    {
      "name": "selected",
      "onEnter": "updateSelectionVisual",
      "onExit": "clearSelectionVisual",
      "on": {
        "DESELECT_ITEM": "idle",
        "PRESS_ADD": "adding",
        "PRESS_REMOVE": "removing",
        "START_DRAG": "dragging",
        "PRESS_COMPUTE": "computing_filling",
        "CHANGE_CAPACITY": "changing_capacity",
        "OPEN_HELP": "help_open"
      }
    },
    {
      "name": "dragging",
      "onEnter": "setDraggingId",
      "onExit": "clearDraggingId",
      "on": {
        "DRAG_OVER_KNAPSACK": "drag_over_knapsack",
        "DRAG_LEAVE_KNAPSACK": "idle",
        "DROP_ON_KNAPSACK": "adding_from_drag",
        "DRAG_CANCEL": "idle"
      }
    },
    {
      "name": "drag_over_knapsack",
      "onEnter": "highlightKnapsack",
      "onExit": "unhighlightKnapsack",
      "on": {
        "DROP_ON_KNAPSACK": "adding_from_drag",
        "DRAG_LEAVE_KNAPSACK": "dragging",
        "DRAG_CANCEL": "dragging"
      }
    },
    {
      "name": "adding",
      "onEnter": "addToKnapsack",
      "onExit": "noop",
      "on": {
        "ACTION_COMPLETE": "totals_check",
        "CANCEL": "idle"
      }
    },
    {
      "name": "adding_from_drag",
      "onEnter": "addToKnapsackFromDrag",
      "onExit": "noop",
      "on": {
        "ACTION_COMPLETE": "totals_check",
        "CANCEL": "idle"
      }
    },
    {
      "name": "removing",
      "onEnter": "removeFromKnapsack",
      "onExit": "noop",
      "on": {
        "ACTION_COMPLETE": "totals_check",
        "CANCEL": "idle"
      }
    },
    {
      "name": "clearing",
      "onEnter": "clearKnapsack",
      "onExit": "noop",
      "on": {
        "ACTION_COMPLETE": "totals_check"
      }
    },
    {
      "name": "resetting",
      "onEnter": "resetItems",
      "onExit": "noop",
      "on": {
        "ACTION_COMPLETE": "totals_check"
      }
    },
    {
      "name": "regenerating",
      "onEnter": "createItems",
      "onExit": "noop",
      "on": {
        "ACTION_COMPLETE": "totals_check"
      }
    },
    {
      "name": "changing_capacity",
      "onEnter": "changeCapacity",
      "onExit": "noop",
      "on": {
        "ACTION_COMPLETE": "totals_check"
      }
    },
    {
      "name": "totals_check",
      "onEnter": "updateTotals",
      "onExit": "noop",
      "on": {
        "TOTALS_OK": "idle",
        "TOTALS_OVER": "over_capacity"
      }
    },
    {
      "name": "over_capacity",
      "onEnter": "highlightOverCapacity",
      "onExit": "unhighlightOverCapacity",
      "on": {
        "PRESS_CLEAR": "clearing",
        "PRESS_REMOVE": "removing",
        "CHANGE_CAPACITY": "changing_capacity",
        "PRESS_COMPUTE": "computing_filling",
        "TOTALS_OK": "idle",
        "DESELECT_ITEM": "idle",
        "OPEN_HELP": "help_open"
      }
    },
    {
      "name": "computing_filling",
      "onEnter": "disableCompute; buildEmptyTable; startDpFillAnimation",
      "onExit": "noop",
      "on": {
        "FILL_COMPLETE": "computing_backtracking",
        "CANCEL_COMPUTE": "computed_done",
        "ERROR": "computed_done"
      }
    },
    {
      "name": "computing_backtracking",
      "onEnter": "highlightBacktrack",
      "onExit": "noop",
      "on": {
        "BACKTRACK_COMPLETE": "computing_animating_adds",
        "CANCEL_COMPUTE": "computed_done"
      }
    },
    {
      "name": "computing_animating_adds",
      "onEnter": "clearKnapsack; animateAddingChosen; enableCompute",
      "onExit": "noop",
      "on": {
        "ANIM_ADDS_COMPLETE": "computed_done",
        "CANCEL_COMPUTE": "computed_done"
      }
    },
    {
      "name": "computed_done",
      "onEnter": "updateTotals",
      "onExit": "noop",
      "on": {
        "PRESS_COMPUTE": "computing_filling",
        "PRESS_CLEAR": "clearing",
        "PRESS_RESET": "resetting",
        "PRESS_REGEN": "regenerating",
        "SELECT_ITEM": "selected",
        "OPEN_HELP": "help_open"
      }
    },
    {
      "name": "help_open",
      "onEnter": "showHelp",
      "onExit": "noop",
      "on": {
        "CLOSE_HELP": "idle"
      }
    }
  ],
  "events": [
    "SELECT_ITEM",
    "DESELECT_ITEM",
    "START_DRAG",
    "DRAG_OVER_KNAPSACK",
    "DRAG_LEAVE_KNAPSACK",
    "DROP_ON_KNAPSACK",
    "DRAG_CANCEL",
    "PRESS_ADD",
    "PRESS_REMOVE",
    "PRESS_CLEAR",
    "PRESS_RESET",
    "PRESS_REGEN",
    "CHANGE_CAPACITY",
    "PRESS_COMPUTE",
    "FILL_COMPLETE",
    "BACKTRACK_COMPLETE",
    "ANIM_ADDS_COMPLETE",
    "ACTION_COMPLETE",
    "TOTALS_OK",
    "TOTALS_OVER",
    "CANCEL_COMPUTE",
    "ERROR",
    "OPEN_HELP",
    "CLOSE_HELP",
    "DRAG_START",
    "DRAG_END"
  ],
  "notes": "States capture selection, drag/drop, capacity evaluation (over_capacity), DP compute phases (filling, backtrack, animating adds), and auxiliary actions (regen/reset/clear). Action states (adding, removing, clearing, resetting, regenerating, changing_capacity, adding_from_drag) perform the side-effect in onEnter and emit ACTION_COMPLETE, which triggers totals_check; totals_check routes to idle or over_capacity via TOTALS_OK/TOTALS_OVER depending on updateTotals outcome. Computing states disable the compute control during animation and re-enable after animating chosen items."
}