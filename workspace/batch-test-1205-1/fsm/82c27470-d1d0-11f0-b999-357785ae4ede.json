{
  "meta": {
    "concept": "Bubble Sort Visualizer",
    "topic": "Bubble Sort",
    "educational_goal": "Demonstrate bubble sort with step-by-step visual highlights of comparisons, swaps, and passes; allow user control over playback, stepping, array generation, and parameters.",
    "expected_interactions": [
      "Click #playBtn to Play/Pause the visualization",
      "Click #stepBtn to advance one step",
      "Click #resetBtn to reset to original array",
      "Click #randomBtn to randomize the array",
      "Adjust input#speed to change animation speed",
      "Adjust input#size to change array size (regenerates array)",
      "Change select#order to toggle ascending/descending (triggers reset)",
      "Toggle input#optimized to enable/disable optimization (triggers reset)",
      "Enter values in input#customArray and click button#loadArray to load custom array",
      "Keyboard shortcuts: Space -> Play/Pause, ArrowRight -> Step, R -> Reset"
    ]
  },
  "states": [
    {
      "id": "S0_Ready",
      "label": "Ready",
      "type": "idle",
      "entry_actions": [
        "renderBars(array)",
        "stepGenerator = bubbleSortGenerator(array, ascending, optimized)",
        "clearCodeHighlight()"
      ],
      "exit_actions": [],
      "evidence": [
        "statusEl.textContent = 'Ready';",
        "stepGenerator = bubbleSortGenerator(array, ascending, optimized);",
        "renderBars(array);",
        "clearCodeHighlight();"
      ],
      "confidence": 1
    },
    {
      "id": "S1_Playing",
      "label": "Playing",
      "type": "active",
      "entry_actions": [
        "startAuto()",
        "playBtn.textContent = 'Pause'"
      ],
      "exit_actions": [
        "stopAuto()"
      ],
      "evidence": [
        "function startAuto(){\n    if (playing) return;\n    playing = true;\n    playBtn.textContent = 'Pause';\n    statusEl.textContent = 'Playing';\n    autoStep();\n  }",
        "statusEl.textContent = 'Playing';",
        "playBtn.addEventListener('click', ()=>{\n    if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    } else {\n      // if generator finished, reinitialize\n      if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n      startAuto();\n    }\n  });"
      ],
      "confidence": 1
    },
    {
      "id": "S2_Paused",
      "label": "Paused",
      "type": "idle",
      "entry_actions": [
        "stopAuto()",
        "statusEl.textContent = 'Paused'"
      ],
      "exit_actions": [
        "startAuto()"
      ],
      "evidence": [
        "if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    }",
        "playBtn.addEventListener('click', ()=>{\n    if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    } else {\n      // if generator finished, reinitialize\n      if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n      startAuto();\n    }\n  });"
      ],
      "confidence": 1
    },
    {
      "id": "S3_Completed",
      "label": "Completed",
      "type": "terminal",
      "entry_actions": [
        "mark all bars sorted",
        "highlightCodeLine(15)",
        "stopAuto()"
      ],
      "exit_actions": [
        "reset()"
      ],
      "evidence": [
        "case 'done':\n        // mark all sorted\n        for (let i=0;i<bars.length;i++) markSorted(i);\n        statusEl.textContent = 'Completed';\n        highlightCodeLine(15);\n        stopAuto();",
        "if (next.done){\n      statusEl.textContent = 'Completed';\n      stopAuto();\n      return;\n    }"
      ],
      "confidence": 1
    }
  ],
  "events": [
    {
      "id": "CLICK_PLAY",
      "event_type": "click",
      "description": "User clicks Play/Pause button (#playBtn). Toggles autoplay: startAuto() if not playing, stopAuto() if playing.",
      "trigger_selectors": [
        "#playBtn"
      ],
      "evidence": [
        "playBtn.addEventListener('click', ()=>{\n    if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    } else {\n      // if generator finished, reinitialize\n      if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n      startAuto();\n    }\n  });"
      ],
      "confidence": 1
    },
    {
      "id": "CLICK_STEP",
      "event_type": "click",
      "description": "User clicks Step button (#stepBtn). Advances one generator step; ignored while playing.",
      "trigger_selectors": [
        "#stepBtn"
      ],
      "evidence": [
        "stepBtn.addEventListener('click', async ()=>{\n    if (playing) return; // do not step while playing\n    if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    await stepOnce();\n  });",
        "async function stepOnce(){\n    if (!stepGenerator) return;\n    const next = stepGenerator.next();\n    if (next.done){\n      statusEl.textContent = 'Completed';\n      stopAuto();\n      return;\n    }\n    await handleAction(next.value);\n  }"
      ],
      "confidence": 1
    },
    {
      "id": "CLICK_RESET",
      "event_type": "click",
      "description": "User clicks Reset button (#resetBtn). Stops playback and restores the initial array and UI counters.",
      "trigger_selectors": [
        "#resetBtn"
      ],
      "evidence": [
        "resetBtn.addEventListener('click', reset);",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "id": "CLICK_RANDOMIZE",
      "event_type": "click",
      "description": "User clicks Randomize (#randomBtn). Generates a new random array, renders bars, resets counters, and prepares generator.",
      "trigger_selectors": [
        "#randomBtn"
      ],
      "evidence": [
        "randomBtn.addEventListener('click', () => { randomize(); });",
        "function randomize(){\n    const n = Number(sizeInput.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "id": "INPUT_SPEED",
      "event_type": "input",
      "description": "User changes speed slider (#speed). Updates animation speed variable.",
      "trigger_selectors": [
        "input#speed"
      ],
      "evidence": [
        "speedInput.addEventListener('input', (e)=>{ speed = Number(e.target.value); });"
      ],
      "confidence": 1
    },
    {
      "id": "INPUT_SIZE",
      "event_type": "input",
      "description": "User changes size slider (#size). Regenerates random array of new size and resets UI.",
      "trigger_selectors": [
        "input#size"
      ],
      "evidence": [
        "sizeInput.addEventListener('input', (e)=>{\n    // change size immediate\n    const n = Number(e.target.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n  });"
      ],
      "confidence": 1
    },
    {
      "id": "CHANGE_ORDER",
      "event_type": "change",
      "description": "User changes the order select (#order). Updates ascending flag and calls reset().",
      "trigger_selectors": [
        "select#order"
      ],
      "evidence": [
        "orderSelect.addEventListener('change', (e)=> {\n    ascending = e.target.value === 'asc';\n    reset();\n  });"
      ],
      "confidence": 1
    },
    {
      "id": "CHANGE_OPTIMIZED",
      "event_type": "change",
      "description": "User toggles optimized checkbox (#optimized). Updates optimized flag and calls reset().",
      "trigger_selectors": [
        "input#optimized"
      ],
      "evidence": [
        "optimizedCheckbox.addEventListener('change', (e)=>{\n    optimized = e.target.checked;\n    reset();\n  });"
      ],
      "confidence": 1
    },
    {
      "id": "CLICK_LOAD_ARRAY",
      "event_type": "click",
      "description": "User clicks Load button (#loadArray) to parse customArray input and load it as array.",
      "trigger_selectors": [
        "button#loadArray"
      ],
      "evidence": [
        "loadArrayBtn.addEventListener('click', loadCustom);",
        "function loadCustom(){\n    const txt = customArrayInput.value.trim();\n    if (!txt) return alert('Enter comma separated numbers (e.g. 5,1,4,2)');\n    const parts = txt.split(/[\\s,]+/).map(s=>Number(s)).filter(n=>!isNaN(n));\n    if (parts.length === 0) return alert('No valid numbers found');\n    array = parts.slice();\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "id": "KEY_SPACE",
      "event_type": "keydown",
      "description": "Space key pressed on window triggers playBtn.click() (Play/Pause).",
      "trigger_selectors": [
        "window.addEventListener('keydown', (e)=>{"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{\n    if (e.key === ' '){\n      e.preventDefault();\n      playBtn.click();\n    } else if (e.key === 'ArrowRight'){\n      e.preventDefault();\n      stepBtn.click();\n    } else if (e.key === 'r' || e.key === 'R'){\n      resetBtn.click();\n    }\n  });"
      ],
      "confidence": 1
    },
    {
      "id": "KEY_ARROW_RIGHT",
      "event_type": "keydown",
      "description": "ArrowRight pressed triggers stepBtn.click().",
      "trigger_selectors": [
        "window.addEventListener('keydown', (e)=>{"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{\n    if (e.key === ' '){\n      e.preventDefault();\n      playBtn.click();\n    } else if (e.key === 'ArrowRight'){\n      e.preventDefault();\n      stepBtn.click();\n    } else if (e.key === 'r' || e.key === 'R'){\n      resetBtn.click();\n    }\n  });"
      ],
      "confidence": 1
    },
    {
      "id": "KEY_R",
      "event_type": "keydown",
      "description": "Key 'r' or 'R' pressed triggers resetBtn.click().",
      "trigger_selectors": [
        "window.addEventListener('keydown', (e)=>{"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{\n    if (e.key === ' '){\n      e.preventDefault();\n      playBtn.click();\n    } else if (e.key === 'ArrowRight'){\n      e.preventDefault();\n      stepBtn.click();\n    } else if (e.key === 'r' || e.key === 'R'){\n      resetBtn.click();\n    }\n  });"
      ],
      "confidence": 1
    }
  ],
  "transitions": [
    {
      "from": "S0_Ready",
      "to": "S1_Playing",
      "event": "CLICK_PLAY",
      "guard": "playing == false",
      "actions": [
        "if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized)",
        "startAuto()",
        "playBtn.textContent = 'Pause'",
        "statusEl.textContent = 'Playing'"
      ],
      "expected_observables": [
        "playBtn text becomes 'Pause'",
        "status element shows 'Playing'",
        "visual auto-advancement begins"
      ],
      "evidence": [
        "playBtn.addEventListener('click', ()=>{\n    if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    } else {\n      // if generator finished, reinitialize\n      if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n      startAuto();\n    }\n  });",
        "if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);",
        "function startAuto(){\n    if (playing) return;\n    playing = true;\n    playBtn.textContent = 'Pause';\n    statusEl.textContent = 'Playing';\n    autoStep();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Paused",
      "to": "S1_Playing",
      "event": "CLICK_PLAY",
      "guard": "playing == false",
      "actions": [
        "startAuto()",
        "statusEl.textContent = 'Playing'"
      ],
      "expected_observables": [
        "status becomes 'Playing' and animation resumes"
      ],
      "evidence": [
        "playBtn.addEventListener('click', ()=>{\n    if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    } else {\n      // if generator finished, reinitialize\n      if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n      startAuto();\n    }\n  });",
        "function startAuto(){\n    if (playing) return;\n    playing = true;\n    playBtn.textContent = 'Pause';\n    statusEl.textContent = 'Playing';\n    autoStep();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S2_Paused",
      "event": "CLICK_PLAY",
      "guard": "playing == true",
      "actions": [
        "stopAuto()",
        "statusEl.textContent = 'Paused'"
      ],
      "expected_observables": [
        "playBtn text becomes 'Play'",
        "status shows 'Paused'",
        "auto advancement stops"
      ],
      "evidence": [
        "playBtn.addEventListener('click', ()=>{\n    if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    } else {\n      // if generator finished, reinitialize\n      if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n      startAuto();\n    }\n  });",
        "function stopAuto(){\n    playing = false;\n    playBtn.textContent = 'Play';\n    if (autoTimer) { clearTimeout(autoTimer); autoTimer=null; }\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "CLICK_STEP",
      "guard": "stepGenerator.next().done === false",
      "actions": [
        "if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized)",
        "stepOnce() -> handleAction(next.value)"
      ],
      "expected_observables": [
        "UI updates for a single compare/swap/pass (compCount/swapCount/passCount/status/code highlight/bar styling) but remains not 'Completed'"
      ],
      "evidence": [
        "stepBtn.addEventListener('click', async ()=>{\n    if (playing) return; // do not step while playing\n    if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    await stepOnce();\n  });",
        "async function stepOnce(){\n    if (!stepGenerator) return;\n    const next = stepGenerator.next();\n    if (next.done){\n      statusEl.textContent = 'Completed';\n      stopAuto();\n      return;\n    }\n    await handleAction(next.value);\n  }"
      ],
      "confidence": 0.95
    },
    {
      "from": "S0_Ready",
      "to": "S3_Completed",
      "event": "CLICK_STEP",
      "guard": "stepGenerator.next().done === true",
      "actions": [
        "statusEl.textContent = 'Completed'",
        "stopAuto()"
      ],
      "expected_observables": [
        "Status shows 'Completed' and bars are marked sorted"
      ],
      "evidence": [
        "async function stepOnce(){\n    if (!stepGenerator) return;\n    const next = stepGenerator.next();\n    if (next.done){\n      statusEl.textContent = 'Completed';\n      stopAuto();\n      return;\n    }\n    await handleAction(next.value);\n  }",
        "case 'done':\n        // mark all sorted\n        for (let i=0;i<bars.length;i++) markSorted(i);\n        statusEl.textContent = 'Completed';\n        highlightCodeLine(15);\n        stopAuto();"
      ],
      "confidence": 0.95
    },
    {
      "from": "S2_Paused",
      "to": "S2_Paused",
      "event": "CLICK_STEP",
      "guard": "playing == false && stepGenerator.next().done === false",
      "actions": [
        "await stepOnce()"
      ],
      "expected_observables": [
        "Single-step actions while paused (compare/swap visuals) without entering Playing state"
      ],
      "evidence": [
        "stepBtn.addEventListener('click', async ()=>{\n    if (playing) return; // do not step while playing\n    if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    await stepOnce();\n  });",
        "async function stepOnce(){\n    if (!stepGenerator) return;\n    const next = stepGenerator.next();\n    if (next.done){\n      statusEl.textContent = 'Completed';\n      stopAuto();\n      return;\n    }\n    await handleAction(next.value);\n  }"
      ],
      "confidence": 0.95
    },
    {
      "from": "S2_Paused",
      "to": "S3_Completed",
      "event": "CLICK_STEP",
      "guard": "playing == false && stepGenerator.next().done === true",
      "actions": [
        "statusEl.textContent = 'Completed'",
        "stopAuto()"
      ],
      "expected_observables": [
        "Status shows 'Completed'"
      ],
      "evidence": [
        "async function stepOnce(){\n    if (!stepGenerator) return;\n    const next = stepGenerator.next();\n    if (next.done){\n      statusEl.textContent = 'Completed';\n      stopAuto();\n      return;\n    }\n    await handleAction(next.value);\n  }"
      ],
      "confidence": 0.95
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "CLICK_RESET",
      "actions": [
        "reset()",
        "stopAuto()",
        "renderBars(initialArray)",
        "compCount = swapCount = passCount = 0",
        "statusEl.textContent = 'Ready'"
      ],
      "expected_observables": [
        "UI counters reset to 0 and status becomes 'Ready', bars revert to initial arrangement"
      ],
      "evidence": [
        "resetBtn.addEventListener('click', reset);",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S0_Ready",
      "event": "CLICK_RESET",
      "actions": [
        "reset()",
        "stopAuto()"
      ],
      "expected_observables": [
        "Auto-play stops and UI resets to Ready"
      ],
      "evidence": [
        "resetBtn.addEventListener('click', reset);",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Paused",
      "to": "S0_Ready",
      "event": "CLICK_RESET",
      "actions": [
        "reset()"
      ],
      "expected_observables": [
        "UI resets to Ready"
      ],
      "evidence": [
        "resetBtn.addEventListener('click', reset);",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Completed",
      "to": "S0_Ready",
      "event": "CLICK_RESET",
      "actions": [
        "reset()"
      ],
      "expected_observables": [
        "Completed state cleared and UI shows Ready"
      ],
      "evidence": [
        "resetBtn.addEventListener('click', reset);",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "CLICK_RANDOMIZE",
      "actions": [
        "randomize()",
        "renderBars(array)",
        "stepGenerator = bubbleSortGenerator(array, ascending, optimized)",
        "statusEl.textContent = 'Ready'"
      ],
      "expected_observables": [
        "New random bars rendered and UI counters set to 0"
      ],
      "evidence": [
        "randomBtn.addEventListener('click', () => { randomize(); });",
        "function randomize(){\n    const n = Number(sizeInput.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S0_Ready",
      "event": "CLICK_RANDOMIZE",
      "actions": [
        "randomize()",
        "stopAuto()"
      ],
      "expected_observables": [
        "Auto-play stops and new random array is displayed"
      ],
      "evidence": [
        "randomBtn.addEventListener('click', () => { randomize(); });",
        "function randomize(){\n    const n = Number(sizeInput.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Paused",
      "to": "S0_Ready",
      "event": "CLICK_RANDOMIZE",
      "actions": [
        "randomize()"
      ],
      "expected_observables": [
        "Paused playback replaced by new random array and Ready status"
      ],
      "evidence": [
        "randomBtn.addEventListener('click', () => { randomize(); });",
        "function randomize(){\n    const n = Number(sizeInput.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Completed",
      "to": "S0_Ready",
      "event": "CLICK_RANDOMIZE",
      "actions": [
        "randomize()"
      ],
      "expected_observables": [
        "Completed cleared and new array shown"
      ],
      "evidence": [
        "randomBtn.addEventListener('click', () => { randomize(); });",
        "function randomize(){\n    const n = Number(sizeInput.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "INPUT_SIZE",
      "actions": [
        "generateRandomArray(n)",
        "renderBars(array)",
        "stepGenerator = bubbleSortGenerator(array, ascending, optimized)",
        "statusEl.textContent = 'Ready'"
      ],
      "expected_observables": [
        "Bars re-rendered with new size and counters reset"
      ],
      "evidence": [
        "sizeInput.addEventListener('input', (e)=>{\n    // change size immediate\n    const n = Number(e.target.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n  });"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S0_Ready",
      "event": "INPUT_SIZE",
      "actions": [
        "generateRandomArray(n)",
        "renderBars(array)",
        "stopAuto()",
        "statusEl.textContent = 'Ready'"
      ],
      "expected_observables": [
        "Auto-play stops and new array is shown"
      ],
      "evidence": [
        "sizeInput.addEventListener('input', (e)=>{\n    // change size immediate\n    const n = Number(e.target.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n  });"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Paused",
      "to": "S0_Ready",
      "event": "INPUT_SIZE",
      "actions": [
        "generateRandomArray(n)",
        "renderBars(array)",
        "statusEl.textContent = 'Ready'"
      ],
      "expected_observables": [
        "Paused replaced by new array and Ready status"
      ],
      "evidence": [
        "sizeInput.addEventListener('input', (e)=>{\n    // change size immediate\n    const n = Number(e.target.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n  });"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Completed",
      "to": "S0_Ready",
      "event": "INPUT_SIZE",
      "actions": [
        "generateRandomArray(n)",
        "renderBars(array)",
        "statusEl.textContent = 'Ready'"
      ],
      "expected_observables": [
        "Completed cleared and new array shown"
      ],
      "evidence": [
        "sizeInput.addEventListener('input', (e)=>{\n    // change size immediate\n    const n = Number(e.target.value);\n    array = generateRandomArray(n);\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n  });"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "CHANGE_ORDER",
      "actions": [
        "ascending = e.target.value === 'asc'",
        "reset()"
      ],
      "expected_observables": [
        "Order flag changes and UI resets to Ready"
      ],
      "evidence": [
        "orderSelect.addEventListener('change', (e)=> {\n    ascending = e.target.value === 'asc';\n    reset();\n  });",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S0_Ready",
      "event": "CHANGE_ORDER",
      "actions": [
        "ascending = e.target.value === 'asc'",
        "reset()"
      ],
      "expected_observables": [
        "Auto-play stops and array resets according to new order selection"
      ],
      "evidence": [
        "orderSelect.addEventListener('change', (e)=> {\n    ascending = e.target.value === 'asc';\n    reset();\n  });",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Paused",
      "to": "S0_Ready",
      "event": "CHANGE_ORDER",
      "actions": [
        "reset()"
      ],
      "expected_observables": [
        "Paused cleared and UI resets"
      ],
      "evidence": [
        "orderSelect.addEventListener('change', (e)=> {\n    ascending = e.target.value === 'asc';\n    reset();\n  });",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Completed",
      "to": "S0_Ready",
      "event": "CHANGE_ORDER",
      "actions": [
        "reset()"
      ],
      "expected_observables": [
        "Completed cleared and Ready shown for new order"
      ],
      "evidence": [
        "orderSelect.addEventListener('change', (e)=> {\n    ascending = e.target.value === 'asc';\n    reset();\n  });",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "CHANGE_OPTIMIZED",
      "actions": [
        "optimized = e.target.checked",
        "reset()"
      ],
      "expected_observables": [
        "Optimization flag toggled and UI resets to Ready"
      ],
      "evidence": [
        "optimizedCheckbox.addEventListener('change', (e)=>{\n    optimized = e.target.checked;\n    reset();\n  });",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S0_Ready",
      "event": "CHANGE_OPTIMIZED",
      "actions": [
        "optimized = e.target.checked",
        "reset()"
      ],
      "expected_observables": [
        "Auto-play stops and resets with updated optimization flag"
      ],
      "evidence": [
        "optimizedCheckbox.addEventListener('change', (e)=>{\n    optimized = e.target.checked;\n    reset();\n  });",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Paused",
      "to": "S0_Ready",
      "event": "CHANGE_OPTIMIZED",
      "actions": [
        "reset()"
      ],
      "expected_observables": [
        "Paused cleared and UI resets"
      ],
      "evidence": [
        "optimizedCheckbox.addEventListener('change', (e)=>{\n    optimized = e.target.checked;\n    reset();\n  });",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Completed",
      "to": "S0_Ready",
      "event": "CHANGE_OPTIMIZED",
      "actions": [
        "reset()"
      ],
      "expected_observables": [
        "Completed cleared and UI resets"
      ],
      "evidence": [
        "optimizedCheckbox.addEventListener('change', (e)=>{\n    optimized = e.target.checked;\n    reset();\n  });",
        "function reset(){\n    stopAuto();\n    array = initialArray.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    statusEl.textContent = 'Ready';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    clearCodeHighlight();\n    resetBarStyles();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "CLICK_LOAD_ARRAY",
      "actions": [
        "loadCustom()",
        "renderBars(array)",
        "stepGenerator = bubbleSortGenerator(array, ascending, optimized)",
        "statusEl.textContent = 'Ready'"
      ],
      "expected_observables": [
        "Custom array is parsed and shown; counters reset"
      ],
      "evidence": [
        "loadArrayBtn.addEventListener('click', loadCustom);",
        "function loadCustom(){\n    const txt = customArrayInput.value.trim();\n    if (!txt) return alert('Enter comma separated numbers (e.g. 5,1,4,2)');\n    const parts = txt.split(/[\\s,]+/).map(s=>Number(s)).filter(n=>!isNaN(n));\n    if (parts.length === 0) return alert('No valid numbers found');\n    array = parts.slice();\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S0_Ready",
      "event": "CLICK_LOAD_ARRAY",
      "actions": [
        "loadCustom()",
        "stopAuto()"
      ],
      "expected_observables": [
        "Auto-play stops and custom array is loaded"
      ],
      "evidence": [
        "loadArrayBtn.addEventListener('click', loadCustom);",
        "function loadCustom(){\n    const txt = customArrayInput.value.trim();\n    if (!txt) return alert('Enter comma separated numbers (e.g. 5,1,4,2)');\n    const parts = txt.split(/[\\s,]+/).map(s=>Number(s)).filter(n=>!isNaN(n));\n    if (parts.length === 0) return alert('No valid numbers found');\n    array = parts.slice();\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Paused",
      "to": "S0_Ready",
      "event": "CLICK_LOAD_ARRAY",
      "actions": [
        "loadCustom()"
      ],
      "expected_observables": [
        "Paused cleared and custom array loaded"
      ],
      "evidence": [
        "loadArrayBtn.addEventListener('click', loadCustom);",
        "function loadCustom(){\n    const txt = customArrayInput.value.trim();\n    if (!txt) return alert('Enter comma separated numbers (e.g. 5,1,4,2)');\n    const parts = txt.split(/[\\s,]+/).map(s=>Number(s)).filter(n=>!isNaN(n));\n    if (parts.length === 0) return alert('No valid numbers found');\n    array = parts.slice();\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Completed",
      "to": "S0_Ready",
      "event": "CLICK_LOAD_ARRAY",
      "actions": [
        "loadCustom()"
      ],
      "expected_observables": [
        "Completed cleared and custom array loaded"
      ],
      "evidence": [
        "loadArrayBtn.addEventListener('click', loadCustom);",
        "function loadCustom(){\n    const txt = customArrayInput.value.trim();\n    if (!txt) return alert('Enter comma separated numbers (e.g. 5,1,4,2)');\n    const parts = txt.split(/[\\s,]+/).map(s=>Number(s)).filter(n=>!isNaN(n));\n    if (parts.length === 0) return alert('No valid numbers found');\n    array = parts.slice();\n    initialArray = array.slice();\n    renderBars(array);\n    compCount = swapCount = passCount = 0;\n    compCountEl.textContent = '0';\n    swapCountEl.textContent = '0';\n    passCountEl.textContent = '0';\n    stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    statusEl.textContent = 'Ready';\n    clearCodeHighlight();\n  }"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "INPUT_SPEED",
      "actions": [
        "speed = Number(e.target.value)"
      ],
      "expected_observables": [
        "Animation timing changes (no visible state change immediately)"
      ],
      "evidence": [
        "speedInput.addEventListener('input', (e)=>{ speed = Number(e.target.value); });"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S1_Playing",
      "event": "INPUT_SPEED",
      "actions": [
        "speed = Number(e.target.value)"
      ],
      "expected_observables": [
        "Ongoing auto-advance timing adjusts"
      ],
      "evidence": [
        "speedInput.addEventListener('input', (e)=>{ speed = Number(e.target.value); });"
      ],
      "confidence": 1
    },
    {
      "from": "S2_Paused",
      "to": "S2_Paused",
      "event": "INPUT_SPEED",
      "actions": [
        "speed = Number(e.target.value)"
      ],
      "expected_observables": [
        "Speed setting updated (no play/resume automatically)"
      ],
      "evidence": [
        "speedInput.addEventListener('input', (e)=>{ speed = Number(e.target.value); });"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Completed",
      "to": "S3_Completed",
      "event": "INPUT_SPEED",
      "actions": [
        "speed = Number(e.target.value)"
      ],
      "expected_observables": [
        "Speed stored (no effect on completed marking)"
      ],
      "evidence": [
        "speedInput.addEventListener('input', (e)=>{ speed = Number(e.target.value); });"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S1_Playing",
      "event": "KEY_SPACE",
      "guard": "playing == false",
      "actions": [
        "playBtn.click() -> startAuto()"
      ],
      "expected_observables": [
        "Equivalent to clicking #playBtn: enters Playing"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{\n    if (e.key === ' '){\n      e.preventDefault();\n      playBtn.click();\n    } else if (e.key === 'ArrowRight'){\n      e.preventDefault();\n      stepBtn.click();\n    } else if (e.key === 'r' || e.key === 'R'){\n      resetBtn.click();\n    }\n  });",
        "playBtn.addEventListener('click', ()=>{\n    if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    } else {\n      // if generator finished, reinitialize\n      if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n      startAuto();\n    }\n  });"
      ],
      "confidence": 1
    },
    {
      "from": "S1_Playing",
      "to": "S2_Paused",
      "event": "KEY_SPACE",
      "guard": "playing == true",
      "actions": [
        "playBtn.click() -> stopAuto()"
      ],
      "expected_observables": [
        "Same as clicking play: pauses"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{\n    if (e.key === ' '){\n      e.preventDefault();\n      playBtn.click();\n    } else if (e.key === 'ArrowRight'){\n      e.preventDefault();\n      stepBtn.click();\n    } else if (e.key === 'r' || e.key === 'R'){\n      resetBtn.click();\n    }\n  });",
        "playBtn.addEventListener('click', ()=>{\n    if (playing){\n      stopAuto();\n      statusEl.textContent = 'Paused';\n    } else {\n      // if generator finished, reinitialize\n      if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n      startAuto();\n    }\n  });"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "KEY_ARROW_RIGHT",
      "actions": [
        "stepBtn.click() -> stepOnce()"
      ],
      "expected_observables": [
        "Advance one step, same effects as clicking #stepBtn"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{\n    if (e.key === ' '){\n      e.preventDefault();\n      playBtn.click();\n    } else if (e.key === 'ArrowRight'){\n      e.preventDefault();\n      stepBtn.click();\n    } else if (e.key === 'r' || e.key === 'R'){\n      resetBtn.click();\n    }\n  });",
        "stepBtn.addEventListener('click', async ()=>{\n    if (playing) return; // do not step while playing\n    if (!stepGenerator) stepGenerator = bubbleSortGenerator(array, ascending, optimized);\n    await stepOnce();\n  });"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Ready",
      "to": "S0_Ready",
      "event": "KEY_R",
      "actions": [
        "resetBtn.click() -> reset()"
      ],
      "expected_observables": [
        "Same behavior as clicking #resetBtn: UI resets to Ready"
      ],
      "evidence": [
        "window.addEventListener('keydown', (e)=>{\n    if (e.key === ' '){\n      e.preventDefault();\n      playBtn.click();\n    } else if (e.key === 'ArrowRight'){\n      e.preventDefault();\n      stepBtn.click();\n    } else if (e.key === 'r' || e.key === 'R'){\n      resetBtn.click();\n    }\n  });",
        "resetBtn.addEventListener('click', reset);"
      ],
      "confidence": 1
    }
  ],
  "components": [
    {
      "type": "button",
      "selector": "#playBtn",
      "text": "Play",
      "attributes": {
        "id": "playBtn",
        "class": "btn",
        "title": "Play/Pause"
      },
      "evidence": [
        "<button class=\"btn\" id=\"playBtn\" title=\"Play/Pause\">Play</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#stepBtn",
      "text": "Step",
      "attributes": {
        "id": "stepBtn",
        "class": "btn secondary",
        "title": "Do one step"
      },
      "evidence": [
        "<button class=\"btn secondary\" id=\"stepBtn\" title=\"Do one step\">Step</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#resetBtn",
      "text": "Reset",
      "attributes": {
        "id": "resetBtn",
        "class": "btn secondary",
        "title": "Reset to original array"
      },
      "evidence": [
        "<button class=\"btn secondary\" id=\"resetBtn\" title=\"Reset to original array\">Reset</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#randomBtn",
      "text": "Randomize",
      "attributes": {
        "id": "randomBtn",
        "class": "btn ghost",
        "title": "Randomize array"
      },
      "evidence": [
        "<button class=\"btn ghost\" id=\"randomBtn\" title=\"Randomize array\">Randomize</button>"
      ]
    },
    {
      "type": "input",
      "selector": "input#speed",
      "text": "",
      "attributes": {
        "type": "range",
        "id": "speed",
        "min": "50",
        "max": "1200",
        "step": "10",
        "value": "300"
      },
      "evidence": [
        "<input type=\"range\" id=\"speed\" min=\"50\" max=\"1200\" step=\"10\" value=\"300\" />"
      ]
    },
    {
      "type": "input",
      "selector": "input#size",
      "text": "",
      "attributes": {
        "type": "range",
        "id": "size",
        "min": "5",
        "max": "60",
        "value": "20"
      },
      "evidence": [
        "<input type=\"range\" id=\"size\" min=\"5\" max=\"60\" value=\"20\" />"
      ]
    },
    {
      "type": "select",
      "selector": "select#order",
      "text": "",
      "attributes": {
        "id": "order"
      },
      "evidence": [
        "<select id=\"order\" style=\"background:transparent;border-radius:8px;padding:6px;border:1px solid rgba(255,255,255,0.04);color:inherit\">"
      ]
    },
    {
      "type": "input",
      "selector": "input#optimized",
      "text": "",
      "attributes": {
        "type": "checkbox",
        "id": "optimized",
        "checked": "checked"
      },
      "evidence": [
        "<input type=\"checkbox\" id=\"optimized\" checked />"
      ]
    },
    {
      "type": "input",
      "selector": "input#customArray",
      "text": "",
      "attributes": {
        "type": "text",
        "id": "customArray",
        "placeholder": "e.g. 5,1,4,2,8",
        "aria-label": "Enter custom array"
      },
      "evidence": [
        "<input type=\"text\" id=\"customArray\" placeholder=\"e.g. 5,1,4,2,8\" aria-label=\"Enter custom array\" />"
      ]
    },
    {
      "type": "button",
      "selector": "button#loadArray",
      "text": "Load",
      "attributes": {
        "id": "loadArray",
        "class": "btn secondary"
      },
      "evidence": [
        "<button class=\"btn secondary\" id=\"loadArray\">Load</button>"
      ]
    },
    {
      "type": "visual",
      "selector": "div#barsWrap",
      "text": "",
      "attributes": {
        "id": "barsWrap",
        "class": "bars-wrap",
        "aria-live": "polite",
        "aria-atomic": "true"
      },
      "evidence": [
        "<div class=\"bars-wrap\" id=\"barsWrap\" aria-live=\"polite\" aria-atomic=\"true\"></div>"
      ]
    },
    {
      "type": "visual",
      "selector": "pre#codeBlock",
      "text": "",
      "attributes": {
        "id": "codeBlock"
      },
      "evidence": [
        "<pre id=\"codeBlock\">"
      ]
    },
    {
      "type": "other",
      "selector": "#compCount",
      "text": "0",
      "attributes": {
        "id": "compCount"
      },
      "evidence": [
        "<div class=\"num\" id=\"compCount\">0</div>"
      ]
    },
    {
      "type": "other",
      "selector": "#swapCount",
      "text": "0",
      "attributes": {
        "id": "swapCount"
      },
      "evidence": [
        "<div class=\"num\" id=\"swapCount\">0</div>"
      ]
    },
    {
      "type": "other",
      "selector": "#passCount",
      "text": "0",
      "attributes": {
        "id": "passCount"
      },
      "evidence": [
        "<div class=\"num\" id=\"passCount\">0</div>"
      ]
    },
    {
      "type": "other",
      "selector": "#status",
      "text": "Ready",
      "attributes": {
        "id": "status"
      },
      "evidence": [
        "<div class=\"num\" id=\"status\">Ready</div>"
      ]
    }
  ],
  "extraction_summary": {
    "timestamp": "2025-12-05T00:00:00.000Z",
    "detected_components_count": 16,
    "detected_components": [
      {
        "type": "button",
        "selector": "#playBtn"
      },
      {
        "type": "button",
        "selector": "#stepBtn"
      },
      {
        "type": "button",
        "selector": "#resetBtn"
      },
      {
        "type": "button",
        "selector": "#randomBtn"
      },
      {
        "type": "input",
        "selector": "input#speed"
      },
      {
        "type": "input",
        "selector": "input#size"
      },
      {
        "type": "select",
        "selector": "select#order"
      },
      {
        "type": "input",
        "selector": "input#optimized"
      },
      {
        "type": "input",
        "selector": "input#customArray"
      },
      {
        "type": "button",
        "selector": "button#loadArray"
      },
      {
        "type": "visual",
        "selector": "div#barsWrap"
      },
      {
        "type": "visual",
        "selector": "pre#codeBlock"
      },
      {
        "type": "other",
        "selector": "#compCount"
      },
      {
        "type": "other",
        "selector": "#swapCount"
      },
      {
        "type": "other",
        "selector": "#passCount"
      },
      {
        "type": "other",
        "selector": "#status"
      }
    ],
    "detected_event_handlers_count": 12,
    "detected_event_handlers": [
      "playBtn.addEventListener('click', ()=>{...});",
      "stepBtn.addEventListener('click', async ()=>{...});",
      "resetBtn.addEventListener('click', reset);",
      "randomBtn.addEventListener('click', () => { randomize(); });",
      "speedInput.addEventListener('input', (e)=>{ speed = Number(e.target.value); });",
      "sizeInput.addEventListener('input', (e)=>{ ... });",
      "orderSelect.addEventListener('change', (e)=> { ascending = e.target.value === 'asc'; reset(); });",
      "optimizedCheckbox.addEventListener('change', (e)=>{ optimized = e.target.checked; reset(); });",
      "loadArrayBtn.addEventListener('click', loadCustom);",
      "window.addEventListener('keydown', (e)=>{ if (e.key === ' '){ playBtn.click(); } else if (e.key === 'ArrowRight'){ stepBtn.click(); } else if (e.key === 'r' || e.key === 'R'){ resetBtn.click(); } });",
      "autoTimer = setTimeout(()=>autoStep(), speed); (inside autoStep scheduling)",
      "stepGenerator = bubbleSortGenerator(array, ascending, optimized); (generator creation observed in code)"
    ],
    "extracted_states_count": 4,
    "extracted_transitions_count": 46,
    "extraction_confidence": 0.95,
    "notes": [
      "All interactive DOM handlers were found inline in the provided <script> and were used as primary evidence.",
      "Internal timing (autoStep via setTimeout) and generator yields drive visual state changes but are represented as transitions triggered by user actions; internal timer ticks were not modeled as separate selector triggers.",
      "No external scripts are referenced inline that would change behavior; all behavior was derived from inline script.",
      "Keyboard handlers are mapped to the same logical actions as buttons (play/step/reset) using the exact window.addEventListener('keydown'...) snippet as evidence.",
      "Where generator.next().done leads to 'Completed', that branch is modeled but labeled with slightly lower confidence for exact boundary timing (0.95)."
    ]
  }
}