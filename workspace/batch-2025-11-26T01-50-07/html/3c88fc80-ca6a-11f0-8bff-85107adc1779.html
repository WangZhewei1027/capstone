<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Insertion Sort Visualization</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 30px;
    background-color: #f0f4f8;
  }
  h1 {
    text-align: center;
    color: #222;
  }
  #container {
    max-width: 800px;
    margin: 0 auto;
  }
  #arrayInput {
    width: 100%;
    font-size: 1.1rem;
    padding: 10px;
    margin-bottom: 10px;
    box-sizing: border-box;
  }
  button {
    background-color: #007bff;
    border: none;
    color: #fff;
    padding: 10px 15px;
    font-size: 1rem;
    cursor: pointer;
    border-radius: 4px;
  }
  button:disabled {
    background-color: #aacdff;
    cursor: not-allowed;
  }
  #visualization {
    margin-top: 40px;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    gap: 5px;
    height: 300px;
    background-color: white;
    border: 1px solid #ccc;
    padding: 15px;
    border-radius: 6px;
  }
  .bar {
    background-color: #6c63ff;
    width: 30px;
    text-align: center;
    color: white;
    border-radius: 4px 4px 0 0;
    font-weight: bold;
    user-select: none;
    position: relative;
  }
  .bar.current {
    background-color: #ff6f61;
    box-shadow: 0 0 10px #ff6f61;
  }
  .bar.compared {
    background-color: #4caf50;
    box-shadow: 0 0 10px #4caf50;
  }
  .bar.sorted {
    background-color: #2e7d32;
  }
  #legend {
    margin-top: 20px;
    display: flex;
    justify-content: center;
    gap: 15px;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .legend-color {
    width: 20px;
    height: 20px;
    border-radius: 4px;
  }
  .color-current {
    background-color: #ff6f61;
    box-shadow: 0 0 5px #ff6f61;
  }
  .color-compared {
    background-color: #4caf50;
    box-shadow: 0 0 5px #4caf50;
  }
  .color-sorted {
    background-color: #2e7d32;
  }
  #description {
    max-width: 800px;
    margin: 30px auto 0;
    font-size: 1.1rem;
    line-height: 1.5;
    color: #333;
  }
  #speedControl {
    width: 100%;
    margin-top: 10px;
  }
  label {
    font-size: 0.9rem;
    color: #555;
  }
</style>
</head>
<body>
  <div id="container">
    <h1>Insertion Sort Visualization</h1>
    <input
      id="arrayInput"
      type="text"
      placeholder="Enter numbers separated by commas, e.g. 8,3,5,2,9"
      aria-label="Array input"
    />
    <button id="startBtn" aria-live="polite">Start Sorting</button>
    <label for="speedControl">Animation Speed: <span id="speedValue">500</span> ms</label>
    <input type="range" id="speedControl" min="50" max="1500" value="500" step="50" />
    <div id="visualization" aria-label="Insertion sort visualization"></div>
    <div id="legend" aria-label="Color legend">
      <div class="legend-item"><div class="legend-color color-current"></div> Current element</div>
      <div class="legend-item"><div class="legend-color color-compared"></div> Compared element</div>
      <div class="legend-item"><div class="legend-color color-sorted"></div> Sorted part</div>
    </div>
    <div id="description">
      <h2>What is Insertion Sort?</h2>
      <p>
        Insertion sort is a simple sorting algorithm that builds the final sorted array one item at a time.
        It works by iterating through the input array and growing a sorted section of the array at its start.
        At each iteration, it removes one element from the input data, finds the location it belongs within the sorted list, and inserts it there.
      </p>
      <p>
        Although it is not efficient for large datasets (average and worst-case time complexity of O(nÂ²)),
        insertion sort is simple to implement and efficient for small or nearly sorted data.
      </p>
    </div>
  </div>
<script>
  (() => {
    const arrayInput = document.getElementById("arrayInput");
    const startBtn = document.getElementById("startBtn");
    const visualization = document.getElementById("visualization");
    const speedControl = document.getElementById("speedControl");
    const speedValue = document.getElementById("speedValue");

    let array = [];
    let bars = [];
    let delay = 500;
    let sorting = false;

    speedControl.addEventListener("input", () => {
      delay = parseInt(speedControl.value, 10);
      speedValue.textContent = delay;
    });

    function createBars(arr) {
      visualization.innerHTML = "";
      bars = [];
      for (let val of arr) {
        const bar = document.createElement("div");
        bar.classList.add("bar");
        bar.style.height = val * 5 + 10 + "px";
        bar.textContent = val;
        bar.setAttribute("aria-label", `Value ${val}`);
        visualization.appendChild(bar);
        bars.push(bar);
      }
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function insertionSort(arr) {
      const n = arr.length;
      // Initially, first element is considered sorted - mark it sorted
      bars[0].classList.add("sorted");

      for (let i = 1; i < n; i++) {
        // current element to insert
        let key = arr[i];
        let j = i - 1;

        // Visual: highlight current element
        bars[i].classList.add("current");

        await sleep(delay);

        // Move elements of arr[0..i-1], that are greater than key,
        // to one position ahead of their current position
        while (j >= 0 && arr[j] > key) {
          // Visual: highlight compared element
          bars[j].classList.add("compared");
          await sleep(delay);

          arr[j + 1] = arr[j];
          bars[j + 1].style.height = bars[j].style.height;
          bars[j + 1].textContent = arr[j];
          // Remove highlight on previous compared if not current
          bars[j].classList.remove("compared");

          j--;

          await sleep(delay);
        }
        arr[j + 1] = key;
        bars[j + 1].style.height = key * 5 + 10 + "px";
        bars[j + 1].textContent = key;

        // Remove highlight from current bar
        bars[i].classList.remove("current");

        // Mark the sorted portion bars
        for (let k = 0; k <= i; k++) {
          bars[k].classList.add("sorted");
        }

        // Remove compared highlight on all other bars
        for (let k = i + 1; k < n; k++) {
          bars[k].classList.remove("compared");
        }

        await sleep(delay);
      }
    }

    startBtn.addEventListener("click", async () => {
      if (sorting) return;

      let inputStr = arrayInput.value.trim();
      if (!inputStr) {
        alert("Please enter some numbers separated by commas.");
        return;
      }

      // Parse input
      let inputArray = inputStr.split(",").map(s => s.trim()).filter(s => s !== "").map(Number);
      if (inputArray.some(isNaN)) {
        alert("Please enter valid numbers separated by commas.");
        return;
      }
      if (inputArray.length < 2) {
        alert("Please enter at least two numbers to sort.");
        return;
      }
      if (inputArray.length > 30) {
        alert("For visualization, please enter 30 or fewer numbers.");
        return;
      }

      array = inputArray;
      createBars(array);

      sorting = true;
      startBtn.disabled = true;
      arrayInput.disabled = true;
      speedControl.disabled = true;

      await insertionSort(array);

      sorting = false;
      startBtn.disabled = false;
      arrayInput.disabled = false;
      speedControl.disabled = false;
    });
  })();
</script>
</body>
</html>