{
  "id": "3c892391-ca6a-11f0-8bff-85107adc1779",
  "timestamp": "2025-11-26T01:51:07.379Z",
  "model": "gpt-3.5-turbo",
  "status": "success",
  "question": "Heap Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<title>Heap Sort Visualization</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 20px;\n    background: #f0f4f8;\n    color: #222;\n  }\n  h1 {\n    text-align: center;\n  }\n  #controls {\n    margin-bottom: 15px;\n    text-align: center;\n  }\n  input[type=\"text\"] {\n    width: 300px;\n    padding: 6px;\n    font-size: 16px;\n  }\n  button {\n    padding: 8px 15px;\n    font-size: 16px;\n    margin-left: 10px;\n    cursor: pointer;\n  }\n  #array {\n    margin: 20px auto;\n    max-width: 800px;\n    height: 150px;\n    display: flex;\n    justify-content: center;\n    align-items: flex-end;\n    gap: 8px;\n  }\n  .bar {\n    background-color: #4a90e2;\n    color: white;\n    font-weight: bold;\n    text-align: center;\n    border-radius: 4px 4px 0 0;\n    user-select: none;\n    transition: background-color 0.3s ease;\n  }\n  .bar.comparing {\n    background-color: #f39c12;\n  }\n  .bar.swapping {\n    background-color: #e74c3c;\n  }\n  .bar.sorted {\n    background-color: #2ecc71;\n  }\n  #log {\n    max-width: 800px;\n    margin: 10px auto;\n    height: 180px;\n    overflow-y: auto;\n    background: #fff;\n    border-radius: 5px;\n    border: 1px solid #ddd;\n    padding: 10px;\n    font-family: monospace;\n    font-size: 14px;\n  }\n  #speedLabel {\n    margin-left: 20px;\n    font-weight: 600;\n  }\n  #speed {\n    vertical-align: middle;\n  }\n  footer {\n    text-align: center;\n    margin-top: 40px;\n    font-size: 14px;\n    color: #777;\n  }\n  @media (max-width: 600px) {\n    #array {\n      height: 120px;\n    }\n    input[type=\"text\"] {\n      width: 90%;\n    }\n  }\n</style>\n</head>\n<body>\n  <h1>Heap Sort Visualization</h1>\n  <div id=\"controls\">\n    <input id=\"inputArray\" placeholder=\"Enter numbers separated by commas\" value=\"20, 3, 15, 7, 6, 2, 9, 12\" />\n    <button id=\"startBtn\">Start Sort</button>\n    <label id=\"speedLabel\" for=\"speed\">Speed:</label>\n    <input type=\"range\" id=\"speed\" min=\"50\" max=\"2000\" value=\"500\" />\n  </div>\n  <div id=\"array\"></div>\n  <div id=\"log\"></div>\n\n<script>\n(() => {\n  const arrayContainer = document.getElementById('array');\n  const logContainer = document.getElementById('log');\n  const startBtn = document.getElementById('startBtn');\n  const inputArray = document.getElementById('inputArray');\n  const speedControl = document.getElementById('speed');\n\n  let array = [];\n  let speed = 500; // delay in ms between steps\n\n  function log(message) {\n    const entry = document.createElement('div');\n    entry.textContent = message;\n    logContainer.appendChild(entry);\n    logContainer.scrollTop = logContainer.scrollHeight;\n  }\n\n  function clearLog() {\n    logContainer.innerHTML = '';\n  }\n\n  // Render bars reflecting the current array\n  function renderArray(highlight = {}, sortedIndices = []) {\n    // highlight: {comparing: [i,j], swapping: [i,j]}\n    arrayContainer.innerHTML = '';\n\n    const maxVal = Math.max(...array);\n    array.forEach((val, idx) => {\n      const bar = document.createElement('div');\n      bar.classList.add('bar');\n      const heightPercent = (val / maxVal) * 100;\n      bar.style.height = `${heightPercent}%`;\n      bar.textContent = val;\n\n      if (highlight.swapping && highlight.swapping.includes(idx)) {\n        bar.classList.add('swapping');\n      } else if (highlight.comparing && highlight.comparing.includes(idx)) {\n        bar.classList.add('comparing');\n      } else if (sortedIndices.includes(idx)) {\n        bar.classList.add('sorted');\n      }\n\n      // Width depends on array length\n      const widthPercent = Math.min(100 / array.length - 1, 10);\n      bar.style.width = `${widthPercent}%`;\n\n      arrayContainer.appendChild(bar);\n    });\n  }\n\n  // Utility delay function (returns a Promise resolved after ms milliseconds)\n  function delay(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  async function heapSort(arr) {\n    const n = arr.length;\n    const sortedIndices = [];\n\n    log(`Building max heap...`);\n    // Build max heap\n    for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {\n      await heapify(arr, n, i, sortedIndices);\n    }\n\n    log(`Max heap built. Starting sort...`);\n    // One by one extract elements\n    for (let i = n - 1; i > 0; i--) {\n      log(`Swap root (index 0, value ${arr[0]}) with element at index ${i}, value ${arr[i]}`);\n      renderArray({ swapping: [0, i] }, sortedIndices);\n      await delay(speed);\n\n      [arr[0], arr[i]] = [arr[i], arr[0]];\n      renderArray({ swapping: [0, i] }, sortedIndices);\n      await delay(speed);\n\n      sortedIndices.push(i);\n      log(`Heapify root after swap, heap size: ${i}`);\n      await heapify(arr, i, 0, sortedIndices);\n    }\n    sortedIndices.push(0);\n    renderArray({}, sortedIndices);\n    log(`Array is fully sorted.`);\n  }\n\n  // Heapify subtree rooted at index i in array of size n\n  async function heapify(arr, n, i, sortedIndices) {\n    let largest = i;\n    const left = 2 * i + 1;\n    const right = 2 * i + 2;\n\n    if (left < n) {\n      log(`Compare arr[${left}] (${arr[left]}) with arr[${largest}] (${arr[largest]})`);\n      renderArray({ comparing: [left, largest] }, sortedIndices);\n      await delay(speed);\n      if (arr[left] > arr[largest]) {\n        largest = left;\n      }\n    }\n\n    if (right < n) {\n      log(`Compare arr[${right}] (${arr[right]}) with arr[${largest}] (${arr[largest]})`);\n      renderArray({ comparing: [right, largest] }, sortedIndices);\n      await delay(speed);\n      if (arr[right] > arr[largest]) {\n        largest = right;\n      }\n    }\n\n    if (largest !== i) {\n      log(`Swap arr[${i}] (${arr[i]}) with arr[${largest}] (${arr[largest]})`);\n      renderArray({ swapping: [i, largest] }, sortedIndices);\n      await delay(speed);\n\n      [arr[i], arr[largest]] = [arr[largest], arr[i]];\n      renderArray({ swapping: [i, largest] }, sortedIndices);\n      await delay(speed);\n\n      await heapify(arr, n, largest, sortedIndices);\n    }\n  }\n\n  function parseInput(input) {\n    let numbers = input.split(',').map(s => s.trim()).filter(s => s.length);\n    let parsed = [];\n    for (let numStr of numbers) {\n      let num = Number(numStr);\n      if (Number.isNaN(num)) return null;\n      parsed.push(num);\n    }\n    return parsed;\n  }\n\n  // Start sorting process\n  async function startSort() {\n    const input = inputArray.value;\n    const parsed = parseInput(input);\n    if (!parsed || parsed.length === 0) {\n      alert('Please enter a valid list of numbers separated by commas.');\n      return;\n    }\n    array = parsed;\n    clearLog();\n    renderArray();\n    startBtn.disabled = true;\n    inputArray.disabled = true;\n    speedControl.disabled = true;\n\n    log(`Starting heap sort on array: [${array.join(', ')}]`);\n    await heapSort(array);\n    log(`Final sorted array: [${array.join(', ')}]`);\n\n    startBtn.disabled = false;\n    inputArray.disabled = false;\n    speedControl.disabled = false;\n  }\n\n  speedControl.addEventListener('input', () => {\n    speed = Number(speedControl.value);\n  });\n\n  startBtn.addEventListener('click', () => {\n    startSort();\n  });\n\n  // Initial render\n  array = parseInput(inputArray.value) || [];\n  renderArray();\n})();\n</script>\n<footer>\n  &copy; Heap Sort Visualization Demo\n</footer>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Heap Sort"
    }
  ],
  "topic": "Heap Sort",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}