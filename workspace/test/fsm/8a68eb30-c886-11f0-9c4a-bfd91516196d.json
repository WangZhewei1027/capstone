{
  "topic": "Bubble Sort",
  "description": "Finite state machine modeling the interactive states of the Bubble Sort visualization app (start/pause/step/generate/reset, array edits, speed/size/order changes and completion).",
  "states": [
    {
      "name": "idle",
      "onEnter": "renderArray; resetStats; setPseudoline(0); sorting=false; running=false",
      "onExit": "noop",
      "on": {
        "START_CLICKED": "running",
        "GENERATE_CLICKED": "idle",
        "RESET_CLICKED": "idle",
        "SIZE_CHANGED": "idle",
        "SPEED_CHANGED": "idle",
        "ORDER_CHANGED": "idle",
        "BAR_CLICKED": "idle",
        "STEP_CLICKED": "stepping",
        "KEY_SPACE": "running",
        "KEY_ARROW_RIGHT": "stepping"
      }
    },
    {
      "name": "running",
      "onEnter": "sorting=true; running=true; aborted=false; resetStats(); setControlsDuringRun(true); call bubbleSortVisual(arr, order)",
      "onExit": "noop",
      "on": {
        "PAUSE_CLICKED": "paused",
        "STEP_CLICKED": "stepping",
        "GENERATE_CLICKED": "idle",
        "RESET_CLICKED": "idle",
        "SIZE_CHANGED": "idle",
        "ALGO_FINISHED": "done",
        "KEY_SPACE": "paused",
        "KEY_ARROW_RIGHT": "stepping",
        "BAR_CLICKED": "running"
      }
    },
    {
      "name": "paused",
      "onEnter": "running=false; setControlsDuringRun(false); (algorithm remains at current point)",
      "onExit": "noop",
      "on": {
        "START_CLICKED": "running",
        "STEP_CLICKED": "stepping",
        "GENERATE_CLICKED": "idle",
        "RESET_CLICKED": "idle",
        "SIZE_CHANGED": "idle",
        "KEY_SPACE": "running",
        "KEY_ARROW_RIGHT": "stepping",
        "BAR_CLICKED": "paused"
      }
    },
    {
      "name": "stepping",
      "onEnter": "stepRequested=true; running=true; setControlsDuringRun(true); ensure bubbleSortVisual advances one step (waitingResolve or stepRequested logic)",
      "onExit": "stepRequested=false; running=false; setControlsDuringRun(false)",
      "on": {
        "STEP_DONE": "paused",
        "ALGO_FINISHED": "done",
        "GENERATE_CLICKED": "idle",
        "RESET_CLICKED": "idle",
        "SIZE_CHANGED": "idle",
        "PAUSE_CLICKED": "paused",
        "KEY_SPACE": "paused",
        "BAR_CLICKED": "stepping"
      }
    },
    {
      "name": "done",
      "onEnter": "updateBars({sorted:0}); curIEl.textContent='-'; curJEl.textContent='-'; setPseudoline(0); sorting=false; running=false; setControlsDuringRun(false)",
      "onExit": "noop",
      "on": {
        "GENERATE_CLICKED": "idle",
        "RESET_CLICKED": "idle",
        "SIZE_CHANGED": "idle",
        "START_CLICKED": "running",
        "BAR_CLICKED": "done",
        "ORDER_CHANGED": "done",
        "SPEED_CHANGED": "done",
        "KEY_SPACE": "running"
      }
    }
  ],
  "events": [
    "START_CLICKED",
    "PAUSE_CLICKED",
    "STEP_CLICKED",
    "GENERATE_CLICKED",
    "RESET_CLICKED",
    "SIZE_CHANGED",
    "SPEED_CHANGED",
    "ORDER_CHANGED",
    "BAR_CLICKED",
    "KEY_SPACE",
    "KEY_ARROW_RIGHT",
    "ALGO_FINISHED",
    "STEP_DONE",
    "ABORT"
  ],
  "triggers": {
    "START_CLICKED": "#btn-start",
    "PAUSE_CLICKED": "#btn-pause",
    "STEP_CLICKED": "#btn-step",
    "GENERATE_CLICKED": "#btn-generate",
    "RESET_CLICKED": "#btn-reset",
    "SIZE_CHANGED": "#size",
    "SPEED_CHANGED": "#speed",
    "ORDER_CHANGED": "#order",
    "BAR_CLICKED": ".bar",
    "KEY_SPACE": "window (keydown: Space)",
    "KEY_ARROW_RIGHT": "window (keydown: ArrowRight)",
    "ALGO_FINISHED": "#bars",
    "STEP_DONE": "#bars",
    "ABORT": "#btn-generate, #btn-reset, #size"
  },
  "notes": "The triggers field maps user actions and keyboard shortcuts to actual selectors found in the HTML. onEnter/onExit strings reference the functions and behaviors implemented in the script: renderArray, resetStats, setPseudoline, setControlsDuringRun, bubbleSortVisual, updateBars and the internal flags sorting/running/stepRequested/aborted."
}