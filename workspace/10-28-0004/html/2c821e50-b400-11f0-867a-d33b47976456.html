<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f4f4f4;
        }
        
        h1 {
            margin-bottom: 16px;
        }
        
        .array-container {
            display: flex;
            margin-bottom: 24px;
        }
        
        .block {
            width: 20px;
            margin: 0 4px;
            background-color: #3498db;
            text-align: center;
            color: white;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.3s;
        }

        .controls {
            display: flex;
            flex-direction: row;
            justify-content: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        button, input[type="range"] {
            padding: 10px;
            font-size: 14px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #2980b9;
            color: white;
        }

        button:hover, input[type="range"]:hover {
            background-color: #1c598a;
        }
    </style>
</head>
<body>

    <h1>Bubble Sort Visualization</h1>
    <p>Learn how the Bubble Sort algorithm works through a hands-on interactive experience!</p>
    
    <div class="array-container" id="arrayContainer"></div>
    
    <div class="controls">
        <label for="size">Array Size:</label>
        <input type="range" id="size" min="5" max="20" value="10" />
        <button id="startBtn">Start Sort</button>
        <button id="resetBtn">Reset</button>
        <label for="speed">Speed:</label>
        <input type="range" id="speed" min="100" max="1000" value="500" />
    </div>
    
    <script>
        const arrayContainer = document.getElementById('arrayContainer');
        const sizeInput = document.getElementById('size');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const speedInput = document.getElementById('speed');

        let array = [];
        
        function generateRandomArray(size) {
            array = [];
            for (let i = 0; i < size; i++) {
                array.push(Math.floor(Math.random() * 100));
            }
            drawArray();
        }

        function drawArray() {
            arrayContainer.innerHTML = '';
            array.forEach(value => {
                const block = document.createElement('div');
                block.style.height = `${value * 2}px`;
                block.className = 'block';
                block.innerText = value;
                arrayContainer.appendChild(block);
            });
        }

        async function bubbleSort() {
            for (let i = 0; i < array.length - 1; i++) {
                for (let j = 0; j < array.length - 1 - i; j++) {
                    const blocks = document.querySelectorAll('.block');
                    
                    // Highlight comparison
                    blocks[j].style.backgroundColor = 'red';
                    blocks[j + 1].style.backgroundColor = 'red';
                    
                    await new Promise(resolve => setTimeout(resolve, speedInput.value));

                    if (array[j] > array[j + 1]) {
                        // Swap
                        [array[j], array[j + 1]] = [array[j + 1], array[j]];
                        drawArray(); // Redraw the array after swap
                    }
                    
                    // Reset color after comparison
                    blocks[j].style.backgroundColor = '#3498db';
                    blocks[j + 1].style.backgroundColor = '#3498db';
                }
                drawArray(); // Final state for this iteration
            }
            alert('Sorting complete!');
        }

        startBtn.addEventListener('click', () => {
            bubbleSort();
        });

        resetBtn.addEventListener('click', () => {
            generateRandomArray(sizeInput.value);
        });

        sizeInput.addEventListener('input', () => {
            generateRandomArray(sizeInput.value);
        });

        // Initial setup
        generateRandomArray(sizeInput.value);
    </script>



  <script id="fsm" type="application/json">
    {
  "topic": "Interactive Application",
  "description": "Finite State Machine for the Bubble Sort Visualization application.",
  "states": [
    {
      "name": "idle",
      "onEnter": "generateRandomArray",
      "onExit": null,
      "on": {
        "START_SORT": "sorting",
        "RESET": "idle",
        "CHANGE_SIZE": "idle"
      }
    },
    {
      "name": "sorting",
      "onEnter": "bubbleSort",
      "onExit": null,
      "on": {
        "SORT_COMPLETE": "done"
      }
    },
    {
      "name": "done",
      "onEnter": "alertSortingComplete",
      "onExit": null,
      "on": {
        "RESET": "idle"
      }
    }
  ],
  "events": [
    "START_SORT",
    "RESET",
    "CHANGE_SIZE",
    "SORT_COMPLETE"
  ],
  "notes": "The application starts in the 'idle' state where it generates a random array. The user can start sorting, reset the array, or change the size of the array. When sorting is initiated, it transitions to the 'sorting' state and upon completion, it moves to the 'done' state."
}
  </script>
</body>
</html>