{
  "topic": "Stack",
  "description": "Finite state machine modeling the interactive Stack visualization: push, pop, peek, clear operations, animations, button/input interactions and enabled/disabled button states.",
  "states": [
    {
      "name": "idle_empty",
      "onEnter": "renderStackAndUpdateButtons",
      "onExit": "noop",
      "on": {
        "PUSH_CLICKED": "pushing",
        "INVALID_PUSH": "idle_empty",
        "POP_CLICKED": "idle_empty",
        "PEEK_CLICKED": "idle_empty",
        "CLEAR_CLICKED": "idle_empty",
        "INPUT_CHANGED": "idle_empty",
        "ENTER_PRESSED": "pushing"
      }
    },
    {
      "name": "idle_nonempty",
      "onEnter": "renderStackAndUpdateButtons",
      "onExit": "noop",
      "on": {
        "PUSH_CLICKED": "pushing",
        "POP_CLICKED": "popping",
        "PEEK_CLICKED": "idle_nonempty",
        "CLEAR_CLICKED": "clearing",
        "INPUT_CHANGED": "idle_nonempty",
        "ENTER_PRESSED": "pushing",
        "STACK_BECAME_FULL": "idle_full"
      }
    },
    {
      "name": "idle_full",
      "onEnter": "renderStackAndUpdateButtons",
      "onExit": "noop",
      "on": {
        "PUSH_CLICKED": "idle_full",
        "INVALID_PUSH": "idle_full",
        "POP_CLICKED": "popping",
        "PEEK_CLICKED": "idle_nonempty",
        "CLEAR_CLICKED": "clearing",
        "INPUT_CHANGED": "idle_full",
        "ENTER_PRESSED": "idle_full",
        "STACK_BECAME_NONFULL": "idle_nonempty"
      }
    },
    {
      "name": "pushing",
      "onEnter": "animatePush",
      "onExit": "renderStackAndUpdateButtons",
      "on": {
        "ANIMATION_END_PUSH_TO_NONFULL": "idle_nonempty",
        "ANIMATION_END_PUSH_TO_FULL": "idle_full",
        "REJECT_WHEN_ANIMATING": "pushing"
      }
    },
    {
      "name": "popping",
      "onEnter": "animatePop",
      "onExit": "renderStackAndUpdateButtons",
      "on": {
        "TRANSITION_END_POP_TO_NONEMPTY": "idle_nonempty",
        "TRANSITION_END_POP_TO_EMPTY": "idle_empty",
        "REJECT_WHEN_ANIMATING": "popping"
      }
    },
    {
      "name": "clearing",
      "onEnter": "animateClearAll",
      "onExit": "renderStackAndUpdateButtons",
      "on": {
        "TRANSITION_END_CLEAR_COMPLETE": "idle_empty",
        "REJECT_WHEN_ANIMATING": "clearing"
      }
    }
  ],
  "events": [
    "PUSH_CLICKED",
    "POP_CLICKED",
    "PEEK_CLICKED",
    "CLEAR_CLICKED",
    "INPUT_CHANGED",
    "ENTER_PRESSED",
    "INVALID_PUSH",
    "STACK_BECAME_FULL",
    "STACK_BECAME_NONFULL",
    "ANIMATION_END_PUSH_TO_NONFULL",
    "ANIMATION_END_PUSH_TO_FULL",
    "TRANSITION_END_POP_TO_NONEMPTY",
    "TRANSITION_END_POP_TO_EMPTY",
    "TRANSITION_END_CLEAR_COMPLETE",
    "REJECT_WHEN_ANIMATING",
    "POP_WHEN_EMPTY",
    "PEEK_WHEN_EMPTY",
    "CLEAR_WHEN_EMPTY"
  ],
  "triggers": {
    "PUSH_CLICKED": "#push-btn",
    "POP_CLICKED": "#pop-btn",
    "PEEK_CLICKED": "#peek-btn",
    "CLEAR_CLICKED": "#clear-btn",
    "INPUT_CHANGED": "#input-value",
    "ENTER_PRESSED": "#input-value",
    "INVALID_PUSH": "#push-btn, #input-value",
    "POP_WHEN_EMPTY": "#pop-btn",
    "PEEK_WHEN_EMPTY": "#peek-btn",
    "CLEAR_WHEN_EMPTY": "#clear-btn",
    "STACK_BECAME_FULL": "#stack-container",
    "STACK_BECAME_NONFULL": "#stack-container",
    "ANIMATION_END_PUSH_TO_NONFULL": ".stack-element.pushing",
    "ANIMATION_END_PUSH_TO_FULL": ".stack-element.pushing",
    "TRANSITION_END_POP_TO_NONEMPTY": ".stack-element.removing",
    "TRANSITION_END_POP_TO_EMPTY": ".stack-element.removing",
    "TRANSITION_END_CLEAR_COMPLETE": ".stack-element.removing",
    "REJECT_WHEN_ANIMATING": "#push-btn, #pop-btn, #peek-btn, #clear-btn, #input-value"
  },
  "notes": "Selectors extracted from HTML: #stack-container, #top-label, #input-value, #push-btn, #pop-btn, #peek-btn, #clear-btn, #info, .stack-element, .stack-element.pushing, .stack-element.removing. Conditional animation end transitions (e.g. push ending to full vs non-full) are represented as separate events that are triggered by the same animationend selector (.stack-element.pushing) and resolved in code based on stack length. Transitionend on .stack-element.removing is used for both single-pop and clearing; clearing waits until all transitionend occurrences complete to emit TRANSITION_END_CLEAR_COMPLETE."
}