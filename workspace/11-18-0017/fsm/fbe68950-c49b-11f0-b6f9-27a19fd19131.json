{
  "topic": "Bubble Sort Visualizer",
  "description": "Finite State Machine modeling the interactive states, user actions, generator actions and UI transitions of the Bubble Sort Visualizer application.",
  "states": [
    {
      "name": "idle",
      "onEnter": "setStatus('Idle')",
      "onExit": "noop",
      "on": {
        "START_CLICKED": "running",
        "SHUFFLE_CLICKED": "idle",
        "RESET_CLICKED": "resetting",
        "APPLY_CLICKED": "applying",
        "SIZE_CHANGED": "idle",
        "KEY_SPACE": "running",
        "KEY_R": "idle",
        "WINDOW_RESIZE": "idle"
      }
    },
    {
      "name": "running",
      "onEnter": "startAuto",
      "onExit": "pauseAuto",
      "on": {
        "PAUSE_CLICKED": "paused",
        "STEP_CLICKED": "stepping",
        "SHUFFLE_CLICKED": "idle",
        "RESET_CLICKED": "resetting",
        "APPLY_CLICKED": "applying",
        "SIZE_CHANGED": "idle",
        "ACTION_PASS_START": "passStart",
        "ACTION_COMPARE": "comparing",
        "ACTION_AFTER_COMPARE": "afterCompare",
        "ACTION_SWAP": "swapping",
        "ACTION_PASS_END": "passEnd",
        "ACTION_DONE": "completed",
        "KEY_SPACE": "paused",
        "KEY_ARROW_RIGHT": "stepping",
        "KEY_R": "idle",
        "WINDOW_RESIZE": "running"
      }
    },
    {
      "name": "paused",
      "onEnter": "pauseAuto",
      "onExit": "noop",
      "on": {
        "START_CLICKED": "running",
        "STEP_CLICKED": "stepping",
        "SHUFFLE_CLICKED": "idle",
        "RESET_CLICKED": "resetting",
        "APPLY_CLICKED": "applying",
        "KEY_SPACE": "running",
        "KEY_ARROW_RIGHT": "stepping",
        "KEY_R": "idle",
        "SIZE_CHANGED": "idle",
        "WINDOW_RESIZE": "paused"
      }
    },
    {
      "name": "stepping",
      "onEnter": "stepOnce",
      "onExit": "noop",
      "on": {
        "ACTION_COMPARE": "comparing",
        "ACTION_AFTER_COMPARE": "afterCompare",
        "ACTION_SWAP": "swapping",
        "ACTION_PASS_END": "passEnd",
        "ACTION_DONE": "completed",
        "STEP_COMPLETE": "paused",
        "KEY_R": "idle",
        "SHUFFLE_CLICKED": "idle",
        "RESET_CLICKED": "resetting",
        "APPLY_CLICKED": "applying",
        "WINDOW_RESIZE": "stepping"
      }
    },
    {
      "name": "comparing",
      "onEnter": "updateBarsFromArray(arr, {compare:[i,j]})",
      "onExit": "updateBarsFromArray(arr)",
      "on": {
        "ACTION_AFTER_COMPARE": "running",
        "ACTION_SWAP": "swapping",
        "ACTION_PASS_END": "passEnd",
        "ACTION_DONE": "completed",
        "STEP_COMPLETE": "paused"
      }
    },
    {
      "name": "afterCompare",
      "onEnter": "updateBarsFromArray(arr)",
      "onExit": "noop",
      "on": {
        "ACTION_COMPARE": "comparing",
        "ACTION_SWAP": "swapping",
        "ACTION_PASS_END": "passEnd",
        "ACTION_DONE": "completed",
        "STEP_COMPLETE": "paused"
      }
    },
    {
      "name": "swapping",
      "onEnter": "updateBarsFromArray(arr, {swap:[i,j]})",
      "onExit": "updateBarsFromArray(arr)",
      "on": {
        "ACTION_AFTER_COMPARE": "running",
        "ACTION_PASS_END": "passEnd",
        "ACTION_DONE": "completed",
        "STEP_COMPLETE": "paused"
      }
    },
    {
      "name": "passStart",
      "onEnter": "setStatus('Running: pass ' + pass)",
      "onExit": "noop",
      "on": {
        "ACTION_COMPARE": "comparing",
        "ACTION_DONE": "completed",
        "ACTION_PASS_END": "passEnd"
      }
    },
    {
      "name": "passEnd",
      "onEnter": "updateBarsFromArray(arr, {sortedIndex:sortedIndex}); setStatus(passSwappedStatus)",
      "onExit": "noop",
      "on": {
        "ACTION_DONE": "completed",
        "START_CLICKED": "running",
        "SHUFFLE_CLICKED": "idle",
        "RESET_CLICKED": "resetting",
        "APPLY_CLICKED": "applying",
        "KEY_SPACE": "running",
        "KEY_R": "idle"
      }
    },
    {
      "name": "completed",
      "onEnter": "finalize",
      "onExit": "noop",
      "on": {
        "START_CLICKED": "running",
        "SHUFFLE_CLICKED": "idle",
        "RESET_CLICKED": "resetting",
        "APPLY_CLICKED": "applying",
        "SIZE_CHANGED": "idle",
        "KEY_R": "idle",
        "WINDOW_RESIZE": "completed"
      }
    },
    {
      "name": "resetting",
      "onEnter": "reset",
      "onExit": "noop",
      "on": {
        "DONE": "idle",
        "START_CLICKED": "running",
        "KEY_R": "idle"
      }
    },
    {
      "name": "applying",
      "onEnter": "applyCustom",
      "onExit": "noop",
      "on": {
        "DONE": "idle",
        "START_CLICKED": "running",
        "KEY_R": "idle"
      }
    }
  ],
  "events": [
    "START_CLICKED",
    "PAUSE_CLICKED",
    "STEP_CLICKED",
    "SHUFFLE_CLICKED",
    "RESET_CLICKED",
    "APPLY_CLICKED",
    "SIZE_CHANGED",
    "SPEED_CHANGED",
    "OPTIMIZED_TOGGLED",
    "CUSTOM_INPUT",
    "KEY_SPACE",
    "KEY_ARROW_RIGHT",
    "KEY_R",
    "WINDOW_RESIZE",
    "ACTION_PASS_START",
    "ACTION_COMPARE",
    "ACTION_AFTER_COMPARE",
    "ACTION_SWAP",
    "ACTION_PASS_END",
    "ACTION_DONE",
    "STEP_COMPLETE",
    "TICK",
    "DONE"
  ],
  "triggers": {
    "START_CLICKED": "#start",
    "PAUSE_CLICKED": "#pause",
    "STEP_CLICKED": "#step",
    "SHUFFLE_CLICKED": "#shuffle",
    "RESET_CLICKED": "#reset",
    "APPLY_CLICKED": "#apply",
    "SIZE_CHANGED": "#size",
    "SPEED_CHANGED": "#speed",
    "OPTIMIZED_TOGGLED": "#optimized",
    "CUSTOM_INPUT": "#custom",
    "KEY_SPACE": "#start, #pause",
    "KEY_ARROW_RIGHT": "#step",
    "KEY_R": "#shuffle",
    "WINDOW_RESIZE": "#bars",
    "TICK": "#start",
    "STEP_COMPLETE": "#step",
    "UI_SELECTORS": "#size, #speed, #optimized, #shuffle, #start, #step, #pause, #reset, #custom, #apply, #comp, #swaps, #pass, #idx-i, #idx-j, #status, #bars, .btn, .btn.primary, .input-text, .bars, .bar, .val, .container, .panel, .top, .controls, .group, .display, .stats, .visual, .small, .help, .footer, .bar, .val"
  },
  "notes": "States include user-level states (idle, running, paused, stepping, completed) and transient generator-action states (comparing, swapping, passStart, passEnd). onEnter/onExit values reference functions or observable actions in the code: startAuto, pauseAuto, reset, stepOnce, finalize, updateBarsFromArray, applyCustom (apply button handler), setStatus('...'). Triggers map user interactions to exact DOM selectors found in the HTML; internal ACTION_* events are produced by the bubbleGenerator and the controller tick/step logic."
}