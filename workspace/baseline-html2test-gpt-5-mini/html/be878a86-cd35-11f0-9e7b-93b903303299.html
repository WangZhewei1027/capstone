<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Selection Sort Visualizer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f1724;
      --panel:#0b1220;
      --muted:#94a3b8;
      --accent:#60a5fa;
      --good:#10b981;
      --bad:#ef4444;
      --highlight:#f59e0b;
      --card:#0b1220;
    }
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg),#061023 80%);
      color:#e6eef8;
      min-height:100vh;
      padding:24px;
      display:flex;
      gap:20px;
      align-items:flex-start;
      justify-content:center;
    }
    .container{
      width:1100px;
      max-width:96vw;
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:18px;
      align-items:start;
    }
    .panel{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      border-radius:12px;
      padding:14px;
      box-shadow: 0 6px 30px rgba(2,6,23,0.6);
    }
    .visual.panel{
      height:540px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .controls > *{margin:2px 0;}
    .btn{
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      color:var(--muted);
      padding:8px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      transition:all .12s;
    }
    .btn.primary{
      color:white;
      background:linear-gradient(180deg,var(--accent),#2b6cb0);
      border-color:rgba(96,165,250,0.2);
      box-shadow:0 6px 18px rgba(96,165,250,0.08);
    }
    .btn:active{transform:translateY(1px);opacity:0.95;}
    .btn.small{padding:6px 8px;font-size:13px;border-radius:6px;}
    input[type=range]{width:160px}
    .top-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
    }
    .bars{
      flex:1;
      height:420px;
      background:linear-gradient(0deg, rgba(255,255,255,0.01), rgba(255,255,255,0.01));
      border-radius:10px;
      padding:12px;
      display:flex;
      align-items:end;
      gap:6px;
      overflow:hidden;
      border:1px dashed rgba(255,255,255,0.03);
    }
    .bar{
      flex:1 1 auto;
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border-radius:6px 6px 4px 4px;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      color:rgba(255,255,255,0.9);
      font-size:12px;
      font-weight:700;
      transition:all 250ms ease;
      position:relative;
      min-width:8px;
      margin:0 2px;
    }
    .bar .label{
      transform:translateY(-6px);
      padding:0 6px;
      font-size:11px;
      color:#081225;
      font-weight:700;
      border-radius:6px;
    }
    .bar.sorted{background:linear-gradient(180deg,#059669,#10b981); color:#052017;}
    .bar.min{background:linear-gradient(180deg,#ef4444,#ef7a7a); color:#2b0b0b;}
    .bar.current{background:linear-gradient(180deg,#60a5fa,#2b6cb0); color:#02102a;}
    .bar.check{background:linear-gradient(180deg,#f59e0b,#fdb86b); color:#241303;}
    .status{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .stat{
      background:rgba(255,255,255,0.02);
      padding:8px 10px;
      border-radius:8px;
      color:var(--muted);
      font-weight:600;
    }
    .right.panel{
      height:540px;
      display:flex;
      flex-direction:column;
      gap:12px;
      width:360px;
      overflow:auto;
    }
    h1{margin:0;font-size:20px}
    p.small{margin:6px 0 0;color:var(--muted);font-size:13px}
    .legend{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:6px;
    }
    .legend .item{
      display:flex;
      gap:8px;
      align-items:center;
      background:rgba(255,255,255,0.02);
      padding:6px 8px;border-radius:8px;color:var(--muted);font-weight:600;font-size:13px;
    }
    .swatches{width:18px;height:18px;border-radius:4px}
    pre{
      background:rgba(255,255,255,0.02);
      padding:10px;border-radius:8px;overflow:auto;
      font-size:13px;color:var(--muted);
    }
    label{font-size:13px;color:var(--muted);display:flex;align-items:center;gap:8px}
    footer{font-size:12px;color:var(--muted);margin-top:8px}
    .tiny{font-size:12px;color:var(--muted)}
    .controls-right{display:flex;gap:8px;align-items:center}
    .flex-col{display:flex;flex-direction:column;gap:6px}
    input[type=number]{width:74px;padding:6px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--muted)}
    .help{font-size:13px;color:var(--muted);line-height:1.35}
  </style>
</head>
<body>
  <div class="container">
    <div class="panel visual">
      <div class="top-row">
        <div style="display:flex;flex-direction:column;gap:6px">
          <h1>Selection Sort</h1>
          <p class="small">Find the minimum element and swap it into place. Repeat for each position.</p>
          <div class="legend" aria-hidden="true">
            <div class="item"><div class="swatches" style="background:linear-gradient(180deg,#059669,#10b981)"></div> Sorted</div>
            <div class="item"><div class="swatches" style="background:linear-gradient(180deg,#ef4444,#ef7a7a)"></div> Current minimum</div>
            <div class="item"><div class="swatches" style="background:linear-gradient(180deg,#60a5fa,#2b6cb0)"></div> Current start position</div>
            <div class="item"><div class="swatches" style="background:linear-gradient(180deg,#f59e0b,#fdb86b)"></div> Element being compared</div>
          </div>
        </div>
        <div class="controls-right">
          <div class="stat" id="comparisons">Comparisons: 0</div>
          <div class="stat" id="swaps">Swaps: 0</div>
        </div>
      </div>

      <div style="display:flex;gap:12px;align-items:center;justify-content:space-between;">
        <div class="controls" role="toolbar" aria-label="controls">
          <button class="btn primary" id="playPause">Play</button>
          <button class="btn small" id="stepBtn">Step</button>
          <button class="btn small" id="resetBtn">Reset</button>
          <button class="btn small" id="shuffleBtn">Shuffle</button>
          <label style="display:flex;align-items:center;gap:8px;">
            Speed
            <input id="speed" type="range" min="1" max="100" value="40" />
          </label>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <label class="tiny">Size
            <input id="size" type="range" min="5" max="80" value="20" />
          </label>
          <button class="btn small" id="newArrBtn">New Array</button>
        </div>
      </div>

      <div class="bars panel" id="bars" role="img" aria-label="Array bars visualization"></div>

      <div class="status">
        <div class="stat" id="info">i: - , j: - , min: -</div>
        <div class="stat" id="progress">Progress: 0 / 0</div>
        <div style="flex:1"></div>
        <label class="tiny" style="display:flex;align-items:center;gap:8px">
          <input type="checkbox" id="showValues" checked /> Show values
        </label>
      </div>
      <footer class="tiny">Use Step to advance one action (compare / new min / swap / mark sorted). Play animates automatically.</footer>
    </div>

    <div class="panel right">
      <div>
        <h2 style="margin:0 0 6px 0">How Selection Sort works</h2>
        <p class="help">
          Selection sort repeatedly selects the smallest remaining element and swaps it into the next position of the sorted portion.
          It's an in-place algorithm with O(n^2) comparisons (worst/average/best) and O(n) swaps. It is not stable in general.
        </p>
      </div>

      <div>
        <h3 style="margin:0 0 6px 0">Pseudocode</h3>
        <pre>
for i from 0 to n-2
  minIndex = i
  for j from i+1 to n-1
    if A[j] &lt; A[minIndex]
      minIndex = j
  if minIndex != i
    swap A[i] and A[minIndex]
        </pre>
      </div>

      <div>
        <h3 style="margin:0 0 6px 0">Notes & Complexity</h3>
        <ul style="margin:0 0 0 18px;color:var(--muted)">
          <li>Comparisons: Theta(n^2)</li>
          <li>Swaps: O(n) (at most n-1 swaps)</li>
          <li>Space: O(1) extra space</li>
          <li>Not stable by default (equal elements may be swapped)</li>
        </ul>
      </div>

      <div>
        <h3 style="margin:0 0 6px 0">Interact with the array</h3>
        <p class="tiny">Drag "Size" or press "New Array" to generate. "Shuffle" randomizes current values. You can toggle values visibility.</p>
        <div style="display:flex;gap:8px;margin-top:8px">
          <input id="customArray" type="text" placeholder="e.g. 5,3,8,1,2" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--muted)"/>
          <button class="btn small" id="applyCustom">Apply</button>
        </div>
        <p class="tiny" style="margin-top:8px;color:var(--muted)">Tip: numbers separated by commas will create that array.</p>
      </div>

    </div>
  </div>

  <script>
    // Selection Sort Visualizer
    const barsEl = document.getElementById('bars');
    const playPauseBtn = document.getElementById('playPause');
    const stepBtn = document.getElementById('stepBtn');
    const resetBtn = document.getElementById('resetBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const newArrBtn = document.getElementById('newArrBtn');
    const sizeInput = document.getElementById('size');
    const speedInput = document.getElementById('speed');
    const comparisonsEl = document.getElementById('comparisons');
    const swapsEl = document.getElementById('swaps');
    const infoEl = document.getElementById('info');
    const progressEl = document.getElementById('progress');
    const showValues = document.getElementById('showValues');
    const customArrayInput = document.getElementById('customArray');
    const applyCustomBtn = document.getElementById('applyCustom');

    let arr = [];
    let initialArr = [];
    let generator = null;
    let running = false;
    let timer = null;
    let interval = getInterval();
    let comps = 0;
    let swaps = 0;
    let lastState = null;
    let stepCount = 0;
    let totalStepsEstimate = 0; // for progress bar
    const MIN_SIZE = 5, MAX_SIZE = 80;

    function getInterval(){
      // speed input: 1 (slow) -> 100 (fast). Inverse mapping to ms.
      const v = +speedInput.value;
      const ms = 1200 - (v*10); // 1190ms -> 200ms
      return Math.max(20, ms);
    }

    function createRandomArray(n){
      const a = [];
      for (let i=0;i<n;i++){
        a.push( Math.floor(Math.random()*100) + 2 );
      }
      return a;
    }

    function renderBars(state = {}) {
      barsEl.innerHTML = '';
      const n = arr.length;
      const max = Math.max(...arr, 1);
      const show = showValues.checked;
      const i = state.i ?? -1;
      const j = state.j ?? -1;
      const minIndex = state.minIndex ?? -1;
      const sortedUpto = state.sortedUpto ?? -1;

      for (let idx=0; idx<n; idx++){
        const v = arr[idx];
        const bar = document.createElement('div');
        bar.className = 'bar';
        bar.style.height = (v / max * 100) + '%';
        bar.style.flexBasis = (100/n) + '%';
        bar.style.transition = running ? 'all 220ms ease' : 'all 120ms ease';

        if (idx <= sortedUpto) bar.classList.add('sorted');
        if (idx === minIndex) bar.classList.add('min');
        if (idx === i) bar.classList.add('current');
        if (idx === j) bar.classList.add('check');

        const label = document.createElement('div');
        label.className = 'label';
        label.style.background = 'transparent';
        label.textContent = show ? v : '';
        bar.appendChild(label);

        barsEl.appendChild(bar);
      }

      comparisonsEl.textContent = `Comparisons: ${comps}`;
      swapsEl.textContent = `Swaps: ${swaps}`;
      infoEl.textContent = `i: ${i>=0?i:'-'} , j: ${j>=0?j:'-'} , min: ${minIndex>=0?minIndex:'-'}`;
      progressEl.textContent = `Progress: ${Math.max(0, sortedUpto+1)} / ${n}`;
    }

    // Generator that yields action states.
    function* selectionSortGenerator(a){
      const n = a.length;
      // We will modify a in place.
      for (let i=0;i<n-1;i++){
        let minIndex = i;
        yield {type:'selectStart', i, minIndex, sortedUpto: i-1};
        for (let j=i+1;j<n;j++){
          yield {type:'compare', i, j, minIndex, sortedUpto: i-1};
          if (a[j] < a[minIndex]){
            minIndex = j;
            yield {type:'newMin', i, j, minIndex, sortedUpto: i-1};
          }
        }
        if (minIndex !== i){
          // swap
          const tmp = a[i]; a[i] = a[minIndex]; a[minIndex] = tmp;
          yield {type:'swap', i, minIndex, arr: a.slice(), sortedUpto: i};
        } else {
          yield {type:'noSwap', i, minIndex, sortedUpto: i};
        }
        // mark sorted element at i
        yield {type:'markSorted', i, sortedUpto: i};
      }
      yield {type:'done', sortedUpto: n-1};
    }

    function startGenerator(){
      generator = selectionSortGenerator(arr);
      comps = 0;
      swaps = 0;
      stepCount = 0;
      totalStepsEstimate = estimateSteps(arr.length);
      lastState = null;
      renderBars({sortedUpto:-1});
    }

    function estimateSteps(n){
      // Rough estimate: for each i, inner loop (n-i-1) compares. Each compare yields one step; newMin can add a step; each swap yields step; marking sorted yields step.
      // We'll estimate comparisons + 2n extra.
      let comps = n*(n-1)/2;
      return Math.floor(comps + 3*n);
    }

    function resetToInitial(){
      arr = initialArr.slice();
      startGenerator();
      stop();
      renderBars({sortedUpto:-1});
    }

    function shuffleArray(){
      // Fisher-Yates
      for (let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]] = [arr[j],arr[i]];
      }
      startGenerator();
      renderBars({sortedUpto:-1});
    }

    function applyCustomArrayText(text){
      const parts = text.split(',').map(s => s.trim()).filter(s => s.length);
      if (!parts.length) return false;
      const nums = parts.map(x => {
        const n = Number(x);
        return isNaN(n) ? null : n;
      });
      if (nums.some(x => x === null)) return false;
      arr = nums.slice();
      initialArr = arr.slice();
      startGenerator();
      renderBars({sortedUpto:-1});
      return true;
    }

    function stop(){
      running = false;
      playPauseBtn.textContent = 'Play';
      if (timer) {
        clearInterval(timer);
        timer = null;
      }
    }

    function play(){
      if (!generator) startGenerator();
      running = true;
      playPauseBtn.textContent = 'Pause';
      interval = getInterval();
      if (timer) clearInterval(timer);
      timer = setInterval(() => {
        const ok = runStep();
        if (!ok) {
          stop();
        }
      }, interval);
    }

    function togglePlay(){
      if (running){
        stop();
      } else {
        // if already done, restart from current array
        if (!generator) startGenerator();
        play();
      }
    }

    function runStep(){
      if (!generator) startGenerator();
      const res = generator.next();
      if (res.done){
        renderBars({sortedUpto: arr.length-1});
        lastState = {sortedUpto: arr.length-1};
        return false;
      }
      const st = res.value;
      stepCount++;
      handleState(st);
      lastState = st;
      return true;
    }

    function handleState(st){
      switch(st.type){
        case 'selectStart':
          // highlight current i and min
          renderBars({...st, sortedUpto: st.sortedUpto});
          break;
        case 'compare':
          comps++;
          renderBars({...st, sortedUpto: st.sortedUpto});
          break;
        case 'newMin':
          // found new minimum
          renderBars({...st, sortedUpto: st.sortedUpto});
          break;
        case 'swap':
          swaps++;
          // arr already updated by generator
          renderBars({...st, sortedUpto: st.sortedUpto});
          break;
        case 'noSwap':
          renderBars({...st, sortedUpto: st.sortedUpto});
          break;
        case 'markSorted':
          renderBars({...st, sortedUpto: st.sortedUpto});
          break;
        case 'done':
          renderBars({...st, sortedUpto: st.sortedUpto});
          break;
      }
    }

    // UI wiring
    playPauseBtn.addEventListener('click', () => {
      togglePlay();
    });

    stepBtn.addEventListener('click', () => {
      stop();
      const ok = runStep();
      if (!ok){
        stop();
      }
    });

    resetBtn.addEventListener('click', () => {
      resetToInitial();
    });

    shuffleBtn.addEventListener('click', () => {
      stop();
      shuffleArray();
    });

    newArrBtn.addEventListener('click', () => {
      const n = parseInt(sizeInput.value,10) || 20;
      arr = createRandomArray(n);
      initialArr = arr.slice();
      startGenerator();
      renderBars({sortedUpto:-1});
      stop();
    });

    sizeInput.addEventListener('input', () => {
      // live preview size change (not regenerated until New Array)
      const n = parseInt(sizeInput.value,10);
      // nothing else
    });

    speedInput.addEventListener('input', () => {
      interval = getInterval();
      if (running){
        clearInterval(timer);
        timer = setInterval(() => {
          const ok = runStep();
          if (!ok) stop();
        }, interval);
      }
    });

    showValues.addEventListener('change', () => {
      renderBars(lastState || {sortedUpto:-1});
    });

    applyCustomBtn.addEventListener('click', () => {
      const ok = applyCustomArrayText(customArrayInput.value);
      if (!ok){
        alert('Invalid input. Use comma separated numbers, e.g. 5,3,8,1,2');
      } else {
        stop();
      }
    });

    // Keyboard: Space -> play/pause, Right -> step
    window.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        togglePlay();
      } else if (e.code === 'ArrowRight') {
        e.preventDefault();
        stop();
        runStep();
      }
    });

    // Initialize
    (function init(){
      const n = parseInt(sizeInput.value,10) || 20;
      arr = createRandomArray(n);
      initialArr = arr.slice();
      startGenerator();
      renderBars({sortedUpto:-1});
    })();

    // Make bars responsive to container resize
    window.addEventListener('resize', () => renderBars(lastState || {sortedUpto:-1}));
  </script>
</body>
</html>