<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Set — Interactive Demo (JavaScript Sets & Set Operations)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin: 18px; color:#111; background:#f7f9fc; }
    h1 { margin:0 0 8px 0; font-size:20px; }
    p.lead { margin:6px 0 18px 0; color:#444; }
    .container { display:grid; grid-template-columns: 1fr 1fr; gap:16px; align-items:start; }
    .box { background:white; border:1px solid #e2e8f0; border-radius:8px; padding:12px; box-shadow: 0 1px 0 rgba(0,0,0,0.02); }
    label { display:block; font-weight:600; margin-bottom:6px; font-size:13px; }
    textarea { width:100%; min-height:72px; font-family: monospace; padding:8px; border-radius:6px; border:1px solid #d0d7df; resize:vertical; }
    .controls { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    button { background:#0366d6; color:white; border:none; padding:8px 10px; border-radius:6px; cursor:pointer; font-weight:600; }
    button.secondary { background:#e6eefc; color:#034c8c; font-weight:700; }
    button.ghost { background:transparent; color:#0366d6; border:1px solid #d7e6ff; }
    .small { font-size:13px; color:#555; margin-top:8px; }
    .result { margin-top:12px; padding:10px; background:#fbfdff; border:1px dashed #dbe9ff; border-radius:6px; }
    .list { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .chip { padding:6px 10px; border-radius:20px; background:#eef6ff; color:#03386a; font-weight:600; font-size:13px; border:1px solid #d3e9ff; }
    .chip.type { font-weight:500; font-size:12px; padding:4px 8px; border-radius:12px; background:#f3f7fb; color:#344a5f; border:1px solid #e6edf6; }
    pre { background:#0b1220; color:#dbeafe; padding:10px; border-radius:6px; overflow:auto; font-size:13px; }
    .examples { display:flex; gap:6px; flex-wrap:wrap; margin-top:8px; }
    .meta { font-size:13px; color:#3b4856; margin-top:10px; }
    .flex { display:flex; gap:10px; align-items:center; }
    .badge { background:#eef6ff; color:#084f8a; padding:5px 8px; border-radius:12px; font-weight:700; font-size:12px; }
    footer { margin-top:18px; font-size:13px; color:#555; }
    @media (max-width:900px){ .container{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <h1>Set — Interactive Demo</h1>
  <p class="lead">Explore JavaScript Sets and common set operations (union, intersection, difference, symmetric difference), deduplication, and important behavior notes (NaN, objects by reference, insertion order).</p>

  <div class="container">
    <div class="box">
      <label>Array A (comma-separated tokens)</label>
      <textarea id="inputA" placeholder='e.g. 1, 2, 2, "apple", {"x":1}, NaN, undefined'></textarea>

      <label style="margin-top:10px;">Array B (comma-separated tokens)</label>
      <textarea id="inputB" placeholder='e.g. 2, "banana", {"x":1}, NaN'></textarea>

      <div class="controls">
        <button id="updateBtn">Create Sets</button>
        <button class="secondary" id="dedupeBtn">Dedupe A → Array</button>
        <button class="ghost" id="clearBtn">Clear</button>
      </div>

      <div class="examples small">
        Examples:
        <button class="ghost" data-ex="nums">Numbers</button>
        <button class="ghost" data-ex="strings">Strings & duplicates</button>
        <button class="ghost" data-ex="nan">NaN behavior</button>
        <button class="ghost" data-ex="objs">Objects by reference</button>
      </div>

      <div id="setsOverview" class="result" style="display:none;">
        <div class="flex">
          <div>
            <div class="meta"><strong>Set A</strong> — size: <span id="sizeA">0</span></div>
            <div id="setAList" class="list"></div>
          </div>
          <div style="margin-left:18px;">
            <div class="meta"><strong>Set B</strong> — size: <span id="sizeB">0</span></div>
            <div id="setBList" class="list"></div>
          </div>
        </div>

        <div class="meta" style="margin-top:12px;">
          In JavaScript, Sets use "SameValueZero" equality:
          - NaN is considered equal to NaN (so duplicates of NaN are removed).
          - Objects are compared by reference (two distinct objects with same content are different).
          - Insertion order is preserved when iterating.
        </div>
      </div>
    </div>

    <div class="box">
      <label>Set Operations</label>
      <div class="controls" style="margin-bottom:6px;">
        <button id="unionBtn">Union</button>
        <button id="intersectionBtn">Intersection</button>
        <button id="diffBtn">A \ B (Difference)</button>
        <button id="symDiffBtn">Symmetric Diff</button>
        <button id="subsetBtn">A ⊆ B?</button>
        <button id="equalsBtn">A == B?</button>
      </div>

      <div id="opResult" class="result" style="display:none;">
        <div id="opTitle" class="meta"></div>
        <div id="opList" class="list" style="margin-top:8px;"></div>
        <pre id="opCode" style="margin-top:10px;"></pre>
      </div>

      <div id="dedupeResult" class="result" style="display:none;">
        <div class="meta"><strong>Dedupe result (Array)</strong></div>
        <div id="dedupeList" class="list"></div>
        <pre id="dedupeCode"></pre>
      </div>

      <div style="margin-top:12px;">
        <label style="font-weight:700">Quick demos & gotchas</label>
        <div class="small" style="margin-top:6px;">
          <button class="ghost" id="demoNaN">Show NaN behavior</button>
          <button class="ghost" id="demoObjects">Show objects-by-reference</button>
          <button class="ghost" id="demoOrder">Insertion order demo</button>
        </div>

        <div id="demoArea" class="result" style="display:none; margin-top:10px;">
          <div id="demoText" class="meta"></div>
          <div id="demoList" class="list" style="margin-top:8px;"></div>
        </div>
      </div>

      <div class="meta" style="margin-top:12px;">
        Code note: examples below show idiomatic JS for creating and computing set operations.
      </div>
    </div>
  </div>

  <footer>
    Tip: You can enter tokens like 1, "two", true, null, undefined, NaN, {"x":1} (objects/arrays using JSON syntax), or bare words (treated as strings).
  </footer>

  <script>
    // Utilities
    function parseTokens(input) {
      // Split on commas not inside braces or quotes: simple heuristic for this demo
      const raw = [];
      let cur = '', depth = 0, inSingle = false, inDouble = false;
      for (let i=0;i<input.length;i++){
        const ch = input[i];
        if (ch === '"' && !inSingle) inDouble = !inDouble;
        if (ch === "'" && !inDouble) inSingle = !inSingle;
        if (!inSingle && !inDouble) {
          if (ch === '{' || ch === '[') depth++;
          if (ch === '}' || ch === ']') depth = Math.max(0, depth-1);
        }
        if (ch === ',' && depth === 0 && !inSingle && !inDouble) {
          raw.push(cur); cur=''; continue;
        }
        cur += ch;
      }
      if (cur.trim() !== '') raw.push(cur);
      return raw.map(s => safeParseToken(s));
    }

    function safeParseToken(token) {
      const t = token.trim();
      if (t === '') return null; // skip empty
      if (t === 'NaN') return NaN;
      if (t === 'undefined') return undefined;
      if (t === 'null') return null;
      if (t === 'true' || t === 'false') return t === 'true';
      // number pattern
      if (/^-?\d+(\.\d+)?$/.test(t)) return Number(t);
      // JSON object/array or quoted string
      if ((t.startsWith('{') && t.endsWith('}')) || (t.startsWith('[') && t.endsWith(']')) || (t.startsWith('"') && t.endsWith('"'))) {
        try { return JSON.parse(t); } catch(e) { /* fall through */ }
      }
      // single-quoted string
      if (t.startsWith("'") && t.endsWith("'")) return t.slice(1,-1);
      // fallback to raw string
      return t;
    }

    function displayVal(v) {
      if (v === null) return 'null';
      if (typeof v === 'string') return '"' + v + '"';
      if (typeof v === 'undefined') return 'undefined';
      if (typeof v === 'number' && Number.isNaN(v)) return 'NaN';
      if (typeof v === 'object') {
        try { return JSON.stringify(v); } catch(e) { return String(v); }
      }
      return String(v);
    }

    function typeOfVal(v) {
      if (v === null) return 'null';
      if (typeof v === 'number' && Number.isNaN(v)) return 'NaN';
      return typeof v;
    }

    // DOM refs
    const inputA = document.getElementById('inputA');
    const inputB = document.getElementById('inputB');
    const updateBtn = document.getElementById('updateBtn');
    const clearBtn = document.getElementById('clearBtn');
    const dedupeBtn = document.getElementById('dedupeBtn');
    const setsOverview = document.getElementById('setsOverview');
    const setAList = document.getElementById('setAList');
    const setBList = document.getElementById('setBList');
    const sizeA = document.getElementById('sizeA');
    const sizeB = document.getElementById('sizeB');

    const opResult = document.getElementById('opResult');
    const opTitle = document.getElementById('opTitle');
    const opList = document.getElementById('opList');
    const opCode = document.getElementById('opCode');

    const dedupeResult = document.getElementById('dedupeResult');
    const dedupeList = document.getElementById('dedupeList');
    const dedupeCode = document.getElementById('dedupeCode');

    const demoArea = document.getElementById('demoArea');
    const demoText = document.getElementById('demoText');
    const demoList = document.getElementById('demoList');

    // state
    let arrA = [], arrB = [], setA = new Set(), setB = new Set();

    function renderSetViews() {
      setAList.innerHTML = '';
      setBList.innerHTML = '';
      sizeA.textContent = setA.size;
      sizeB.textContent = setB.size;

      for (const v of setA) {
        const el = document.createElement('div');
        el.className = 'chip';
        el.textContent = displayVal(v);
        const t = document.createElement('div');
        t.className = 'chip type';
        t.style.marginLeft = '6px';
        t.textContent = typeOfVal(v);
        const wrap = document.createElement('div');
        wrap.style.display='flex';
        wrap.style.alignItems='center';
        wrap.appendChild(el);
        wrap.appendChild(t);
        setAList.appendChild(wrap);
      }
      for (const v of setB) {
        const el = document.createElement('div');
        el.className = 'chip';
        el.textContent = displayVal(v);
        const t = document.createElement('div');
        t.className = 'chip type';
        t.style.marginLeft = '6px';
        t.textContent = typeOfVal(v);
        const wrap = document.createElement('div');
        wrap.style.display='flex';
        wrap.style.alignItems='center';
        wrap.appendChild(el);
        wrap.appendChild(t);
        setBList.appendChild(wrap);
      }
      setsOverview.style.display = 'block';
    }

    function loadInputs() {
      arrA = parseTokens(inputA.value);
      arrB = parseTokens(inputB.value);
      // filter out the null placeholders we used for empties
      arrA = arrA.filter(x => x !== null);
      arrB = arrB.filter(x => x !== null);
      setA = new Set(arrA);
      setB = new Set(arrB);
      renderSetViews();
      opResult.style.display = 'none';
      dedupeResult.style.display = 'none';
      demoArea.style.display = 'none';
    }

    updateBtn.addEventListener('click', loadInputs);
    clearBtn.addEventListener('click', () => {
      inputA.value = '';
      inputB.value = '';
      arrA = []; arrB = []; setA = new Set(); setB = new Set();
      setAList.innerHTML = ''; setBList.innerHTML = '';
      sizeA.textContent = 0; sizeB.textContent = 0;
      setsOverview.style.display = 'none';
      opResult.style.display = 'none';
      dedupeResult.style.display = 'none';
      demoArea.style.display = 'none';
    });

    // Examples loader
    document.querySelectorAll('[data-ex]').forEach(btn => {
      btn.addEventListener('click', () => {
        const ex = btn.getAttribute('data-ex');
        if (ex === 'nums') {
          inputA.value = '1, 2, 2, 3, 4';
          inputB.value = '2, 4, 6';
        } else if (ex === 'strings') {
          inputA.value = 'apple, apple, "banana", banana, "apple"';
          inputB.value = '"banana", "cherry"';
        } else if (ex === 'nan') {
          inputA.value = 'NaN, NaN, 0/0, "NaN"';
          inputB.value = 'NaN';
        } else if (ex === 'objs') {
          inputA.value = '{"x":1}, {"x":1}, {"y":2}';
          inputB.value = '{"x":1}';
        }
        loadInputs();
      });
    });

    // Operation helpers
    function union(a,b) { return new Set([...a, ...b]); }
    function intersection(a,b) { return new Set([...a].filter(x => b.has(x))); }
    function difference(a,b) { return new Set([...a].filter(x => !b.has(x))); }
    function symmetricDiff(a,b) { return new Set([...difference(a,b), ...difference(b,a)]); }
    function isSubset(a,b) { return [...a].every(x=>b.has(x)); }
    function isEqualSet(a,b) { return a.size === b.size && isSubset(a,b); }

    function showOperation(title, resultSet, code) {
      opTitle.textContent = title + ' — size: ' + resultSet.size;
      opList.innerHTML = '';
      for (const v of resultSet) {
        const el = document.createElement('div');
        el.className = 'chip';
        el.textContent = displayVal(v);
        opList.appendChild(el);
      }
      opCode.textContent = code;
      opResult.style.display = 'block';
      // hide other panels
      dedupeResult.style.display = 'none';
      demoArea.style.display = 'none';
    }

    document.getElementById('unionBtn').addEventListener('click', () => {
      const res = union(setA,setB);
      showOperation('Union (A ∪ B)', res, `const union = new Set([...A, ...B]);`);
    });

    document.getElementById('intersectionBtn').addEventListener('click', () => {
      const res = intersection(setA,setB);
      showOperation('Intersection (A ∩ B)', res, `const intersection = new Set([...A].filter(x => B.has(x)));`);
    });

    document.getElementById('diffBtn').addEventListener('click', () => {
      const res = difference(setA, setB);
      showOperation('Difference (A \\ B)', res, `const difference = new Set([...A].filter(x => !B.has(x)));`);
    });

    document.getElementById('symDiffBtn').addEventListener('click', () => {
      const res = symmetricDiff(setA,setB);
      showOperation('Symmetric Difference (A Δ B)', res, `const symDiff = new Set([...difference(A,B), ...difference(B,A)]);`);
    });

    document.getElementById('subsetBtn').addEventListener('click', () => {
      const res = isSubset(setA,setB);
      opTitle.textContent = `A ⊆ B ? → ${res}`;
      opList.innerHTML = '';
      opCode.textContent = `const isSubset = [...A].every(x => B.has(x));`;
      opResult.style.display = 'block';
      dedupeResult.style.display = 'none';
      demoArea.style.display = 'none';
    });

    document.getElementById('equalsBtn').addEventListener('click', () => {
      const res = isEqualSet(setA,setB);
      opTitle.textContent = `A == B (same elements)? → ${res}`;
      opList.innerHTML = '';
      opCode.textContent = `const isEqual = A.size === B.size && [...A].every(x => B.has(x));`;
      opResult.style.display = 'block';
      dedupeResult.style.display = 'none';
      demoArea.style.display = 'none';
    });

    // Dedupe single array A
    dedupeBtn.addEventListener('click', () => {
      const deduped = [...new Set(arrA)];
      dedupeList.innerHTML = '';
      for (const v of deduped) {
        const el = document.createElement('div');
        el.className = 'chip';
        el.textContent = displayVal(v);
        dedupeList.appendChild(el);
      }
      dedupeCode.textContent = `const deduped = [...new Set(arrayA)]; // returns a deduplicated array in insertion order`;
      dedupeResult.style.display = 'block';
      opResult.style.display = 'none';
      demoArea.style.display = 'none';
    });

    // Quick demos
    document.getElementById('demoNaN').addEventListener('click', () => {
      demoText.textContent = 'NaN is considered equal to NaN in JavaScript Sets (SameValueZero). Adding multiple NaN values results in a single entry.';
      const s = new Set([NaN, 0/0, NaN]);
      demoList.innerHTML = '';
      for (const v of s) {
        const el = document.createElement('div'); el.className='chip'; el.textContent = displayVal(v);
        demoList.appendChild(el);
      }
      demoArea.style.display = 'block';
      opResult.style.display = 'none';
      dedupeResult.style.display = 'none';
    });

    document.getElementById('demoObjects').addEventListener('click', () => {
      demoText.textContent = 'Objects are stored by reference. Two distinct object literals with same content are different entries:';
      demoList.innerHTML = '';
      const o1 = {"x":1};
      const o2 = {"x":1};
      const s = new Set([o1, o2, o1]);
      [o1,o2].forEach(o=>{
        const el = document.createElement('div'); el.className='chip'; el.textContent = displayVal(o);
        demoList.appendChild(el);
      });
      const note = document.createElement('div'); note.style.marginTop='8px'; note.className='small'; note.textContent = 'Set contents (two distinct objects remain): size = ' + s.size;
      demoList.appendChild(note);
      demoArea.style.display = 'block';
      opResult.style.display = 'none';
      dedupeResult.style.display = 'none';
    });

    document.getElementById('demoOrder').addEventListener('click', () => {
      demoText.textContent = 'Sets preserve insertion order. Iterating yields values in the order they were first added.';
      demoList.innerHTML = '';
      const s = new Set();
      s.add(3); s.add(1); s.add(2); s.add(1);
      for (const v of s) {
        const el = document.createElement('div'); el.className='chip'; el.textContent = displayVal(v);
        demoList.appendChild(el);
      }
      demoArea.style.display = 'block';
      opResult.style.display = 'none';
      dedupeResult.style.display = 'none';
    });

    // Initialize with a small example
    inputA.value = '1, 2, 2, "apple", {"x":1}, NaN';
    inputB.value = '2, "banana", {"x":1}, NaN';
    loadInputs();

    // Allow pressing Ctrl+Enter in textarea to update
    [inputA, inputB].forEach(t => t.addEventListener('keydown', (e)=>{ if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) { loadInputs(); } }));
  </script>
</body>
</html>