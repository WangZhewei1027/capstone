{
  "id": "be87d8a0-cd35-11f0-9e7b-93b903303299",
  "timestamp": "2025-11-29T15:13:40.992Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Huffman Coding",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\"/>\n<title>Huffman Coding Demonstration</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"/>\n<style>\n  body { font-family: system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial; margin: 18px; color: #111; background: #f7f9fb; }\n  h1 { margin: 0 0 8px 0; font-size: 20px; }\n  .layout { display: grid; grid-template-columns: 46% 54%; gap: 16px; align-items: start; }\n  .panel { background: white; border-radius: 8px; padding: 12px; box-shadow: 0 1px 4px rgba(15,20,30,0.06); }\n  textarea { width: 100%; height: 140px; padding: 8px; font-family: monospace; font-size: 13px; box-sizing: border-box; border: 1px solid #dde6ef; border-radius: 6px; resize: vertical; }\n  .controls { margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap; }\n  button { background: #2563eb; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; }\n  button.secondary { background: #eef2ff; color: #1f2937; }\n  button.small { padding: 6px 8px; font-size: 13px; }\n  table { width: 100%; border-collapse: collapse; font-size: 13px; margin-top: 8px; }\n  th, td { text-align: left; padding: 6px 8px; border-bottom: 1px solid #f1f5f9; vertical-align: middle; }\n  th { background: #fbfdff; font-weight: 600; position: sticky; top: 0; }\n  .code { font-family: monospace; background: #f8fafc; padding: 2px 6px; border-radius: 4px; display: inline-block; }\n  .small-note { color: #475569; font-size: 13px; margin-top: 6px; }\n  .stat-row { display:flex; gap:12px; flex-wrap:wrap; margin-top:8px; }\n  .stat { background: #f1f5f9; padding: 8px 10px; border-radius:8px; font-size:13px; }\n  .svg-wrap { width: 100%; height: 340px; overflow: auto; border: 1px dashed #e6eef8; border-radius: 8px; background: #fff; }\n  svg { width: 100%; height: 100%; }\n  .leaf-highlight { stroke: #fb923c; stroke-width: 3px; }\n  .node { cursor: default; }\n  .bit-output { font-family: monospace; background: #0f1724; color: #e2e8f0; padding: 10px; border-radius: 6px; white-space: pre-wrap; word-break: break-all; font-size: 13px; max-height:160px; overflow:auto; }\n  .muted { color: #334155; font-size: 13px; }\n  .footer { margin-top: 12px; color: #475569; font-size: 13px; }\n  .legend { font-size: 13px; display:flex; gap:10px; flex-wrap:wrap; margin-top:8px; }\n  .legend .box { display:inline-flex; align-items:center; gap:8px; }\n  .color { width:14px; height:14px; border-radius:4px; display:inline-block; }\n  .color.orange { background:#fb923c; }\n  .color.blue { background:#60a5fa; }\n  .hint { color:#0f1724; background:#fffbeb; padding:8px;border-radius:6px; font-size:13px; margin-top:8px; border:1px solid #fef3c7; }\n  .footer small { color:#64748b; }\n</style>\n</head>\n<body>\n<h1>Huffman Coding — Interactive Demonstration</h1>\n<div class=\"layout\">\n  <div class=\"panel\">\n    <strong>Input text</strong>\n    <textarea id=\"inputText\" spellcheck=\"false\">this is an example for huffman coding</textarea>\n    <div class=\"controls\">\n      <button id=\"buildBtn\">Build Huffman Codes</button>\n      <button class=\"secondary\" id=\"randomBtn\">Load Random Sample</button>\n      <button class=\"secondary\" id=\"clearBtn\">Clear</button>\n      <button class=\"secondary small\" id=\"toggleSpaces\">Show invisible chars</button>\n    </div>\n\n    <div id=\"freqSection\" style=\"margin-top:10px; display:none;\">\n      <strong>Frequency table</strong>\n      <table id=\"freqTable\">\n        <thead><tr><th>Symbol</th><th>Count</th><th>Probability</th><th>Code</th><th>Bits</th></tr></thead>\n        <tbody></tbody>\n      </table>\n\n      <div class=\"stat-row\">\n        <div class=\"stat\" id=\"totalBits\">Total bits: —</div>\n        <div class=\"stat\" id=\"avgBits\">Average bits/symbol: —</div>\n        <div class=\"stat\" id=\"entropy\">Entropy (H): —</div>\n        <div class=\"stat\" id=\"ratio\">Compression vs 8-bit: —</div>\n      </div>\n\n      <div class=\"small-note\" id=\"noteText\"></div>\n    </div>\n  </div>\n\n  <div class=\"panel\">\n    <strong>Huffman Tree (visual)</strong>\n    <div class=\"svg-wrap\" id=\"svgContainer\">\n      <svg id=\"huffmanSVG\" xmlns=\"http://www.w3.org/2000/svg\"></svg>\n    </div>\n\n    <div style=\"display:flex; gap:8px; margin-top:8px; align-items:center;\">\n      <button id=\"encodeBtn\">Encode input</button>\n      <button id=\"decodeBtn\" class=\"secondary\">Decode bits → text</button>\n      <button id=\"stepBtn\" class=\"secondary\">Step decode (animate)</button>\n      <button id=\"copyBits\" class=\"secondary small\">Copy bits</button>\n    </div>\n\n    <div style=\"margin-top:8px;\">\n      <div style=\"display:flex; gap:8px;\">\n        <div style=\"flex:1;\">\n          <strong>Encoded bits</strong>\n          <div id=\"bits\" class=\"bit-output\">—</div>\n        </div>\n        <div style=\"width:45%;\">\n          <strong>Decoded text</strong>\n          <div id=\"decoded\" class=\"bit-output\">—</div>\n        </div>\n      </div>\n\n      <div class=\"legend\">\n        <div class=\"box\"><span class=\"color orange\"></span> Current leaf (during animation)</div>\n        <div class=\"box\"><span class=\"color blue\"></span> Node / branch</div>\n      </div>\n      <div class=\"hint\" id=\"hint\">Type or paste text on the left and click \"Build Huffman Codes\". Then encode, decode, and step through bits to see how the tree is traversed.</div>\n    </div>\n  </div>\n</div>\n\n<script>\n/*\n  Huffman Coding interactive demo\n  - Build frequency table from input text\n  - Build Huffman tree (binary, standard greedy)\n  - Assign codes\n  - Encode / decode\n  - Visualize tree in SVG and animate decoding\n*/\n\n// Utilities\nfunction escapeSymbol(ch, showInvisible) {\n  if (ch === ' ') return showInvisible ? '␣' : '[space]';\n  if (ch === '\\\\n') return '\\\\n';\n  if (ch === '\\\\t') return '\\\\t';\n  if (ch === '\\n') return showInvisible ? '↵' : '[LF]';\n  if (ch === '\\t') return showInvisible ? '⇥' : '[TAB]';\n  if (ch === '\\r') return '[CR]';\n  if (ch === '') return '[empty]';\n  return ch;\n}\n\nfunction formatProb(p) { return (p*100).toFixed(2) + '%'; }\nfunction bitsToGroupedString(bits) {\n  if (!bits) return '—';\n  // group in 8 bits for readability, also show total bits\n  let out = '';\n  for (let i=0;i<bits.length;i++){\n    out += bits[i];\n    if ((i+1)%8===0 && i+1 < bits.length) out += ' ';\n  }\n  return out + '  (' + bits.length + ' bits)';\n}\n\n// Huffman functions\nfunction buildFrequency(text) {\n  const freq = new Map();\n  for (let ch of text) freq.set(ch, (freq.get(ch) || 0) + 1);\n  return freq;\n}\n\n// Node structure: {id, weight, char (if leaf), left, right}\nlet nodeIdCounter = 0;\nfunction buildHuffmanTree(freqMap) {\n  // create initial nodes\n  let nodes = [];\n  for (let [ch,w] of freqMap.entries()) {\n    nodes.push({ id: nodeIdCounter++, weight: w, char: ch, left: null, right: null });\n  }\n  if (nodes.length === 0) return null;\n  if (nodes.length === 1) {\n    // Special-case: single symbol -> create dummy node so it gets code '0'\n    const leaf = nodes[0];\n    const root = { id: nodeIdCounter++, weight: leaf.weight, char: null, left: leaf, right: { id: nodeIdCounter++, weight: 0, char: null, left: null, right: null } };\n    return root;\n  }\n  // standard greedy: repeatedly merge two smallest weights\n  while (nodes.length > 1) {\n    nodes.sort((a,b) => a.weight - b.weight || (a.id - b.id)); // deterministic tie-breaker by id\n    const a = nodes.shift();\n    const b = nodes.shift();\n    const parent = { id: nodeIdCounter++, weight: a.weight + b.weight, char: null, left: a, right: b };\n    nodes.push(parent);\n  }\n  return nodes[0];\n}\n\nfunction assignCodes(node, prefix='', codes={}) {\n  if (!node) return codes;\n  if (node.char !== null && node.left === null && node.right === null) {\n    // leaf\n    codes[node.char] = prefix || '0'; // single symbol -> code '0'\n  } else {\n    assignCodes(node.left, prefix + '0', codes);\n    assignCodes(node.right, prefix + '1', codes);\n  }\n  return codes;\n}\n\n// Encoding & decoding\nfunction encodeText(text, codes) {\n  let out = '';\n  for (let ch of text) out += codes[ch];\n  return out;\n}\n\nfunction decodeBits(bits, root) {\n  if (!root) return '';\n  let res = '';\n  let node = root;\n  for (let b of bits) {\n    if (b === '0') node = node.left;\n    else node = node.right;\n    if (!node) return null; // invalid bits\n    if (node.char !== null && node.left === null && node.right === null) {\n      res += node.char;\n      node = root;\n    }\n  }\n  // If ended mid-way, return null to indicate incomplete/invalid\n  if (node !== root) return null;\n  return res;\n}\n\n// Visualization: compute layout positions by assigning x positions to leaves evenly\nfunction layoutTree(root) {\n  if (!root) return { nodes: [], links: [] };\n  // count leaves\n  function countLeaves(n) {\n    if (!n.left && !n.right) return 1;\n    let sum = 0;\n    if (n.left) sum += countLeaves(n.left);\n    if (n.right) sum += countLeaves(n.right);\n    return sum;\n  }\n  const totalLeaves = countLeaves(root);\n  const levelGap = 80;\n  const leafGap = 60;\n  let xCursor = 20;\n\n  const positions = new Map();\n  function dfs(n, depth) {\n    if (!n.left && !n.right) {\n      const x = xCursor;\n      const y = depth * levelGap + 30;\n      positions.set(n.id, { x, y });\n      xCursor += leafGap;\n      return 1;\n    }\n    let leftCount = 0, rightCount = 0;\n    if (n.left) leftCount = dfs(n.left, depth+1);\n    if (n.right) rightCount = dfs(n.right, depth+1);\n    // center parent above its children\n    // compute children's x\n    const childXs = [];\n    if (n.left) childXs.push(positions.get(n.left.id).x);\n    if (n.right) childXs.push(positions.get(n.right.id).x);\n    const avgX = childXs.reduce((a,b)=>a+b,0)/childXs.length;\n    const y = depth * levelGap + 30;\n    positions.set(n.id, { x: avgX, y });\n    return leftCount + rightCount;\n  }\n  dfs(root, 0);\n\n  const nodes = [];\n  const links = [];\n  function collect(n) {\n    const p = positions.get(n.id);\n    nodes.push({...n, x: p.x, y: p.y});\n    if (n.left) {\n      links.push({ from: n.id, to: n.left.id });\n      collect(n.left);\n    }\n    if (n.right) {\n      links.push({ from: n.id, to: n.right.id });\n      collect(n.right);\n    }\n  }\n  collect(root);\n  return { nodes, links };\n}\n\n// Render SVG\nfunction renderSVG(root, codes, showInvisible, highlightLeafId=null) {\n  const svg = document.getElementById('huffmanSVG');\n  while (svg.firstChild) svg.removeChild(svg.firstChild);\n  if (!root) {\n    svg.setAttribute('viewBox','0 0 400 120');\n    const g = document.createElementNS('http://www.w3.org/2000/svg','g');\n    const t = document.createElementNS('http://www.w3.org/2000/svg','text');\n    t.setAttribute('x',20); t.setAttribute('y',40); t.setAttribute('fill','#94a3b8'); t.setAttribute('font-size','13');\n    t.textContent = 'No tree (empty input)';\n    g.appendChild(t);\n    svg.appendChild(g);\n    return;\n  }\n  const layout = layoutTree(root);\n  // compute viewBox\n  const xs = layout.nodes.map(n=>n.x);\n  const ys = layout.nodes.map(n=>n.y);\n  const minX = Math.max(0, Math.min(...xs)-40), maxX = Math.max(...xs)+80;\n  const minY = Math.min(...ys)-40, maxY = Math.max(...ys)+40;\n  svg.setAttribute('viewBox', `${minX} ${Math.max(0,minY)} ${Math.max(300, maxX-minX)} ${Math.max(200, maxY-minY)}`);\n\n  // helper to find node by id\n  const nodeById = new Map(layout.nodes.map(n=>[n.id,n]));\n\n  // draw links\n  for (let link of layout.links) {\n    const from = nodeById.get(link.from);\n    const to = nodeById.get(link.to);\n    const line = document.createElementNS('http://www.w3.org/2000/svg','line');\n    line.setAttribute('x1', from.x); line.setAttribute('y1', from.y+18);\n    line.setAttribute('x2', to.x); line.setAttribute('y2', to.y-18);\n    line.setAttribute('stroke','#cfe6ff');\n    line.setAttribute('stroke-width','2');\n    svg.appendChild(line);\n    // add label 0 or 1 near half of the link (left child = 0, right child = 1)\n    const childNode = nodeById.get(link.to);\n    const parentNode = nodeById.get(link.from);\n    const midX = (parentNode.x + childNode.x) / 2;\n    const midY = (parentNode.y + childNode.y) / 2;\n    const label = document.createElementNS('http://www.w3.org/2000/svg','text');\n    const isLeft = parentNode.left && parentNode.left.id === childNode.id;\n    label.setAttribute('x', midX - (isLeft ? 6 : 0));\n    label.setAttribute('y', midY - 6);\n    label.setAttribute('fill','#1e293b');\n    label.setAttribute('font-size','12');\n    label.textContent = isLeft ? '0' : '1';\n    svg.appendChild(label);\n  }\n\n  // draw nodes\n  for (let n of layout.nodes) {\n    const g = document.createElementNS('http://www.w3.org/2000/svg','g');\n    g.setAttribute('transform', `translate(${n.x},${n.y})`);\n    g.classList.add('node');\n    // circle\n    const circle = document.createElementNS('http://www.w3.org/2000/svg','circle');\n    circle.setAttribute('r', 18);\n    circle.setAttribute('fill', '#fff');\n    circle.setAttribute('stroke', '#60a5fa');\n    circle.setAttribute('stroke-width', '2');\n    if (n.id === highlightLeafId) {\n      circle.setAttribute('stroke', '#fb923c');\n      circle.setAttribute('stroke-width', '4');\n    }\n    g.appendChild(circle);\n    // weight text\n    const wtext = document.createElementNS('http://www.w3.org/2000/svg','text');\n    wtext.setAttribute('x',0); wtext.setAttribute('y',5); wtext.setAttribute('text-anchor','middle');\n    wtext.setAttribute('font-size','12'); wtext.setAttribute('fill','#0f1724'); wtext.textContent = n.weight;\n    g.appendChild(wtext);\n    // if leaf, show char and code\n    if (n.char !== null && !n.left && !n.right) {\n      const top = document.createElementNS('http://www.w3.org/2000/svg','text');\n      top.setAttribute('x',0); top.setAttribute('y',-26); top.setAttribute('text-anchor','middle');\n      top.setAttribute('font-size','12'); top.setAttribute('fill','#0f1724');\n      top.textContent = escapeSymbol(n.char, showInvisible);\n      g.appendChild(top);\n      const code = document.createElementNS('http://www.w3.org/2000/svg','text');\n      code.setAttribute('x',0); code.setAttribute('y',44); code.setAttribute('text-anchor','middle');\n      code.setAttribute('font-size','11'); code.setAttribute('fill','#475569');\n      code.textContent = codes[n.char] || '';\n      g.appendChild(code);\n      // interactive: click leaf to show mapping highlight in table\n      g.style.cursor = 'pointer';\n      g.addEventListener('mouseenter', ()=> {\n        // highlight corresponding table row\n        const row = document.querySelector(`tr[data-char=\"${encodeURIComponent(n.char)}\"]`);\n        if (row) row.style.background = '#fffbeb';\n      });\n      g.addEventListener('mouseleave', ()=> {\n        const row = document.querySelector(`tr[data-char=\"${encodeURIComponent(n.char)}\"]`);\n        if (row) row.style.background = '';\n      });\n      g.addEventListener('click', ()=> {\n        // scroll table to that row\n        const row = document.querySelector(`tr[data-char=\"${encodeURIComponent(n.char)}\"]`);\n        if (row) row.scrollIntoView({behavior:'smooth', block:'center'});\n      });\n    }\n    svg.appendChild(g);\n  }\n}\n\n// UI wiring\nconst inputText = document.getElementById('inputText');\nconst buildBtn = document.getElementById('buildBtn');\nconst randomBtn = document.getElementById('randomBtn');\nconst clearBtn = document.getElementById('clearBtn');\nconst toggleSpaces = document.getElementById('toggleSpaces');\nconst freqSection = document.getElementById('freqSection');\nconst freqTableBody = document.querySelector('#freqTable tbody');\nconst totalBitsDiv = document.getElementById('totalBits');\nconst avgBitsDiv = document.getElementById('avgBits');\nconst entropyDiv = document.getElementById('entropy');\nconst ratioDiv = document.getElementById('ratio');\nconst noteText = document.getElementById('noteText');\nconst bitsDiv = document.getElementById('bits');\nconst decodedDiv = document.getElementById('decoded');\nconst encodeBtn = document.getElementById('encodeBtn');\nconst decodeBtn = document.getElementById('decodeBtn');\nconst stepBtn = document.getElementById('stepBtn');\nconst copyBitsBtn = document.getElementById('copyBits');\nconst svgContainer = document.getElementById('svgContainer');\nlet currentRoot = null;\nlet currentCodes = null;\nlet showInvisible = false;\n\n// sample specifics\nconst samples = [\n  \"this is an example for huffman coding\",\n  \"aaaaaaaaaaaaaaaaaaaaaaa\", // single symbol\n  \"To be, or not to be, that is the question: Whether 'tis nobler in the mind to suffer.\",\n  \"a quick brown fox jumps over the lazy dog\",\n  \"Huffman coding is a lossless data compression algorithm.\"\n];\n\nfunction buildFromInput() {\n  const text = inputText.value;\n  const freq = buildFrequency(text);\n  if (freq.size === 0) {\n    freqSection.style.display = 'none';\n    currentRoot = null;\n    currentCodes = null;\n    renderSVG(null, {}, showInvisible);\n    bitsDiv.textContent = '—';\n    decodedDiv.textContent = '—';\n    totalBitsDiv.textContent = 'Total bits: —';\n    avgBitsDiv.textContent = 'Average bits/symbol: —';\n    entropyDiv.textContent = 'Entropy (H): —';\n    ratioDiv.textContent = 'Compression vs 8-bit: —';\n    noteText.textContent = '';\n    return;\n  }\n  freqSection.style.display = 'block';\n  // build tree\n  currentRoot = buildHuffmanTree(freq);\n  currentCodes = assignCodes(currentRoot, '', {});\n  // prepare table\n  const total = text.length;\n  // create an array of entries sorted by count desc\n  const entries = Array.from(freq.entries()).sort((a,b)=> b[1]-a[1] || (a[0] < b[0] ? -1:1));\n  freqTableBody.innerHTML = '';\n  let totalBits = 0;\n  let entropy = 0;\n  for (let [ch,count] of entries) {\n    const p = count/total;\n    const code = currentCodes[ch];\n    const bits = code ? code.length * count : 0;\n    totalBits += bits;\n    if (p > 0) entropy += -p * Math.log2(p);\n    const tr = document.createElement('tr');\n    tr.setAttribute('data-char', encodeURIComponent(ch));\n    const symTd = document.createElement('td');\n    symTd.textContent = escapeSymbol(ch, showInvisible);\n    const countTd = document.createElement('td'); countTd.textContent = ''+count;\n    const probTd = document.createElement('td'); probTd.textContent = formatProb(p);\n    const codeTd = document.createElement('td'); codeTd.innerHTML = '<span class=\"code\">'+ (code || '') +'</span>';\n    const bitsTd = document.createElement('td'); bitsTd.textContent = bits;\n    tr.append(symTd, countTd, probTd, codeTd, bitsTd);\n    // hover highlight on table to highlight leaf in SVG\n    tr.addEventListener('mouseenter', ()=> {\n      // find leaf node id for this char\n      let lid = findLeafIdByChar(currentRoot, ch);\n      renderSVG(currentRoot, currentCodes, showInvisible, lid);\n    });\n    tr.addEventListener('mouseleave', ()=> {\n      renderSVG(currentRoot, currentCodes, showInvisible, null);\n    });\n    freqTableBody.appendChild(tr);\n  }\n  const avgBits = totalBits / total;\n  totalBitsDiv.textContent = 'Total bits: ' + totalBits;\n  avgBitsDiv.textContent = 'Average bits/symbol: ' + avgBits.toFixed(3);\n  entropyDiv.textContent = 'Entropy (H): ' + entropy.toFixed(3) + ' bits/symbol';\n  const ratio = ((total*8) / totalBits);\n  ratioDiv.textContent = 'Compression vs 8-bit: ' + (isFinite(ratio) ? ratio.toFixed(3) + '×' : '—');\n  noteText.textContent = 'Note: Huffman produces variable-length prefix-free codes. Average bits per symbol is ≥ entropy. Ties in the algorithm can change exact codes but not code lengths distribution.';\n  // render tree\n  renderSVG(currentRoot, currentCodes, showInvisible, null);\n  bitsDiv.textContent = '—';\n  decodedDiv.textContent = '—';\n}\n\n// helper to find leaf node id by char\nfunction findLeafIdByChar(node, ch) {\n  if (!node) return null;\n  if (node.char !== null && node.char === ch) return node.id;\n  let l = null, r = null;\n  if (node.left) l = findLeafIdByChar(node.left, ch);\n  if (node.right) r = findLeafIdByChar(node.right, ch);\n  return l || r;\n}\n\n// button handlers\nbuildBtn.addEventListener('click', ()=> {\n  nodeIdCounter = 0;\n  buildFromInput();\n});\nrandomBtn.addEventListener('click', ()=> {\n  const s = samples[Math.floor(Math.random()*samples.length)];\n  inputText.value = s;\n  nodeIdCounter = 0;\n  buildFromInput();\n});\nclearBtn.addEventListener('click', ()=> {\n  inputText.value = '';\n  nodeIdCounter = 0;\n  buildFromInput();\n});\ntoggleSpaces.addEventListener('click', ()=> {\n  showInvisible = !showInvisible;\n  toggleSpaces.textContent = showInvisible ? 'Show invisible chars' : 'Show invisible chars';\n  buildFromInput();\n});\n\n// encode / decode\nencodeBtn.addEventListener('click', ()=> {\n  if (!currentCodes) { alert('Build codes first'); return; }\n  const text = inputText.value;\n  const bits = encodeText(text, currentCodes);\n  bitsDiv.textContent = bitsToGroupedString(bits);\n  decodedDiv.textContent = '—';\n});\n\ndecodeBtn.addEventListener('click', ()=> {\n  if (!currentRoot) { alert('Build codes first'); return; }\n  const bitsText = prompt('Paste bits to decode (e.g. 010110...)\\nOr leave empty to decode the current encoded bits displayed below.');\n  let bits = bitsText;\n  if (bits === null) return;\n  if (bits.trim() === '') {\n    // take from bitsDiv internal content (strip parenthesis)\n    const cur = bitsDiv.textContent;\n    if (!cur || cur === '—') { alert('No bits to decode'); return; }\n    bits = cur.replace(/[^01]/g,'');\n  } else {\n    bits = bits.replace(/[^01]/g,'');\n  }\n  const decoded = decodeBits(bits, currentRoot);\n  if (decoded === null) {\n    alert('Bits could not be decoded fully (incomplete or invalid sequence).');\n  } else {\n    decodedDiv.textContent = decoded;\n  }\n});\n\n// animate step decode\nstepBtn.addEventListener('click', async ()=> {\n  if (!currentRoot) { alert('Build codes first'); return; }\n  const curBits = bitsDiv.textContent;\n  if (!curBits || curBits === '—') { alert('No encoded bits available. Click \"Encode input\" first.'); return; }\n  const bits = curBits.replace(/[^01]/g,'');\n  if (bits.length === 0) { alert('No bits to animate'); return; }\n  // animation: iterate bits, traverse, highlight current leaf when found\n  let node = currentRoot;\n  renderSVG(currentRoot, currentCodes, showInvisible, null);\n  decodedDiv.textContent = '';\n  for (let i=0;i<bits.length;i++) {\n    const b = bits[i];\n    if (b === '0') node = node.left;\n    else node = node.right;\n    // highlight current node if leaf\n    if (!node) {\n      alert('Invalid traversal (bits do not match tree).');\n      return;\n    }\n    // find leaf id if at leaf\n    if (node.char !== null && !node.left && !node.right) {\n      // highlight leaf\n      renderSVG(currentRoot, currentCodes, showInvisible, node.id);\n      // append decoded char\n      decodedDiv.textContent += node.char;\n      await new Promise(r=>setTimeout(r, 350));\n      node = currentRoot;\n    } else {\n      // highlight intermediate node: render with no leaf highlight\n      renderSVG(currentRoot, currentCodes, showInvisible, null);\n      await new Promise(r=>setTimeout(r, 160));\n    }\n    // scroll svg container to show center (for wide trees)\n    svgContainer.scrollLeft = Math.max(0, node ? node.x - 50 : 0);\n  }\n  // final: ensure full decode\n  if (node !== currentRoot) {\n    alert('Ended mid-code. Bits may be incomplete.');\n  }\n});\n\n// copy bits\ncopyBitsBtn.addEventListener('click', ()=> {\n  const cur = bitsDiv.textContent.replace(/[^01]/g,'');\n  if (!cur) { alert('No bits to copy'); return; }\n  navigator.clipboard.writeText(cur).then(()=> {\n    copyBitsBtn.textContent = 'Copied!';\n    setTimeout(()=> copyBitsBtn.textContent = 'Copy bits', 1200);\n  }, ()=> alert('Could not copy'));\n});\n\n// build on load\nnodeIdCounter = 0;\nbuildFromInput();\n\n// allow encoding by pressing Ctrl+Enter in textarea\ninputText.addEventListener('keydown', (e)=> {\n  if (e.ctrlKey && e.key === 'Enter') {\n    nodeIdCounter = 0;\n    buildFromInput();\n  }\n});\n\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Huffman Coding"
    }
  ],
  "topic": "Huffman Coding",
  "hasFSM": false,
  "hasTest": true
}