{
  "id": "2bde4386-cd36-11f0-b98e-a1744d282049",
  "timestamp": "2025-11-29T15:16:38.966Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Merge Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\" />\n<title>Merge Sort Visualizer</title>\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n<style>\n  :root{\n    --bg:#0f1724;\n    --panel:#0b1220;\n    --muted:#94a3b8;\n    --accent:#06b6d4;\n    --bar:#3b82f6;\n    --compare:#f97316;\n    --write:#ef4444;\n    --merged:#10b981;\n    --text:#e6eef8;\n  }\n  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#071027);font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,\"Helvetica Neue\",Arial;}\n  .container{max-width:1100px;margin:20px auto;padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:0 6px 30px rgba(2,6,23,0.6);}\n  h1{color:var(--text);margin:0 0 10px;font-size:20px;}\n  .top{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:12px;}\n  .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;}\n  .btn{background:var(--panel);color:var(--text);border:1px solid rgba(255,255,255,0.03);padding:8px 12px;border-radius:8px;cursor:pointer;}\n  .btn:hover{filter:brightness(1.05)}\n  .btn:active{transform:translateY(1px)}\n  .sliderRow{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:13px;}\n  input[type=range]{accent-color:var(--accent);cursor:pointer}\n  .stats{margin-left:auto;color:var(--muted);font-size:13px;display:flex;gap:12px;align-items:center;}\n  .visualArea{height:320px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.007),rgba(255,255,255,0.003));padding:12px;margin-top:12px;display:flex;align-items:flex-end;overflow:hidden;position:relative;}\n  .bar{flex:1 1 auto;margin:0 2px;background:var(--bar);height:40px;border-radius:4px;display:flex;align-items:flex-end;justify-content:center;color:transparent;font-size:11px;transition:height 200ms ease, background 120ms;}\n  .barValue{font-size:11px;color:transparent;}\n  .bar.compare{background:var(--compare);color:#000;}\n  .bar.write{background:var(--write);color:#000;}\n  .bar.merged{background:var(--merged);color:#000;}\n  .rangeOverlay{position:absolute;left:0;top:0;height:100%;border-radius:6px;pointer-events:none;mix-blend-mode:overlay;opacity:0.08;}\n  .infoRow{display:flex;gap:18px;align-items:center;margin-top:12px;flex-wrap:wrap;}\n  .panel{background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;color:var(--muted);flex:1;min-width:260px}\n  .panel h3{color:var(--text);margin:0 0 8px;font-size:14px}\n  .pcode{background:#061225;padding:12px;border-radius:8px;color:#cfe8ff;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,\"Liberation Mono\",\"Courier New\",monospace;font-size:13px;line-height:1.45;overflow:auto;max-height:220px}\n  .line{padding:2px 6px;border-radius:4px}\n  .line.active{background:linear-gradient(90deg,rgba(6,182,212,0.12),rgba(16,185,129,0.06));color:#eaffff}\n  .legend{display:flex;gap:10px;align-items:center;color:var(--muted);font-size:13px;margin-top:8px}\n  .legendItem{display:flex;gap:6px;align-items:center}\n  .swatch{width:14px;height:14px;border-radius:3px;}\n  .footer{color:var(--muted);font-size:13px;margin-top:12px}\n  .small{font-size:12px;color:var(--muted)}\n  @media (max-width:700px){.visualArea{height:220px}}\n</style>\n</head>\n<body>\n<div class=\"container\">\n  <div style=\"display:flex;align-items:flex-start;gap:12px;\">\n    <div style=\"flex:1\">\n      <h1>Merge Sort â€” Interactive Visualizer</h1>\n      <div class=\"small\">Watch how Merge Sort divides the array, compares elements, and merges sorted subarrays. Use controls to step, play/pause, and adjust speed/size.</div>\n    </div>\n    <div style=\"width:220px;text-align:right;\">\n      <div class=\"small\" style=\"color:var(--muted)\">Time Complexity: O(n log n)</div>\n      <div class=\"small\" style=\"color:var(--muted)\">Space Complexity: O(n)</div>\n    </div>\n  </div>\n\n  <div class=\"top\">\n    <div class=\"controls\">\n      <button class=\"btn\" id=\"newArrayBtn\">New Array</button>\n      <button class=\"btn\" id=\"startPauseBtn\">Start</button>\n      <button class=\"btn\" id=\"stepBtn\">Step</button>\n      <button class=\"btn\" id=\"resetBtn\">Reset</button>\n      <div style=\"width:1px;background:rgba(255,255,255,0.04);height:28px;margin:0 8px\"></div>\n      <div class=\"sliderRow\"><label class=\"small\">Size</label><input id=\"sizeRange\" type=\"range\" min=\"8\" max=\"120\" value=\"40\"></div>\n      <div class=\"sliderRow\"><label class=\"small\">Speed</label><input id=\"speedRange\" type=\"range\" min=\"1\" max=\"1000\" value=\"200\"></div>\n    </div>\n\n    <div class=\"stats\">\n      <div id=\"compCount\">Comparisons: 0</div>\n      <div id=\"writeCount\">Writes: 0</div>\n      <div id=\"actionCount\">Steps: 0</div>\n    </div>\n  </div>\n\n  <div class=\"visualArea\" id=\"visualArea\" aria-hidden=\"false\"></div>\n\n  <div class=\"infoRow\">\n    <div class=\"panel\" style=\"flex:1.5\">\n      <h3>Controls & Stats</h3>\n      <div class=\"small\" style=\"margin-bottom:8px\">Use \"Step\" to advance one algorithm action. \"Start\" runs continuously. You can change size or regenerate array anytime (it will stop the current run).</div>\n      <div style=\"display:flex;gap:8px;flex-wrap:wrap\">\n        <div class=\"small\">Array Size: <strong id=\"sizeLabel\">40</strong></div>\n        <div class=\"small\">Speed (ms per step): <strong id=\"speedLabel\">200</strong></div>\n        <div class=\"small\">Status: <strong id=\"statusLabel\">Ready</strong></div>\n      </div>\n\n      <div class=\"legend\">\n        <div class=\"legendItem\"><div class=\"swatch\" style=\"background:var(--bar)\"></div><div class=\"small\">Unsorted</div></div>\n        <div class=\"legendItem\"><div class=\"swatch\" style=\"background:var(--compare)\"></div><div class=\"small\">Comparing</div></div>\n        <div class=\"legendItem\"><div class=\"swatch\" style=\"background:var(--write)\"></div><div class=\"small\">Writing / Overwriting</div></div>\n        <div class=\"legendItem\"><div class=\"swatch\" style=\"background:var(--merged)\"></div><div class=\"small\">Merged (finalized)</div></div>\n      </div>\n    </div>\n\n    <div class=\"panel\" style=\"flex:1.6\">\n      <h3>Pseudo-code (Merge Sort)</h3>\n      <div class=\"pcode\" id=\"pseudocode\">\n        <div class=\"line\" id=\"line1\">1. mergeSort(A, left, right):</div>\n        <div class=\"line\" id=\"line2\">2. &nbsp;&nbsp;if left >= right: return</div>\n        <div class=\"line\" id=\"line3\">3. &nbsp;&nbsp;mid = (left + right) // 2</div>\n        <div class=\"line\" id=\"line4\">4. &nbsp;&nbsp;mergeSort(A, left, mid)</div>\n        <div class=\"line\" id=\"line5\">5. &nbsp;&nbsp;mergeSort(A, mid+1, right)</div>\n        <div class=\"line\" id=\"line6\">6. &nbsp;&nbsp;merge the two sorted halves into A[left..right]</div>\n        <div class=\"line\" id=\"line7\">7. &nbsp;&nbsp;-- Use temporary array, compare heads and copy smaller into A</div>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"footer\">\n    Tip: Try small array sizes and slow speeds when stepping to see the division/merge boundaries clearly.\n  </div>\n</div>\n\n<script>\n(() => {\n  // DOM elements\n  const visualArea = document.getElementById('visualArea');\n  const newArrayBtn = document.getElementById('newArrayBtn');\n  const startPauseBtn = document.getElementById('startPauseBtn');\n  const stepBtn = document.getElementById('stepBtn');\n  const resetBtn = document.getElementById('resetBtn');\n  const sizeRange = document.getElementById('sizeRange');\n  const speedRange = document.getElementById('speedRange');\n  const compCountEl = document.getElementById('compCount');\n  const writeCountEl = document.getElementById('writeCount');\n  const actionCountEl = document.getElementById('actionCount');\n  const sizeLabel = document.getElementById('sizeLabel');\n  const speedLabel = document.getElementById('speedLabel');\n  const statusLabel = document.getElementById('statusLabel');\n  const pseudocode = {\n    1: document.getElementById('line1'),\n    2: document.getElementById('line2'),\n    3: document.getElementById('line3'),\n    4: document.getElementById('line4'),\n    5: document.getElementById('line5'),\n    6: document.getElementById('line6'),\n    7: document.getElementById('line7'),\n  };\n\n  // App state\n  let SIZE = parseInt(sizeRange.value,10);\n  let SPEED = parseInt(speedRange.value,10);\n  let array = [];\n  let bars = [];\n  let gen = null;\n  let timer = null;\n  let running = false;\n  let counts = {comparisons:0, writes:0, actions:0};\n  let mergedRanges = []; // list of [l,r] ranges currently finalized\n\n  // Initialize\n  sizeLabel.textContent = SIZE;\n  speedLabel.textContent = SPEED;\n  createArray();\n\n  // Utility: random array\n  function createArray() {\n    stop();\n    mergedRanges = [];\n    counts = {comparisons:0,writes:0,actions:0};\n    updateCounts();\n    statusLabel.textContent = 'Ready';\n    array = [];\n    const maxVal = 300;\n    for (let i=0;i<SIZE;i++){\n      array.push( Math.floor(10 + Math.random()*(maxVal-10)) );\n    }\n    renderArray();\n    gen = null;\n    startPauseBtn.textContent = 'Start';\n    clearCodeHighlight();\n  }\n\n  function renderArray(){\n    visualArea.innerHTML = '';\n    bars = [];\n    // create bars with proportional widths\n    const gap = 4;\n    const areaWidth = visualArea.clientWidth;\n    const barWidth = Math.max(4, Math.floor((areaWidth - SIZE*gap) / SIZE));\n    const maxVal = Math.max(...array, 1);\n    for (let i=0;i<array.length;i++){\n      const b = document.createElement('div');\n      b.className = 'bar';\n      b.style.width = (barWidth) + 'px';\n      b.style.marginLeft = (i===0?0:gap/2+'px');\n      b.style.marginRight = (i===array.length-1?0:gap/2+'px');\n      b.dataset.index = i;\n      b.style.height = Math.round((array[i] / maxVal) * (visualArea.clientHeight - 24)) + 24 + 'px';\n      b.title = String(array[i]);\n      visualArea.appendChild(b);\n      bars.push(b);\n    }\n  }\n\n  // Generator that yields actions describing Merge Sort steps.\n  // Action types:\n  // {type:'enter', left, right} - entering recursion on range\n  // {type:'exit', left, right} - finishing recursion (range merged)\n  // {type:'compare', i, j} - comparison between indices\n  // {type:'overwrite', index, value} - write value into index (overwriting original)\n  // This generator works on a copy of the array to compute decisions.\n  function* mergeSortGenerator(arrCopy, left=0, right=arrCopy.length-1) {\n    yield {type:'enter', left, right};\n    if (left >= right) {\n      // Single element, trivially sorted\n      yield {type:'exit', left, right};\n      return;\n    }\n    const mid = Math.floor((left+right)/2);\n    yield* mergeSortGenerator(arrCopy, left, mid);\n    yield* mergeSortGenerator(arrCopy, mid+1, right);\n\n    // Merge step: standard merge using temp array\n    let i = left, j = mid+1;\n    const temp = [];\n    while (i <= mid && j <= right) {\n      yield {type:'compare', i, j};\n      if (arrCopy[i] <= arrCopy[j]) {\n        temp.push(arrCopy[i]);\n        i++;\n      } else {\n        temp.push(arrCopy[j]);\n        j++;\n      }\n    }\n    while (i <= mid) {\n      temp.push(arrCopy[i]);\n      i++;\n    }\n    while (j <= right) {\n      temp.push(arrCopy[j]);\n      j++;\n    }\n    // Overwrite back into arrCopy and yield overwrites for animation\n    for (let k=0;k<temp.length;k++){\n      yield {type:'overwrite', index: left + k, value: temp[k]};\n      arrCopy[left + k] = temp[k];\n    }\n    yield {type:'exit', left, right};\n  }\n\n  // Apply one action to the visualization\n  function applyAction(action){\n    counts.actions++;\n    actionCountEl.textContent = 'Steps: ' + counts.actions;\n    clearCodeHighlight();\n    switch(action.type){\n      case 'enter':\n        statusLabel.textContent = `Descending: [${action.left}, ${action.right}]`;\n        highlightCodeLine(3); // mid line\n        // mark this range subtly by opacity overlay\n        // We'll not create overlay per-enter to avoid clutter.\n        break;\n      case 'exit':\n        statusLabel.textContent = `Merged: [${action.left}, ${action.right}]`;\n        highlightCodeLine(6);\n        // mark bars in this range as merged (green)\n        mergedRanges.push([action.left, action.right]);\n        for (let idx = action.left; idx <= action.right; idx++){\n          const b = bars[idx];\n          if (b) {\n            b.classList.remove('compare','write');\n            b.classList.add('merged');\n            b.title = b.dataset.value || b.title;\n          }\n        }\n        break;\n      case 'compare':\n        counts.comparisons++;\n        compCountEl.textContent = 'Comparisons: ' + counts.comparisons;\n        highlightCodeLine(7);\n        // highlight the two bars being compared\n        markCompare(action.i, action.j);\n        break;\n      case 'overwrite':\n        counts.writes++;\n        writeCountEl.textContent = 'Writes: ' + counts.writes;\n        highlightCodeLine(6);\n        // visually overwrite the bar at index with new value\n        animateWrite(action.index, action.value);\n        break;\n      default:\n        break;\n    }\n  }\n\n  function markCompare(i, j){\n    // remove previous compare classes\n    bars.forEach(b=>b.classList.remove('compare'));\n    if (bars[i]) bars[i].classList.add('compare');\n    if (bars[j]) bars[j].classList.add('compare');\n  }\n\n  function animateWrite(index, value){\n    // remove compare classes on that bar\n    const b = bars[index];\n    if (!b) return;\n    // set height accordingly\n    const maxVal =  Math.max(...array, value, 1);\n    // Update underlying displayed array so subsequent height scaling is coherent\n    // But we keep original 'array' for display only; generator supplies final values.\n    array[index] = value;\n    const targetH = Math.round((array[index] / maxVal) * (visualArea.clientHeight - 24)) + 24;\n    b.style.height = targetH + 'px';\n    b.classList.remove('compare');\n    b.classList.add('write');\n    b.title = String(value);\n    // After a short while, if index is within a merged range, mark merged, else revert\n    setTimeout(()=>{\n      // determine if this index lies in any merged range\n      let inMerged = false;\n      for (const [L,R] of mergedRanges){\n        if (index >= L && index <= R){ inMerged = true; break; }\n      }\n      b.classList.remove('write');\n      if (inMerged) b.classList.add('merged');\n      else b.classList.remove('merged');\n    }, Math.max(60, SPEED/2));\n  }\n\n  function updateCounts(){\n    compCountEl.textContent = 'Comparisons: ' + counts.comparisons;\n    writeCountEl.textContent = 'Writes: ' + counts.writes;\n    actionCountEl.textContent = 'Steps: ' + counts.actions;\n  }\n\n  function stopTimer(){\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n    running = false;\n    startPauseBtn.textContent = 'Start';\n  }\n\n  function stop(){\n    stopTimer();\n    statusLabel.textContent = 'Stopped';\n  }\n\n  function start(){\n    if (!gen) {\n      // Prepare generator working on a copy of current displayed array\n      const copy = array.slice();\n      gen = mergeSortGenerator(copy, 0, copy.length - 1);\n      mergedRanges = [];\n      counts = {comparisons:0,writes:0,actions:0};\n      updateCounts();\n    }\n    if (running) return;\n    running = true;\n    startPauseBtn.textContent = 'Pause';\n    statusLabel.textContent = 'Running';\n    timer = setInterval(()=> {\n      step();\n    }, Math.max(1, SPEED));\n  }\n\n  function pause(){\n    stopTimer();\n    statusLabel.textContent = 'Paused';\n  }\n\n  function step(){\n    if (!gen) {\n      // initialize generator but do not start timer\n      const copy = array.slice();\n      gen = mergeSortGenerator(copy, 0, copy.length - 1);\n    }\n    const res = gen.next();\n    if (res.done) {\n      // finish\n      // After finished, mark all as merged\n      for (let i=0;i<bars.length;i++){\n        bars[i].classList.remove('compare','write');\n        bars[i].classList.add('merged');\n      }\n      statusLabel.textContent = 'Finished';\n      stopTimer();\n      highlightCodeLine(null);\n      return;\n    }\n    applyAction(res.value);\n  }\n\n  // Hook up UI events\n  newArrayBtn.addEventListener('click', () => {\n    SIZE = parseInt(sizeRange.value,10);\n    sizeLabel.textContent = SIZE;\n    createArray();\n  });\n\n  startPauseBtn.addEventListener('click', () => {\n    if (running){\n      pause();\n    } else {\n      start();\n    }\n  });\n\n  stepBtn.addEventListener('click', () => {\n    if (running){\n      // if running, stepping should pause first\n      pause();\n    }\n    step();\n  });\n\n  resetBtn.addEventListener('click', () => {\n    stop();\n    gen = null;\n    createArray();\n  });\n\n  sizeRange.addEventListener('input', (e) => {\n    SIZE = parseInt(e.target.value,10);\n    sizeLabel.textContent = SIZE;\n  });\n\n  speedRange.addEventListener('input', (e) => {\n    SPEED = parseInt(e.target.value,10);\n    speedLabel.textContent = SPEED;\n    if (running) {\n      // restart interval with new speed\n      stopTimer();\n      timer = setInterval(()=> step(), Math.max(1, SPEED));\n      running = true;\n      startPauseBtn.textContent = 'Pause';\n    }\n  });\n\n  // Pseudocode highlighting helpers\n  function highlightCodeLine(num){\n    Object.values(pseudocode).forEach(el=>el.classList.remove('active'));\n    if (!num) return;\n    const el = pseudocode[num];\n    if (el) el.classList.add('active');\n  }\n  function clearCodeHighlight(){ Object.values(pseudocode).forEach(el=>el.classList.remove('active')); }\n\n  // Resize handling - re-render bars to fit\n  let resizeTimeout = null;\n  window.addEventListener('resize', () => {\n    clearTimeout(resizeTimeout);\n    resizeTimeout = setTimeout(() => {\n      renderArray();\n    }, 120);\n  });\n\n  // Initialize first render on load: create array with default size\n  createArray();\n\n  // Accessibility: keyboard shortcuts\n  window.addEventListener('keydown', (e) => {\n    if (e.key === ' ') {\n      e.preventDefault();\n      if (running) pause(); else start();\n    } else if (e.key === 'ArrowRight') {\n      e.preventDefault();\n      if (running) pause();\n      step();\n    } else if (e.key === 'n') {\n      createArray();\n    }\n  });\n\n  // Small note: If the generator yields comparisons and there are many steps per second,\n  // the visual highlight can be very quick. Slowing speed or stepping gives clearer view.\n\n})();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Merge Sort"
    }
  ],
  "topic": "Merge Sort",
  "hasFSM": false,
  "hasTest": true
}