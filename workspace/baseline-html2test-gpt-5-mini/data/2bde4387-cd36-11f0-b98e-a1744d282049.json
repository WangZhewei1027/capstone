{
  "id": "2bde4387-cd36-11f0-b98e-a1744d282049",
  "timestamp": "2025-11-29T15:16:53.522Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Quick Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <title>Quick Sort Visualizer</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n  <style>\n    :root{\n      --bg:#0f1724;\n      --panel:#0b1220;\n      --accent:#3b82f6;\n      --muted:#94a3b8;\n      --bar:#60a5fa;\n      --pivot:#ef4444;\n      --compare:#f59e0b;\n      --swap:#fb923c;\n      --sorted:#10b981;\n      --range:#1e293b;\n      font-family: system-ui, -apple-system, Segoe UI, Roboto, \"Helvetica Neue\", Arial;\n    }\n    *{box-sizing:border-box}\n    html,body{height:100%;margin:0;background:linear-gradient(180deg,#06111d 0%, #071328 100%);color:#e6eef6}\n    .app{\n      max-width:1100px;margin:28px auto;padding:20px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));\n      border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03);\n    }\n    .header{display:flex;align-items:center;gap:16px;margin-bottom:12px}\n    h1{font-size:20px;margin:0}\n    .controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center}\n    button{background:var(--accent);color:white;border:0;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600}\n    button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:6px 10px}\n    button:disabled{opacity:0.45;cursor:not-allowed}\n    .panel{padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:10px;margin-top:12px}\n    .top-controls{display:flex;gap:14px;align-items:center;flex-wrap:wrap}\n    .control-row{display:flex;gap:10px;align-items:center}\n    label{font-size:13px;color:var(--muted)}\n    input[type=\"range\"]{cursor:pointer}\n    .visual{\n      height:360px;margin-top:14px;border-radius:8px;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.06));\n      display:flex;align-items:flex-end;gap:6px;overflow:hidden;border:1px solid rgba(255,255,255,0.03)\n    }\n    .bar{\n      background:var(--bar);flex:1 1 auto;border-radius:6px 6px 2px 2px;display:flex;align-items:flex-end;justify-content:center;color:#03263f;font-weight:700;font-size:11px;\n      transition:height 150ms ease, background-color 120ms;\n      min-width:6px;\n    }\n    .bar.pivot{background:linear-gradient(180deg,var(--pivot),#f87171);color:white}\n    .bar.compare{background:linear-gradient(180deg,var(--compare),#facc15);color:#111827}\n    .bar.swap{background:linear-gradient(180deg,var(--swap),#fb923c);color:#111827}\n    .bar.sorted{background:linear-gradient(180deg,var(--sorted),#34d399);color:#012509}\n    .bar.range{outline:2px solid rgba(96,165,250,0.12);box-shadow:0 6px 18px rgba(59,130,246,0.06)}\n    .status{display:flex;gap:12px;align-items:center;margin-top:10px;flex-wrap:wrap}\n    .badge{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:8px;font-size:13px;color:var(--muted)}\n    .code{margin-top:12px;padding:12px;background:#031325;border-radius:8px;font-family:monospace;color:#cbd5e1;font-size:13px;white-space:pre-wrap}\n    .stack{margin-left:8px;font-size:13px;color:var(--muted)}\n    .legend{display:flex;gap:8px;align-items:center;margin-top:8px;flex-wrap:wrap}\n    .legend span{display:inline-flex;gap:6px;align-items:center;background:rgba(255,255,255,0.02);padding:6px 8px;border-radius:8px;font-size:13px;color:var(--muted)}\n    .keycolor{width:14px;height:14px;border-radius:3px;display:inline-block}\n    .footer{margin-top:10px;font-size:13px;color:var(--muted)}\n    @media (max-width:700px){\n      .visual{height:260px}\n      .bar{font-size:10px}\n    }\n  </style>\n</head>\n<body>\n  <div class=\"app\">\n    <div class=\"header\">\n      <h1>Quick Sort Visualizer</h1>\n      <div style=\"color:var(--muted);font-size:13px\">Visual demonstration of Lomuto quick sort (last-element pivot). Toggle random pivot to use a random pivot.</div>\n    </div>\n\n    <div class=\"panel\">\n      <div class=\"top-controls\">\n        <div class=\"control-row\">\n          <label for=\"size\">Array size</label>\n          <input id=\"size\" type=\"range\" min=\"6\" max=\"80\" value=\"32\">\n        </div>\n\n        <div class=\"control-row\">\n          <label for=\"speed\">Speed</label>\n          <input id=\"speed\" type=\"range\" min=\"10\" max=\"1000\" value=\"180\">\n        </div>\n\n        <div class=\"control-row\">\n          <label style=\"display:flex;gap:8px;align-items:center\">\n            <input id=\"randomPivot\" type=\"checkbox\"> Use random pivot\n          </label>\n        </div>\n\n        <div style=\"margin-left:auto;display:flex;gap:8px\">\n          <button id=\"randomize\">Randomize</button>\n          <button id=\"start\">Start</button>\n          <button id=\"pause\" class=\"secondary\" disabled>Pause</button>\n          <button id=\"step\" class=\"secondary\">Step</button>\n        </div>\n      </div>\n\n      <div class=\"visual\" id=\"visual\" aria-hidden=\"false\"></div>\n\n      <div class=\"status\">\n        <div class=\"badge\" id=\"actionState\">Idle</div>\n        <div class=\"badge\">Actions: <span id=\"actionCount\">0</span></div>\n        <div class=\"badge\">Progress: <span id=\"progress\">0/0</span></div>\n        <div class=\"badge\">Recursive stack:\n          <span class=\"stack\" id=\"stackDisplay\">[]</span>\n        </div>\n      </div>\n\n      <div class=\"legend\">\n        <span><i class=\"keycolor\" style=\"background:var(--pivot)\"></i> pivot</span>\n        <span><i class=\"keycolor\" style=\"background:var(--compare)\"></i> comparing</span>\n        <span><i class=\"keycolor\" style=\"background:var(--swap)\"></i> swapping</span>\n        <span><i class=\"keycolor\" style=\"background:var(--sorted)\"></i> placed/final</span>\n        <span><i class=\"keycolor\" style=\"background:var(--range)\"></i> current partition</span>\n      </div>\n\n      <div class=\"code\" id=\"pseudocode\">\nQuick Sort (Lomuto partition)\nfunction quickSort(a, low, high):\n  if low < high:\n    pivot = a[high]\n    p = partition(a, low, high)\n    quickSort(a, low, p - 1)\n    quickSort(a, p + 1, high)\n\nfunction partition(a, low, high):\n  pivot = a[high]\n  i = low - 1\n  for j = low to high-1:\n    if a[j] <= pivot:\n      i = i + 1\n      swap a[i], a[j]\n  swap a[i+1], a[high]\n  return i+1\n      </div>\n    </div>\n\n    <div class=\"footer\">Tip: Use \"Step\" to move one action at a time. \"Pause\" toggles playback. Adjust speed for faster/slower animation.</div>\n  </div>\n\n  <script>\n    (function(){\n      // Elements\n      const visual = document.getElementById('visual');\n      const sizeInput = document.getElementById('size');\n      const speedInput = document.getElementById('speed');\n      const randomizeBtn = document.getElementById('randomize');\n      const startBtn = document.getElementById('start');\n      const pauseBtn = document.getElementById('pause');\n      const stepBtn = document.getElementById('step');\n      const actionState = document.getElementById('actionState');\n      const actionCount = document.getElementById('actionCount');\n      const progressEl = document.getElementById('progress');\n      const stackDisplay = document.getElementById('stackDisplay');\n      const randomPivotCheckbox = document.getElementById('randomPivot');\n\n      // State\n      let array = [];\n      let bars = [];\n      let actions = []; // sequence of actions generated by algorithm\n      let playing = false;\n      let paused = false;\n      let currentAction = 0;\n      let timer = null;\n      let stepRequested = false;\n\n      function createArray(n){\n        const arr = [];\n        for(let i=0;i<n;i++){\n          arr.push(Math.floor(Math.random()*90)+10); // 10..99\n        }\n        return arr;\n      }\n\n      function renderArray(a){\n        visual.innerHTML = '';\n        bars = [];\n        const max = Math.max(...a);\n        a.forEach((v, idx) => {\n          const bar = document.createElement('div');\n          bar.className = 'bar';\n          bar.style.height = ((v/max)*100) + '%';\n          bar.textContent = v;\n          bar.dataset.index = idx;\n          bar.dataset.value = v;\n          visual.appendChild(bar);\n          bars.push(bar);\n        });\n      }\n\n      function setBarClass(i, cls){\n        if(i == null || !bars[i]) return;\n        bars[i].className = 'bar ' + cls;\n      }\n\n      function clearBarClasses(i){\n        if(i == null || !bars[i]) return;\n        bars[i].className = 'bar';\n      }\n\n      function swapBars(i,j){\n        if(i==j) return;\n        // swap displayed heights and labels and dataset.value\n        const bi = bars[i], bj = bars[j];\n        const hi = bi.style.height, hj = bj.style.height;\n        const ti = bi.textContent, tj = bj.textContent;\n        bi.style.height = hj; bi.textContent = tj; bi.dataset.value = bj.dataset.value;\n        bj.style.height = hi; bj.textContent = ti; bj.dataset.value = bi.dataset.value;\n      }\n\n      // Action types:\n      // {type:'range', low, high} -> highlight current partition range\n      // {type:'pivot', index}\n      // {type:'compare', i, j}\n      // {type:'swap', i, j}\n      // {type:'markSorted', index}\n      // {type:'clear'} clear highlights\n      // {type:'stack', stackArray} show recursion stack\n      // {type:'done'}\n      function generateActionsFromQuickSort(origArr, useRandomPivot){\n        const a = origArr.slice();\n        const acts = [];\n        const stack = [];\n\n        function push(action){\n          acts.push(action);\n        }\n\n        function pushStack(){\n          push({type:'stack', stack:stack.slice()});\n        }\n\n        function partition(low, high){\n          // Lomuto, optionally random pivot (swap random with high)\n          if(useRandomPivot){\n            const r = Math.floor(Math.random()*(high - low + 1)) + low;\n            if(r !== high){\n              push({type:'range', low, high});\n              push({type:'compare', i:r, j:high});\n              push({type:'swap', i:r, j:high});\n              const tmp = a[r]; a[r]=a[high]; a[high]=tmp;\n              push({type:'clear'});\n            }\n          }\n          push({type:'range', low, high});\n          const pivotVal = a[high];\n          push({type:'pivot', index:high});\n          let i = low - 1;\n          for(let j=low;j<=high-1;j++){\n            push({type:'compare', i:j, j:high});\n            if(a[j] <= pivotVal){\n              i++;\n              if(i !== j){\n                push({type:'swap', i:i, j:j});\n                const tmp = a[i]; a[i]=a[j]; a[j]=tmp;\n              } else {\n                // even if same index, still show an informative action to highlight\n                push({type:'compare', i:i, j:j});\n              }\n            }\n          }\n          push({type:'swap', i:i+1, j:high});\n          const tmp = a[i+1]; a[i+1]=a[high]; a[high]=tmp;\n          push({type:'markSorted', index:i+1});\n          push({type:'clear'});\n          return i+1;\n        }\n\n        function quick(low, high){\n          if(low < high){\n            stack.push([low,high]); pushStack();\n            const p = partition(low, high);\n            // mark pivot placed (already did markSorted)\n            // remove top of stack as we've handled this node before recursing\n            stack.pop(); pushStack();\n            quick(low, p-1);\n            quick(p+1, high);\n          } else {\n            // if single element, it's in final position\n            if(low === high){\n              push({type:'markSorted', index:low});\n            }\n          }\n        }\n\n        push({type:'clear'});\n        quick(0, a.length - 1);\n        push({type:'done'});\n        return acts;\n      }\n\n      function resetUI(){\n        actionState.textContent = 'Idle';\n        actionCount.textContent = actions.length;\n        progressEl.textContent = `${currentAction}/${actions.length}`;\n        stackDisplay.textContent = '[]';\n      }\n\n      function applyAction(act){\n        switch(act.type){\n          case 'range':\n            // highlight range\n            for(let i=0;i<bars.length;i++){\n              if(i>=act.low && i<=act.high) bars[i].classList.add('range');\n              else bars[i].classList.remove('range');\n            }\n            actionState.textContent = `Processing range [${act.low}, ${act.high}]`;\n            break;\n          case 'pivot':\n            // mark pivot\n            for(let i=0;i<bars.length;i++){\n              bars[i].classList.remove('pivot');\n            }\n            if(bars[act.index]) bars[act.index].classList.add('pivot');\n            actionState.textContent = `Pivot at index ${act.index}`;\n            break;\n          case 'compare':\n            // brief compare highlight\n            for(let i=0;i<bars.length;i++){\n              bars[i].classList.remove('compare');\n            }\n            if(bars[act.i]) bars[act.i].classList.add('compare');\n            if(bars[act.j]) bars[act.j].classList.add('compare');\n            actionState.textContent = `Comparing index ${act.i} with ${act.j}`;\n            break;\n          case 'swap':\n            // animate swap visually by swapping heights and labels\n            if(bars[act.i] && bars[act.j]){\n              bars[act.i].classList.add('swap');\n              bars[act.j].classList.add('swap');\n              // delay visually handled by the main player\n              swapBars(act.i, act.j);\n            }\n            actionState.textContent = `Swapped ${act.i} â†” ${act.j}`;\n            break;\n          case 'markSorted':\n            if(bars[act.index]){\n              bars[act.index].className = 'bar sorted';\n            }\n            actionState.textContent = `Placed element at index ${act.index}`;\n            break;\n          case 'clear':\n            // clear range/pivot/compare/swap classes except 'sorted'\n            for(let i=0;i<bars.length;i++){\n              if(!bars[i].classList.contains('sorted')){\n                bars[i].className = 'bar';\n              } else {\n                // keep sorted class only\n                bars[i].className = 'bar sorted';\n              }\n            }\n            actionState.textContent = '...';\n            break;\n          case 'stack':\n            stackDisplay.textContent = JSON.stringify(act.stack);\n            break;\n          case 'done':\n            actionState.textContent = 'Done';\n            // mark everything sorted\n            for(let i=0;i<bars.length;i++){\n              bars[i].className = 'bar sorted';\n            }\n            break;\n        }\n      }\n\n      function sleep(ms){\n        return new Promise(resolve => setTimeout(resolve, ms));\n      }\n\n      async function play(){\n        playing = true;\n        paused = false;\n        pauseBtn.disabled = false;\n        startBtn.disabled = true;\n        randomizeBtn.disabled = true;\n        sizeInput.disabled = true;\n        speedInput.disabled = true;\n        stepBtn.disabled = true;\n        randomPivotCheckbox.disabled = true;\n\n        const total = actions.length;\n        actionCount.textContent = total;\n        while(currentAction < actions.length && playing){\n          if(paused){\n            await sleep(50);\n            continue;\n          }\n          const act = actions[currentAction];\n          applyAction(act);\n          currentAction++;\n          progressEl.textContent = `${currentAction}/${total}`;\n          // when stepping, pause after one action\n          if(stepRequested){\n            stepRequested = false;\n            paused = true;\n            pauseBtn.textContent = 'Resume';\n            break;\n          }\n          // control timing: speed inverted: higher speed -> smaller delay\n          const speedVal = Number(speedInput.value); // 10..1000\n          const delay = Math.max(6, speedVal); // in ms between actions\n          // Give extra time for swap visuals to be noticeable\n          if(act.type === 'swap') {\n            await sleep(Math.max(30, delay+40));\n          } else {\n            await sleep(Math.max(10, delay));\n          }\n        }\n\n        if(currentAction >= actions.length){\n          playing = false;\n          paused = false;\n          pauseBtn.disabled = true;\n          startBtn.disabled = false;\n          randomizeBtn.disabled = false;\n          sizeInput.disabled = false;\n          speedInput.disabled = false;\n          stepBtn.disabled = false;\n          randomPivotCheckbox.disabled = false;\n          pauseBtn.textContent = 'Pause';\n        }\n      }\n\n      // Controls\n      sizeInput.addEventListener('input', () => {\n        const n = Number(sizeInput.value);\n        array = createArray(n);\n        renderArray(array);\n        actions = [];\n        currentAction = 0;\n        resetUI();\n      });\n\n      randomizeBtn.addEventListener('click', () => {\n        const n = Number(sizeInput.value);\n        array = createArray(n);\n        renderArray(array);\n        actions = [];\n        currentAction = 0;\n        resetUI();\n      });\n\n      startBtn.addEventListener('click', () => {\n        if(playing && !paused){\n          // already playing\n          return;\n        }\n        // If not started or finished, generate actions\n        if(actions.length === 0 || currentAction >= actions.length){\n          // build actions\n          actions = generateActionsFromQuickSort(array, randomPivotCheckbox.checked);\n          currentAction = 0;\n        }\n        paused = false;\n        pauseBtn.textContent = 'Pause';\n        play();\n      });\n\n      pauseBtn.addEventListener('click', () => {\n        if(!playing) return;\n        paused = !paused;\n        pauseBtn.textContent = paused ? 'Resume' : 'Pause';\n      });\n\n      stepBtn.addEventListener('click', ()=>{\n        // If not generated yet, create actions\n        if(actions.length === 0 || currentAction >= actions.length){\n          actions = generateActionsFromQuickSort(array, randomPivotCheckbox.checked);\n          currentAction = 0;\n        }\n        // If not playing, set playing and pause after one action\n        if(!playing){\n          // ensure UI locked for single step\n          playing = true;\n          pauseBtn.disabled = true;\n          startBtn.disabled = true;\n          randomizeBtn.disabled = true;\n          sizeInput.disabled = true;\n          speedInput.disabled = true;\n          randomPivotCheckbox.disabled = true;\n        }\n        stepRequested = true;\n        paused = false;\n        play().then(()=>{\n          // After stepping, re-enable certain controls if finished\n          if(!playing){\n            pauseBtn.disabled = true;\n            startBtn.disabled = false;\n            randomizeBtn.disabled = false;\n            sizeInput.disabled = false;\n            speedInput.disabled = false;\n            randomPivotCheckbox.disabled = false;\n            pauseBtn.textContent = 'Pause';\n          } else {\n            // keep controls locked while stepping in the middle\n            pauseBtn.disabled = false;\n          }\n          // Pause after one action\n          paused = true;\n          playing = true;\n          pauseBtn.textContent = 'Resume';\n        });\n      });\n\n      // initial setup\n      array = createArray(Number(sizeInput.value));\n      renderArray(array);\n      resetUI();\n\n      // expose for debugging (optional)\n      window._qs = {\n        gen: generateActionsFromQuickSort,\n        array,\n        actions\n      };\n\n    })();\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Quick Sort"
    }
  ],
  "topic": "Quick Sort",
  "hasFSM": false,
  "hasTest": true
}