{
  "id": "be878a84-cd35-11f0-9e7b-93b903303299",
  "timestamp": "2025-11-29T15:14:01.257Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Priority Queue",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Priority Queue Visualizer (Binary Heap)</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n  <style>\n    :root{\n      --bg:#0f1724;\n      --card:#0b1220;\n      --accent:#3b82f6;\n      --muted:#9ca3af;\n      --text:#e6eef8;\n      --success:#10b981;\n      --danger:#fb7185;\n      --glass: rgba(255,255,255,0.03);\n    }\n    html,body{\n      height:100%;\n      margin:0;\n      font-family: Inter, ui-sans-serif, system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial;\n      background: linear-gradient(180deg, #071226 0%, #07162a 50%, #071226 100%);\n      color:var(--text);\n      -webkit-font-smoothing:antialiased;\n      -moz-osx-font-smoothing:grayscale;\n    }\n    .app {\n      max-width:1100px;\n      margin:24px auto;\n      padding:20px;\n      border-radius:12px;\n      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));\n      box-shadow: 0 6px 30px rgba(2,6,23,0.7);\n      border: 1px solid rgba(255,255,255,0.03);\n    }\n    header {\n      display:flex;\n      gap:16px;\n      align-items:center;\n      margin-bottom:18px;\n    }\n    h1{\n      font-size:20px;\n      margin:0;\n      letter-spacing:0.2px;\n    }\n    p.lead{\n      margin:0;\n      color:var(--muted);\n      font-size:13px;\n    }\n    .controls {\n      display:flex;\n      gap:12px;\n      margin-top:14px;\n      flex-wrap:wrap;\n      align-items:center;\n    }\n    .card {\n      background:var(--card);\n      padding:12px;\n      border-radius:10px;\n      border:1px solid rgba(255,255,255,0.02);\n    }\n    .form-row {\n      display:flex;\n      gap:8px;\n      align-items:center;\n    }\n    input[type=\"text\"], input[type=\"number\"], select {\n      background:var(--glass);\n      border:1px solid rgba(255,255,255,0.03);\n      color:var(--text);\n      padding:8px 10px;\n      border-radius:8px;\n      outline:none;\n      min-width:120px;\n    }\n    button {\n      background:linear-gradient(90deg,var(--accent),#60a5fa);\n      border:none;\n      color:white;\n      padding:8px 12px;\n      border-radius:8px;\n      cursor:pointer;\n      font-weight:600;\n    }\n    button.ghost {\n      background:transparent;\n      border:1px solid rgba(255,255,255,0.06);\n      color:var(--text);\n    }\n    .secondary {\n      background:transparent;\n      border:1px solid rgba(255,255,255,0.06);\n      padding:6px 10px;\n    }\n    .toggle {\n      display:flex;\n      gap:6px;\n      align-items:center;\n    }\n    .main-grid{\n      display:grid;\n      grid-template-columns: 1fr 420px;\n      gap:14px;\n      margin-top:16px;\n    }\n    .vis {\n      min-height:420px;\n      padding:12px;\n      border-radius:10px;\n      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.01));\n      border:1px solid rgba(255,255,255,0.02);\n    }\n    .heap-array {\n      display:flex;\n      gap:8px;\n      align-items:center;\n      flex-wrap:wrap;\n      margin-top:10px;\n    }\n    .cell {\n      min-width:70px;\n      text-align:center;\n      padding:8px;\n      border-radius:8px;\n      background:rgba(255,255,255,0.02);\n      border:1px solid rgba(255,255,255,0.03);\n      font-size:13px;\n    }\n    .cell .idx {\n      display:block;\n      font-size:11px;\n      color:var(--muted);\n    }\n    .cell.highlight {\n      background:linear-gradient(90deg,#0ea5e922,#7c3aed22);\n      border:1px solid rgba(99,102,241,0.55);\n      box-shadow:0 6px 18px rgba(99,102,241,0.06);\n    }\n    svg {\n      width:100%;\n      height:340px;\n      overflow:visible;\n    }\n    .node {\n      cursor:default;\n      transition:transform 200ms ease;\n    }\n    .node circle {\n      fill:linear-gradient(#111827,#0f1724);\n      stroke:rgba(255,255,255,0.04);\n    }\n    .log {\n      margin-top:10px;\n      max-height:160px;\n      overflow:auto;\n      font-size:13px;\n      color:var(--muted);\n      padding:8px;\n      border-radius:8px;\n      background:rgba(255,255,255,0.02);\n    }\n    .meta {\n      display:flex;\n      gap:10px;\n      margin-top:8px;\n      align-items:center;\n      color:var(--muted);\n      font-size:13px;\n    }\n    .badge {\n      background:rgba(255,255,255,0.03);\n      padding:6px 8px;\n      border-radius:8px;\n      border:1px solid rgba(255,255,255,0.02);\n      display:inline-flex;\n      gap:8px;\n      align-items:center;\n      font-weight:600;\n    }\n    .small {\n      font-size:12px;\n      color:var(--muted);\n      margin-left:8px;\n    }\n    .footer {\n      margin-top:14px;\n      font-size:13px;\n      color:var(--muted);\n    }\n    a { color: #60a5fa; text-decoration:none }\n    .hint { color:var(--muted); font-size:13px; margin-top:8px; }\n    .op-btn { padding:7px 10px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--text); cursor:pointer }\n  </style>\n</head>\n<body>\n  <div class=\"app\" role=\"application\" aria-label=\"Priority Queue Visualizer\">\n    <header>\n      <div>\n        <h1>Priority Queue Visualizer</h1>\n        <p class=\"lead\">Binary-heap based priority queue with animated sift-up / sift-down. Supports min/max and stable insertion order.</p>\n        <div class=\"hint\">Push and pop items with a numeric priority. Lower priority = higher priority in \"Min\" mode.</div>\n      </div>\n    </header>\n\n    <div class=\"controls\">\n      <div class=\"card\">\n        <div class=\"form-row\">\n          <input id=\"valueInput\" type=\"text\" placeholder=\"Value (optional)\" />\n          <input id=\"priorityInput\" type=\"number\" placeholder=\"Priority (number)\" />\n          <button id=\"addBtn\">Add</button>\n        </div>\n        <div style=\"margin-top:8px; display:flex; gap:8px; align-items:center;\">\n          <button id=\"addRandBtn\" class=\"ghost\">Add Random</button>\n          <button id=\"bulkRandBtn\" class=\"ghost\">Add 10 Random</button>\n          <button id=\"popBtn\" class=\"secondary\">Pop</button>\n          <button id=\"peekBtn\" class=\"secondary\">Peek</button>\n          <button id=\"clearBtn\" class=\"ghost\">Clear</button>\n        </div>\n      </div>\n\n      <div class=\"card\" style=\"display:flex; gap:10px; align-items:center;\">\n        <div class=\"toggle\">\n          <label style=\"font-size:13px; color:var(--muted);\">Mode:</label>\n          <select id=\"modeSelect\">\n            <option value=\"min\">Min-Heap (smallest priority first)</option>\n            <option value=\"max\">Max-Heap (largest priority first)</option>\n          </select>\n        </div>\n        <div style=\"display:flex; gap:8px; align-items:center;\">\n          <button id=\"rebuildBtn\" class=\"op-btn\">Rebuild</button>\n          <button id=\"demoSeqBtn\" class=\"op-btn\">Demo Sequence</button>\n        </div>\n      </div>\n\n      <div class=\"card\" style=\"padding:10px 12px;\">\n        <div style=\"font-size:13px; margin-bottom:6px\">Stats</div>\n        <div class=\"meta\">\n          <div class=\"badge\">Size: <span id=\"sizeBadge\">0</span></div>\n          <div class=\"badge\">Peek: <span id=\"peekBadge\">—</span></div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"main-grid\">\n      <div class=\"vis card\">\n        <div style=\"display:flex; align-items:center; justify-content:space-between;\">\n          <div style=\"font-weight:700\">Heap Visualization</div>\n          <div style=\"font-size:13px; color:var(--muted)\">Array-backed binary heap</div>\n        </div>\n\n        <div id=\"svgWrap\" style=\"margin-top:8px;\">\n          <svg id=\"heapSvg\" viewBox=\"0 0 1000 400\" preserveAspectRatio=\"xMidYMin meet\"></svg>\n        </div>\n\n        <div style=\"margin-top:12px; font-size:13px; color:var(--muted)\">Array representation (index 0 = root):</div>\n        <div id=\"arrayWrap\" class=\"heap-array\" aria-live=\"polite\"></div>\n\n        <div class=\"log\" id=\"logArea\" aria-live=\"polite\"></div>\n      </div>\n\n      <div class=\"card\">\n        <div style=\"font-weight:700\">Inspector & Actions</div>\n        <div style=\"margin-top:8px; font-size:13px; color:var(--muted)\">Click \"Pop\" to remove the top priority item. Use \"Demo Sequence\" to see example operations animated.</div>\n\n        <div style=\"margin-top:12px; display:flex; gap:8px; align-items:center;\">\n          <button id=\"stepBackBtn\" class=\"ghost\">Step Back</button>\n          <button id=\"playAnimBtn\" class=\"ghost\">Play Animation</button>\n          <button id=\"fastToggleBtn\" class=\"ghost\">Speed: 300ms</button>\n        </div>\n\n        <div style=\"margin-top:12px;\">\n          <div style=\"font-size:13px; color:var(--muted)\">Operation Log:</div>\n          <div id=\"shortLog\" style=\"margin-top:6px; font-size:13px; color:var(--muted)\">(most recent actions shown above)</div>\n        </div>\n\n        <div style=\"margin-top:12px;\">\n          <div style=\"font-weight:700; font-size:14px\">Notes</div>\n          <ul style=\"color:var(--muted); font-size:13px; margin-top:6px; padding-left:16px;\">\n            <li>Push / Pop cost: O(log n) — swapping along heap height.</li>\n            <li>Peek returns current top in O(1).</li>\n            <li>Stable insertion order is preserved for equal priorities.</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"footer\">\n      Built-in demo of a priority queue implemented as a binary heap. Source code is client-side and interactive.\n    </div>\n  </div>\n\n  <script>\n    // Priority Queue (binary heap) with stability (insertionIndex used to break ties)\n    class PriorityQueue {\n      constructor(mode = 'min') {\n        // items stored as {value, priority, idx} ; comparator uses priority and idx\n        this.data = [];\n        this._insertion = 0;\n        this.setMode(mode);\n      }\n      setMode(mode) {\n        this.mode = mode === 'max' ? 'max' : 'min';\n        // comparator returns true if a has higher priority than b\n        if (this.mode === 'min') {\n          this._cmp = (a,b) => (a.priority < b.priority) || (a.priority === b.priority && a.idx < b.idx);\n        } else {\n          this._cmp = (a,b) => (a.priority > b.priority) || (a.priority === b.priority && a.idx < b.idx);\n        }\n      }\n      size(){ return this.data.length; }\n      peek(){ return this.data[0] || null; }\n      push(value, priority){\n        const node = { value: value===\"\" ? null : (value===undefined?String(priority):String(value)), priority: Number(priority), idx: this._insertion++ };\n        this.data.push(node);\n        const swaps = this._siftUp(this.data.length - 1);\n        return { node, swaps };\n      }\n      pop(){\n        if (this.size() === 0) return null;\n        const top = this.data[0];\n        const last = this.data.pop();\n        if (this.size() > 0) {\n          this.data[0] = last;\n          const swaps = this._siftDown(0);\n          return { node: top, swaps };\n        }\n        return { node: top, swaps: [] };\n      }\n      clear(){\n        this.data = [];\n        this._insertion = 0;\n      }\n      toArray(){ return this.data.slice(); }\n      // internal siftUp and siftDown capture sequence of swaps (pairs of indices)\n      _siftUp(i){\n        const swaps = [];\n        let cur = i;\n        while (cur > 0) {\n          const parent = Math.floor((cur - 1) / 2);\n          if (this._cmp(this.data[cur], this.data[parent])) {\n            swaps.push([parent, cur]);\n            [this.data[parent], this.data[cur]] = [this.data[cur], this.data[parent]];\n            cur = parent;\n          } else break;\n        }\n        return swaps;\n      }\n      _siftDown(i){\n        const swaps = [];\n        const n = this.data.length;\n        let cur = i;\n        while (true) {\n          const left = 2*cur + 1;\n          const right = 2*cur + 2;\n          let best = cur;\n          if (left < n && this._cmp(this.data[left], this.data[best])) best = left;\n          if (right < n && this._cmp(this.data[right], this.data[best])) best = right;\n          if (best !== cur) {\n            swaps.push([cur, best]);\n            [this.data[cur], this.data[best]] = [this.data[best], this.data[cur]];\n            cur = best;\n          } else break;\n        }\n        return swaps;\n      }\n      // Rebuild using current comparator (useful when switching min/max)\n      rebuildFromArray(arr){\n        // arr: array of plain items {value,priority,idx}\n        this.data = arr.slice();\n        // heapify in-place bottom-up; capture no swaps here\n        const swaps = [];\n        for (let i = Math.floor(this.size()/2); i >= 0; i--) {\n          this._siftDown(i);\n        }\n        return swaps;\n      }\n    }\n\n    // UI and visualization\n    const pq = new PriorityQueue('min');\n    const svg = document.getElementById('heapSvg');\n    const arrayWrap = document.getElementById('arrayWrap');\n    const logArea = document.getElementById('logArea');\n    const sizeBadge = document.getElementById('sizeBadge');\n    const peekBadge = document.getElementById('peekBadge');\n    const valueInput = document.getElementById('valueInput');\n    const priorityInput = document.getElementById('priorityInput');\n    const addBtn = document.getElementById('addBtn');\n    const addRandBtn = document.getElementById('addRandBtn');\n    const bulkRandBtn = document.getElementById('bulkRandBtn');\n    const popBtn = document.getElementById('popBtn');\n    const peekBtn = document.getElementById('peekBtn');\n    const clearBtn = document.getElementById('clearBtn');\n    const modeSelect = document.getElementById('modeSelect');\n    const rebuildBtn = document.getElementById('rebuildBtn');\n    const demoSeqBtn = document.getElementById('demoSeqBtn');\n    const logShort = document.getElementById('shortLog');\n    const playAnimBtn = document.getElementById('playAnimBtn');\n    const stepBackBtn = document.getElementById('stepBackBtn');\n    const fastToggleBtn = document.getElementById('fastToggleBtn');\n\n    let animSpeed = 300; // ms per swap\n    let animPlaying = false;\n    let animSteps = []; // queued steps as {type:'swap'|'push'|'pop', swaps:[], before, after, node}\n    let animIndex = 0;\n\n    function writeLog(msg){\n      const t = new Date().toLocaleTimeString();\n      const el = document.createElement('div');\n      el.textContent = `[${t}] ${msg}`;\n      logArea.prepend(el);\n      // truncate\n      while (logArea.childNodes.length > 200) logArea.removeChild(logArea.lastChild);\n      logShort.textContent = msg;\n    }\n\n    function render(){\n      // render array\n      arrayWrap.innerHTML = '';\n      const arr = pq.toArray();\n      arr.forEach((node, i) => {\n        const el = document.createElement('div');\n        el.className = 'cell';\n        el.title = `Index ${i}`;\n        el.innerHTML = `<span class=\"idx\">[${i}]</span><div style=\"font-weight:700\">${node.value!==null?node.value:'(nil)'}</div><div class=\"small\">p=${node.priority}</div>`;\n        arrayWrap.appendChild(el);\n      });\n      if (arr.length === 0) {\n        const el = document.createElement('div');\n        el.className = 'cell';\n        el.textContent = '(empty)';\n        arrayWrap.appendChild(el);\n      }\n      sizeBadge.textContent = pq.size();\n      const top = pq.peek();\n      peekBadge.textContent = top ? `${top.value} (p=${top.priority})` : '—';\n\n      renderTree(arr);\n    }\n\n    // Basic tree layout to position nodes for binary heap\n    function renderTree(arr){\n      // svg coordinate system: width 1000, height 380\n      const W = 1000, H = 380;\n      svg.setAttribute('viewBox', `0 0 ${W} ${H}`);\n      svg.innerHTML = '';\n      if (arr.length === 0) {\n        const t = document.createElementNS('http://www.w3.org/2000/svg','text');\n        t.setAttribute('x',W/2);\n        t.setAttribute('y',H/2);\n        t.setAttribute('fill','rgba(255,255,255,0.12)');\n        t.setAttribute('text-anchor','middle');\n        t.setAttribute('font-size','18');\n        t.textContent = 'Heap is empty';\n        svg.appendChild(t);\n        return;\n      }\n      // compute positions by level\n      const levels = [];\n      let i = 0;\n      let level = 0;\n      while (i < arr.length) {\n        const count = Math.min(arr.length - i, Math.pow(2, level));\n        const row = [];\n        for (let j=0;j<count;j++){\n          row.push(i++);\n        }\n        levels.push(row);\n        level++;\n      }\n      // calculate coordinates\n      const coords = {};\n      const topMargin = 40;\n      const levelHeight = Math.min(80, (H - topMargin - 40) / (levels.length));\n      levels.forEach((row, li) => {\n        const y = topMargin + li * levelHeight;\n        // spread horizontally across width; at level li, place nodes evenly among slots 2^li\n        const slots = Math.pow(2, li);\n        row.forEach((idx, k) => {\n          const x = W * ( (k+0.5) / slots );\n          coords[idx] = {x,y};\n        });\n      });\n\n      // draw edges\n      arr.forEach((node, idx) => {\n        const left = 2*idx+1, right = 2*idx+2;\n        const p = coords[idx];\n        if (left < arr.length) {\n          const c = coords[left];\n          const line = document.createElementNS('http://www.w3.org/2000/svg','line');\n          line.setAttribute('x1',p.x);\n          line.setAttribute('y1',p.y+18);\n          line.setAttribute('x2',c.x);\n          line.setAttribute('y2',c.y-18);\n          line.setAttribute('stroke','rgba(255,255,255,0.04)');\n          line.setAttribute('stroke-width','1.5');\n          svg.appendChild(line);\n        }\n        if (right < arr.length) {\n          const c = coords[right];\n          const line = document.createElementNS('http://www.w3.org/2000/svg','line');\n          line.setAttribute('x1',p.x);\n          line.setAttribute('y1',p.y+18);\n          line.setAttribute('x2',c.x);\n          line.setAttribute('y2',c.y-18);\n          line.setAttribute('stroke','rgba(255,255,255,0.04)');\n          line.setAttribute('stroke-width','1.5');\n          svg.appendChild(line);\n        }\n      });\n\n      // draw nodes\n      arr.forEach((node, idx) => {\n        const g = document.createElementNS('http://www.w3.org/2000/svg','g');\n        g.setAttribute('class','node');\n        g.setAttribute('data-idx',idx);\n        const {x,y} = coords[idx];\n        g.setAttribute('transform', `translate(${x},${y})`);\n        // circle\n        const circ = document.createElementNS('http://www.w3.org/2000/svg','circle');\n        circ.setAttribute('r', 26);\n        circ.setAttribute('fill', 'url(#grad'+idx+')');\n        circ.setAttribute('stroke','rgba(255,255,255,0.03)');\n        circ.setAttribute('stroke-width','1.5');\n        // gradient\n        const defs = document.createElementNS('http://www.w3.org/2000/svg','defs');\n        const grad = document.createElementNS('http://www.w3.org/2000/svg','radialGradient');\n        grad.setAttribute('id','grad'+idx);\n        const stop1 = document.createElementNS('http://www.w3.org/2000/svg','stop');\n        stop1.setAttribute('offset','0%'); stop1.setAttribute('stop-color','#0ea5e9'); stop1.setAttribute('stop-opacity','0.06');\n        const stop2 = document.createElementNS('http://www.w3.org/2000/svg','stop');\n        stop2.setAttribute('offset','100%'); stop2.setAttribute('stop-color','#111827'); stop2.setAttribute('stop-opacity','0.8');\n        grad.appendChild(stop1); grad.appendChild(stop2); defs.appendChild(grad);\n        g.appendChild(defs);\n        g.appendChild(circ);\n        // text value\n        const t1 = document.createElementNS('http://www.w3.org/2000/svg','text');\n        t1.setAttribute('x',0); t1.setAttribute('y',-4);\n        t1.setAttribute('text-anchor','middle');\n        t1.setAttribute('fill','white');\n        t1.setAttribute('font-size','11');\n        t1.setAttribute('font-weight','700');\n        t1.textContent = node.value!==null?node.value:'(nil)';\n        g.appendChild(t1);\n        const t2 = document.createElementNS('http://www.w3.org/2000/svg','text');\n        t2.setAttribute('x',0); t2.setAttribute('y',14);\n        t2.setAttribute('text-anchor','middle');\n        t2.setAttribute('fill','rgba(255,255,255,0.7)');\n        t2.setAttribute('font-size','11');\n        t2.textContent = `p=${node.priority}`;\n        g.appendChild(t2);\n\n        svg.appendChild(g);\n      });\n    }\n\n    // animate swap sequence (array indices) and update DOM highlighting\n    async function animateSwaps(swaps, description){\n      if (!swaps || swaps.length === 0) {\n        if (description) writeLog(description + ' (no swaps)');\n        render();\n        return;\n      }\n      writeLog(description + ` (swaps: ${swaps.length})`);\n      animPlaying = true;\n      for (let k=0;k<swaps.length;k++){\n        const [i,j] = swaps[k];\n        // highlight array cells\n        highlightArrayCells(i,j);\n        // animate svg nodes by swapping their positions (we will visually swap by updating transform)\n        const nodes = document.querySelectorAll('#heapSvg .node');\n        const nodeI = [...nodes].find(n => Number(n.getAttribute('data-idx')) === i);\n        const nodeJ = [...nodes].find(n => Number(n.getAttribute('data-idx')) === j);\n        // if nodes not found (maybe re-render won't match indices), fall back to re-render then pause.\n        if (!nodeI || !nodeJ) {\n          render();\n          await pause(animSpeed);\n          continue;\n        }\n        // extract transforms\n        const t1 = nodeI.getAttribute('transform');\n        const t2 = nodeJ.getAttribute('transform');\n        // animate quick scale then swap positions\n        nodeI.style.transition = `transform ${animSpeed/1.8}ms ease`;\n        nodeJ.style.transition = `transform ${animSpeed/1.8}ms ease`;\n        // swap transforms\n        nodeI.setAttribute('transform', t2);\n        nodeJ.setAttribute('transform', t1);\n        await pause(animSpeed);\n        // after animation, update actual data positions for subsequent transforms by re-rendering\n        render();\n      }\n      clearHighlights();\n      animPlaying = false;\n    }\n\n    function highlightArrayCells(i,j){\n      const cells = arrayWrap.querySelectorAll('.cell');\n      cells.forEach((c,idx) => {\n        c.classList.toggle('highlight', idx===i || idx===j);\n      });\n    }\n    function clearHighlights(){\n      const cells = arrayWrap.querySelectorAll('.cell');\n      cells.forEach(c => c.classList.remove('highlight'));\n    }\n    function pause(ms){ return new Promise(r => setTimeout(r, ms)); }\n\n    // UI event handlers\n    addBtn.addEventListener('click', () => {\n      const v = valueInput.value.trim();\n      const p = priorityInput.value;\n      if (p === '') { alert('Please enter a numeric priority'); return; }\n      const res = pq.push(v, Number(p));\n      animSteps = []; // reset queued animations\n      // animate the swaps for push\n      (async ()=>{\n        await animateSwaps(res.swaps, `Push ${v || String(p)} (p=${p})`);\n      })();\n      writeLog(`push value=\"${v || '(nil)'}\" priority=${p}`);\n      render();\n      valueInput.value = '';\n      priorityInput.value = '';\n    });\n\n    addRandBtn.addEventListener('click', () => {\n      const val = randomValue();\n      const pr = Math.floor(Math.random()*100);\n      const res = pq.push(val, pr);\n      (async ()=> {\n        await animateSwaps(res.swaps, `Push ${val} (p=${pr})`);\n      })();\n      writeLog(`push value=\"${val}\" priority=${pr}`);\n      render();\n    });\n\n    bulkRandBtn.addEventListener('click', async () => {\n      const ops = [];\n      for (let i=0;i<10;i++){\n        const val = randomValue();\n        const pr = Math.floor(Math.random()*100);\n        ops.push({val,pr});\n      }\n      // push one by one with animation\n      for (const op of ops){\n        const res = pq.push(op.val, op.pr);\n        await animateSwaps(res.swaps, `Push ${op.val} (p=${op.pr})`);\n        writeLog(`push value=\"${op.val}\" priority=${op.pr}`);\n      }\n      render();\n    });\n\n    popBtn.addEventListener('click', async () => {\n      if (pq.size() === 0) { writeLog('pop attempted on empty heap'); return; }\n      const beforeTop = pq.peek();\n      const res = pq.pop();\n      await animateSwaps(res.swaps, `Pop -> removed ${res.node.value} (p=${res.node.priority})`);\n      writeLog(`pop removed value=\"${res.node.value}\" priority=${res.node.priority}`);\n      render();\n    });\n\n    peekBtn.addEventListener('click', () => {\n      const t = pq.peek();\n      if (!t) {\n        writeLog('peek: heap empty');\n        alert('Heap is empty');\n      } else {\n        writeLog(`peek: ${t.value} (p=${t.priority})`);\n        alert(`Top: ${t.value} (priority=${t.priority})`);\n      }\n      render();\n    });\n\n    clearBtn.addEventListener('click', () => {\n      pq.clear();\n      writeLog('cleared heap');\n      render();\n    });\n\n    modeSelect.addEventListener('change', () => {\n      const m = modeSelect.value;\n      pq.setMode(m);\n      // Rebuild to restore heap order under new comparator\n      pq.rebuildFromArray(pq.toArray());\n      writeLog(`mode set to ${m}`);\n      render();\n    });\n\n    rebuildBtn.addEventListener('click', () => {\n      pq.rebuildFromArray(pq.toArray());\n      writeLog('heap rebuilt');\n      render();\n    });\n\n    demoSeqBtn.addEventListener('click', async () => {\n      // demo sequence: add few items, pop some, add more\n      const seq = [\n        {op:'push',v:'A',p:20},\n        {op:'push',v:'B',p:5},\n        {op:'push',v:'C',p:14},\n        {op:'push',v:'D',p:5},\n        {op:'pop'},\n        {op:'push',v:'E',p:2},\n        {op:'pop'},\n        {op:'pop'}\n      ];\n      for (const s of seq){\n        if (s.op === 'push'){\n          const res = pq.push(s.v, s.p);\n          await animateSwaps(res.swaps, `Push ${s.v} (p=${s.p})`);\n          writeLog(`push ${s.v} p=${s.p}`);\n        } else if (s.op === 'pop'){\n          if (pq.size() === 0) { writeLog('pop attempted on empty during demo'); continue; }\n          const res = pq.pop();\n          await animateSwaps(res.swaps, `Pop -> removed ${res.node.value}`);\n          writeLog(`pop -> ${res.node.value}`);\n        }\n      }\n      render();\n    });\n\n    // Play/pause and speed controls (for potential queued animations)\n    fastToggleBtn.addEventListener('click', () => {\n      if (animSpeed === 300) { animSpeed = 120; fastToggleBtn.textContent = 'Speed: 120ms'; }\n      else if (animSpeed === 120) { animSpeed = 50; fastToggleBtn.textContent = 'Speed: 50ms'; }\n      else { animSpeed = 300; fastToggleBtn.textContent = 'Speed: 300ms'; }\n    });\n    playAnimBtn.addEventListener('click', () => {\n      // not bound to specialized queued animations in this simple demo\n      alert('Animations play automatically for each operation. Use Demo Sequence to see multiple steps.');\n    });\n    stepBackBtn.addEventListener('click', () => {\n      alert('Step back is not implemented. You can clear and replay actions to simulate stepping.');\n    });\n\n    // helper utilities\n    function randomValue(){\n      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n      return letters[Math.floor(Math.random()*letters.length)];\n    }\n\n    // initialize with some random items\n    (async ()=>{\n      for (let i=0;i<5;i++){\n        const v = randomValue();\n        const p = Math.floor(Math.random()*60);\n        const res = pq.push(v,p);\n        // we await but with short pause\n        await animateSwaps(res.swaps, `Initial push ${v} (p=${p})`);\n      }\n      writeLog('initialized with random items');\n      render();\n    })();\n\n    // Ensure initial rendering\n    render();\n\n    // Expose pq to window for debugging in browser console\n    window._pq = pq;\n    window._render = render;\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Priority Queue"
    }
  ],
  "topic": "Priority Queue",
  "hasFSM": false,
  "hasTest": true
}