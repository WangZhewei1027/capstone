{
  "id": "be878a85-cd35-11f0-9e7b-93b903303299",
  "timestamp": "2025-11-29T15:13:36.117Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Bubble Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\" />\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n<title>Bubble Sort Visualization</title>\n<style>\n  :root{\n    --bg:#0f1724;\n    --panel:#0b1220;\n    --accent:#2dd4bf;\n    --muted:#94a3b8;\n    --bar:#60a5fa;\n    --compare:#f59e0b;\n    --swap:#ef4444;\n    --sorted:#34d399;\n    --glass: rgba(255,255,255,0.03);\n    font-family: Inter, ui-sans-serif, system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial;\n  }\n  *{box-sizing:border-box}\n  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#071028);color:#e6eef8}\n  .app{\n    max-width:1100px;margin:28px auto;padding:20px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);\n    box-shadow: 0 6px 30px rgba(2,6,23,0.6);\n  }\n  header{display:flex;align-items:center;justify-content:space-between;gap:20px;margin-bottom:12px}\n  h1{font-size:20px;margin:0}\n  .top-info{color:var(--muted);font-size:13px}\n  .controls{display:flex;gap:8px;flex-wrap:wrap}\n  button,select,input[type=range]{\n    background:var(--glass);border:1px solid rgba(255,255,255,0.04);color:inherit;padding:8px 12px;border-radius:8px;\n    cursor:pointer;font-size:14px\n  }\n  button:active{transform:translateY(1px)}\n  .btn-primary{background: linear-gradient(90deg,var(--accent),#60a5fa); color:#042024;border:none}\n  .btn-danger{background:linear-gradient(90deg,#fb7185,#ef4444);border:none}\n  .layout{display:grid;grid-template-columns:1fr 320px;gap:16px;margin-top:12px}\n  .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}\n  .visual{height:360px;display:flex;align-items:flex-end;gap:6px;padding:12px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);overflow:hidden}\n  .bar{\n    flex:1 1 auto;min-width:6px;display:flex;align-items:flex-end;justify-content:center;\n    background:linear-gradient(180deg,var(--bar),#1e3a8a);border-radius:6px;transition:height 300ms ease, transform 300ms ease, background 200ms ease;\n    position:relative;color:#021024;font-weight:700;font-size:11px;\n  }\n  .bar span{position:absolute;bottom:4px;color:rgba(255,255,255,0.95);font-size:11px}\n  .bar.compare{background:linear-gradient(180deg,var(--compare),#b45309);transform:translateY(-6px);z-index:3}\n  .bar.swap{background:linear-gradient(180deg,var(--swap),#b91c1c);transform:translateY(-10px);z-index:4}\n  .bar.sorted{background:linear-gradient(180deg,var(--sorted),#059669);transform:none;box-shadow:0 6px 18px rgba(3,105,161,0.12)}\n  .stats{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px;color:var(--muted);font-size:13px}\n  .stat{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.02)}\n  .sidebar-title{font-weight:600;margin-bottom:8px}\n  .pseudocode{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;font-size:13px;line-height:1.45}\n  .pseudocode div{padding:6px;border-radius:6px}\n  .pc-active{background:linear-gradient(90deg, rgba(255,255,255,0.03), transparent);border:1px solid rgba(255,255,255,0.02)}\n  .small{font-size:13px;color:var(--muted)}\n  .controls-row{display:flex;gap:8px;align-items:center;margin-top:10px}\n  .footer-note{margin-top:12px;color:var(--muted);font-size:13px}\n  label{font-size:13px;color:var(--muted)}\n  input[type=range]{-webkit-appearance:none;height:8px;border-radius:6px;background:linear-gradient(90deg,var(--accent),#60a5fa);outline:none}\n  .code-block{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:#021024;padding:10px;border-radius:8px;font-size:12px;color:#bfe9e7;white-space:pre-wrap;overflow:auto;max-height:220px}\n  .disabled{opacity:0.5;pointer-events:none}\n  .top-left{display:flex;gap:12px;align-items:center}\n  .toggle{display:flex;align-items:center;gap:6px}\n  .small-muted{color:var(--muted);font-size:12px}\n  @media (max-width:880px){\n    .layout{grid-template-columns:1fr;max-height:none}\n    .visual{height:260px}\n  }\n</style>\n</head>\n<body>\n<div class=\"app\" role=\"application\" aria-label=\"Bubble Sort visualization\">\n  <header>\n    <div class=\"top-left\">\n      <h1>Bubble Sort — Visualizer</h1>\n      <div class=\"top-info small-muted\">Compare & swap adjacent elements until array is sorted</div>\n    </div>\n    <div class=\"controls\">\n      <button id=\"randomizeBtn\">Randomize</button>\n      <button id=\"startBtn\" class=\"btn-primary\">Start</button>\n      <button id=\"stepBtn\">Step</button>\n      <button id=\"resetBtn\">Reset</button>\n      <label class=\"toggle small-muted\"><input type=\"checkbox\" id=\"directionChk\"> Descending</label>\n    </div>\n  </header>\n\n  <div class=\"layout\">\n    <div class=\"panel\">\n      <div style=\"display:flex;justify-content:space-between;align-items:center;gap:10px\">\n        <div class=\"small-muted\">Array visualization</div>\n        <div style=\"display:flex;gap:8px;align-items:center\">\n          <label class=\"small-muted\">Size</label>\n          <input id=\"sizeRange\" type=\"range\" min=\"5\" max=\"60\" value=\"20\">\n        </div>\n      </div>\n\n      <div id=\"visual\" class=\"visual\" aria-live=\"polite\" aria-atomic=\"true\"></div>\n\n      <div class=\"controls-row\">\n        <label class=\"small-muted\">Speed</label>\n        <input id=\"speedRange\" type=\"range\" min=\"50\" max=\"1200\" value=\"350\">\n        <div id=\"speedLabel\" class=\"small-muted\">350 ms</div>\n      </div>\n\n      <div class=\"stats\" id=\"stats\">\n        <div class=\"stat\">Comparisons: <strong id=\"comparisons\">0</strong></div>\n        <div class=\"stat\">Swaps: <strong id=\"swaps\">0</strong></div>\n        <div class=\"stat\">Pass: <strong id=\"pass\">0</strong></div>\n        <div class=\"stat\">Index: <strong id=\"idx\">—</strong></div>\n        <div class=\"stat\">Status: <strong id=\"status\">Ready</strong></div>\n      </div>\n\n      <div class=\"footer-note\">\n        Try clicking Step to move one operation at a time. Press Start to autoplay. Use Descending for reversed order.\n      </div>\n    </div>\n\n    <aside class=\"panel\" aria-label=\"controls and explanation\">\n      <div>\n        <div class=\"sidebar-title\">Pseudocode</div>\n        <div class=\"pseudocode\" id=\"pseudocode\">\n          <div data-line=\"1\">1. for n = length(array) downto 2</div>\n          <div data-line=\"2\">2.   for i = 0 to n - 2</div>\n          <div data-line=\"3\">3.     compare array[i] and array[i+1]</div>\n          <div data-line=\"4\">4.     if out of order then swap array[i], array[i+1]</div>\n          <div data-line=\"5\">5.   mark element at n-1 as sorted</div>\n        </div>\n\n        <div style=\"margin-top:12px\" class=\"sidebar-title\">Controls</div>\n        <div class=\"small-muted\">Change array size or randomize. Use step to see each compare/swap.</div>\n\n        <div style=\"margin-top:10px;display:flex;gap:8px;flex-wrap:wrap\">\n          <button id=\"codeBtn\">Show Code</button>\n          <button id=\"explainBtn\">Explain</button>\n        </div>\n\n        <div id=\"infoPanel\" style=\"margin-top:12px\"></div>\n\n        <div style=\"margin-top:12px\">\n          <div class=\"sidebar-title\">Bubble Sort Complexity</div>\n          <div class=\"small-muted\">Time: O(n^2) worst/average, O(n) best (optimized). Space: O(1).</div>\n        </div>\n\n        <div style=\"margin-top:12px\">\n          <div class=\"sidebar-title\">Code (JavaScript)</div>\n          <div id=\"codeBlock\" class=\"code-block\" style=\"display:none\">\nconst bubbleSortGenerator = function*(arr, ascending=true) {\n  // Outer loop: reduce unsorted portion\n  for (let n = arr.length; n > 1; n--) {\n    // Inner loop: sweep adjacent pairs\n    for (let i = 0; i < n - 1; i++) {\n      yield {type:'compare', i, j: i+1};\n      if ((ascending && arr[i] > arr[i+1]) ||\n          (!ascending && arr[i] < arr[i+1])) {\n        yield {type:'swap', i, j: i+1};\n        // swap values in the backing array\n        const tmp = arr[i]; arr[i] = arr[i+1]; arr[i+1] = tmp;\n      }\n    }\n    yield {type:'sorted', index: n-1};\n  }\n  yield {type:'sorted', index: 0};\n};\n          </div>\n        </div>\n      </div>\n    </aside>\n\n  </div>\n</div>\n\n<script>\n/*\n  Bubble Sort Visualizer\n  - Single-file demo with interactive controls\n  - Implements bubble sort as a generator yielding actions:\n      {type:'compare', i, j}\n      {type:'swap', i, j}\n      {type:'sorted', index}\n  - Controls:\n      Randomize, Start/Pause, Step, Reset, Size, Speed, Direction\n*/\n\n(() => {\n  // Elements\n  const visual = document.getElementById('visual');\n  const randomizeBtn = document.getElementById('randomizeBtn');\n  const startBtn = document.getElementById('startBtn');\n  const stepBtn = document.getElementById('stepBtn');\n  const resetBtn = document.getElementById('resetBtn');\n  const directionChk = document.getElementById('directionChk');\n  const sizeRange = document.getElementById('sizeRange');\n  const speedRange = document.getElementById('speedRange');\n  const speedLabel = document.getElementById('speedLabel');\n  const comparisonsEl = document.getElementById('comparisons');\n  const swapsEl = document.getElementById('swaps');\n  const passEl = document.getElementById('pass');\n  const idxEl = document.getElementById('idx');\n  const statusEl = document.getElementById('status');\n  const pseudocode = document.getElementById('pseudocode');\n  const codeBtn = document.getElementById('codeBtn');\n  const codeBlock = document.getElementById('codeBlock');\n  const explainBtn = document.getElementById('explainBtn');\n  const infoPanel = document.getElementById('infoPanel');\n\n  // State\n  let arr = [];\n  let bars = [];\n  let gen = null;\n  let autoId = null;\n  let comparisons = 0;\n  let swaps = 0;\n  let currentPass = 0;\n  let currentIndex = null;\n  let ascending = true;\n  let size = parseInt(sizeRange.value,10);\n  let speed = parseInt(speedRange.value,10);\n\n  // Initialize\n  speedLabel.textContent = speed + ' ms';\n\n  function randomArray(n) {\n    const a = [];\n    for (let i = 0; i < n; i++) {\n      // generate varied values to make visualization interesting\n      a.push(Math.floor(Math.random()*100) + 2);\n    }\n    return a;\n  }\n\n  function createBars() {\n    visual.innerHTML = '';\n    bars = [];\n    const max = Math.max(...arr);\n    for (let i = 0; i < arr.length; i++) {\n      const bar = document.createElement('div');\n      bar.className = 'bar';\n      // height proportional to value\n      const h = (arr[i] / max) * 100;\n      bar.style.height = h + '%';\n      const lbl = document.createElement('span');\n      lbl.textContent = arr[i];\n      bar.appendChild(lbl);\n      visual.appendChild(bar);\n      bars.push(bar);\n    }\n  }\n\n  // Update counters and status UI\n  function updateStats() {\n    comparisonsEl.textContent = comparisons;\n    swapsEl.textContent = swaps;\n    passEl.textContent = currentPass;\n    idxEl.textContent = (currentIndex === null) ? '—' : currentIndex;\n  }\n\n  // Highlight pseudocode line\n  function highlightLine(num) {\n    Array.from(pseudocode.children).forEach(div => {\n      div.classList.toggle('pc-active', parseInt(div.dataset.line,10) === num);\n    });\n  }\n\n  // Generator implementing bubble sort steps (operates on a copy of arr passed in)\n  function* bubbleSortGenerator(arrCopy, ascendingFlag) {\n    // n is length of unsorted portion\n    for (let n = arrCopy.length; n > 1; n--) {\n      // update pass information (for UI)\n      yield {type:'passStart', pass: arrCopy.length - n + 1, n};\n      for (let i = 0; i < n - 1; i++) {\n        // Compare\n        yield {type:'compare', i, j: i+1};\n        if ((ascendingFlag && arrCopy[i] > arrCopy[i+1]) ||\n            (!ascendingFlag && arrCopy[i] < arrCopy[i+1])) {\n          // Swap\n          yield {type:'swap', i, j: i+1};\n          const tmp = arrCopy[i]; arrCopy[i] = arrCopy[i+1]; arrCopy[i+1] = tmp;\n        }\n      }\n      // Mark last element of this pass as sorted\n      yield {type:'sorted', index: n-1};\n    }\n    // All sorted: mark index 0 as sorted\n    yield {type:'sorted', index: 0};\n    yield {type:'done'};\n  }\n\n  // Apply a single step from generator\n  async function step() {\n    if (!gen) return;\n    const {value, done} = gen.next();\n    if (done) {\n      statusEl.textContent = 'Finished';\n      stopAuto();\n      return;\n    }\n    const action = value;\n    if (!action) return;\n\n    switch(action.type) {\n      case 'passStart':\n        currentPass = action.pass;\n        currentIndex = '—';\n        highlightLine(1);\n        statusEl.textContent = 'Running';\n        updateStats();\n        break;\n      case 'compare':\n        comparisons++;\n        currentIndex = action.i;\n        updateStats();\n        // highlight bars\n        clearBarClasses();\n        bars[action.i].classList.add('compare');\n        bars[action.j].classList.add('compare');\n        highlightLine(3);\n        break;\n      case 'swap':\n        swaps++;\n        updateStats();\n        // animate swap: swap heights and labels\n        bars[action.i].classList.remove('compare');\n        bars[action.j].classList.remove('compare');\n        bars[action.i].classList.add('swap');\n        bars[action.j].classList.add('swap');\n        highlightLine(4);\n        await animateSwap(action.i, action.j);\n        break;\n      case 'sorted':\n        // mark bar as sorted (green)\n        const idx = action.index;\n        bars[idx].classList.remove('compare','swap');\n        bars[idx].classList.add('sorted');\n        highlightLine(5);\n        break;\n      case 'done':\n        statusEl.textContent = 'Sorted';\n        clearBarClasses();\n        bars.forEach(b => b.classList.add('sorted'));\n        highlightLine(null);\n        stopAuto();\n        break;\n      default:\n        break;\n    }\n  }\n\n  // Swap visual bars by swapping heights/value labels\n  function animateSwap(i,j) {\n    return new Promise(resolve => {\n      // swap heights and labels in DOM\n      const bA = bars[i];\n      const bB = bars[j];\n\n      // swap values in the backing arr immediately so future steps reflect\n      const tmpVal = arr[i]; arr[i] = arr[j]; arr[j] = tmpVal;\n\n      // swap label text\n      const labelA = bA.querySelector('span').textContent;\n      const labelB = bB.querySelector('span').textContent;\n      bA.querySelector('span').textContent = labelB;\n      bB.querySelector('span').textContent = labelA;\n\n      // swap heights via computed style\n      const hA = bA.style.height;\n      const hB = bB.style.height;\n      // apply for smooth animation\n      bA.style.height = hB;\n      bB.style.height = hA;\n\n      // Wait for transition end roughly equal to speed (some margin)\n      const t = Math.max(120, Math.min(1000, speed));\n      setTimeout(() => {\n        // remove swap classes after animation\n        bA.classList.remove('swap');\n        bB.classList.remove('swap');\n        resolve();\n      }, t + 30);\n    });\n  }\n\n  function clearBarClasses() {\n    bars.forEach(b => b.classList.remove('compare','swap'));\n  }\n\n  function startAuto() {\n    if (autoId) return;\n    // disable manual randomize and size while running\n    randomizeBtn.disabled = true;\n    sizeRange.disabled = true;\n    stepBtn.disabled = true;\n    startBtn.textContent = 'Pause';\n    autoId = setInterval(() => {\n      // call step; if generator finished, clear interval\n      const res = gen.next();\n      if (res.done) {\n        stopAuto();\n        statusEl.textContent = 'Sorted';\n        highlightLine(null);\n        return;\n      }\n      const action = res.value;\n      handleAutoAction(action);\n    }, speed);\n    statusEl.textContent = 'Running';\n  }\n\n  function handleAutoAction(action) {\n    if (!action) return;\n    switch(action.type) {\n      case 'passStart':\n        currentPass = action.pass;\n        currentIndex = '—';\n        highlightLine(1);\n        updateStats();\n        break;\n      case 'compare':\n        comparisons++;\n        currentIndex = action.i;\n        updateStats();\n        clearBarClasses();\n        bars[action.i].classList.add('compare');\n        bars[action.j].classList.add('compare');\n        highlightLine(3);\n        break;\n      case 'swap':\n        swaps++;\n        updateStats();\n        // perform immediate swap animation but don't await (we still use interval pacing)\n        bars[action.i].classList.remove('compare');\n        bars[action.j].classList.remove('compare');\n        bars[action.i].classList.add('swap');\n        bars[action.j].classList.add('swap');\n        highlightLine(4);\n        // animate swap and then clean up after animation duration\n        animateSwap(action.i, action.j);\n        break;\n      case 'sorted':\n        bars[action.index].classList.remove('compare','swap');\n        bars[action.index].classList.add('sorted');\n        highlightLine(5);\n        break;\n      case 'done':\n        clearInterval(autoId);\n        autoId = null;\n        statusEl.textContent = 'Sorted';\n        clearBarClasses();\n        bars.forEach(b => b.classList.add('sorted'));\n        highlightLine(null);\n        randomizeBtn.disabled = false;\n        sizeRange.disabled = false;\n        stepBtn.disabled = false;\n        startBtn.textContent = 'Start';\n        break;\n    }\n  }\n\n  function stopAuto() {\n    if (autoId) {\n      clearInterval(autoId);\n      autoId = null;\n    }\n    randomizeBtn.disabled = false;\n    sizeRange.disabled = false;\n    stepBtn.disabled = false;\n    startBtn.textContent = 'Start';\n  }\n\n  // Prepare a new run: create generator over a copy of arr\n  function prepareRun() {\n    // reset counters\n    comparisons = 0;\n    swaps = 0;\n    currentPass = 0;\n    currentIndex = null;\n    ascending = !directionChk.checked; // checkbox says \"Descending\", so ascending = !checked\n    updateStats();\n    statusEl.textContent = 'Ready';\n    // create copy for generator to operate on (it will mutate its copy)\n    gen = bubbleSortGenerator(arr.slice(), ascending);\n    clearBarClasses();\n    // remove any 'sorted' marking\n    bars.forEach(b => b.classList.remove('sorted'));\n    highlightLine(null);\n  }\n\n  // Reset visual to initial random array state\n  function reset() {\n    stopAuto();\n    arr = randomArray(size);\n    createBars();\n    prepareRun();\n    statusEl.textContent = 'Ready';\n  }\n\n  // Event wiring\n  randomizeBtn.addEventListener('click', () => {\n    reset();\n  });\n\n  startBtn.addEventListener('click', () => {\n    if (!gen) prepareRun();\n    if (autoId) {\n      // currently running -> pause\n      stopAuto();\n      statusEl.textContent = 'Paused';\n      startBtn.textContent = 'Start';\n    } else {\n      // start autoplay\n      startAuto();\n    }\n  });\n\n  stepBtn.addEventListener('click', async () => {\n    if (autoId) return; // ignore steps while auto-running\n    if (!gen) prepareRun();\n    statusEl.textContent = 'Running';\n    await step();\n  });\n\n  resetBtn.addEventListener('click', () => {\n    stopAuto();\n    arr = arr.map(v => v); // keep same array but reset run\n    createBars();\n    prepareRun();\n    statusEl.textContent = 'Ready';\n  });\n\n  directionChk.addEventListener('change', () => {\n    // If user toggles direction mid-run, reset the run to reflect new direction\n    stopAuto();\n    prepareRun();\n    statusEl.textContent = 'Ready';\n  });\n\n  sizeRange.addEventListener('input', () => {\n    size = parseInt(sizeRange.value,10);\n    // regenerate immediately to show different size\n    reset();\n  });\n\n  speedRange.addEventListener('input', () => {\n    speed = parseInt(speedRange.value,10);\n    speedLabel.textContent = speed + ' ms';\n    // update transitions on bars to match speed\n    bars.forEach(b => {\n      const ms = Math.max(80, speed);\n      b.style.transitionDuration = (ms*0.9) + 'ms';\n    });\n    // if running auto, restart interval so pacing changes immediately\n    if (autoId) {\n      stopAuto();\n      startAuto();\n    }\n  });\n\n  codeBtn.addEventListener('click', () => {\n    codeBlock.style.display = codeBlock.style.display === 'none' ? 'block' : 'none';\n  });\n\n  explainBtn.addEventListener('click', () => {\n    infoPanel.innerHTML = '<div class=\"small-muted\" style=\"margin-top:8px\">Bubble sort repeatedly steps through the list, compares adjacent items and swaps them if they are in the wrong order. Each pass places the next largest (or smallest) element at its final position. This implementation shows every compare and swap so you can step through the algorithm.</div>';\n    setTimeout(()=> infoPanel.innerHTML = '', 6000);\n  });\n\n  // Setup initial array & UI\n  function init() {\n    arr = randomArray(size);\n    createBars();\n    prepareRun();\n    updateStats();\n    // set bar transition duration based on speed\n    bars.forEach(b => b.style.transitionDuration = (speed*0.9) + 'ms');\n  }\n\n  // Basic accessibility: allow space to step or start/pause\n  document.addEventListener('keydown', e => {\n    if (e.code === 'Space') {\n      e.preventDefault();\n      if (autoId) {\n        startBtn.click();\n      } else {\n        stepBtn.click();\n      }\n    }\n  });\n\n  // Implement bubbleSortGenerator local to closure\n  function* bubbleSortGenerator(arrCopy, ascendingFlag) {\n    for (let n = arrCopy.length; n > 1; n--) {\n      // pass begins\n      yield {type:'passStart', pass: arrCopy.length - n + 1, n};\n      for (let i = 0; i < n - 1; i++) {\n        yield {type:'compare', i, j: i+1};\n        if ((ascendingFlag && arrCopy[i] > arrCopy[i+1]) ||\n            (!ascendingFlag && arrCopy[i] < arrCopy[i+1])) {\n          yield {type:'swap', i, j: i+1};\n          const tmp = arrCopy[i]; arrCopy[i] = arrCopy[i+1]; arrCopy[i+1] = tmp;\n        }\n      }\n      yield {type:'sorted', index: n-1};\n    }\n    yield {type:'sorted', index: 0};\n    yield {type:'done'};\n  }\n\n  // Kick off\n  init();\n})();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Bubble Sort"
    }
  ],
  "topic": "Bubble Sort",
  "hasFSM": false,
  "hasTest": true
}