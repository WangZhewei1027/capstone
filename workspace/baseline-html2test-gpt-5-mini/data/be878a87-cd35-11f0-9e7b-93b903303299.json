{
  "id": "be878a87-cd35-11f0-9e7b-93b903303299",
  "timestamp": "2025-11-29T15:13:37.231Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Insertion Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <title>Insertion Sort Visualizer</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n  <style>\n    :root{\n      --bg:#0f1724; --panel:#0b1220; --accent:#60a5fa; --muted:#94a3b8; --card:#071025;\n      --bar:#90a4ae; --sorted:#38bdf8; --key:#fb923c; --comp:#ef4444; --shift:#a78bfa;\n    }\n    *{box-sizing:border-box}\n    body{\n      margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial;\n      background:linear-gradient(180deg,#021021 0%, #02111b 100%); color:#e6eef6; padding:18px;\n    }\n    .app{\n      max-width:1100px; margin:0 auto;\n    }\n    header{\n      display:flex; align-items:center; gap:12px; margin-bottom:12px;\n    }\n    header h1{font-size:20px; margin:0; color:var(--accent)}\n    .controls{\n      display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-bottom:12px;\n    }\n    .card{\n      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));\n      padding:12px; border-radius:8px; border:1px solid rgba(255,255,255,0.04);\n    }\n    .row{display:flex; gap:8px; align-items:center; flex-wrap:wrap}\n    label{font-size:12px; color:var(--muted)}\n    input[type=range]{width:100%}\n    button{\n      background:linear-gradient(180deg,var(--accent),#3b82f6); color:#041024; border:none; padding:8px 12px; border-radius:6px; cursor:pointer;\n      font-weight:600;\n    }\n    button.ghost{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted)}\n    .vis{\n      margin-top:12px; display:flex; gap:12px;\n    }\n    .bars{\n      flex:1 1 60%; min-height:300px; background:var(--card); padding:12px; border-radius:8px; display:flex; align-items:end; gap:4px;\n      border:1px solid rgba(255,255,255,0.03); position:relative;\n    }\n    .bar{\n      background:var(--bar); flex:1 1 auto; border-radius:4px 4px 0 0; display:flex; align-items:flex-end; justify-content:center; color:#031127; font-weight:700;\n      transition:height 160ms linear, transform 160ms linear, background-color 120ms linear;\n      position:relative; overflow:visible;\n    }\n    .bar .val{font-size:11px; transform:translateY(-6px); color:#031127; padding:2px 6px; border-radius:4px; background:rgba(255,255,255,0.85)}\n    .panel{\n      width:360px; min-width:260px; background:var(--panel); padding:12px; border-radius:8px; border:1px solid rgba(255,255,255,0.03);\n      display:flex; flex-direction:column; gap:8px;\n    }\n    .pseudocode{\n      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, \"Roboto Mono\", monospace; font-size:13px; color:var(--muted); background:rgba(255,255,255,0.02);\n      padding:8px; border-radius:6px; overflow:auto; max-height:220px;\n    }\n    .pseudocode .line{padding:4px 6px; border-radius:4px; margin-bottom:4px}\n    .pseudocode .line.active{background:linear-gradient(90deg, rgba(96,165,250,0.12), rgba(96,165,250,0.06)); color:var(--accent)}\n    .stats{display:flex; gap:8px; flex-wrap:wrap}\n    .stat{background:rgba(255,255,255,0.02); padding:8px; border-radius:6px; font-size:13px}\n    .footer-controls{display:flex; gap:8px; align-items:center; margin-top:8px; flex-wrap:wrap}\n    textarea{width:100%; min-height:56px; background:transparent; color:var(--muted); border:1px dashed rgba(255,255,255,0.04); padding:8px; border-radius:6px}\n    .legend{display:flex; gap:8px; align-items:center; flex-wrap:wrap}\n    .legend .item{display:flex; gap:6px; align-items:center; font-size:12px; color:var(--muted)}\n    .swatch{width:14px; height:12px; border-radius:3px}\n    @media (max-width:880px){\n      .controls{grid-template-columns:1fr; }\n      .vis{flex-direction:column}\n      .panel{width:100%}\n    }\n  </style>\n</head>\n<body>\n  <div class=\"app\">\n    <header>\n      <h1>Insertion Sort — Visualizer & Stepper</h1>\n      <div style=\"margin-left:auto;color:var(--muted);font-size:13px\">Learn how insertion sort shifts elements to insert the key value.</div>\n    </header>\n\n    <div class=\"controls\">\n      <div class=\"card\">\n        <div class=\"row\" style=\"justify-content:space-between\">\n          <div style=\"flex:1 1 60%\">\n            <label>Array size: <span id=\"sizeVal\">20</span></label>\n            <input id=\"size\" type=\"range\" min=\"5\" max=\"80\" value=\"20\">\n          </div>\n          <div style=\"flex:1 1 40%\">\n            <label>Max value: <span id=\"maxVal\">100</span></label>\n            <input id=\"max\" type=\"range\" min=\"10\" max=\"500\" value=\"100\">\n          </div>\n        </div>\n        <div style=\"margin-top:8px\" class=\"row\">\n          <button id=\"randomBtn\">Randomize</button>\n          <button id=\"almostSortedBtn\" class=\"ghost\">Nearly Sorted</button>\n          <button id=\"reverseBtn\" class=\"ghost\">Reverse</button>\n        </div>\n      </div>\n\n      <div class=\"card\">\n        <label>Manual input (comma/space separated)</label>\n        <textarea id=\"manual\" placeholder=\"e.g. 5,3,8,1,9\"></textarea>\n        <div class=\"row\" style=\"margin-top:8px\">\n          <button id=\"applyManual\">Apply</button>\n          <button id=\"resetBtn\" class=\"ghost\">Reset View</button>\n        </div>\n      </div>\n\n      <div class=\"card\">\n        <label>Animation speed: <span id=\"speedVal\">1.0x</span></label>\n        <input id=\"speed\" type=\"range\" min=\"0.25\" max=\"3\" step=\"0.25\" value=\"1\">\n        <div class=\"footer-controls\">\n          <button id=\"playBtn\">Play</button>\n          <button id=\"stepBtn\" class=\"ghost\">Step</button>\n          <button id=\"backBtn\" class=\"ghost\">Back</button>\n          <button id=\"toStart\" class=\"ghost\">To Start</button>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"vis\">\n      <div class=\"bars card\" id=\"bars\" aria-hidden=\"false\"></div>\n\n      <div class=\"panel\">\n        <div style=\"display:flex; justify-content:space-between; align-items:center;\">\n          <strong style=\"color:var(--accent)\">Algorithm (Insertion Sort)</strong>\n          <div class=\"legend\">\n            <div class=\"item\"><span class=\"swatch\" style=\"background:var(--sorted)\"></span> Sorted</div>\n            <div class=\"item\"><span class=\"swatch\" style=\"background:var(--key)\"></span> Key</div>\n            <div class=\"item\"><span class=\"swatch\" style=\"background:var(--comp)\"></span> Comparing</div>\n            <div class=\"item\"><span class=\"swatch\" style=\"background:var(--shift)\"></span> Shifted</div>\n          </div>\n        </div>\n\n        <div class=\"pseudocode\" id=\"pseudocode\">\n          <div class=\"line\" data-line=\"1\">1: for i = 1 to n - 1</div>\n          <div class=\"line\" data-line=\"2\">2: &nbsp;&nbsp;&nbsp; key = arr[i]</div>\n          <div class=\"line\" data-line=\"3\">3: &nbsp;&nbsp;&nbsp; j = i - 1</div>\n          <div class=\"line\" data-line=\"4\">4: &nbsp;&nbsp;&nbsp; while j >= 0 and arr[j] > key</div>\n          <div class=\"line\" data-line=\"5\">5: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arr[j + 1] = arr[j]</div>\n          <div class=\"line\" data-line=\"6\">6: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = j - 1</div>\n          <div class=\"line\" data-line=\"7\">7: &nbsp;&nbsp;&nbsp; arr[j + 1] = key</div>\n        </div>\n\n        <div class=\"stats\">\n          <div class=\"stat\">Step: <span id=\"stepCount\">0</span> / <span id=\"totalSteps\">0</span></div>\n          <div class=\"stat\">Comparisons: <span id=\"compCount\">0</span></div>\n          <div class=\"stat\">Shifts: <span id=\"shiftCount\">0</span></div>\n        </div>\n\n        <div style=\"margin-top:6px; display:flex; gap:8px;\">\n          <div style=\"flex:1\">\n            <label style=\"font-size:12px;color:var(--muted)\">Current frame action</label>\n            <div id=\"action\" style=\"padding:6px;background:rgba(255,255,255,0.02);border-radius:6px;font-size:13px;margin-top:4px;color:var(--muted)\">—</div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <footer style=\"margin-top:12px;color:var(--muted);font-size:13px\">Tip: Press Play to animate, Step to advance frame-by-frame, Back to step backwards.</footer>\n  </div>\n\n  <script>\n    // Insertion Sort Visualizer\n    const sizeEl = document.getElementById('size');\n    const maxEl = document.getElementById('max');\n    const sizeVal = document.getElementById('sizeVal');\n    const maxVal = document.getElementById('maxVal');\n    const barsEl = document.getElementById('bars');\n    const randomBtn = document.getElementById('randomBtn');\n    const almostSortedBtn = document.getElementById('almostSortedBtn');\n    const reverseBtn = document.getElementById('reverseBtn');\n    const manual = document.getElementById('manual');\n    const applyManual = document.getElementById('applyManual');\n    const resetBtn = document.getElementById('resetBtn');\n\n    const playBtn = document.getElementById('playBtn');\n    const stepBtn = document.getElementById('stepBtn');\n    const backBtn = document.getElementById('backBtn');\n    const toStart = document.getElementById('toStart');\n\n    const speedEl = document.getElementById('speed');\n    const speedVal = document.getElementById('speedVal');\n\n    const stepCountEl = document.getElementById('stepCount');\n    const totalStepsEl = document.getElementById('totalSteps');\n    const compCountEl = document.getElementById('compCount');\n    const shiftCountEl = document.getElementById('shiftCount');\n    const actionEl = document.getElementById('action');\n    const pseudocode = document.getElementById('pseudocode');\n\n    let arr = [];\n    let frames = []; // recorded frames\n    let cur = 0;\n    let playing = false;\n    let timer = null;\n    let speed = parseFloat(speedEl.value);\n\n    function randArray(n, max){\n      return Array.from({length:n},()=>Math.floor(Math.random()*max)+1);\n    }\n\n    function makeAlmostSorted(n, max){\n      const a = randArray(n, max).sort((a,b)=>a-b);\n      // introduce a few swaps\n      for(let k=0;k<Math.max(1,Math.floor(n/10));k++){\n        const i = Math.floor(Math.random()*n);\n        const j = Math.floor(Math.random()*n);\n        [a[i],a[j]]=[a[j],a[i]];\n      }\n      return a;\n    }\n\n    function makeReverse(n, max){\n      return randArray(n,max).sort((a,b)=>b-a);\n    }\n\n    function updateControlsDisplay(){\n      sizeVal.textContent = sizeEl.value;\n      maxVal.textContent = maxEl.value;\n      speedVal.textContent = speedEl.value + 'x';\n    }\n\n    function clone(a){ return a.slice(); }\n\n    // Generate frames that represent steps of insertion sort\n    function generateFrames(inputArr){\n      const a = inputArr.slice();\n      const n = a.length;\n      const frames = [];\n      let comps = 0;\n      let shifts = 0;\n\n      frames.push({type:'start', arr:clone(a), i:null, j:null, action:'Start' , comps, shifts});\n\n      for(let i=1;i<n;i++){\n        const key = a[i];\n        let j = i-1;\n\n        frames.push({type:'start_i', arr:clone(a), i, j, keyIndex:i, action:`Start iteration i=${i}`, comps, shifts});\n\n        while(j>=0){\n          // compare arr[j] and key\n          comps++;\n          frames.push({type:'compare', arr:clone(a), i, j, keyIndex:i, compared:[j,i], action:`Compare arr[${j}] (${a[j]}) > key (${key})?`, comps, shifts});\n\n          if(a[j] > key){\n            // shift a[j] to a[j+1]\n            a[j+1] = a[j];\n            shifts++;\n            frames.push({type:'shift', arr:clone(a), i, j, shiftedIndex:j+1, keyIndex:i, action:`Shift arr[${j}] to position ${j+1}`, comps, shifts});\n            j = j-1;\n            // after decrement, continue\n          } else {\n            frames.push({type:'no_shift', arr:clone(a), i, j, action:`No shift needed (arr[${j}] ≤ key)`, comps, shifts});\n            break;\n          }\n        }\n        // place key at j+1\n        a[j+1] = key;\n        shifts++;\n        frames.push({type:'place', arr:clone(a), i, j, placedIndex:j+1, action:`Place key at index ${j+1}`, comps, shifts});\n\n        frames.push({type:'done_i', arr:clone(a), i, sortedUpto:i, action:`End of iteration i=${i}`, comps, shifts});\n      }\n\n      frames.push({type:'done', arr:clone(a), action:'Array sorted', comps, shifts});\n      return frames;\n    }\n\n    // Render functions\n    function renderFrame(index){\n      if(!frames.length) return;\n      cur = Math.max(0, Math.min(index, frames.length-1));\n      const f = frames[cur];\n      // render bars\n      const values = f.arr;\n      const maxValInArr = Math.max(...values, 1);\n      barsEl.innerHTML = '';\n      const n = values.length;\n      for(let k=0;k<n;k++){\n        const val = values[k];\n        const bar = document.createElement('div');\n        bar.className = 'bar';\n        // height relative\n        const height = 20 + Math.round((val / maxValInArr) * 260);\n        bar.style.height = height + 'px';\n        // width distribution\n        bar.style.flex = '1 1 auto';\n        // colors\n        let bg = 'var(--bar)';\n        // sorted area: if f.sortedUpto present mark <= sortedUpto as sorted\n        if(f.sortedUpto !== undefined && k <= f.sortedUpto) bg = 'var(--sorted)';\n        // if final done: all sorted\n        if(f.type === 'done') bg = 'var(--sorted)';\n\n        // key element\n        if(f.keyIndex === k){\n          bg = 'var(--key)';\n          bar.style.transform = 'translateY(-6px)';\n        }\n        // compared\n        if(f.compared && f.compared.includes(k)){\n          bg = 'var(--comp)';\n          bar.style.transform = 'scale(1.03)';\n        }\n        // shifted\n        if(f.shiftedIndex === k){\n          bg = 'var(--shift)';\n          bar.style.transform = 'translateY(-4px)';\n        }\n        // placed\n        if(f.placedIndex === k){\n          bg = 'var(--sorted)';\n          bar.style.transform = 'translateY(-6px)';\n        }\n\n        bar.style.background = bg;\n        const valEl = document.createElement('div');\n        valEl.className = 'val';\n        valEl.textContent = val;\n        bar.appendChild(valEl);\n        barsEl.appendChild(bar);\n      }\n\n      // update stats & action\n      stepCountEl.textContent = cur;\n      totalStepsEl.textContent = frames.length - 1;\n      compCountEl.textContent = f.comps ?? (frames[cur]?.comps ?? 0);\n      shiftCountEl.textContent = f.shifts ?? (frames[cur]?.shifts ?? 0);\n      actionEl.textContent = f.action || '—';\n\n      // highlight pseudocode lines\n      const lines = pseudocode.querySelectorAll('.line');\n      lines.forEach(l=>l.classList.remove('active'));\n      // map frame types to lines:\n      // start_i -> lines 2 & 3, compare -> 4, shift->5, place->7, no_shift->4, done->none\n      const setActive = (nums)=> nums.forEach(n=>{\n        const el = pseudocode.querySelector(`.line[data-line=\"${n}\"]`);\n        if(el) el.classList.add('active');\n      });\n\n      switch(f.type){\n        case 'start_i': setActive([2,3]); break;\n        case 'compare': setActive([4]); break;\n        case 'shift': setActive([5,6]); break;\n        case 'no_shift': setActive([4]); break;\n        case 'place': setActive([7]); break;\n        default: break;\n      }\n    }\n\n    function play(){\n      if(playing) return;\n      playing = true; playBtn.textContent = 'Pause';\n      const stepInterval = 500 / speed; // base 500ms\n      function tick(){\n        if(!playing) return;\n        if(cur < frames.length -1){\n          cur++;\n          renderFrame(cur);\n          timer = setTimeout(tick, stepInterval);\n        } else {\n          playing = false; playBtn.textContent = 'Play';\n        }\n      }\n      timer = setTimeout(tick, stepInterval);\n    }\n\n    function pause(){\n      playing = false; playBtn.textContent = 'Play';\n      if(timer) clearTimeout(timer);\n      timer = null;\n    }\n\n    // UI events\n    sizeEl.addEventListener('input', ()=>{ updateControlsDisplay(); });\n    maxEl.addEventListener('input', ()=>{ updateControlsDisplay(); });\n    speedEl.addEventListener('input', ()=>{\n      speed = parseFloat(speedEl.value);\n      updateControlsDisplay();\n    });\n    updateControlsDisplay();\n\n    function loadAndGenerate(a){\n      arr = a.slice();\n      frames = generateFrames(arr);\n      cur = 0;\n      renderFrame(0);\n    }\n\n    randomBtn.addEventListener('click', ()=>{\n      const a = randArray(parseInt(sizeEl.value), parseInt(maxEl.value));\n      manual.value = a.join(', ');\n      loadAndGenerate(a);\n      pause();\n    });\n    almostSortedBtn.addEventListener('click', ()=>{\n      const a = makeAlmostSorted(parseInt(sizeEl.value), parseInt(maxEl.value));\n      manual.value = a.join(', ');\n      loadAndGenerate(a);\n      pause();\n    });\n    reverseBtn.addEventListener('click', ()=>{\n      const a = makeReverse(parseInt(sizeEl.value), parseInt(maxEl.value));\n      manual.value = a.join(', ');\n      loadAndGenerate(a);\n      pause();\n    });\n\n    applyManual.addEventListener('click', ()=>{\n      const txt = manual.value.trim();\n      if(!txt) return;\n      const parts = txt.split(/[\\s,]+/).filter(Boolean);\n      const nums = parts.map(x=>Number(x)).filter(x=>!Number.isNaN(x));\n      if(nums.length === 0){\n        alert('No valid numbers found.');\n        return;\n      }\n      loadAndGenerate(nums);\n      pause();\n    });\n\n    resetBtn.addEventListener('click', ()=>{\n      // re-render the current frame\n      renderFrame(0);\n      pause();\n    });\n\n    playBtn.addEventListener('click', ()=>{\n      if(playing) pause(); else play();\n    });\n\n    stepBtn.addEventListener('click', ()=>{\n      pause();\n      if(cur < frames.length -1){\n        cur++;\n        renderFrame(cur);\n      }\n    });\n\n    backBtn.addEventListener('click', ()=>{\n      pause();\n      if(cur > 0){\n        cur--;\n        renderFrame(cur);\n      }\n    });\n\n    toStart.addEventListener('click', ()=>{\n      pause();\n      cur = 0;\n      renderFrame(cur);\n    });\n\n    // initialize default array\n    (function init(){\n      const initArr = randArray(parseInt(sizeEl.value), parseInt(maxEl.value));\n      manual.value = initArr.join(', ');\n      loadAndGenerate(initArr);\n    })();\n\n    // keyboard shortcuts\n    window.addEventListener('keydown', (e)=>{\n      if(e.key === ' ') { e.preventDefault(); playBtn.click(); }\n      if(e.key === 'ArrowRight') { stepBtn.click(); }\n      if(e.key === 'ArrowLeft') { backBtn.click(); }\n      if(e.key === 'Home') { toStart.click(); }\n    });\n\n    // accessibility: resize bars when window resizes\n    window.addEventListener('resize', ()=> renderFrame(cur));\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Insertion Sort"
    }
  ],
  "topic": "Insertion Sort",
  "hasFSM": false,
  "hasTest": true
}