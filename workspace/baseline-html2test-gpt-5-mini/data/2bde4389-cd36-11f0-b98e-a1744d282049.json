{
  "id": "2bde4389-cd36-11f0-b98e-a1744d282049",
  "timestamp": "2025-11-29T15:16:53.980Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Counting Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Counting Sort Visualizer</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n  <style>\n    :root{\n      --bg:#0f1724; --panel:#0b1220; --muted:#98a0b3; --accent:#60a5fa; --accent2:#34d399;\n      --card:#0b1220; --glass:rgba(255,255,255,0.03);\n    }\n    html,body{height:100%; margin:0; font-family:Inter,ui-sans-serif,system-ui,-apple-system,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial; background:linear-gradient(180deg,#071024 0%, #071829 60%); color:#e6eef8;}\n    .app{max-width:1200px; margin:18px auto; padding:18px;}\n    header{display:flex;align-items:center;gap:12px;margin-bottom:12px}\n    h1{font-size:18px;margin:0}\n    .controls{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:12px}\n    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:10px; padding:12px; box-shadow: 0 6px 18px rgba(2,6,23,0.6); border:1px solid rgba(255,255,255,0.03)}\n    .left{display:flex;gap:12px;flex-direction:column;min-width:320px}\n    label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}\n    input[type=\"text\"], input[type=\"number\"], select{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:6px;color:var(--muted);width:100%}\n    button{background:linear-gradient(180deg,var(--accent),#2b6fc1);border:none;color:white;padding:8px 12px;border-radius:8px;cursor:pointer}\n    button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}\n    .row{display:flex;gap:8px;align-items:center}\n    .viz{display:flex;gap:12px}\n    .panel{flex:1; min-height:360px; padding:12px; display:flex;flex-direction:column; gap:12px}\n    .bars{display:flex;align-items:end;gap:6px;height:140px;padding:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:8px}\n    .bar{width:26px;background:linear-gradient(180deg,#60a5fa,#2563eb);border-radius:4px;display:flex;align-items:flex-end;justify-content:center;color:#071024;font-weight:600}\n    .bar.small{width:40px;background:linear-gradient(180deg,#34d399,#059669);color:#042018}\n    .counts{display:flex;gap:6px;align-items:end;height:100px;padding:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:8px}\n    .label{font-size:12px;color:var(--muted)}\n    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}\n    .code{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:12px;border-radius:8px;font-family:monospace;font-size:13px;color:#cfe8ff; max-height:340px; overflow:auto}\n    .code .line{padding:2px 6px;border-radius:4px}\n    .code .hl{background:linear-gradient(90deg, rgba(96,165,250,0.14), rgba(52,211,153,0.06)); color:white}\n    .log{background:#061229;padding:8px;border-radius:8px;color:var(--muted);font-size:13px; max-height:220px; overflow:auto}\n    .controls-bottom{display:flex;gap:8px;align-items:center;flex-wrap:wrap}\n    .small{font-size:12px;color:var(--muted)}\n    .status{font-size:13px;color:var(--accent2);font-weight:600}\n    footer{margin-top:12px;font-size:12px;color:var(--muted)}\n    @media (max-width:920px){\n      .viz{flex-direction:column}\n      .left{min-width:unset}\n    }\n  </style>\n</head>\n<body>\n  <div class=\"app\">\n    <header>\n      <h1>Counting Sort — Interactive Visualizer</h1>\n      <div class=\"small\" style=\"margin-left:8px\">Non-negative integers only • Stable variant shown</div>\n    </header>\n\n    <div class=\"controls\">\n      <div class=\"card left\">\n        <label>Array (comma or space separated integers)</label>\n        <input id=\"inputArray\" type=\"text\" placeholder=\"e.g. 4,3,2,6,1,3,2\" value=\"4,3,2,6,1,3,2\">\n        <div class=\"row\">\n          <div style=\"flex:1\">\n            <label>Random: size</label>\n            <input id=\"randSize\" type=\"number\" min=\"1\" max=\"40\" value=\"10\">\n          </div>\n          <div style=\"width:120px\">\n            <label>Max value (k)</label>\n            <input id=\"randMax\" type=\"number\" min=\"0\" max=\"100\" value=\"9\">\n          </div>\n          <div style=\"width:100px;display:flex;align-items:flex-end\">\n            <button id=\"btnRandom\" class=\"secondary\">Generate</button>\n          </div>\n        </div>\n\n        <div class=\"row\">\n          <div style=\"flex:1\">\n            <label>Mode</label>\n            <select id=\"mode\">\n              <option value=\"stable-asc\">Stable (ascending) — classic counting sort</option>\n              <option value=\"desc-nonstable\">Descending (non-stable) — fill by value</option>\n            </select>\n          </div>\n          <div style=\"width:160px\">\n            <label>Delay (ms) autoplay</label>\n            <input id=\"speed\" type=\"range\" min=\"50\" max=\"1500\" value=\"300\">\n            <div class=\"small\" id=\"speedLabel\">300 ms</div>\n          </div>\n        </div>\n\n        <div class=\"controls-bottom\">\n          <button id=\"btnStart\">Start</button>\n          <button id=\"btnStep\" class=\"secondary\">Step</button>\n          <button id=\"btnPause\" class=\"secondary\">Pause</button>\n          <button id=\"btnReset\" class=\"secondary\">Reset</button>\n          <div style=\"flex:1\"></div>\n          <div class=\"small\">Status: <span id=\"status\" class=\"status\">Idle</span></div>\n        </div>\n      </div>\n\n      <div class=\"card\" style=\"flex:1\">\n        <div class=\"viz\">\n          <div class=\"panel\" style=\"flex:1\">\n            <div class=\"label\">Input array (original)</div>\n            <div id=\"inputBars\" class=\"bars\"></div>\n            <div class=\"label\">Counts array (index = value)</div>\n            <div id=\"countsBars\" class=\"counts\"></div>\n            <div class=\"label\">Output array (building)</div>\n            <div id=\"outputBars\" class=\"bars\"></div>\n          </div>\n\n          <div style=\"width:420px;display:flex;flex-direction:column;gap:12px\">\n            <div class=\"code card\" id=\"codeBlock\" aria-hidden=\"false\">\n              <!-- pseudo-code will be injected -->\n            </div>\n            <div class=\"log card\" id=\"log\"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <footer class=\"small card\">\n      How it works: Counting sort counts how many items have each key (value), computes starting positions using prefix sums, and places items into the output according to those positions. The stable variant processes input from right to left when placing so equal keys keep their relative order.\n    </footer>\n  </div>\n\n  <script>\n  // Counting Sort Visualizer\n  // Author: generated interactive demo\n  (function(){\n    // Elements\n    const inputArrayEl = document.getElementById('inputArray');\n    const randSizeEl = document.getElementById('randSize');\n    const randMaxEl = document.getElementById('randMax');\n    const btnRandom = document.getElementById('btnRandom');\n    const modeEl = document.getElementById('mode');\n    const speedEl = document.getElementById('speed');\n    const speedLabel = document.getElementById('speedLabel');\n    const btnStart = document.getElementById('btnStart');\n    const btnStep = document.getElementById('btnStep');\n    const btnPause = document.getElementById('btnPause');\n    const btnReset = document.getElementById('btnReset');\n    const inputBars = document.getElementById('inputBars');\n    const countsBars = document.getElementById('countsBars');\n    const outputBars = document.getElementById('outputBars');\n    const codeBlock = document.getElementById('codeBlock');\n    const logEl = document.getElementById('log');\n    const statusEl = document.getElementById('status');\n\n    let state = {\n      arr: [],\n      k: 0,\n      actions: [],\n      stepIndex: 0,\n      playing: false,\n      timer: null\n    };\n\n    // Pseudo-code lines\n    const codeLines = [\n      \"1. k = max(A)  // or provided maximum key\",\n      \"2. initialize counts[0..k] = 0\",\n      \"3. for j = 0 .. n-1: counts[A[j]]++   // count occurrences\",\n      \"4. for i = 1 .. k: counts[i] += counts[i-1]   // prefix sums (starting indices)\",\n      \"5. // stable placement (ascending):\",\n      \"6. for j = n-1 .. 0: output[counts[A[j]] - 1] = A[j]; counts[A[j]]--\",\n      \"7. // non-stable descending (alternate):\",\n      \"8. p = 0\",\n      \"9. for v = k .. 0: while counts[v]-- > 0: output[p++] = v\"\n    ];\n\n    function renderCode(highlightLine){\n      codeBlock.innerHTML = '';\n      codeLines.forEach((ln,i)=>{\n        const div = document.createElement('div');\n        div.textContent = ln;\n        div.className = 'line' + ((i+1) === highlightLine ? ' hl' : '');\n        codeBlock.appendChild(div);\n      });\n    }\n\n    // Helpers: parse input\n    function parseInputArray(){\n      const raw = inputArrayEl.value.trim();\n      if(!raw) return [];\n      const parts = raw.split(/[\\s,]+/).map(s=>s.trim()).filter(Boolean);\n      const nums = [];\n      for(const p of parts){\n        const v = Number(p);\n        if(!Number.isFinite(v) || v<0 || Math.floor(v)!==v){\n          alert(\"Only non-negative integers allowed. Invalid: \" + p);\n          return null;\n        }\n        nums.push(v);\n      }\n      return nums;\n    }\n\n    function generateRandom(){\n      const n = Math.max(1, Math.min(80, Number(randSizeEl.value) || 10));\n      const maxv = Math.max(0, Math.min(200, Number(randMaxEl.value) || 9));\n      const a = [];\n      for(let i=0;i<n;i++) a.push(Math.floor(Math.random()*(maxv+1)));\n      inputArrayEl.value = a.join(', ');\n    }\n\n    // Build operations by simulating the algorithm (recording actions)\n    function recordActions(arr, mode, givenK){\n      const A = arr.slice();\n      const n = A.length;\n      const k = Math.max(givenK===undefined? -1 : givenK, ...A, 0);\n      const counts = new Array(k+1).fill(0);\n      const output = new Array(n).fill(null);\n      const ops = [];\n\n      // initial state\n      ops.push({type:'init', arr:A.slice(), counts:counts.slice(), output:output.slice(), desc:`Initialize counts array with zeros (size k=${k})`, line:2});\n\n      // counting occurrences\n      for(let j=0;j<n;j++){\n        const v = A[j];\n        counts[v] += 1;\n        ops.push({type:'count', idx:j, val:v, counts:counts.slice(), arr:A.slice(), output:output.slice(), desc:`Count value ${v}: counts[${v}]++ => ${counts[v]}`, line:3});\n      }\n\n      if(mode === 'stable-asc'){\n        // prefix sums\n        for(let i=1;i<=k;i++){\n          counts[i] += counts[i-1];\n          ops.push({type:'cumulative', idx:i, counts:counts.slice(), desc:`Prefix sum at ${i}: counts[${i}] += counts[${i-1}] => ${counts[i]}`, line:4});\n        }\n        // stable placement: iterate from right to left\n        for(let j=n-1;j>=0;j--){\n          const v = A[j];\n          const pos = counts[v] - 1;\n          output[pos] = v;\n          counts[v] -= 1;\n          ops.push({type:'place', fromIndex:j, value:v, toIndex:pos, counts:counts.slice(), arr:A.slice(), output:output.slice(), desc:`Place A[${j}]=${v} at output[${pos}] (counts[${v}]-- => ${counts[v]})`, line:6});\n        }\n        ops.push({type:'done', counts:counts.slice(), output:output.slice(), desc:'Completed stable ascending counting sort', line:null});\n      } else {\n        // descending non-stable: fill output by value from k down to 0\n        let p = 0;\n        // Note: we recorded counts already in counting phase\n        for(let v=k; v>=0; v--){\n          while(counts[v] > 0){\n            output[p] = v;\n            counts[v] -= 1;\n            ops.push({type:'fillDesc', value:v, toIndex:p, counts:counts.slice(), arr:A.slice(), output:output.slice(), desc:`Place value ${v} at output[${p}] (counts[${v}]-- => ${counts[v]})`, line:9});\n            p++;\n          }\n        }\n        ops.push({type:'done', counts:counts.slice(), output:output.slice(), desc:'Completed descending non-stable counting sort', line:null});\n      }\n\n      return {ops, k};\n    }\n\n    // Rendering visual arrays\n    function renderBars(container, values, options={}){\n      // Options: maxValue (for scaling), showIndex, small\n      container.innerHTML = '';\n      const maxVal = options.maxValue !== undefined ? options.maxValue : Math.max(...values.map(v=>v===null?0:v), 1);\n      const showIndex = options.showIndex || false;\n      const small = options.small || false;\n      const width = small ? 40 : 26;\n      values.forEach((v,i)=>{\n        const bar = document.createElement('div');\n        bar.className = 'bar' + (small ? ' small' : '');\n        const val = (v===null)? '' : String(v);\n        bar.style.height = ( (v===null?0:v) / (maxVal||1) * 100 ) + '%';\n        bar.title = val;\n        bar.style.transition = 'height 200ms, background 200ms';\n        bar.textContent = val;\n        bar.style.minWidth = width + 'px';\n        container.appendChild(bar);\n        if(showIndex){\n          const idx = document.createElement('div');\n          idx.style.fontSize='11px'; idx.style.color='var(--muted)';\n          idx.textContent = i; container.appendChild(idx);\n        }\n      });\n    }\n\n    // Render counts array with indices below bars\n    function renderCounts(container, counts){\n      container.innerHTML = '';\n      const maxCount = Math.max(...counts, 1);\n      counts.forEach((c,i)=>{\n        const wrap = document.createElement('div');\n        wrap.style.display = 'flex'; wrap.style.flexDirection='column'; wrap.style.alignItems='center';\n        const bar = document.createElement('div');\n        bar.className = 'bar small';\n        bar.style.height = (c / maxCount * 100) + '%';\n        bar.style.width = '34px';\n        bar.style.background = 'linear-gradient(180deg,#fbbf24,#fb923c)';\n        bar.textContent = c===0? '' : String(c);\n        bar.title = String(c);\n        bar.style.marginBottom = '6px';\n        wrap.appendChild(bar);\n        const lbl = document.createElement('div');\n        lbl.textContent = i; lbl.style.fontSize='12px'; lbl.style.color='var(--muted)';\n        wrap.appendChild(lbl);\n        container.appendChild(wrap);\n      });\n    }\n\n    // Log helper\n    function log(msg){\n      const d = document.createElement('div');\n      d.textContent = msg;\n      logEl.appendChild(d);\n      logEl.scrollTop = logEl.scrollHeight;\n    }\n\n    function setStatus(s){\n      statusEl.textContent = s;\n    }\n\n    // Playback control\n    function applyAction(action){\n      // update visuals & code highlight & log\n      if(action.arr) renderBars(inputBars, action.arr, {maxValue: Math.max(...action.arr,1)});\n      if(action.counts) renderCounts(countsBars, action.counts);\n      if(action.output) renderBars(outputBars, action.output, {maxValue: Math.max(...state.arr,1)});\n      if(action.desc) log(action.desc);\n      renderCode(action.line || null);\n    }\n\n    async function play(){\n      if(state.playing) return;\n      state.playing = true;\n      setStatus('Playing');\n      while(state.playing && state.stepIndex < state.actions.length){\n        const a = state.actions[state.stepIndex];\n        applyAction(a);\n        state.stepIndex++;\n        const delay = Number(speedEl.value) || 300;\n        await new Promise(r=>state.playing ? setTimeout(r, delay) : r());\n      }\n      if(state.stepIndex >= state.actions.length){\n        setStatus('Completed');\n        state.playing = false;\n      } else {\n        setStatus('Paused');\n      }\n    }\n\n    function step(){\n      if(state.stepIndex >= state.actions.length){\n        setStatus('Completed');\n        return;\n      }\n      const a = state.actions[state.stepIndex];\n      applyAction(a);\n      state.stepIndex++;\n      setStatus(`Step ${state.stepIndex} / ${state.actions.length}`);\n      if(state.stepIndex >= state.actions.length) setStatus('Completed');\n    }\n\n    function pause(){\n      state.playing = false;\n      setStatus('Paused');\n    }\n\n    function resetUI(){\n      state.playing = false;\n      state.stepIndex = 0;\n      state.actions = [];\n      state.arr = [];\n      logEl.innerHTML = '';\n      inputBars.innerHTML = '';\n      countsBars.innerHTML = '';\n      outputBars.innerHTML = '';\n      renderCode(null);\n      setStatus('Idle');\n    }\n\n    // Wire controls\n    btnRandom.addEventListener('click', ()=>{\n      generateRandom();\n    });\n\n    speedEl.addEventListener('input', ()=>{\n      speedLabel.textContent = speedEl.value + ' ms';\n    });\n\n    btnStart.addEventListener('click', ()=>{\n      // prepare and play\n      const A = parseInputArray();\n      if(A === null) return;\n      if(A.length === 0){\n        alert('Provide at least one number.');\n        return;\n      }\n      const mode = modeEl.value;\n      const kGiven = Number(randMaxEl.value);\n      resetUI();\n      state.arr = A.slice();\n      const rec = recordActions(A, mode, kGiven);\n      state.actions = rec.ops;\n      state.k = rec.k;\n      // Render initial arrays\n      renderBars(inputBars, state.arr, {maxValue: Math.max(...state.arr,1)});\n      // initial counts (first action)\n      if(state.actions.length>0 && state.actions[0].counts) renderCounts(countsBars, state.actions[0].counts);\n      renderBars(outputBars, new Array(state.arr.length).fill(null), {maxValue: Math.max(...state.arr,1)});\n      logEl.innerHTML = '';\n      state.stepIndex = 0;\n      play();\n    });\n\n    btnStep.addEventListener('click', ()=>{\n      if(state.actions.length===0){\n        // prepare actions but don't play\n        const A = parseInputArray();\n        if(A === null) return;\n        if(A.length === 0){\n          alert('Provide at least one number.');\n          return;\n        }\n        const mode = modeEl.value;\n        const kGiven = Number(randMaxEl.value);\n        resetUI();\n        state.arr = A.slice();\n        const rec = recordActions(A, mode, kGiven);\n        state.actions = rec.ops;\n        state.k = rec.k;\n        renderBars(inputBars, state.arr, {maxValue: Math.max(...state.arr,1)});\n        if(state.actions.length>0 && state.actions[0].counts) renderCounts(countsBars, state.actions[0].counts);\n        renderBars(outputBars, new Array(state.arr.length).fill(null), {maxValue: Math.max(...state.arr,1)});\n      }\n      pause();\n      step();\n    });\n\n    btnPause.addEventListener('click', ()=>{\n      pause();\n    });\n\n    btnReset.addEventListener('click', ()=>{\n      resetUI();\n    });\n\n    // initial render\n    renderCode(null);\n    renderBars(inputBars, [4,3,2,6,1,3,2], {maxValue:7});\n    renderCounts(countsBars, [0,0,0,0,0,0,0]);\n    renderBars(outputBars, new Array(7).fill(null), {maxValue:7});\n    log(\"Ready. Click Start to run counting sort or Step to step through.\");\n\n    // keyboard shortcuts\n    window.addEventListener('keydown', (e)=>{\n      if(e.key === ' ') { e.preventDefault(); if(state.playing) pause(); else btnStart.click(); }\n      if(e.key === 'ArrowRight') btnStep.click();\n    });\n  })();\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Counting Sort"
    }
  ],
  "topic": "Counting Sort",
  "hasFSM": false,
  "hasTest": true
}