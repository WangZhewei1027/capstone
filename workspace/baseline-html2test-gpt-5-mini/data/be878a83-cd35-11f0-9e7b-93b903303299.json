{
  "id": "be878a83-cd35-11f0-9e7b-93b903303299",
  "timestamp": "2025-11-29T15:13:49.408Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Union-Find (Disjoint Set)",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Union-Find (Disjoint Set) Interactive Demo</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n  <style>\n    :root{\n      --bg:#0f1724;\n      --panel:#0b1220;\n      --accent:#4f46e5;\n      --muted:#9aa4bf;\n      --good:#10b981;\n      --danger:#ef4444;\n      --card:#0b1220aa;\n      --glass: linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.005));\n      --font-sans: system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial;\n    }\n    html,body{height:100%; margin:0; font-family:var(--font-sans); background: radial-gradient(1200px 600px at 10% 10%, rgba(79,70,229,0.12), transparent), radial-gradient(900px 400px at 90% 90%, rgba(16,185,129,0.04), transparent), var(--bg); color:#e6eef8;}\n    .app{display:flex; height:100vh; gap:16px; padding:18px; box-sizing:border-box;}\n    .left{width:720px; min-width:420px; background:var(--panel); border-radius:12px; padding:12px; box-shadow:0 8px 30px rgba(2,6,23,0.7); display:flex; flex-direction:column; gap:12px;}\n    .right{flex:1; min-width:280px; background:var(--panel); border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:12px;}\n    .toolbar{display:flex; gap:8px; align-items:center; flex-wrap:wrap;}\n    .btn{background:transparent; border:1px solid rgba(255,255,255,0.06); padding:8px 10px; border-radius:8px; color:var(--muted); cursor:pointer;}\n    .btn.primary{background:linear-gradient(90deg,var(--accent),#06b6d4); color:white; border:none; box-shadow:0 6px 18px rgba(79,70,229,0.12);}\n    .btn.warn{background:linear-gradient(90deg,#ef4444,#fb923c); color:white;}\n    .btn.ghost{background:transparent; border:1px dashed rgba(255,255,255,0.04);}\n    .small{font-size:13px; padding:6px 8px;}\n    .svg-wrap{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); border-radius:10px; padding:8px; flex:1; display:flex; align-items:center; justify-content:center;}\n    svg{width:100%; height:520px; border-radius:10px; overflow:visible;}\n    .controls{display:flex; gap:8px; align-items:center; flex-wrap:wrap;}\n    .panel{background:var(--card); border-radius:10px; padding:10px; box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);}\n    .muted{color:var(--muted); font-size:13px;}\n    .log{flex:1; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:8px; padding:10px; overflow:auto; max-height:260px; font-size:13px;}\n    .row{display:flex; gap:8px; align-items:center;}\n    .switch{display:flex; gap:6px; align-items:center;}\n    .node{cursor:pointer;}\n    .legend{display:flex; gap:8px; flex-wrap:wrap;}\n    .chip{padding:6px 8px; border-radius:999px; background:rgba(255,255,255,0.02); font-size:13px;}\n    .code{background:rgba(0,0,0,0.25); padding:8px; border-radius:8px; font-family:monospace; font-size:12px; color:#dce7ff;}\n    footer{font-size:12px; color:var(--muted); text-align:center; margin-top:6px;}\n    /* node visuals */\n    .node-circle{transition:transform 160ms ease, filter 160ms ease;}\n    .node-label{font-size:12px; pointer-events:none;}\n    .parent-line{stroke:#9aa4bf; stroke-opacity:0.28; stroke-width:2; marker-end:url(#arrow);} \n    .highlight-line{stroke: #60a5fa; stroke-width:3; stroke-opacity:0.95;}\n    .root-circle{stroke:#fde68a; stroke-width:2;}\n    .set-color-legend{width:14px;height:14px;border-radius:4px;display:inline-block;margin-right:6px;}\n    /* tooltip */\n    .tooltip{position:fixed;background:#020617; padding:8px 10px;border-radius:6px; box-shadow:0 6px 20px rgba(2,6,23,0.7); color:#cfe8ff; font-size:13px; pointer-events:none; z-index:9999; opacity:0.98;}\n  </style>\n</head>\n<body>\n  <div class=\"app\">\n    <div class=\"left\">\n      <div class=\"toolbar\">\n        <div class=\"controls\">\n          <button class=\"btn primary\" id=\"addNode\">Add node</button>\n          <button class=\"btn\" id=\"addMany\">Add 5</button>\n          <button class=\"btn\" id=\"randomExample\">Random example</button>\n          <button class=\"btn ghost\" id=\"reset\">Reset</button>\n          <label class=\"panel small\" title=\"Click two nodes to union; click one to find\">\n            <input type=\"checkbox\" id=\"autoAdd\" /> Auto place nodes\n          </label>\n        </div>\n        <div style=\"flex:1\"></div>\n        <div class=\"controls\">\n          <label class=\"panel small muted\">Union method</label>\n          <select id=\"unionMethod\" class=\"btn small\">\n            <option value=\"rank\">Union by rank</option>\n            <option value=\"size\">Union by size</option>\n            <option value=\"naive\">Naive (no balancing)</option>\n          </select>\n          <label class=\"panel small\" title=\"Path compression flattens the tree during find\">\n            <input type=\"checkbox\" id=\"pathCompression\" checked /> Path compression\n          </label>\n        </div>\n      </div>\n\n      <div class=\"svg-wrap panel\" id=\"canvasWrap\">\n        <svg id=\"svgCanvas\" viewBox=\"0 0 1000 600\" preserveAspectRatio=\"xMidYMid meet\">\n          <defs>\n            <marker id=\"arrow\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto-start-reverse\">\n              <path d=\"M 0 0 L 10 5 L 0 10 z\" fill=\"#9aa4bf\" fill-opacity=\"0.9\" />\n            </marker>\n            <marker id=\"arrowBright\" viewBox=\"0 0 10 10\" refX=\"9\" refY=\"5\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto-start-reverse\">\n              <path d=\"M 0 0 L 10 5 L 0 10 z\" fill=\"#60a5fa\" />\n            </marker>\n          </defs>\n          <g id=\"edges\"></g>\n          <g id=\"nodes\"></g>\n        </svg>\n      </div>\n\n      <div class=\"row\">\n        <div style=\"flex:1\" class=\"panel\">\n          <div style=\"display:flex; justify-content:space-between; align-items:center; gap:12px;\">\n            <div>\n              <strong>Operations</strong>\n              <div class=\"muted\" style=\"margin-top:4px\">Click nodes to perform actions. Use log to follow steps.</div>\n            </div>\n            <div class=\"legend\">\n              <div class=\"chip\"><span class=\"set-color-legend\" style=\"background:#60a5fa\"></span> Root / Highlight</div>\n              <div class=\"chip\"><span class=\"set-color-legend\" style=\"background:#f97316\"></span> Compressed pointer</div>\n              <div class=\"chip\"><span class=\"set-color-legend\" style=\"background:#9aa4bf\"></span> Parent pointer</div>\n            </div>\n          </div>\n          <div style=\"margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;\">\n            <button class=\"btn\" id=\"selectMode\">Select (Union)</button>\n            <button class=\"btn\" id=\"findMode\">Find</button>\n            <button class=\"btn\" id=\"autoFindRoots\">Show roots</button>\n            <button class=\"btn primary\" id=\"runAllFinds\">Find all (compress)</button>\n            <button class=\"btn warn\" id=\"shuffleLayout\">Shuffle layout</button>\n          </div>\n        </div>\n\n        <div style=\"width:340px\" class=\"panel\">\n          <div style=\"display:flex; justify-content:space-between; align-items:center;\">\n            <strong>DSU State</strong>\n            <div class=\"muted\">n = <span id=\"nCount\">0</span></div>\n          </div>\n          <div style=\"margin-top:8px;\">\n            <div class=\"muted\">Parent array (index: parent)</div>\n            <pre class=\"code\" id=\"parentView\">[]</pre>\n            <div class=\"muted\">Rank / Size</div>\n            <pre class=\"code\" id=\"rankView\">[]</pre>\n          </div>\n        </div>\n      </div>\n\n      <div style=\"display:flex; gap:8px;\">\n        <div style=\"flex:1\" class=\"panel\">\n          <div style=\"display:flex; justify-content:space-between; align-items:center;\">\n            <strong>Execution log</strong>\n            <div class=\"muted\">step by step</div>\n          </div>\n          <div class=\"log\" id=\"log\"></div>\n        </div>\n\n        <div style=\"width:320px\" class=\"panel\">\n          <strong>Notes & Complexity</strong>\n          <div class=\"muted\" style=\"margin-top:8px; font-size:13px;\">\n            - Union by rank/size + path compression results in nearly constant amortized time per operation: α(n) (inverse Ackermann).\n            - Use path compression to flatten trees during find. Use union by rank/size to attach smaller tree under larger.\n            - Click two nodes in Select (Union) mode to union them; click one node in Find mode to trace find.\n          </div>\n        </div>\n      </div>\n\n      <footer>\n        Interactive demo of Union-Find (Disjoint Set Union). Click nodes to operate. Visualizes parent pointers, finds and path compression.\n      </footer>\n    </div>\n\n    <div class=\"right\">\n      <div class=\"panel\">\n        <strong>Tutorial</strong>\n        <ol style=\"margin-top:8px; color:var(--muted); font-size:13px;\">\n          <li>Create nodes (Add node / Add 5)</li>\n          <li>Click \"Select (Union)\" then click two nodes to union them</li>\n          <li>Use \"Find\" mode to see which root a node belongs to (animated traversal)</li>\n          <li>Toggle path compression or union method and hit \"Find all (compress)\" to see effects</li>\n        </ol>\n      </div>\n\n      <div class=\"panel\">\n        <strong>Code (conceptual)</strong>\n        <pre class=\"code\">\nclass DSU {\n  constructor(n){\n    parent = Array(n).fill().map((_,i)=>i);\n    rank = Array(n).fill(0);\n  }\n  find(x){\n    if(parent[x] !== x) parent[x] = find(parent[x]); // path compression\n    return parent[x];\n  }\n  union(a,b){\n    ra = find(a); rb = find(b);\n    if(ra===rb) return;\n    if(rank[ra] &gt; rank[rb]) parent[rb]=ra;\n    else if(rank[ra] &lt; rank[rb]) parent[ra]=rb;\n    else parent[rb]=ra, rank[ra]++;\n  }\n}\n        </pre>\n      </div>\n\n      <div class=\"panel\" style=\"flex:1; overflow:auto;\">\n        <strong>Quick tips</strong>\n        <ul style=\"color:var(--muted); font-size:13px; margin-top:8px;\">\n          <li>Path compression flattens paths by setting every visited node's parent to the root.</li>\n          <li>Union by size attaches smaller tree under larger (keeps height small).</li>\n          <li>Combining both gives effectively constant time for millions of operations in practice.</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n\n  <script>\n  // ---- Interactive Union-Find Demo ----\n  (function(){\n    const svg = document.getElementById('svgCanvas');\n    const nodesG = document.getElementById('nodes');\n    const edgesG = document.getElementById('edges');\n    const logEl = document.getElementById('log');\n    const parentView = document.getElementById('parentView');\n    const rankView = document.getElementById('rankView');\n    const nCountEl = document.getElementById('nCount');\n\n    // Controls\n    const addNodeBtn = document.getElementById('addNode');\n    const addManyBtn = document.getElementById('addMany');\n    const resetBtn = document.getElementById('reset');\n    const randomExampleBtn = document.getElementById('randomExample');\n    const unionMethodSel = document.getElementById('unionMethod');\n    const pathCompressionCb = document.getElementById('pathCompression');\n    const selectModeBtn = document.getElementById('selectMode');\n    const findModeBtn = document.getElementById('findMode');\n    const autoFindRootsBtn = document.getElementById('autoFindRoots');\n    const runAllFindsBtn = document.getElementById('runAllFinds');\n    const shuffleLayoutBtn = document.getElementById('shuffleLayout');\n    const addManyAuto = document.getElementById('autoAdd');\n\n    let mode = 'select'; // 'select' or 'find'\n    let lastSelected = null;\n    let autoPlace = false;\n\n    // Colors for sets\n    const palette = ['#60a5fa','#f97316','#fb7185','#34d399','#a78bfa','#f59e0b','#06b6d4','#ef4444','#f472b6','#7c3aed'];\n\n    function log(msg, kind='info'){\n      const el = document.createElement('div');\n      el.innerHTML = msg;\n      el.style.marginBottom='6px';\n      if(kind==='step') el.style.color='#cfe8ff';\n      logEl.prepend(el);\n    }\n\n    // DSU implementation with step tracing for animation\n    class DSU {\n      constructor(){\n        this.parent = [];\n        this.rank = []; // or size depends on method\n      }\n      makeSet(){\n        const i = this.parent.length;\n        this.parent.push(i);\n        this.rank.push(1);\n        return i;\n      }\n      size(){return this.parent.length;}\n      // find with optional recording of path visited; does NOT compress automatically unless compress=true\n      findWithPath(x, compress){\n        const visited = [];\n        let cur = x;\n        while(this.parent[cur] !== cur){\n          visited.push(cur);\n          cur = this.parent[cur];\n        }\n        const root = cur;\n        if(compress){\n          for(const v of visited) this.parent[v] = root;\n        }\n        return {root, visited};\n      }\n      union(a,b, method='rank'){\n        const fa = this.findWithPath(a,false).root;\n        const fb = this.findWithPath(b,false).root;\n        if(fa===fb) return {merged:false, root:fa, other:fb};\n        if(method==='rank'){\n          // rank[] stores rank in conceptual sense (height)\n          if(this.rank[fa] > this.rank[fb]) {\n            this.parent[fb] = fa;\n            return {merged:true, parent:fa, child:fb};\n          } else if(this.rank[fa] < this.rank[fb]) {\n            this.parent[fa] = fb;\n            return {merged:true, parent:fb, child:fa};\n          } else {\n            this.parent[fb] = fa;\n            this.rank[fa] = this.rank[fa] + 1;\n            return {merged:true, parent:fa, child:fb, rankInc:fa};\n          }\n        } else if(method==='size'){\n          // treat rank as size\n          if(this.rank[fa] >= this.rank[fb]){\n            this.parent[fb] = fa;\n            this.rank[fa] += this.rank[fb];\n            return {merged:true, parent:fa, child:fb};\n          } else {\n            this.parent[fa] = fb;\n            this.rank[fb] += this.rank[fa];\n            return {merged:true, parent:fb, child:fa};\n          }\n        } else {\n          // naive\n          this.parent[fb] = fa;\n          return {merged:true, parent:fa, child:fb};\n        }\n      }\n    }\n\n    const dsu = new DSU();\n    let nodes = []; // {id,x,y,elGroup}\n    let layoutSeed = 1;\n\n    function updateStateViews(){\n      parentView.textContent = JSON.stringify(dsu.parent);\n      rankView.textContent = JSON.stringify(dsu.rank);\n      nCountEl.textContent = dsu.size();\n    }\n\n    function clearSVG(){\n      nodesG.innerHTML = '';\n      edgesG.innerHTML = '';\n      nodes = [];\n    }\n\n    function placeNode(id, x=null, y=null){\n      const W = 1000, H = 520;\n      if(x===null || y===null){\n        // auto layout: grid-like with jitter\n        const cols = Math.max(1, Math.round(Math.sqrt(dsu.size())));\n        const row = Math.floor(id/cols);\n        const col = id%cols;\n        const gapX = W / (cols+1);\n        const gapY = 80;\n        x = (col+1) * gapX + (Math.sin((id+layoutSeed)*1.3)*20);\n        y = 80 + row*gapY + (Math.cos((id+layoutSeed)*0.9)*14);\n      }\n      const g = document.createElementNS('http://www.w3.org/2000/svg','g');\n      g.classList.add('node');\n      g.setAttribute('data-id', id);\n\n      // circle\n      const circle = document.createElementNS('http://www.w3.org/2000/svg','circle');\n      circle.setAttribute('cx', x);\n      circle.setAttribute('cy', y);\n      circle.setAttribute('r', 20);\n      circle.setAttribute('fill', '#071129');\n      circle.setAttribute('stroke', '#1f2937');\n      circle.setAttribute('class', 'node-circle');\n      circle.style.filter = 'drop-shadow(0 6px 18px rgba(2,6,23,0.6))';\n      g.appendChild(circle);\n\n      // id label\n      const label = document.createElementNS('http://www.w3.org/2000/svg','text');\n      label.setAttribute('x', x);\n      label.setAttribute('y', y+5);\n      label.setAttribute('text-anchor','middle');\n      label.setAttribute('class','node-label');\n      label.textContent = id;\n      g.appendChild(label);\n\n      // mini rank/size indicator\n      const sub = document.createElementNS('http://www.w3.org/2000/svg','text');\n      sub.setAttribute('x', x+28);\n      sub.setAttribute('y', y-18);\n      sub.setAttribute('class','node-label');\n      sub.setAttribute('font-size','10');\n      sub.style.fill='#9aa4bf';\n      sub.textContent = '';\n      sub.setAttribute('data-sub','1');\n      g.appendChild(sub);\n\n      // attach\n      nodesG.appendChild(g);\n\n      // events\n      g.addEventListener('click', (ev)=>{\n        ev.stopPropagation();\n        const id = Number(g.getAttribute('data-id'));\n        onNodeClick(id, g);\n      });\n\n      nodes.push({id,x,y,g, circle, label, sub});\n    }\n\n    function redrawEdges(){\n      edgesG.innerHTML = '';\n      // draw parent pointers for every node except roots\n      for(const node of nodes){\n        const id = node.id;\n        const p = dsu.parent[id];\n        if(p === undefined) continue;\n        if(p === id) continue;\n        const from = {x: node.x, y: node.y};\n        const parentNode = nodes.find(n=>n.id===p);\n        if(!parentNode) continue;\n        const to = {x: parentNode.x, y: parentNode.y};\n        // draw curved line\n        const dx = to.x - from.x;\n        const dy = to.y - from.y;\n        const mx = (from.x + to.x)/2;\n        const my = (from.y + to.y)/2;\n        const cx = mx - dy*0.1;\n        const cy = my + dx*0.08;\n        const path = document.createElementNS('http://www.w3.org/2000/svg','path');\n        const d = `M ${from.x} ${from.y} Q ${cx} ${cy} ${to.x} ${to.y}`;\n        path.setAttribute('d', d);\n        path.setAttribute('class','parent-line');\n        path.setAttribute('data-from', id);\n        path.setAttribute('data-to', p);\n        edgesG.appendChild(path);\n      }\n    }\n\n    function refreshAllVisuals(){\n      // update subs (rank/size) and colors\n      for(const node of nodes){\n        const id = node.id;\n        const p = dsu.parent[id];\n        const r = dsu.rank[id];\n        node.sub.textContent = `p:${p} r:${r}`;\n        node.label.textContent = id;\n        node.circle.setAttribute('stroke', id===p ? '#fde68a' : '#1f2937');\n      }\n      redrawEdges();\n      updateStateViews();\n    }\n\n    function addNode(){\n      const id = dsu.makeSet();\n      if(addManyAuto.checked){\n        // automatic layout; we'll place automatically\n        placeNode(id, null, null);\n      } else {\n        // place near center with slight jitter\n        const x = 200 + (Math.random()*600);\n        const y = 60 + (Math.random()*420);\n        placeNode(id,x,y);\n      }\n      refreshAllVisuals();\n      log(`makeSet: created node ${id}`, 'step');\n    }\n\n    function resetAll(){\n      dsu.parent = [];\n      dsu.rank = [];\n      layoutSeed++;\n      clearSVG();\n      log('Reset all nodes', 'info');\n      updateStateViews();\n      lastSelected = null;\n    }\n\n    function onNodeClick(id, g){\n      if(mode==='select'){\n        if(lastSelected === null){\n          lastSelected = id;\n          highlightNode(id);\n          log(`Selected node ${id} (first) — choose another to union`, 'info');\n        } else if(lastSelected === id){\n          unhighlightAll();\n          lastSelected = null;\n          log(`Deselected node ${id}`, 'info');\n        } else {\n          // perform union\n          const a = lastSelected, b = id;\n          unhighlightAll();\n          lastSelected = null;\n          animateUnion(a,b);\n        }\n      } else if(mode==='find'){\n        animateFind(id);\n      }\n    }\n\n    function highlightNode(id, color='#60a5fa'){\n      for(const node of nodes){\n        if(node.id===id){\n          node.circle.setAttribute('transform','scale(1.06)');\n          node.circle.setAttribute('stroke', color);\n          node.circle.setAttribute('stroke-width','2.5');\n        } else {\n          node.circle.setAttribute('transform','');\n          node.circle.setAttribute('stroke-width','1.2');\n          node.circle.setAttribute('stroke', dsu.parent[node.id]===node.id ? '#fde68a' : '#1f2937');\n        }\n      }\n    }\n\n    function unhighlightAll(){\n      for(const node of nodes){\n        node.circle.setAttribute('transform','');\n        node.circle.setAttribute('stroke-width','1.2');\n        node.circle.setAttribute('stroke', dsu.parent[node.id]===node.id ? '#fde68a' : '#1f2937');\n      }\n      // restore edge styles\n      for(const e of edgesG.querySelectorAll('path')) e.classList.remove('highlight-line');\n    }\n\n    // animate find with optional path compression\n    async function animateFind(start){\n      const compress = pathCompressionCb.checked;\n      log(`Find(${start}) — traversing...`, 'step');\n      // highlight path sequentially\n      const visited = [];\n      let cur = start;\n      while(dsu.parent[cur] !== cur){\n        visited.push(cur);\n        const nxt = dsu.parent[cur];\n        // highlight arrow from cur -> nxt\n        const pathEl = edgesG.querySelector(`path[data-from=\"${cur}\"][data-to=\"${nxt}\"]`);\n        if(pathEl) pathEl.classList.add('highlight-line');\n        highlightNode(cur, '#60a5fa');\n        await sleep(350);\n        cur = nxt;\n      }\n      // root reached\n      highlightNode(cur, '#fde68a');\n      log(`Root of ${start} is ${cur}`, 'info');\n      if(compress && visited.length){\n        // animate compression: set each visited node's parent to root visually\n        for(const v of visited){\n          // change style of edge\n          const prevParent = dsu.parent[v];\n          dsu.parent[v] = cur;\n          refreshAllVisuals();\n          const pathEl = edgesG.querySelector(`path[data-from=\"${v}\"][data-to=\"${cur}\"]`);\n          if(pathEl) pathEl.classList.add('highlight-line');\n          // temporarily color compressed arrow\n          await sleep(250);\n        }\n        log(`Path compression applied: all nodes on path now point to ${cur}`, 'info');\n      }\n      refreshAllVisuals();\n      await sleep(300);\n      unhighlightAll();\n    }\n\n    async function animateUnion(a,b){\n      const method = unionMethodSel.value;\n      log(`Union(${a}, ${b}) — method: ${method}`, 'step');\n      // show finds for both\n      highlightNode(a,'#60a5fa'); await sleep(300);\n      await animateFind(a);\n      highlightNode(b,'#60a5fa'); await sleep(300);\n      await animateFind(b);\n      // perform union with animated effect\n      const fa = dsu.findWithPath(a,false).root;\n      const fb = dsu.findWithPath(b,false).root;\n      if(fa===fb){\n        log(`They already share the same root ${fa}`, 'info');\n        return;\n      }\n      // show roots before union\n      highlightNode(fa,'#fde68a'); highlightNode(fb,'#fde68a');\n      await sleep(300);\n      // perform union in DSU, record what happens\n      const beforeRanks = dsu.rank.slice();\n      const res = dsu.union(a,b,method);\n      refreshAllVisuals();\n      // visualize connecting child->parent and flashing\n      if(res.merged){\n        const child = res.child, parent = res.parent;\n        log(`Attach root ${child} -> root ${parent}`, 'info');\n        // find the edge element just created and highlight it\n        await sleep(200);\n        const pathEl = edgesG.querySelector(`path[data-from=\"${child}\"][data-to=\"${parent}\"]`);\n        if(pathEl){\n          pathEl.classList.add('highlight-line');\n        }\n        // if rank changed, show\n        if(res.rankInc !== undefined){\n          log(`Rank of ${res.rankInc} increased (tie-breaker)`, 'info');\n        }\n      }\n      refreshAllVisuals();\n      await sleep(350);\n      unhighlightAll();\n    }\n\n    // utility\n    function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }\n\n    // initial wiring\n    addNodeBtn.addEventListener('click', ()=>{ addNode(); });\n    addManyBtn.addEventListener('click', ()=>{ for(let i=0;i<5;i++) addNode(); });\n    resetBtn.addEventListener('click', ()=>{ resetAll(); });\n    randomExampleBtn.addEventListener('click', ()=>{ randomExample(); });\n    unionMethodSel.addEventListener('change', ()=>{ log('Union method: '+unionMethodSel.value,'info'); });\n    pathCompressionCb.addEventListener('change', ()=>{ log('Path compression: '+(pathCompressionCb.checked?'ON':'OFF'),'info'); });\n\n    selectModeBtn.addEventListener('click', ()=>{ mode='select'; selectModeBtn.classList.add('primary'); findModeBtn.classList.remove('primary'); log('Mode: Select (Union)','info'); });\n    findModeBtn.addEventListener('click', ()=>{ mode='find'; findModeBtn.classList.add('primary'); selectModeBtn.classList.remove('primary'); log('Mode: Find','info'); });\n    autoFindRootsBtn.addEventListener('click', ()=>{ revealRoots(); });\n    runAllFindsBtn.addEventListener('click', async ()=>{ await findAllCompress(); });\n    shuffleLayoutBtn.addEventListener('click', ()=>{ shuffleLayout(); });\n\n    // initial mode visuals\n    selectModeBtn.classList.add('primary');\n\n    // create some random example unions\n    function randomExample(){\n      resetAll();\n      for(let i=0;i<10;i++) addNode();\n      const pairs = [];\n      for(let i=0;i<7;i++){\n        const a = Math.floor(Math.random()*10);\n        const b = Math.floor(Math.random()*10);\n        if(a!==b) pairs.push([a,b]);\n      }\n      (async ()=>{\n        for(const [a,b] of pairs){\n          await sleep(400);\n          await animateUnion(a,b);\n        }\n      })();\n    }\n\n    // Show which nodes are roots by coloring them\n    function revealRoots(){\n      for(const node of nodes){\n        const id=node.id;\n        if(dsu.parent[id]===id){\n          node.circle.setAttribute('stroke','#fde68a');\n          node.circle.setAttribute('stroke-width','2.5');\n        } else {\n          node.circle.setAttribute('stroke','#1f2937');\n          node.circle.setAttribute('stroke-width','1.2');\n        }\n      }\n      log('Roots highlighted', 'info');\n    }\n\n    // Run find for every node (compress optionally)\n    async function findAllCompress(){\n      const compress = pathCompressionCb.checked;\n      log('Find all nodes (this may apply path compression)', 'step');\n      for(let id=0; id<dsu.size(); id++){\n        await animateFind(id);\n      }\n      if(compress) log('After find-all with compression, trees are flattened.', 'info');\n    }\n\n    // Shuffle layout positions randomly and re-place nodes; keeps logical structure\n    function shuffleLayout(){\n      layoutSeed++;\n      for(const n of nodes){\n        const jitterX = (Math.random()*700)+120;\n        const jitterY = (Math.random()*420)+60;\n        n.x = jitterX;\n        n.y = jitterY;\n        // move circle and labels\n        const circle = n.circle;\n        circle.setAttribute('cx', n.x);\n        circle.setAttribute('cy', n.y);\n        n.label.setAttribute('x', n.x);\n        n.label.setAttribute('y', n.y+5);\n        n.sub.setAttribute('x', n.x+28);\n        n.sub.setAttribute('y', n.y-18);\n      }\n      refreshAllVisuals();\n      log('Shuffled layout', 'info');\n    }\n\n    // click on empty canvas to deselect\n    svg.addEventListener('click', (ev)=>{\n      lastSelected = null;\n      unhighlightAll();\n    });\n\n    // initialize some nodes for convenience\n    for(let i=0;i<6;i++) addNode();\n    updateStateViews();\n\n    // expose nothing to window (self-contained)\n  })();\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Union-Find (Disjoint Set)"
    }
  ],
  "topic": "Union-Find (Disjoint Set)",
  "hasFSM": false,
  "hasTest": true
}