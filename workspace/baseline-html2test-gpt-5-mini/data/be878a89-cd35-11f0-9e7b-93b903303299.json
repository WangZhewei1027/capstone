{
  "id": "be878a89-cd35-11f0-9e7b-93b903303299",
  "timestamp": "2025-11-29T15:13:48.612Z",
  "type": "html-to-test",
  "htmlModel": "gpt-5-mini",
  "playwrightModel": "gpt-5-mini",
  "status": "success",
  "question": "Quick Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Quick Sort Visualization</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n  <style>\n    :root {\n      --bg: #0f1724;\n      --panel: #0b1220;\n      --text: #e6eef8;\n      --muted: #9fb3d1;\n      --accent: #3b82f6;\n      --bar-bg: linear-gradient(180deg, #60a5fa 0%, #2563eb 100%);\n      --bar-sorted: linear-gradient(180deg, #34d399 0%, #059669 100%);\n      --bar-compare: #ef4444;\n      --bar-pivot: #f59e0b;\n      --bar-swap: #10b981;\n      --control-bg: rgba(255,255,255,0.03);\n    }\n    html,body {\n      height:100%;\n      margin:0;\n      background: radial-gradient(1200px 600px at 10% 10%, rgba(59,130,246,0.05), transparent),\n                  radial-gradient(1000px 500px at 90% 90%, rgba(16,185,129,0.03), transparent),\n                  var(--bg);\n      font-family: Inter, ui-sans-serif, system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial;\n      color: var(--text);\n      -webkit-font-smoothing:antialiased;\n      -moz-osx-font-smoothing:grayscale;\n    }\n    .app {\n      max-width:1100px;\n      margin:24px auto;\n      padding:18px;\n    }\n    header {\n      display:flex;\n      align-items:center;\n      justify-content:space-between;\n      gap:12px;\n      margin-bottom:12px;\n    }\n    h1 { font-size:20px; margin:0; letter-spacing:0.2px; }\n    .controls {\n      display:flex;\n      gap:10px;\n      align-items:center;\n      flex-wrap:wrap;\n    }\n    .panel {\n      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));\n      border: 1px solid rgba(255,255,255,0.04);\n      padding:12px;\n      border-radius:10px;\n      box-shadow: 0 6px 20px rgba(2,6,23,0.6);\n    }\n    .control-row {\n      display:flex;\n      gap:8px;\n      align-items:center;\n      flex-wrap:wrap;\n    }\n    label { font-size:13px; color:var(--muted); }\n    input[type=range] { accent-color: var(--accent); }\n    button {\n      background: var(--control-bg);\n      border: 1px solid rgba(255,255,255,0.04);\n      color:var(--text);\n      padding:8px 10px;\n      border-radius:8px;\n      cursor:pointer;\n      font-weight:600;\n    }\n    button.primary {\n      background: linear-gradient(90deg, rgba(59,130,246,0.12), rgba(16,185,129,0.06));\n      border: 1px solid rgba(59,130,246,0.18);\n      color:var(--text);\n    }\n    button:disabled { opacity:0.4; cursor:not-allowed; }\n    .main {\n      display:flex;\n      gap:12px;\n      margin-top:12px;\n    }\n    .vis {\n      flex:1;\n      height:420px;\n      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));\n      border-radius:10px;\n      padding:12px;\n      position:relative;\n      overflow:hidden;\n      display:flex;\n      align-items:end;\n      justify-content:center;\n    }\n    .bars {\n      width:100%;\n      height:100%;\n      display:flex;\n      align-items:end;\n      gap:2px;\n      padding:6px;\n    }\n    .bar {\n      background: var(--bar-bg);\n      width:20px;\n      border-radius:6px 6px 2px 2px;\n      display:flex;\n      align-items:flex-end;\n      justify-content:center;\n      color:rgba(255,255,255,0.9);\n      font-size:11px;\n      box-shadow: 0 2px 6px rgba(2,6,23,0.45), inset 0 -6px 12px rgba(255,255,255,0.02);\n      transition: height 200ms ease, background 200ms ease, transform 150ms ease;\n    }\n    .bar.small { font-size:9px; padding-bottom:4px; }\n    .bar .label { transform: translateY(6px); opacity:0.95; }\n    .legend { display:flex; gap:8px; align-items:center; margin-top:8px; flex-wrap:wrap; }\n    .legend .item { display:flex; gap:6px; align-items:center; color:var(--muted); font-size:13px; }\n    .swatch { width:14px; height:14px; border-radius:3px; border:1px solid rgba(255,255,255,0.04); }\n    .info {\n      width:270px;\n      min-width:220px;\n      display:flex;\n      flex-direction:column;\n      gap:8px;\n    }\n    .stat {\n      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));\n      padding:10px;\n      border-radius:8px;\n      border:1px solid rgba(255,255,255,0.03);\n      font-size:13px;\n      color:var(--muted);\n    }\n    .stack {\n      max-height:180px;\n      overflow:auto;\n      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, \"Roboto Mono\", monospace;\n      font-size:13px;\n      background: rgba(255,255,255,0.01);\n      border-radius:6px;\n      padding:8px;\n      color:var(--text);\n    }\n    footer { margin-top:12px; color:var(--muted); font-size:13px; text-align:center; }\n    @media (max-width:800px){\n      .main { flex-direction:column; }\n      .info { width:100%; }\n      .bars { gap:1px; padding:4px; }\n    }\n  </style>\n</head>\n<body>\n  <div class=\"app\">\n    <header>\n      <div>\n        <h1>Quick Sort Visualization</h1>\n        <div style=\"color:var(--muted); font-size:13px;\">Interactive demo showing pivot selection, partitioning, and swaps</div>\n      </div>\n      <div class=\"controls panel\">\n        <div class=\"control-row\">\n          <label>Array Size\n            <input id=\"size\" type=\"range\" min=\"5\" max=\"120\" value=\"40\" />\n          </label>\n          <label>Speed\n            <input id=\"speed\" type=\"range\" min=\"1\" max=\"100\" value=\"35\" />\n          </label>\n          <label style=\"display:flex;flex-direction:column;\">\n            Pivot\n            <select id=\"pivot\" style=\"margin-top:6px; padding:6px; border-radius:6px; background:transparent; color:var(--text); border:1px solid rgba(255,255,255,0.04);\">\n              <option value=\"last\">Last Element</option>\n              <option value=\"first\">First Element</option>\n              <option value=\"middle\">Middle Element</option>\n              <option value=\"random\">Random</option>\n              <option value=\"median\">Median of Three</option>\n            </select>\n          </label>\n          <button id=\"newArr\">New Array</button>\n          <button id=\"shuffle\">Shuffle</button>\n          <button id=\"sortBtn\" class=\"primary\">Start Sort</button>\n          <button id=\"pauseBtn\">Pause</button>\n          <button id=\"cancelBtn\">Cancel</button>\n        </div>\n      </div>\n    </header>\n\n    <div class=\"main\">\n      <div class=\"vis panel\" aria-hidden=\"false\">\n        <div id=\"bars\" class=\"bars\"></div>\n        <div style=\"position:absolute;left:12px;top:12px;\">\n          <div style=\"color:var(--muted); font-size:13px;\">Comparisons: <span id=\"comp\">0</span></div>\n          <div style=\"color:var(--muted); font-size:13px; margin-top:4px;\">Swaps: <span id=\"swaps\">0</span></div>\n        </div>\n        <div style=\"position:absolute; right:12px; top:12px; text-align:right;\">\n          <div style=\"color:var(--muted); font-size:13px;\">Speed: <span id=\"speedLabel\">35</span></div>\n          <div style=\"color:var(--muted); font-size:13px; margin-top:4px;\">Pivot: <span id=\"pivotLabel\">Last Element</span></div>\n        </div>\n        <div style=\"position:absolute; left:12px; bottom:12px;\">\n          <div class=\"legend\">\n            <div class=\"item\"><div class=\"swatch\" style=\"background:var(--bar-pivot)\"></div> Pivot</div>\n            <div class=\"item\"><div class=\"swatch\" style=\"background:var(--bar-compare)\"></div> Comparing</div>\n            <div class=\"item\"><div class=\"swatch\" style=\"background:var(--bar-swap)\"></div> Swapped</div>\n            <div class=\"item\"><div class=\"swatch\" style=\"background:var(--bar-sorted)\"></div> Sorted</div>\n          </div>\n        </div>\n      </div>\n\n      <aside class=\"info\">\n        <div class=\"stat\">\n          <strong>Algorithm Info</strong>\n          <div style=\"margin-top:8px; color:var(--muted); font-size:13px;\">\n            Quick Sort is a divide-and-conquer sorting algorithm. It picks a pivot and partitions the array so that elements less than pivot come before it and greater elements after. Then it recursively sorts the partitions.\n          </div>\n        </div>\n\n        <div class=\"stat\">\n          <strong>Recursion Stack</strong>\n          <div id=\"stack\" class=\"stack\" aria-live=\"polite\"></div>\n        </div>\n\n        <div class=\"stat\">\n          <strong>Controls</strong>\n          <div style=\"margin-top:8px; color:var(--muted); font-size:13px;\">\n            - New Array: generate a fresh random array.\n            <br>- Shuffle: randomize current array.\n            <br>- Start Sort: animate Quick Sort on the current array.\n            <br>- Pause / Resume and Cancel available during sorting.\n          </div>\n        </div>\n      </aside>\n    </div>\n\n    <footer class=\"panel\">\n      Tip: Try different pivot strategies (First, Last, Middle, Random, Median of Three) and watch how partitioning behavior changes.\n    </footer>\n  </div>\n\n  <script>\n    // Quick Sort Visualization - single-file demo\n    const barsEl = document.getElementById('bars');\n    const sizeInput = document.getElementById('size');\n    const speedInput = document.getElementById('speed');\n    const speedLabel = document.getElementById('speedLabel');\n    const pivotSelect = document.getElementById('pivot');\n    const pivotLabel = document.getElementById('pivotLabel');\n    const newBtn = document.getElementById('newArr');\n    const shuffleBtn = document.getElementById('shuffle');\n    const sortBtn = document.getElementById('sortBtn');\n    const pauseBtn = document.getElementById('pauseBtn');\n    const cancelBtn = document.getElementById('cancelBtn');\n    const compEl = document.getElementById('comp');\n    const swapsEl = document.getElementById('swaps');\n    const stackEl = document.getElementById('stack');\n\n    let arr = [];\n    let barEls = [];\n    let comparisons = 0;\n    let swaps = 0;\n\n    let paused = false;\n    let pauseResolvers = [];\n    let cancelRequested = false;\n    let running = false;\n\n    function createArray(n) {\n      arr = Array.from({length:n}, (_,i) => Math.floor(Math.random()*95)+5);\n      comparisons = 0;\n      swaps = 0;\n      updateStats();\n      render();\n    }\n\n    function render() {\n      barsEl.innerHTML = '';\n      barEls = [];\n      const n = arr.length;\n      const max = Math.max(...arr);\n      const small = n > 70;\n      for (let i=0;i<n;i++){\n        const b = document.createElement('div');\n        b.className = 'bar' + (small ? ' small' : '');\n        const h = Math.round((arr[i]/max) * 100);\n        b.style.height = h + '%';\n        b.dataset.index = i;\n        b.innerHTML = '<div class=\"label\">'+arr[i]+'</div>';\n        barsEl.appendChild(b);\n        barEls.push(b);\n      }\n    }\n\n    function updateStats() {\n      compEl.textContent = comparisons;\n      swapsEl.textContent = swaps;\n      speedLabel.textContent = speedInput.value;\n      pivotLabel.textContent = pivotSelect.options[pivotSelect.selectedIndex].text;\n    }\n\n    function colorBar(i, color) {\n      const el = barEls[i];\n      if (!el) return;\n      el.style.background = color;\n      el.style.transform = 'scale(1.02)';\n      setTimeout(()=>el.style.transform='scale(1)', 120);\n    }\n\n    function resetBarColor(i) {\n      const el = barEls[i];\n      if (!el) return;\n      el.style.background = '';\n    }\n\n    function markSorted(i) {\n      const el = barEls[i];\n      if (!el) return;\n      el.style.background = 'var(--bar-sorted)';\n      el.style.boxShadow = '0 4px 20px rgba(2,6,23,0.6)';\n    }\n\n    function swapVisual(i,j) {\n      // swap heights and labels\n      const a = barEls[i];\n      const b = barEls[j];\n      if (!a || !b) return;\n      const ha = a.style.height;\n      const hb = b.style.height;\n      const la = a.querySelector('.label').textContent;\n      const lb = b.querySelector('.label').textContent;\n      a.style.height = hb;\n      b.style.height = ha;\n      a.querySelector('.label').textContent = lb;\n      b.querySelector('.label').textContent = la;\n    }\n\n    function sleep(ms) {\n      // allow pause/resume and cancel\n      return new Promise((resolve, reject) => {\n        const start = performance.now();\n        function tick(){\n          if (cancelRequested) return reject(new Error('cancelled'));\n          if (paused) {\n            // push resolver to be resumed\n            pauseResolvers.push(() => {\n              if (cancelRequested) return reject(new Error('cancelled'));\n              waitMore();\n            });\n          } else {\n            waitMore();\n          }\n        }\n        function waitMore(){\n          const elapsed = performance.now() - start;\n          const remaining = ms - elapsed;\n          if (remaining <= 0) return resolve();\n          // wait in small chunks so we can react to pause/cancel quickly\n          setTimeout(()=> {\n            if (cancelRequested) return reject(new Error('cancelled'));\n            if (paused) {\n              pauseResolvers.push(() => {\n                if (cancelRequested) return reject(new Error('cancelled'));\n                waitMore();\n              });\n            } else {\n              waitMore();\n            }\n          }, Math.min(50, remaining));\n        }\n        tick();\n      });\n    }\n\n    function resumeAllFromPause() {\n      while (pauseResolvers.length) {\n        const r = pauseResolvers.shift();\n        try { r(); } catch(e) {}\n      }\n    }\n\n    function getDelay() {\n      // map speed (1..100) to delay (600ms..5ms)\n      const s = Number(speedInput.value);\n      const min = 5;\n      const max = 700;\n      // higher speed => smaller delay\n      const delay = Math.round(max - ((s-1)/99)*(max-min));\n      return delay;\n    }\n\n    function choosePivotIndex(l, r) {\n      const mode = pivotSelect.value;\n      if (mode === 'last') return r;\n      if (mode === 'first') return l;\n      if (mode === 'middle') return Math.floor((l+r)/2);\n      if (mode === 'random') return l + Math.floor(Math.random()*(r-l+1));\n      if (mode === 'median') {\n        const m = Math.floor((l+r)/2);\n        const trio = [\n          {i:l, v:arr[l]},\n          {i:m, v:arr[m]},\n          {i:r, v:arr[r]}\n        ];\n        trio.sort((a,b)=>a.v-b.v);\n        return trio[1].i;\n      }\n      return r;\n    }\n\n    // recursion stack visualization\n    let stackRanges = [];\n    function pushStack(l,r) {\n      stackRanges.push([l,r]);\n      renderStack();\n    }\n    function popStack() {\n      stackRanges.pop();\n      renderStack();\n    }\n    function renderStack() {\n      stackEl.innerHTML = '';\n      if (stackRanges.length===0) {\n        stackEl.innerHTML = '<div style=\"color:var(--muted);\">Stack is empty (idle)</div>';\n        return;\n      }\n      for (let i=stackRanges.length-1;i>=0;i--) {\n        const [l,r] = stackRanges[i];\n        const el = document.createElement('div');\n        el.textContent = `quickSort(${l}, ${r})`;\n        el.style.padding = '4px 6px';\n        el.style.borderRadius = '5px';\n        el.style.marginBottom = '6px';\n        el.style.background = i===stackRanges.length-1 ? 'rgba(59,130,246,0.08)' : 'rgba(255,255,255,0.01)';\n        el.style.color = 'var(--text)';\n        stackEl.appendChild(el);\n      }\n    }\n\n    async function partition(l, r) {\n      // Lomuto partition scheme (with pivot chosen by strategy), visually animated\n      const pIndex = choosePivotIndex(l,r);\n      // highlight pivot chosen\n      colorBar(pIndex, 'var(--bar-pivot)');\n      await sleep(getDelay());\n      if (pIndex !== r) {\n        // move pivot to end for Lomuto convenience\n        [arr[pIndex], arr[r]] = [arr[r], arr[pIndex]];\n        swapVisual(pIndex, r);\n        swaps++; updateStats();\n        colorBar(r, 'var(--bar-pivot)');\n        resetBarColor(pIndex);\n        await sleep(getDelay());\n      }\n      const pivot = arr[r];\n      let i = l - 1;\n      for (let j = l; j < r; j++) {\n        if (cancelRequested) throw new Error('cancelled');\n        comparisons++; updateStats();\n        colorBar(j, 'var(--bar-compare)');\n        await sleep(getDelay());\n        if (arr[j] <= pivot) {\n          i++;\n          if (i !== j) {\n            // swap arr[i] and arr[j]\n            colorBar(i, 'var(--bar-swap)');\n            colorBar(j, 'var(--bar-swap)');\n            await sleep(getDelay());\n            [arr[i], arr[j]] = [arr[j], arr[i]];\n            swapVisual(i,j);\n            swaps++; updateStats();\n            await sleep(getDelay());\n            resetBarColor(i);\n            resetBarColor(j);\n          } else {\n            // slight highlight for equality case\n            colorBar(i,'var(--bar-swap)');\n            await sleep(getDelay()/2);\n            resetBarColor(i);\n          }\n        }\n        resetBarColor(j);\n      }\n      // place pivot to correct position\n      if (i+1 !== r) {\n        colorBar(i+1,'var(--bar-swap)');\n        colorBar(r,'var(--bar-pivot)');\n        await sleep(getDelay());\n        [arr[i+1], arr[r]] = [arr[r], arr[i+1]];\n        swapVisual(i+1, r);\n        swaps++; updateStats();\n        await sleep(getDelay());\n        resetBarColor(r);\n        resetBarColor(i+1);\n      } else {\n        resetBarColor(r);\n      }\n      // mark pivot index as sorted-ish (not guaranteed global sorted until complete)\n      markSorted(i+1);\n      return i+1;\n    }\n\n    async function quickSort(l, r) {\n      if (cancelRequested) throw new Error('cancelled');\n      pushStack(l,r);\n      if (l < r) {\n        const p = await partition(l, r);\n        // allow small pause after partition\n        await sleep(Math.max(20, getDelay()/2));\n        await quickSort(l, p-1);\n        await quickSort(p+1, r);\n      } else if (l === r) {\n        // single element is sorted\n        markSorted(l);\n      }\n      popStack();\n    }\n\n    async function startSort() {\n      if (running) return;\n      running = true;\n      cancelRequested = false;\n      paused = false;\n      pauseBtn.textContent = 'Pause';\n      disableControlsWhileRunning(true);\n      updateStats();\n      stackRanges = [];\n      renderStack();\n      try {\n        await quickSort(0, arr.length-1);\n      } catch(e) {\n        // cancelled or error\n      } finally {\n        running = false;\n        disableControlsWhileRunning(false);\n        resumeAllFromPause(); // ensure no suspended promises remain\n      }\n    }\n\n    function disableControlsWhileRunning(dis) {\n      sizeInput.disabled = dis;\n      newBtn.disabled = dis;\n      shuffleBtn.disabled = dis;\n      pivotSelect.disabled = dis;\n      sortBtn.disabled = dis;\n    }\n\n    // Event bindings\n    sizeInput.addEventListener('input', () => {\n      const n = Number(sizeInput.value);\n      createArray(n);\n    });\n\n    speedInput.addEventListener('input', () => {\n      speedLabel.textContent = speedInput.value;\n    });\n\n    pivotSelect.addEventListener('change', () => {\n      pivotLabel.textContent = pivotSelect.options[pivotSelect.selectedIndex].text;\n    });\n\n    newBtn.addEventListener('click', () => {\n      if (running) return;\n      createArray(Number(sizeInput.value));\n    });\n\n    shuffleBtn.addEventListener('click', () => {\n      if (running) return;\n      // Fisher-Yates shuffle\n      for (let i = arr.length-1;i>0;i--) {\n        const j = Math.floor(Math.random()*(i+1));\n        [arr[i], arr[j]] = [arr[j], arr[i]];\n      }\n      comparisons = 0; swaps = 0; updateStats();\n      render();\n    });\n\n    sortBtn.addEventListener('click', () => {\n      if (running) return startSort();\n    });\n\n    pauseBtn.addEventListener('click', () => {\n      if (!running) return;\n      paused = !paused;\n      pauseBtn.textContent = paused ? 'Resume' : 'Pause';\n      if (!paused) resumeAllFromPause();\n    });\n\n    cancelBtn.addEventListener('click', () => {\n      if (!running) return;\n      cancelRequested = true;\n      paused = false;\n      resumeAllFromPause();\n      // reset visual highlights\n      setTimeout(() => {\n        for (let i=0;i<barEls.length;i++){\n          resetBarColor(i);\n        }\n      }, 150);\n    });\n\n    // keyboard shortcuts\n    window.addEventListener('keydown', (e) => {\n      if (e.key === ' ') {\n        e.preventDefault();\n        if (running) {\n          paused = !paused;\n          pauseBtn.textContent = paused ? 'Resume' : 'Pause';\n          if (!paused) resumeAllFromPause();\n        }\n      }\n      if (e.key === 'Escape') {\n        if (running) {\n          cancelRequested = true;\n          paused = false;\n          resumeAllFromPause();\n        }\n      }\n    });\n\n    // initialize\n    createArray(Number(sizeInput.value));\n    renderStack();\n\n    // Make bars clickable to pin pivot (optional small interaction)\n    barsEl.addEventListener('click', (e) => {\n      if (running) return;\n      const b = e.target.closest('.bar');\n      if (!b) return;\n      const idx = Number(b.dataset.index);\n      // swap chosen bar to end and start a single partition step to visualize\n      colorBar(idx,'var(--bar-pivot)');\n      setTimeout(()=>resetBarColor(idx), 700);\n    });\n\n  </script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Quick Sort"
    }
  ],
  "topic": "Quick Sort",
  "hasFSM": false,
  "hasTest": true
}