{
  "id": "0ccc0721-d5b5-11f0-899c-75bf12e026a9",
  "timestamp": "2025-12-10T10:45:14.491Z",
  "model": "gpt-3.5-turbo",
  "status": "success",
  "question": "Merge Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<title>Merge Sort Visualization</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 20px;\n    background: #fafafa;\n    color: #333;\n  }\n  h1 {\n    text-align: center;\n  }\n  #inputArea {\n    text-align: center;\n    margin-bottom: 20px;\n  }\n  #arrayInput {\n    width: 300px;\n    padding: 8px;\n    font-size: 16px;\n  }\n  #sortBtn {\n    padding: 8px 16px;\n    font-size: 16px;\n    margin-left: 10px;\n    cursor: pointer;\n  }\n  #visualization {\n    display: flex;\n    justify-content: center;\n    align-items: flex-end;\n    height: 300px;\n    max-width: 90vw;\n    margin: 0 auto 30px;\n    border: 1px solid #ddd;\n    background: #fff;\n    padding: 10px;\n    box-sizing: border-box;\n  }\n  .bar {\n    margin: 0 2px;\n    background-color: #4a90e2;\n    width: 20px;\n    transition: all 0.4s ease;\n    border-radius: 3px 3px 0 0;\n  }\n  .bar.compare {\n    background-color: #f39c12;\n  }\n  .bar.merge {\n    background-color: #27ae60;\n  }\n  .bar.sorted {\n    background-color: #2ecc71;\n  }\n  #codeArea {\n    max-width: 90vw;\n    margin: 0 auto;\n    background: #2d2d2d;\n    color: #ccc;\n    padding: 15px;\n    border-radius: 8px;\n    font-family: Consolas, monospace;\n    white-space: pre-wrap;\n    line-height: 1.5;\n  }\n  #status {\n    max-width: 90vw;\n    margin: 10px auto;\n    text-align: center;\n    font-size: 18px;\n    min-height: 24px;\n    color: #636363;\n  }\n  #legend {\n    max-width: 90vw;\n    margin: 10px auto 40px;\n    display: flex;\n    justify-content: center;\n    gap: 20px;\n    font-size: 14px;\n    color: #555;\n  }\n  .legend-box {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n  .color-box {\n    width: 18px;\n    height: 18px;\n    border-radius: 3px;\n  }\n  .color-compare { background-color: #f39c12; }\n  .color-merge { background-color: #27ae60; }\n  .color-sorted { background-color: #2ecc71; }\n</style>\n</head>\n<body>\n<h1>Merge Sort Visualization</h1>\n\n<div id=\"inputArea\">\n  <input type=\"text\" id=\"arrayInput\" placeholder=\"Enter numbers separated by commas\" value=\"38,27,43,3,9,82,10\" />\n  <button id=\"sortBtn\">Sort</button>\n</div>\n\n<div id=\"visualization\"></div>\n\n<div id=\"status\"></div>\n\n<div id=\"legend\">\n  <div class=\"legend-box\"><div class=\"color-box color-compare\"></div> Comparing</div>\n  <div class=\"legend-box\"><div class=\"color-box color-merge\"></div> Merging</div>\n  <div class=\"legend-box\"><div class=\"color-box color-sorted\"></div> Sorted</div>\n</div>\n\n<div id=\"codeArea\">\n// Merge Sort Algorithm - JavaScript\n\nfunction mergeSort(arr) {\n    if (arr.length <= 1) {\n        return arr;\n    }\n    const mid = Math.floor(arr.length / 2);\n    const left = mergeSort(arr.slice(0, mid));\n    const right = mergeSort(arr.slice(mid));\n    return merge(left, right);\n}\n\nfunction merge(left, right) {\n    let result = [];\n    let i = 0, j = 0;\n    while(i < left.length && j < right.length) {\n        if (left[i] < right[j]) {\n            result.push(left[i]);\n            i++;\n        } else {\n            result.push(right[j]);\n            j++;\n        }\n    }\n    return result.concat(left.slice(i)).concat(right.slice(j));\n}\n</div>\n\n<script>\n(() => {\n  const input = document.getElementById('arrayInput');\n  const btn = document.getElementById('sortBtn');\n  const visualization = document.getElementById('visualization');\n  const status = document.getElementById('status');\n\n  let array = [];\n\n  const delay = ms => new Promise(res => setTimeout(res, ms));\n\n  function createBars(arr) {\n    visualization.innerHTML = '';\n    // normalize bar heights for display\n    const maxVal = Math.max(...arr);\n    arr.forEach(value => {\n      const bar = document.createElement('div');\n      bar.classList.add('bar');\n      // height relative to maxVal, min height 10px for visibility\n      const height = (value / maxVal) * 250 + 10;\n      bar.style.height = height + 'px';\n      bar.title = value;\n      bar.dataset.value = value;\n      visualization.appendChild(bar);\n    });\n  }\n\n  async function mergeSortVisual(arr, leftIndex=0) {\n    // Base case\n    if(arr.length <= 1) {\n      return arr;\n    }\n    const mid = Math.floor(arr.length / 2);\n\n    // Recursive calls for left and right halves\n    status.textContent = `Splitting array at index ${mid} (length: ${arr.length})`;\n    let left = await mergeSortVisual(arr.slice(0, mid), leftIndex);\n    let right = await mergeSortVisual(arr.slice(mid), leftIndex + mid);\n\n    // Merge the sorted halves\n    let merged = [];\n    let i = 0, j = 0;\n\n    while(i < left.length && j < right.length) {\n      // Highlight bars being compared\n      highlightBars(leftIndex + i, rightIndex = leftIndex + mid + j, 'compare');\n      status.textContent = `Comparing ${left[i]} and ${right[j]}`;\n      await delay(600);\n\n      if(left[i] < right[j]) {\n        merged.push(left[i]);\n        i++;\n      } else {\n        merged.push(right[j]);\n        j++;\n      }\n      clearHighlights();\n      highlightRange(leftIndex, leftIndex + merged.length - 1, 'merge');\n      updateArrayDisplay(globalArray, leftIndex, merged, i, j);\n      await delay(600);\n    }\n\n    // Remaining left elements\n    while(i < left.length) {\n      merged.push(left[i]);\n      highlightRange(leftIndex + i, leftIndex + i, 'merge');\n      status.textContent = `Appending remaining left element: ${left[i]}`;\n      updateArrayDisplay(globalArray, leftIndex, merged, i + 1, j);\n      i++;\n      await delay(400);\n    }\n\n    // Remaining right elements\n    while(j < right.length) {\n      merged.push(right[j]);\n      highlightRange(leftIndex + merged.length - 1, leftIndex + merged.length - 1, 'merge');\n      status.textContent = `Appending remaining right element: ${right[j]}`;\n      updateArrayDisplay(globalArray, leftIndex, merged, i, j+1);\n      j++;\n      await delay(400);\n    }\n\n    // Set global array's relevant part to merged result\n    for(let k = 0; k < merged.length; k++) {\n      globalArray[leftIndex + k] = merged[k];\n    }\n    updateBars(globalArray);\n\n    // Mark merged section as sorted\n    highlightRange(leftIndex, leftIndex + merged.length - 1, 'sorted');\n    status.textContent = `Merged: [${merged.join(', ')}]`;\n    await delay(700);\n\n    clearHighlights();\n    return merged;\n  }\n\n  // Highlight two bars by indices with a class\n  function highlightBars(i1, i2, className) {\n    const bars = visualization.children;\n    if(bars[i1]) bars[i1].classList.add(className);\n    if(bars[i2]) bars[i2].classList.add(className);\n  }\n\n  // Highlight a range of bars by class\n  function highlightRange(start, end, className) {\n    clearHighlights();\n    const bars = visualization.children;\n    for(let i = start; i <= end; i++) {\n      if(bars[i]) bars[i].classList.add(className);\n    }\n  }\n\n  // Remove all highlight classes\n  function clearHighlights() {\n    Array.from(visualization.children).forEach(bar => {\n      bar.classList.remove('compare', 'merge', 'sorted');\n    });\n  }\n\n  // Update the visual bars with globalArray values\n  function updateBars(arr) {\n    const bars = visualization.children;\n    const maxVal = Math.max(...arr);\n    for(let i = 0; i < arr.length; i++) {\n      const height = (arr[i] / maxVal) * 250 + 10;\n      bars[i].style.height = height + 'px';\n      bars[i].title = arr[i];\n      bars[i].dataset.value = arr[i];\n    }\n  }\n\n  // Update the global array displayed in bars during merge step (for smooth transitions)\n  function updateArrayDisplay(globalArr, startIndex, mergedPart, leftDone, rightDone) {\n    // This function updates the bars for the section being merged to show partial merged progress.\n    // We update the bars from startIndex up to startIndex+mergedPart.length with mergedPart values\n    // Bars outside merged section remain unchanged.\n    const bars = visualization.children;\n    const maxVal = Math.max(...globalArr);\n    for(let i = 0; i < mergedPart.length; i++) {\n      const idx = startIndex + i;\n      if(bars[idx]) {\n        const height = (mergedPart[i] / maxVal) * 250 + 10;\n        bars[idx].style.height = height + 'px';\n        bars[idx].title = mergedPart[i];\n        bars[idx].dataset.value = mergedPart[i];\n        bars[idx].classList.add('merge');\n      }\n    }\n  }\n\n  let globalArray = [];\n\n  btn.addEventListener('click', async () => {\n    let values = input.value.split(',').map(s => s.trim()).filter(s => s !== '').map(Number);\n    if(values.length === 0 || values.some(v => isNaN(v))) {\n      alert('Please enter a valid list of numbers separated by commas.');\n      return;\n    }\n\n    globalArray = values.slice();\n    createBars(globalArray);\n    status.textContent = 'Starting merge sort...';\n    btn.disabled = true;\n    input.disabled = true;\n\n    await mergeSortVisual(globalArray);\n\n    status.textContent = 'Array sorted!';\n    btn.disabled = false;\n    input.disabled = false;\n\n    highlightRange(0, globalArray.length - 1, 'sorted');\n  });\n\n  // Initialize the display with default input\n  (() => {\n    globalArray = input.value.split(',').map(s => s.trim()).filter(s => s !== '').map(Number);\n    if(globalArray.length && !globalArray.some(isNaN)) {\n      createBars(globalArray);\n    }\n  })();\n\n})();\n</script>\n\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Merge Sort"
    }
  ],
  "topic": "Merge Sort",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}