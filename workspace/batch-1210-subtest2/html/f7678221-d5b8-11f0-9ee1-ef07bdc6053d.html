<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merge Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        .array-bar {
            display: inline-block;
            width: 5px;
            background-color: lightblue;
            margin: 0 1px;
            vertical-align: bottom;
        }
        #array-container {
            margin: 20px 0;
        }
        #controls {
            margin: 20px 0;
        }
    </style>
</head>
<body>

<h1>Merge Sort Visualization</h1>
<p>Click the button to generate a random array and start the merge sort.</p>

<div id="controls">
    <button onclick="generateArray()">Generate Random Array</button>
    <button onclick="mergeSort(arr)">Start Merge Sort</button>
</div>
<div id="array-container"></div>

<script>
    let arr = [];

    function generateArray() {
        arr = Array.from({length: 50}, () => Math.floor(Math.random() * 100));
        displayArray(arr);
    }

    function displayArray(array) {
        const container = document.getElementById('array-container');
        container.innerHTML = '';
        array.forEach(num => {
            const bar = document.createElement('div');
            bar.style.height = `${num * 2}px`; // Scale height for visibility
            bar.className = 'array-bar';
            container.appendChild(bar);
        });
    }

    async function mergeSort(array) {
        if (array.length < 2) {
            return array;
        }
        
        const mid = Math.floor(array.length / 2);
        const left = array.slice(0, mid);
        const right = array.slice(mid);

        await mergeSort(left);
        await mergeSort(right);
        const sortedArray = await merge(left, right);
        displayArray(sortedArray);
    }

    async function merge(left, right) {
        const result = [];
        let leftIndex = 0;
        let rightIndex = 0;

        while (leftIndex < left.length && rightIndex < right.length) {
            if (left[leftIndex] < right[rightIndex]) {
                result.push(left[leftIndex]);
                leftIndex++;
            } else {
                result.push(right[rightIndex]);
                rightIndex++;
            }
            displayArray(result.concat(left.slice(leftIndex)).concat(right.slice(rightIndex)));
            await sleep(100); // Delay for visualization
        }

        return result.concat(left.slice(leftIndex)).concat(right.slice(rightIndex));
    }

    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

</script>

</body>
</html>