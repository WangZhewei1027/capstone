<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hash Table Demonstration</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 30px;
    background: #f4f7f8;
    color: #333;
  }
  h1 {
    text-align: center;
    color: #005a9c;
  }
  #container {
    max-width: 600px;
    margin: 0 auto;
    background: white;
    box-shadow: 0 0 12px rgba(0,0,0,0.1);
    border-radius: 8px;
    padding: 20px;
  }
  label {
    font-weight: bold;
    display: block;
    margin: 15px 0 6px 0;
  }
  input[type=text] {
    width: 100%;
    padding: 8px 10px;
    box-sizing: border-box;
    font-size: 1rem;
    border: 1.5px solid #ccc;
    border-radius: 5px;
  }
  button {
    margin-top: 15px;
    background-color: #005a9c;
    border: none;
    padding: 10px 15px;
    color: white;
    font-weight: bold;
    font-size: 1rem;
    border-radius: 5px;
    cursor: pointer;
  }
  button:hover {
    background-color: #004080;
  }
  #output {
    margin-top: 20px;
    background: #eef6fb;
    border-radius: 5px;
    padding: 15px;
    font-family: monospace;
    max-height: 300px;
    overflow-y: auto;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 12px;
  }
  th, td {
    padding: 6px 8px;
    border: 1px solid #ddd;
    text-align: center;
    font-family: monospace;
  }
  th {
    background: #005a9c;
    color: white;
  }
  .hash-index {
    font-weight: bold;
    color: #004080;
  }
  .chain-item {
    margin: 0 4px;
    padding: 3px 6px;
    background: #cce6ff;
    border-radius: 3px;
    display: inline-block;
  }
</style>
</head>
<body>
  <h1>Hash Table Demonstration</h1>
  <div id="container">
    <label for="keyInput">Key (string):</label>
    <input type="text" id="keyInput" placeholder="Enter the key" autocomplete="off" />
    
    <label for="valueInput">Value (string):</label>
    <input type="text" id="valueInput" placeholder="Enter the value" autocomplete="off" />
    
    <button id="insertBtn">Insert / Update</button>
    <button id="removeBtn" style="background-color:#cc3e3e; margin-left:10px;">Remove</button>
    <button id="searchBtn" style="background-color:#3e6ecc; margin-left:10px;">Search</button>
    <button id="clearBtn" style="background-color:#888; margin-left:10px;">Clear Table</button>
    
    <div id="output"></div>
  </div>

<script>
// Simple Hash Table Implementation with Separate Chaining

class HashTable {
  constructor(size=20) {
    this.size = size;
    this.buckets = new Array(size);
    for(let i=0; i<size; i++) {
      this.buckets[i] = [];
    }
  }

  // djb2 string hash function
  _hash(key) {
    let hash = 5381;
    for(let i=0; i < key.length; i++) {
      hash = ((hash << 5) + hash) + key.charCodeAt(i); // hash * 33 + c
      hash = hash & hash; // Convert to 32bit integer
    }
    return Math.abs(hash) % this.size;
  }

  insert(key, value) {
    const index = this._hash(key);
    let bucket = this.buckets[index];

    for(let i=0; i<bucket.length; i++) {
      if(bucket[i][0] === key) {
        bucket[i][1] = value;  // Update existing key
        return false; // updated
      }
    }
    bucket.push([key, value]);
    return true; // inserted new
  }

  remove(key) {
    const index = this._hash(key);
    let bucket = this.buckets[index];

    for(let i=0; i<bucket.length; i++) {
      if(bucket[i][0] === key) {
        bucket.splice(i,1);
        return true; // removed
      }
    }
    return false; // not found
  }

  search(key) {
    const index = this._hash(key);
    let bucket = this.buckets[index];

    for(let i=0; i<bucket.length; i++) {
      if(bucket[i][0] === key) {
        return bucket[i][1];
      }
    }
    return undefined; // not found
  }

  clear() {
    this.buckets = new Array(this.size);
    for(let i=0; i<this.size; i++) {
      this.buckets[i] = [];
    }
  }

  entries() {
    let all = [];
    for(let i=0; i<this.size; i++) {
      if(this.buckets[i].length > 0) {
        for(let kv of this.buckets[i]) {
          all.push({index: i, key: kv[0], value: kv[1]});
        }
      }
    }
    return all;
  }
}

const hashTable = new HashTable(20);

const keyInput = document.getElementById("keyInput");
const valueInput = document.getElementById("valueInput");
const output = document.getElementById("output");
const insertBtn = document.getElementById("insertBtn");
const removeBtn = document.getElementById("removeBtn");
const searchBtn = document.getElementById("searchBtn");
const clearBtn = document.getElementById("clearBtn");

function renderTable() {
  let html = "<table><thead><tr><th>Bucket (Index)</th><th>Chain (Key → Value pairs)</th></tr></thead><tbody>";
  for(let i=0; i < hashTable.size; i++) {
    const chain = hashTable.buckets[i];
    if(chain.length === 0) {
      html += `<tr><td class="hash-index">${i}</td><td><i>empty</i></td></tr>`;
    } else {
      let chainHtml = chain.map(kv => {
        return `<span class="chain-item"><b>${kv[0]}</b> → ${kv[1]}</span>`;
      }).join(" → ");
      html += `<tr><td class="hash-index">${i}</td><td>${chainHtml}</td></tr>`;
    }
  }
  html += "</tbody></table>";
  output.innerHTML = html;
}

function showMessage(msg, color="#005a9c") {
  output.innerHTML = `<p style="color:${color}; font-weight:bold;">${msg}</p>`;
}

insertBtn.onclick = () => {
  const key = keyInput.value.trim();
  const value = valueInput.value.trim();
  if(key === "") {
    showMessage("Please enter a valid key to insert/update.", "#cc3e3e");
    return;
  }
  if(value === "") {
    showMessage("Please enter a value.", "#cc3e3e");
    return;
  }
  const insertedNew = hashTable.insert(key, value);
  if(insertedNew) {
    showMessage(`Inserted key "${key}" with value "${value}".`);
  } else {
    showMessage(`Updated key "${key}" with new value "${value}".`);
  }
  renderTable();
}

removeBtn.onclick = () => {
  const key = keyInput.value.trim();
  if(key === "") {
    showMessage("Please enter a key to remove.", "#cc3e3e");
    return;
  }
  const removed = hashTable.remove(key);
  if(removed) {
    showMessage(`Removed key "${key}" from the table.`, "#007a3d");
  } else {
    showMessage(`Key "${key}" not found. Nothing removed.`, "#cc3e3e");
  }
  renderTable();
}

searchBtn.onclick = () => {
  const key = keyInput.value.trim();
  if(key === "") {
    showMessage("Please enter a key to search.", "#cc3e3e");
    return;
  }
  const value = hashTable.search(key);
  if(value === undefined) {
    showMessage(`Key "${key}" not found in the table.`, "#cc3e3e");
  } else {
    showMessage(`Found key "${key}" with value: "${value}".`, "#007a3d");
  }
}

clearBtn.onclick = () => {
  hashTable.clear();
  showMessage("Hash Table cleared.", "#007a3d");
  renderTable();
}

// Initialize display
renderTable();
</script>
</body>
</html>