<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insertion Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f9;
        }
        #array {
            display: flex;
            margin-bottom: 20px;
        }
        .bar {
            width: 30px;
            margin: 0 2px;
            background-color: #3498db;
            display: inline-block;
        }
    </style>
</head>
<body>

    <h1>Insertion Sort Visualization</h1>
    <div id="array"></div>
    <button id="sortButton">Sort Array</button>

    <script>
        const arraySize = 10;
        let array = Array.from({length: arraySize}, () => Math.floor(Math.random() * 100));
        
        const drawArray = () => {
            const arrayDiv = document.getElementById('array');
            arrayDiv.innerHTML = '';

            array.forEach(value => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${value * 3}px`;
                arrayDiv.appendChild(bar);
            });
        };

        const insertionSort = async () => {
            const bars = document.getElementsByClassName('bar');

            for (let i = 1; i < array.length; i++) {
                let key = array[i];
                let j = i - 1;

                // Highlight the current key
                bars[i].style.backgroundColor = 'red';

                while (j >= 0 && array[j] > key) {
                    array[j + 1] = array[j];
                    // Update the bar height
                    bars[j + 1].style.height = `${array[j] * 3}px`;

                    // Visually reflect the current comparison
                    bars[j + 1].style.backgroundColor = 'red';
                    await new Promise(resolve => setTimeout(resolve, 300));
                    
                    // Reset the color after the operation
                    bars[j + 1].style.backgroundColor = '#3498db';
                    j--;
                }
                array[j + 1] = key;
                bars[j + 1].style.height = `${key * 3}px`;
                bars[j + 1].style.backgroundColor = 'green';

                // Reset the color of the current key
                await new Promise(resolve => setTimeout(resolve, 300));
                bars[i].style.backgroundColor = '#3498db';
            }
        };

        document.getElementById('sortButton').addEventListener('click', async () => {
            await insertionSort();
        });

        drawArray();
    </script>
</body>
</html>