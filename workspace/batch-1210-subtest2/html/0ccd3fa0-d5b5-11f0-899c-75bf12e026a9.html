<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sliding Window Technique Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2rem;
    max-width: 700px;
  }
  h1 {
    text-align: center;
    margin-bottom: 0.5rem;
  }
  p.description {
    text-align: center;
    margin-top: 0;
    margin-bottom: 2rem;
    color: #555;
  }
  label {
    display: block;
    margin-top: 1rem;
  }
  input[type="text"],
  input[type="number"] {
    width: 100%;
    padding: 0.5rem;
    font-size: 1rem;
    margin-top: 0.3rem;
    box-sizing: border-box;
  }
  button {
    margin-top: 1.5rem;
    padding: 0.75rem 1.5rem;
    font-size: 1.1rem;
    cursor: pointer;
  }
  .output {
    margin-top: 2rem;
    border-top: 2px solid #ccc;
    padding-top: 1rem;
    white-space: pre-wrap;
    background-color: #f9f9f9;
    font-family: Consolas, monospace;
  }
  .window {
    display: inline-block;
    margin: 0.2rem;
    padding: 0.4rem 0.8rem;
    background-color: #4a90e2;
    color: white;
    border-radius: 4px;
    font-weight: bold;
  }
  .sum {
    font-weight: bold;
    margin-left: 0.4rem;
    color: #d35400;
  }
</style>
</head>
<body>
<h1>Sliding Window Technique Demo</h1>
<p class="description">
  Enter an array of numbers and a window size to see how the sliding window moves and the sums it produces.
</p>

<form id="slidingForm">
  <label for="arrayInput">Array (comma or space separated numbers):</label>
  <input
    type="text"
    id="arrayInput"
    placeholder="e.g. 2, 1, 5, 2, 3, 2"
    required
  />

  <label for="windowSizeInput">Window Size (positive integer):</label>
  <input type="number" id="windowSizeInput" min="1" required />

  <button type="submit">Run Sliding Window</button>
</form>

<div class="output" id="output"></div>

<script>
  /*
   * Demo of the Sliding Window technique:
   * Here we calculate the sum of every window of size k in the input array.
   * Instead of recalculating the sum each time from scratch, we subtract the element
   * leaving the window and add the new element entering it.
   */

  const form = document.getElementById("slidingForm");
  const output = document.getElementById("output");

  function parseArray(input) {
    // Split by commas or spaces, trim, filter empty, convert to numbers
    return input
      .split(/[\s,]+/)
      .map((x) => x.trim())
      .filter((x) => x.length > 0)
      .map((x) => Number(x))
      .filter((x) => !isNaN(x));
  }

  function slidingWindowSum(arr, k) {
    let results = [];
    let windowSum = 0;

    // Initialize sum of first window
    for (let i = 0; i < k; i++) {
      windowSum += arr[i];
    }
    results.push({ window: arr.slice(0, k), sum: windowSum });

    // Slide the window through the array
    for (let i = k; i < arr.length; i++) {
      windowSum += arr[i] - arr[i - k];
      results.push({ window: arr.slice(i - k + 1, i + 1), sum: windowSum });
    }
    return results;
  }

  function renderResults(results) {
    if (results.length === 0) {
      return "No windows to display.";
    }
    let lines = [];
    lines.push(`Total windows: ${results.length}\n`);
    results.forEach(({ window, sum }, idx) => {
      // Format window elements in colored boxes
      let windowStr = window
        .map(
          (v) =>
            `<span class="window">${v}</span>`
        )
        .join(" ");
      lines.push(
        `Window ${idx + 1}: ${windowStr} <span class="sum">Sum: ${sum}</span>`
      );
    });
    return lines.join("\n");
  }

  form.addEventListener("submit", (e) => {
    e.preventDefault();
    output.innerHTML = ""; // Clear previous output

    const arrInput = document.getElementById("arrayInput").value;
    const kInput = document.getElementById("windowSizeInput").value;

    const arr = parseArray(arrInput);
    const k = Number(kInput);

    if (arr.length === 0) {
      output.textContent = "Please enter a valid array of numbers.";
      return;
    }
    if (isNaN(k) || k < 1 || k > arr.length) {
      output.textContent =
        "Window size must be a positive integer and less than or equal to the array length.";
      return;
    }

    const results = slidingWindowSum(arr, k);

    // Render with innerHTML to parse the span tags for colors
    output.innerHTML = renderResults(results).replace(
      /\n/g,
      "<br />"
    );
  });
</script>
</body>
</html>