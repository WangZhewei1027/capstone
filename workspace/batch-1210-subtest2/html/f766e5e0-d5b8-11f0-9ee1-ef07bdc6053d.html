<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red-Black Tree Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            padding: 20px;
        }
        #tree {
            margin: 0 auto;
            text-align: center;
        }
        .node {
            display: inline-block;
            margin: 5px;
            padding: 10px;
            border-radius: 5px;
            color: white;
            position: relative;
        }
        .red { background-color: red; }
        .black { background-color: black; }
        .line {
            position: absolute;
            height: 20px;
            width: 2px;
            background-color: black;
            left: 50%;
            transform: translateX(-50%);
        }
    </style>
</head>
<body>

<h1>Red-Black Tree Visualization</h1>
<div>
    <input type="number" id="nodeValue" placeholder="Enter node value">
    <button onclick="insertNode()">Insert Node</button>
</div>
<div id="tree"></div>

<script>
    class Node {
        constructor(data) {
            this.data = data;
            this.color = 'red';
            this.left = null;
            this.right = null;
            this.parent = null;
        }
    }

    class RedBlackTree {
        constructor() {
            this.root = null;
        }

        insert(data) {
            let newNode = new Node(data);
            this.root = this.insertNode(this.root, newNode);
            this.fixViolation(newNode);
        }

        insertNode(root, node) {
            if (root === null) {
                return node;
            }

            if (node.data < root.data) {
                root.left = this.insertNode(root.left, node);
                root.left.parent = root;
            } else {
                root.right = this.insertNode(root.right, node);
                root.right.parent = root;
            }
            return root;
        }

        fixViolation(node) {
            while (node !== this.root && node.parent.color === 'red') {
                if (node.parent === node.parent.parent.left) {
                    let uncle = node.parent.parent.right;

                    if (uncle && uncle.color === 'red') {
                        node.parent.color = 'black';
                        uncle.color = 'black';
                        node.parent.parent.color = 'red';
                        node = node.parent.parent;
                    } else {
                        if (node === node.parent.right) {
                            node = node.parent;
                            this.rotateLeft(node);
                        }
                        node.parent.color = 'black';
                        node.parent.parent.color = 'red';
                        this.rotateRight(node.parent.parent);
                    }
                } else {
                    let uncle = node.parent.parent.left;

                    if (uncle && uncle.color === 'red') {
                        node.parent.color = 'black';
                        uncle.color = 'black';
                        node.parent.parent.color = 'red';
                        node = node.parent.parent;
                    } else {
                        if (node === node.parent.left) {
                            node = node.parent;
                            this.rotateRight(node);
                        }
                        node.parent.color = 'black';
                        node.parent.parent.color = 'red';
                        this.rotateLeft(node.parent.parent);
                    }
                }
            }
            this.root.color = 'black';
        }

        rotateLeft(node) {
            let rightChild = node.right;
            node.right = rightChild.left;

            if (node.right !== null) {
                node.right.parent = node;
            }
            rightChild.parent = node.parent;

            if (node.parent === null) {
                this.root = rightChild;
            } else if (node === node.parent.left) {
                node.parent.left = rightChild;
            } else {
                node.parent.right = rightChild;
            }
            rightChild.left = node;
            node.parent = rightChild;
        }

        rotateRight(node) {
            let leftChild = node.left;
            node.left = leftChild.right;

            if (node.left !== null) {
                node.left.parent = node;
            }
            leftChild.parent = node.parent;

            if (node.parent === null) {
                this.root = leftChild;
            } else if (node === node.parent.right) {
                node.parent.right = leftChild;
            } else {
                node.parent.left = leftChild;
            }
            leftChild.right = node;
            node.parent = leftChild;
        }

        visualize(root) {
            if (!root) return '';

            let left = this.visualize(root.left);
            let right = this.visualize(root.right);

            let nodeDiv = `<div class="node ${root.color}" style="margin-left: ${left ? '80px' : '0'};">${root.data}</div>`;
            let lineDiv = `<div class="line" style="top: -20px;"></div>`;

            return `${lineDiv}${nodeDiv}${left}${right}`;
        }
    }

    const tree = new RedBlackTree();

    function insertNode() {
        const input = document.getElementById('nodeValue');
        const value = parseInt(input.value);
        if (!isNaN(value)) {
            tree.insert(value);
            updateTree();
            input.value = '';
        } else {
            alert("Please enter a valid number.");
        }
    }

    function updateTree() {
        const treeDiv = document.getElementById('tree');
        treeDiv.innerHTML = tree.visualize(tree.root);
    }
</script>

</body>
</html>