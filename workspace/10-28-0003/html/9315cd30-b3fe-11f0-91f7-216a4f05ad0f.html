<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Visualization</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 24px;
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
        }
        h1 {
            text-align: center;
        }
        #array {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            width: 100%;
            max-width: 800px;
            height: 200px;
            margin: 16px 0;
        }
        .bar {
            width: 40px;
            margin: 0 4px;
            background-color: #007bff;
            transition: height 0.3s ease;
        }
        #controls {
            display: flex;
            justify-content: center;
            gap: 16px;
        }
        button {
            padding: 8px 16px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Bubble Sort Visualization</h1>
    <p>Understand how Bubble Sort arranges numbers step-by-step!</p>
    <div id="array"></div>
    <div id="controls">
        <button id="sortBtn">Sort</button>
        <button id="nextStepBtn">Next Step</button>
        <button id="resetBtn">Reset</button>
    </div>

    <script>
        let array = [];
        let steps = [];
        let currentStep = 0;
        const arraySize = 10;

        function initializeArray() {
            array = Array.from({ length: arraySize }, () => Math.floor(Math.random() * 100));
            steps = [];
            renderArray();
        }

        function renderArray() {
            const arrayDiv = document.getElementById('array');
            arrayDiv.innerHTML = '';
            array.forEach(value => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${value}px`;
                arrayDiv.appendChild(bar);
            });
        }

        function bubbleSort() {
            for (let i = 0; i < array.length; i++) {
                for (let j = 0; j < array.length - 1 - i; j++) {
                    steps.push({i: j, j: j + 1, arr: [...array]});
                    if (array[j] > array[j + 1]) {
                        [array[j], array[j + 1]] = [array[j + 1], array[j]];
                    }
                }
            }
            steps.push({ arr: [...array] }); // Final state
        }

        function highlightStep(index) {
            const { i, j, arr } = steps[index];
            renderArray();
            const bars = document.querySelectorAll('.bar');
            bars[i].style.backgroundColor = 'red';
            bars[j].style.backgroundColor = 'red';
            setTimeout(() => {
                bars[i].style.backgroundColor = '#007bff';
                bars[j].style.backgroundColor = '#007bff';
            }, 500);
        }

        document.getElementById('sortBtn').addEventListener('click', () => {
            bubbleSort();
            currentStep = 0;
            highlightStep(currentStep);
        });

        document.getElementById('nextStepBtn').addEventListener('click', () => {
            if (currentStep < steps.length - 1) {
                currentStep++;
                highlightStep(currentStep);
            }
        });

        document.getElementById('resetBtn').addEventListener('click', initializeArray);

        // Initialize the first array on load
        initializeArray();
    </script>


  <script id="fsm" type="application/json">
    {
  "topic": "bubble sort",
  "description": "Finite state machine modeling the interactive states and transitions of a Bubble Sort visualization application.",
  "states": [
    {
      "name": "idle",
      "onEnter": "initializeArray",
      "onExit": null,
      "on": {
        "SORT_BUTTON_CLICKED": "sorting",
        "RESET_BUTTON_CLICKED": "idle"
      }
    },
    {
      "name": "sorting",
      "onEnter": "bubbleSort",
      "onExit": null,
      "on": {
        "NEXT_STEP_BUTTON_CLICKED": "highlighting",
        "SORT_COMPLETED": "done"
      }
    },
    {
      "name": "highlighting",
      "onEnter": "highlightStep(currentStep)",
      "onExit": null,
      "on": {
        "NEXT_STEP_BUTTON_CLICKED": "highlighting",
        "SORT_COMPLETED": "done"
      }
    },
    {
      "name": "done",
      "onEnter": null,
      "onExit": null,
      "on": {
        "RESET_BUTTON_CLICKED": "idle"
      }
    }
  ],
  "events": [
    "SORT_BUTTON_CLICKED",
    "NEXT_STEP_BUTTON_CLICKED",
    "RESET_BUTTON_CLICKED",
    "SORT_COMPLETED"
  ],
  "notes": "The 'sorting' state transitions to 'highlighting' after each step, and to 'done' when sorting is complete. The 'idle' state initializes the array and can transition to 'sorting' when the sort button is clicked."
}
  </script>
</body>
</html>