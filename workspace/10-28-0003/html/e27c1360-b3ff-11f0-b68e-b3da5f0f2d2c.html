<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Visualizer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 24px;
        }

        h1 {
            text-align: center;
        }

        #arrayContainer {
            display: flex;
            justify-content: center;
            margin: 16px 0;
        }

        .bar {
            width: 20px;
            margin: 0 2px;
            background-color: #3498db;
            transition: height 0.3s, background-color 0.3s;
        }

        #controls {
            text-align: center;
            margin: 16px 0;
        }

        button {
            padding: 10px;
            margin: 0 10px;
        }

        #speedControl {
            margin-left: 10px;
        }

        #glossary {
            margin-top: 24px;
            text-align: center;
        }
    </style>
</head>

<body>

    <h1>Interactive Bubble Sort Visualizer</h1>
    <p>Explore how the Bubble Sort algorithm sorts a list of numbers step by step!</p>
    
    <div id="arrayContainer"></div>
    
    <div id="controls">
        <button onclick="generateArray()">Generate Array</button>
        <button onclick="startSort()">Sort</button>
        <button onclick="nextStep()">Next Step</button>
        <button onclick="reset()">Reset</button>
        <label for="speedControl">Speed:</label>
        <input type="range" id="speedControl" min="100" max="2000" value="500" step="100">
    </div>

    <div id="glossary">
        <h3>What is Bubble Sort?</h3>
        <p>Bubble Sort is a simple sorting algorithm that repeatedly steps through the list, compares adjacent elements and swaps them if they are in the wrong order.</p>
    </div>

    <script>
        let array = [];
        let currentStep = 0;
        let animations = [];
        let isSorting = false;

        function generateArray() {
            array = Array.from({ length: 20 }, () => Math.floor(Math.random() * 100));
            currentStep = 0;
            isSorting = false;
            renderArray();
        }

        function renderArray() {
            const arrayContainer = document.getElementById("arrayContainer");
            arrayContainer.innerHTML = "";
            for (let value of array) {
                const bar = document.createElement("div");
                bar.className = "bar";
                bar.style.height = `${value * 3}px`;
                arrayContainer.appendChild(bar);
            }
        }

        function startSort() {
            if (isSorting) return;
            animations = [];
            bubbleSort(array);
            isSorting = true;
            processAnimations();
        }

        function bubbleSort(arr) {
            let n = arr.length;
            for (let i = 0; i < n - 1; i++) {
                for (let j = 0; j < n - i - 1; j++) {
                    animations.push([j, j + 1, false]); // Compare
                    if (arr[j] > arr[j + 1]) {
                        animations.push([j, j + 1, true]); // Swap
                        [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
                    }
                }
            }
        }

        function processAnimations() {
            const speed = document.getElementById("speedControl").value;
            if (currentStep < animations.length) {
                const [i, j, swap] = animations[currentStep++];
                const bars = document.querySelectorAll(".bar");
                if (swap) {
                    bars[i].style.backgroundColor = "#e74c3c";
                    bars[j].style.backgroundColor = "#e74c3c";
                    setTimeout(() => {
                        [bars[i].style.height, bars[j].style.height] = [bars[j].style.height, bars[i].style.height];
                        bars[i].style.backgroundColor = "#3498db";
                        bars[j].style.backgroundColor = "#3498db";
                        processAnimations();
                    }, speed);
                } else {
                    bars[i].style.backgroundColor = "#f39c12"; // Comparing color
                    setTimeout(() => {
                        bars[i].style.backgroundColor = "#3498db"; 
                        processAnimations();
                    }, speed);
                }
            } else {
                isSorting = false;
            }
        }

        function nextStep() {
            if (currentStep < animations.length) {
                const [i, j, swap] = animations[currentStep++];
                const bars = document.querySelectorAll(".bar");
                if (swap) {
                    bars[i].style.backgroundColor = "#e74c3c";
                    bars[j].style.backgroundColor = "#e74c3c";
                    setTimeout(() => {
                        [bars[i].style.height, bars[j].style.height] = [bars[j].style.height, bars[i].style.height];
                        bars[i].style.backgroundColor = "#3498db";
                        bars[j].style.backgroundColor = "#3498db";
                    }, 500);
                } else {
                    bars[i].style.backgroundColor = "#f39c12";
                    setTimeout(() => {
                        bars[i].style.backgroundColor = "#3498db"; 
                    }, 500);
                }
            }
        }

        function reset() {
            array = [];
            currentStep = 0;
            isSorting = false;
            renderArray();
        }
    </script>


  <script id="fsm" type="application/json">
    {
  "topic": "Stack",
  "description": "Finite State Machine for the Bubble Sort Visualizer application.",
  "states": [
    {
      "name": "idle",
      "onEnter": "renderArray",
      "onExit": "",
      "on": {
        "GENERATE_ARRAY": "array_generated",
        "RESET": "idle"
      }
    },
    {
      "name": "array_generated",
      "onEnter": "",
      "onExit": "",
      "on": {
        "START_SORT": "sorting",
        "NEXT_STEP": "stepping",
        "RESET": "idle"
      }
    },
    {
      "name": "sorting",
      "onEnter": "processAnimations",
      "onExit": "",
      "on": {
        "SORT_COMPLETE": "array_generated",
        "NEXT_STEP": "stepping"
      }
    },
    {
      "name": "stepping",
      "onEnter": "processAnimations",
      "onExit": "",
      "on": {
        "NEXT_STEP": "stepping",
        "SORT_COMPLETE": "array_generated"
      }
    }
  ],
  "events": [
    "GENERATE_ARRAY",
    "START_SORT",
    "NEXT_STEP",
    "RESET",
    "SORT_COMPLETE"
  ],
  "notes": "The FSM captures the main states of the Bubble Sort Visualizer, including idle, array generation, sorting, and stepping through the sort process."
}
  </script>
</body>

</html>