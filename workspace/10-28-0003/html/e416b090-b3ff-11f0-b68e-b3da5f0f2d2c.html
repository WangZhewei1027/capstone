<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Interactive Module</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 24px;
            background-color: #f2f2f2;
            color: #333;
        }
        h1 {
            text-align: center;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .array-container {
            display: flex;
            justify-content: center;
            margin: 16px 0;
        }
        .array-bar {
            width: 30px;
            background-color: #007bff;
            margin: 0 4px;
            display: flex;
            align-items: flex-end;
            transition: height 0.5s ease-in-out;
        }
        button {
            margin: 16px 8px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bubble Sort Visualization</h1>
        <p>Click "Sort" to see how the Bubble Sort algorithm works step by step!</p>
        <div>
            <button id="generate">Generate Array</button>
            <button id="sort" disabled>Sort</button>
        </div>
        <div class="array-container" id="arrayContainer"></div>
    </div>

    <script>
        const arrayContainer = document.getElementById('arrayContainer');
        const generateButton = document.getElementById('generate');
        const sortButton = document.getElementById('sort');
        let array = [];

        // Generate Random Array
        function generateArray() {
            array = Array.from({ length: 10 }, () => Math.floor(Math.random() * 100) + 1);
            displayArray();
            sortButton.disabled = false;
        }

        // Display Array
        function displayArray() {
            arrayContainer.innerHTML = '';
            array.forEach(value => {
                const bar = document.createElement('div');
                bar.style.height = `${value * 2}px`;
                bar.className = 'array-bar';
                bar.style.width = '30px';
                bar.innerText = value;
                arrayContainer.appendChild(bar);
            });
        }

        // Bubble Sort Algorithm
        async function bubbleSort() {
            let bars = document.querySelectorAll('.array-bar');
            for (let i = 0; i < array.length - 1; i++) {
                for (let j = 0; j < array.length - 1 - i; j++) {
                    // Highlight the bars being compared
                    bars[j].style.backgroundColor = '#ffc107'; // Yellow
                    bars[j + 1].style.backgroundColor = '#ffc107'; // Yellow

                    // Compare values and swap if needed
                    if (array[j] > array[j + 1]) {
                        // Swap values in array
                        [array[j], array[j + 1]] = [array[j + 1], array[j]];

                        // Animate the height swap
                        bars[j].style.height = `${array[j] * 2}px`;
                        bars[j + 1].style.height = `${array[j + 1] * 2}px`;

                        // Wait for a moment to visualize the change
                        await new Promise(resolve => setTimeout(resolve, 500));
                    }

                    // Reset bar colors
                    bars[j].style.backgroundColor = '#007bff'; // Blue
                    bars[j + 1].style.backgroundColor = '#007bff'; // Blue
                }
            }
            sortButton.disabled = true; // Disable sort button when finished
        }

        generateButton.addEventListener('click', generateArray);
        sortButton.addEventListener('click', bubbleSort);
    </script>


  <script id="fsm" type="application/json">
    {
  "topic": "Array",
  "description": "Finite State Machine for the Bubble Sort Interactive Module",
  "states": [
    {
      "name": "idle",
      "onEnter": "resetUI",
      "onExit": null,
      "on": {
        "GENERATE_ARRAY": "array_generated"
      }
    },
    {
      "name": "array_generated",
      "onEnter": "displayArray",
      "onExit": null,
      "on": {
        "START_SORT": "sorting"
      }
    },
    {
      "name": "sorting",
      "onEnter": "initiateSort",
      "onExit": "disableSortButton",
      "on": {
        "SORT_COMPLETE": "done"
      }
    },
    {
      "name": "done",
      "onEnter": "resetToIdle",
      "onExit": null,
      "on": {
        "GENERATE_ARRAY": "array_generated"
      }
    }
  ],
  "events": [
    "GENERATE_ARRAY",
    "START_SORT",
    "SORT_COMPLETE"
  ],
  "notes": "The FSM captures the states of the application as it generates an array and sorts it using the Bubble Sort algorithm. The 'idle' state represents the initial state where no array is generated. The 'array_generated' state indicates that an array has been created and is ready for sorting. The 'sorting' state represents the process of sorting the array, and the 'done' state indicates that sorting is complete."
}
  </script>
</body>
</html>