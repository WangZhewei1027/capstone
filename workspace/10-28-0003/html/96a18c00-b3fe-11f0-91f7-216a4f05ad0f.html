<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Bubble Sort Visualizer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 24px;
            text-align: center;
        }
        .controls {
            margin-bottom: 16px;
        }
        .bar {
            display: inline-block;
            width: 10px;
            margin: 0 2px;
            transition: height 0.5s ease; 
        }
        #arrayContainer {
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: flex-end;
        }
    </style>
</head>
<body>

    <h1>Interactive Bubble Sort Visualizer</h1>
    <div class="controls">
        <input type="number" id="arraySize" value="10" min="2" max="50" />
        <button onclick="generateArray()">Generate Array</button>
        <button onclick="startSorting()">Start Sorting</button>
        <button onclick="pauseSorting()">Pause</button>
        <input type="range" id="delay" min="50" max="1000" value="250" />
        <label for="delay">Speed: <span id="delayValue">250ms</span></label>
    </div>
    
    <div id="arrayContainer"></div>

    <script>
        let array = [];
        let delay = 250;
        let sorting = false;

        document.getElementById('delay').addEventListener('input', function () {
            delay = this.value;
            document.getElementById('delayValue').innerText = delay + "ms";
        });

        function generateArray() {
            const size = document.getElementById("arraySize").value;
            array = Array.from({ length: size }, () => Math.floor(Math.random() * 100) + 1);
            drawArray();
        }

        function drawArray() {
            const container = document.getElementById("arrayContainer");
            container.innerHTML = '';
            array.forEach((value) => {
                const bar = document.createElement("div");
                bar.className = "bar";
                bar.style.height = `${value * 2}px`;
                container.appendChild(bar);
            });
        }

        async function startSorting() {
            sorting = true;
            drawArray();
            for (let i = 0; i < array.length; i++) {
                for (let j = 0; j < array.length - i - 1; j++) {
                    if (sorting) {
                        if (array[j] > array[j + 1]) {
                            [array[j], array[j + 1]] = [array[j + 1], array[j]];
                            drawArray();
                            await new Promise(resolve => setTimeout(resolve, delay));
                        }
                    }
                }
            }
            sorting = false;
        }

        function pauseSorting() {
            sorting = false;
        }
    </script>


  <script id="fsm" type="application/json">
    {
  "topic": "bubble sort",
  "description": "Finite state machine for the interactive bubble sort visualizer application.",
  "states": [
    {
      "name": "idle",
      "onEnter": "drawArray",
      "onExit": null,
      "on": {
        "GENERATE_ARRAY": "array_generated",
        "START_SORTING": "sorting",
        "PAUSE_SORTING": "paused"
      }
    },
    {
      "name": "array_generated",
      "onEnter": "drawArray",
      "onExit": null,
      "on": {
        "START_SORTING": "sorting",
        "PAUSE_SORTING": "paused"
      }
    },
    {
      "name": "sorting",
      "onEnter": "drawArray",
      "onExit": null,
      "on": {
        "PAUSE_SORTING": "paused",
        "SORT_COMPLETE": "done"
      }
    },
    {
      "name": "paused",
      "onEnter": null,
      "onExit": null,
      "on": {
        "START_SORTING": "sorting"
      }
    },
    {
      "name": "done",
      "onEnter": null,
      "onExit": null,
      "on": {
        "GENERATE_ARRAY": "array_generated",
        "START_SORTING": "sorting"
      }
    }
  ],
  "events": [
    "GENERATE_ARRAY",
    "START_SORTING",
    "PAUSE_SORTING",
    "SORT_COMPLETE"
  ],
  "notes": "The FSM captures the states of generating an array, sorting, pausing, and completing the sort. The 'done' state indicates that sorting has finished, while 'paused' allows resuming sorting."
}
  </script>
</body>
</html>