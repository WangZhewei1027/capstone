<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Bubble Sort Visualization</title>
    <style>
        body {
            margin: 24px;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f4f4f4;
        }
        h1 {
            margin-bottom: 24px;
        }
        .input-section {
            margin-bottom: 16px;
        }
        input {
            padding: 8px;
            margin-right: 8px;
        }
        button {
            padding: 8px 16px;
            margin: 0 8px;
            cursor: pointer;
        }
        .array-container {
            display: flex;
            margin-top: 16px;
            gap: 4px;
        }
        .bar {
            width: 30px;
            display: inline-block;
            background-color: #3498db;
        }
    </style>
</head>
<body>
    <h1>Interactive Bubble Sort Visualization</h1>
    <div class="input-section">
        <label for="arrayInput">Input Array:</label>
        <input type="text" id="arrayInput" placeholder="e.g., 5, 3, 8, 4, 2">
        <button id="startSort">Start Sort</button>
        <button id="reset">Reset</button>
    </div>
    <div id="arrayContainer" class="array-container"></div>
    <div id="swapCount" style="margin-top: 16px;"></div>

    <script>
        const startSortButton = document.getElementById('startSort');
        const resetButton = document.getElementById('reset');
        const arrayInput = document.getElementById('arrayInput');
        const arrayContainer = document.getElementById('arrayContainer');
        const swapCountDisplay = document.getElementById('swapCount');

        startSortButton.addEventListener('click', () => {
            const input = arrayInput.value.split(',').map(num => parseInt(num.trim())).filter(num => !isNaN(num));
            if (input.length > 0) {
                bubbleSort(input);
            }
        });

        resetButton.addEventListener('click', () => {
            arrayInput.value = '';
            arrayContainer.innerHTML = '';
            swapCountDisplay.textContent = '';
        });

        function bubbleSort(arr) {
            arrayContainer.innerHTML = '';
            let bars = arr.map(num => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${num * 10}px`;
                return bar;
            });

            bars.forEach(bar => arrayContainer.appendChild(bar));

            let swaps = 0;
            const len = arr.length;

            const sort = async () => {
                for (let i = 0; i < len - 1; i++) {
                    for (let j = 0; j < len - 1 - i; j++) {
                        if (arr[j] > arr[j + 1]) {
                            await new Promise(resolve => {
                                setTimeout(() => {
                                    // Swap visually
                                    [bars[j].style.height, bars[j + 1].style.height] = [bars[j + 1].style.height, bars[j].style.height];
                                    [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
                                    bars[j].style.backgroundColor = '#e74c3c';
                                    bars[j + 1].style.backgroundColor = '#e74c3c';
                                    swaps++;
                                    resolve();
                                }, 500);
                            });

                            // Reset color after swap
                            bars[j].style.backgroundColor = '#3498db';
                            bars[j + 1].style.backgroundColor = '#3498db';
                        }
                    }
                }
                swapCountDisplay.textContent = `Total Swaps: ${swaps}`;
            };
            sort();
        }
    </script>


  <script id="fsm" type="application/json">
    {
  "topic": "bubble sort",
  "description": "Finite state machine for the interactive bubble sort visualization application.",
  "states": [
    {
      "name": "idle",
      "onEnter": "clearInputAndDisplay",
      "onExit": "",
      "on": {
        "START_SORT": "sorting",
        "RESET": "idle"
      }
    },
    {
      "name": "sorting",
      "onEnter": "initializeSorting",
      "onExit": "displaySwapCount",
      "on": {
        "SWAP": "sorting",
        "SORT_COMPLETE": "done"
      }
    },
    {
      "name": "done",
      "onEnter": "highlightSortedArray",
      "onExit": "",
      "on": {
        "RESET": "idle"
      }
    }
  ],
  "events": [
    "START_SORT",
    "RESET",
    "SWAP",
    "SORT_COMPLETE"
  ],
  "notes": "The FSM captures the states of the bubble sort visualization, including idle state, sorting state, and completion state. Events trigger transitions between these states."
}
  </script>
</body>
</html>