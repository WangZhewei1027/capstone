<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Visualizer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 24px;
            background-color: #f4f4f4;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        h1 {
            margin: 0 0 16px;
        }
        
        #array {
            display: flex;
            margin-bottom: 16px;
            align-items: flex-end;
            height: 400px;
        }
        
        .bar {
            width: 30px;
            margin: 0 4px;
            background-color: cornflowerblue;
            transition: height 0.3s, background-color 0.3s;
        }
        
        button {
            margin-right: 16px;
            padding: 8px 16px;
            font-size: 16px;
            cursor: pointer;
        }
        
        #speed-slider {
            width: 200px;
        }
        
        footer {
            margin-top: 24px;
            font-size: 14px;
            text-align: center;
        }
    </style>
</head>

<body>
    <h1>Understanding Bubble Sort: A Visual Guide</h1>
    <div id="array"></div>
    <div>
        <button id="generate">Generate Array</button>
        <button id="sort">Sort</button>
        <label for="speed-slider">Speed</label>
        <input type="range" id="speed-slider" min="1" max="1000" value="500">
    </div>
    <footer>
        <p>Bubble Sort Time Complexity: O(nÂ²)</p>
    </footer>
    <script>
        const arrayContainer = document.getElementById("array");
        const generateBtn = document.getElementById("generate");
        const sortBtn = document.getElementById("sort");
        const speedSlider = document.getElementById("speed-slider");
        let array = [];

        function generateArray() {
            array = [];
            arrayContainer.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const value = Math.floor(Math.random() * 100) + 1;
                array.push(value);
                const bar = document.createElement("div");
                bar.classList.add("bar");
                bar.style.height = `${value * 3}px`;  // Scale height
                arrayContainer.appendChild(bar);
            }
        }

        async function bubbleSort() {
            const bars = document.querySelectorAll(".bar");
            const speed = parseInt(speedSlider.value);
            for (let i = 0; i < array.length - 1; i++) {
                for (let j = 0; j < array.length - i - 1; j++) {
                    bars[j].style.backgroundColor = "red"; // Mark comparing elements.
                    bars[j + 1].style.backgroundColor = "red"; // Mark comparing elements.

                    await new Promise(resolve => setTimeout(resolve, speed));

                    if (array[j] > array[j + 1]) {
                        [array[j], array[j + 1]] = [array[j + 1], array[j]];
                        bars[j].style.height = `${array[j] * 3}px`;
                        bars[j + 1].style.height = `${array[j + 1] * 3}px`;
                    }

                    bars[j].style.backgroundColor = "cornflowerblue"; // Reset color.
                    bars[j + 1].style.backgroundColor = "cornflowerblue"; // Reset color.
                }
                bars[array.length - 1 - i].style.backgroundColor = "green"; // Mark sorted element.
            }
        }

        generateBtn.onclick = generateArray;
        sortBtn.onclick = () => bubbleSort();

    </script>


  <script id="fsm" type="application/json">
    {
  "topic": "bubble sort",
  "description": "Finite state machine for the Bubble Sort visualizer application, modeling user interactions and sorting process.",
  "states": [
    {
      "name": "idle",
      "onEnter": "resetArray",
      "onExit": null,
      "on": {
        "GENERATE_ARRAY": "array_generated",
        "START_SORT": "sorting"
      }
    },
    {
      "name": "array_generated",
      "onEnter": "displayArray",
      "onExit": null,
      "on": {
        "START_SORT": "sorting"
      }
    },
    {
      "name": "sorting",
      "onEnter": "initiateSorting",
      "onExit": null,
      "on": {
        "SORT_COMPLETE": "sorted"
      }
    },
    {
      "name": "sorted",
      "onEnter": "highlightSortedArray",
      "onExit": "resetColors",
      "on": {
        "GENERATE_ARRAY": "array_generated",
        "START_SORT": "sorting"
      }
    }
  ],
  "events": [
    "GENERATE_ARRAY",
    "START_SORT",
    "SORT_COMPLETE"
  ],
  "notes": "The FSM captures the states of the application during the bubble sort visualization, including generating a new array and sorting it. The 'sorting' state transitions to 'sorted' upon completion of the sorting process."
}
  </script>
</body>

</html>