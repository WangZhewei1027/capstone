{
  "meta": {
    "concept": "Interactive Graph (Directed / Undirected)",
    "topic": "Graph",
    "educational_goal": "To provide an interactive tool for visualizing and manipulating directed and undirected graphs.",
    "expected_interactions": [
      "Add Node",
      "Add Edge",
      "Delete",
      "Clear",
      "Random",
      "Export",
      "Import",
      "Toggle Labels",
      "Toggle Weights",
      "Shortest Path"
    ]
  },
  "states": [
    {
      "id": "S0_Idle",
      "label": "Idle",
      "type": "default",
      "entry_actions": [],
      "exit_actions": [],
      "evidence": [
        "let mode = 'idle';"
      ],
      "confidence": 1
    },
    {
      "id": "S1_AddNode",
      "label": "Add Node",
      "type": "default",
      "entry_actions": [],
      "exit_actions": [],
      "evidence": [
        "setMode('addNode');"
      ],
      "confidence": 1
    },
    {
      "id": "S2_AddEdge",
      "label": "Add Edge",
      "type": "default",
      "entry_actions": [],
      "exit_actions": [],
      "evidence": [
        "setMode('addEdge');"
      ],
      "confidence": 1
    },
    {
      "id": "S3_Delete",
      "label": "Delete",
      "type": "default",
      "entry_actions": [],
      "exit_actions": [],
      "evidence": [
        "setMode('delete');"
      ],
      "confidence": 1
    }
  ],
  "events": [
    {
      "id": "AddNode",
      "event_type": "click",
      "description": "Trigger to add a node to the graph.",
      "trigger_selectors": [
        "#addNodeBtn"
      ],
      "evidence": [
        "addNodeBtn.addEventListener('click', () => setMode(mode==='addNode' ? 'idle' : 'addNode'));"
      ],
      "confidence": 1
    },
    {
      "id": "AddEdge",
      "event_type": "click",
      "description": "Trigger to add an edge between nodes.",
      "trigger_selectors": [
        "#addEdgeBtn"
      ],
      "evidence": [
        "addEdgeBtn.addEventListener('click', () => setMode(mode==='addEdge' ? 'idle' : 'addEdge'));"
      ],
      "confidence": 1
    },
    {
      "id": "Delete",
      "event_type": "click",
      "description": "Trigger to delete a node or edge.",
      "trigger_selectors": [
        "#delBtn"
      ],
      "evidence": [
        "delBtn.addEventListener('click', () => setMode(mode==='delete' ? 'idle' : 'delete'));"
      ],
      "confidence": 1
    },
    {
      "id": "Clear",
      "event_type": "click",
      "description": "Trigger to clear the entire graph.",
      "trigger_selectors": [
        "#clearBtn"
      ],
      "evidence": [
        "clearBtn.addEventListener('click', () => { if (!confirm('Clear entire graph?')) return; state.nodes = []; state.edges = []; idCounters.node=0; idCounters.edge=0; selected = null; edgePending=null; render(); });"
      ],
      "confidence": 1
    },
    {
      "id": "Random",
      "event_type": "click",
      "description": "Trigger to generate a random graph.",
      "trigger_selectors": [
        "#randomBtn"
      ],
      "evidence": [
        "randomBtn.addEventListener('click', () => { const n = Math.floor(Math.random()*6)+4; makeRandomGraph(n, Math.min(1, Math.random()*0.6+0.2)); });"
      ],
      "confidence": 1
    },
    {
      "id": "Export",
      "event_type": "click",
      "description": "Trigger to export the current graph to JSON.",
      "trigger_selectors": [
        "#exportBtn"
      ],
      "evidence": [
        "exportBtn.addEventListener('click', () => { const obj = {nodes: state.nodes, edges: state.edges, directed: state.directed}; jsonArea.value = JSON.stringify(obj, null, 2); });"
      ],
      "confidence": 1
    },
    {
      "id": "Import",
      "event_type": "click",
      "description": "Trigger to import a graph from JSON.",
      "trigger_selectors": [
        "#importBtn"
      ],
      "evidence": [
        "importBtn.addEventListener('click', () => { try { const obj = JSON.parse(jsonArea.value); if (!Array.isArray(obj.nodes) || !Array.isArray(obj.edges)) throw new Error('Invalid format'); state.nodes = obj.nodes.map(n=>({id:n.id,label:n.label,x:n.x,y:n.y})); state.edges = obj.edges.map(e=>({id:e.id,from:e.from,to:e.to,weight:e.weight||1})); state.directed = !!obj.directed; idCounters.node = (state.nodes.reduce((m,n)=>Math.max(m, parseInt(n.id.replace(/[^\n]/g,'' )||0)),0))+1; idCounters.edge = (state.edges.reduce((m,e)=>Math.max(m, parseInt(e.id.replace(/[^\n]/g,'' )||0)),0))+1; modeSelect.value = state.directed ? 'directed':'undirected'; render(); alert('Imported successfully'); } catch (err) { alert('Import failed: ' + err.message); }});"
      ],
      "confidence": 1
    },
    {
      "id": "ToggleLabels",
      "event_type": "click",
      "description": "Trigger to toggle the visibility of node labels.",
      "trigger_selectors": [
        "#toggleLabelsBtn"
      ],
      "evidence": [
        "toggleLabelsBtn.addEventListener('click', () => { state.showLabels = !state.showLabels; render(); });"
      ],
      "confidence": 1
    },
    {
      "id": "ToggleWeights",
      "event_type": "click",
      "description": "Trigger to toggle the visibility of edge weights.",
      "trigger_selectors": [
        "#toggleWeightsBtn"
      ],
      "evidence": [
        "toggleWeightsBtn.addEventListener('click', () => { state.showWeights = !state.showWeights; render(); });"
      ],
      "confidence": 1
    },
    {
      "id": "ShortestPath",
      "event_type": "click",
      "description": "Trigger to calculate the shortest path between two nodes.",
      "trigger_selectors": [
        "#shortestBtn"
      ],
      "evidence": [
        "shortestBtn.addEventListener('click', () => { const src = sourceInput.value.trim(); const dst = targetInput.value.trim(); if (!src || !dst) { alert('Enter source and target node labels (case-sensitive).'); return; } const nodeByLabel = {}; state.nodes.forEach(n=> nodeByLabel[n.label]=n); const s = nodeByLabel[src], t = nodeByLabel[dst]; if (!s || !t) { alert('Source or target node not found'); return; } const path = shortestPath(s.id, t.id); highlightedPath = path ? pathToEdgeIds(path) : []; render(); if (!path) alert('No path found'); });"
      ],
      "confidence": 1
    },
    {
      "id": "ChangeMode",
      "event_type": "change",
      "description": "Trigger to change the graph mode between directed and undirected.",
      "trigger_selectors": [
        "#modeSelect"
      ],
      "evidence": [
        "modeSelect.addEventListener('change', (e) => { state.directed = e.target.value === 'directed'; render(); });"
      ],
      "confidence": 1
    }
  ],
  "transitions": [
    {
      "from": "S0_Idle",
      "to": "S1_AddNode",
      "event": "AddNode",
      "actions": [
        "setMode('addNode')"
      ],
      "expected_observables": [
        "Node added to the graph"
      ],
      "evidence": [
        "addNodeBtn.addEventListener('click', () => setMode(mode==='addNode' ? 'idle' : 'addNode'));"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Idle",
      "to": "S2_AddEdge",
      "event": "AddEdge",
      "actions": [
        "setMode('addEdge')"
      ],
      "expected_observables": [
        "Edge added between nodes"
      ],
      "evidence": [
        "addEdgeBtn.addEventListener('click', () => setMode(mode==='addEdge' ? 'idle' : 'addEdge'));"
      ],
      "confidence": 1
    },
    {
      "from": "S0_Idle",
      "to": "S3_Delete",
      "event": "Delete",
      "actions": [
        "setMode('delete')"
      ],
      "expected_observables": [
        "Node or edge deleted"
      ],
      "evidence": [
        "delBtn.addEventListener('click', () => setMode(mode==='delete' ? 'idle' : 'delete'));"
      ],
      "confidence": 1
    },
    {
      "from": "S1_AddNode",
      "to": "S0_Idle",
      "event": "AddNode",
      "actions": [
        "Node added to graph"
      ],
      "expected_observables": [
        "Node placed on canvas"
      ],
      "evidence": [
        "svg.addEventListener('mousedown', (e) => { const pt = screenToSvg(e); if (mode === 'addNode') { const label = nextNodeLabel(); const id = 'n'+(++idCounters.node); state.nodes.push({id,label,x:pt.x,y:pt.y}); render(); setMode('idle'); }});"
      ],
      "confidence": 1
    },
    {
      "from": "S2_AddEdge",
      "to": "S0_Idle",
      "event": "AddEdge",
      "actions": [
        "Edge created between nodes"
      ],
      "expected_observables": [
        "Edge placed on canvas"
      ],
      "evidence": [
        "g.addEventListener('mousedown', (ev) => { ev.stopPropagation(); const pt = screenToSvg(ev); if (mode === 'addEdge') { if (!edgePending) { edgePending = n.id; } else { const fromId = edgePending, toId = n.id; createEdge(fromId,toId); edgePending = null; setMode('idle'); } render(); } });"
      ],
      "confidence": 1
    },
    {
      "from": "S3_Delete",
      "to": "S0_Idle",
      "event": "Delete",
      "actions": [
        "Node or edge deleted"
      ],
      "expected_observables": [
        "Node or edge removed from canvas"
      ],
      "evidence": [
        "g.addEventListener('mousedown', (ev) => { if (mode === 'delete') { state.edges = state.edges.filter(e=> e.from !== n.id && e.to !== n.id); state.nodes = state.nodes.filter(nn=> nn.id !== n.id); render(); } });"
      ],
      "confidence": 1
    }
  ],
  "components": [
    {
      "type": "button",
      "selector": "#addNodeBtn",
      "text": "Add Node",
      "attributes": {},
      "evidence": [
        "<button id=\"addNodeBtn\">Add Node</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#addEdgeBtn",
      "text": "Add Edge",
      "attributes": {},
      "evidence": [
        "<button id=\"addEdgeBtn\">Add Edge</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#delBtn",
      "text": "Delete",
      "attributes": {},
      "evidence": [
        "<button id=\"delBtn\">Delete</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#clearBtn",
      "text": "Clear",
      "attributes": {},
      "evidence": [
        "<button id=\"clearBtn\">Clear</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#randomBtn",
      "text": "Random",
      "attributes": {},
      "evidence": [
        "<button id=\"randomBtn\">Random</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#exportBtn",
      "text": "Export",
      "attributes": {},
      "evidence": [
        "<button id=\"exportBtn\">Export</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#importBtn",
      "text": "Import",
      "attributes": {},
      "evidence": [
        "<button id=\"importBtn\">Import</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#toggleLabelsBtn",
      "text": "Toggle Labels",
      "attributes": {},
      "evidence": [
        "<button id=\"toggleLabelsBtn\">Toggle Labels</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#toggleWeightsBtn",
      "text": "Toggle Weights",
      "attributes": {},
      "evidence": [
        "<button id=\"toggleWeightsBtn\">Toggle Weights</button>"
      ]
    },
    {
      "type": "button",
      "selector": "#shortestBtn",
      "text": "Shortest Path",
      "attributes": {},
      "evidence": [
        "<button id=\"shortestBtn\">Shortest Path</button>"
      ]
    },
    {
      "type": "select",
      "selector": "#modeSelect",
      "text": "Mode",
      "attributes": {},
      "evidence": [
        "<select id=\"modeSelect\" title=\"Switch between directed and undirected\">"
      ]
    },
    {
      "type": "input",
      "selector": "#weightInput",
      "text": "Edge weight on creation",
      "attributes": {
        "placeholder": "default 1"
      },
      "evidence": [
        "<input type=\"text\" id=\"weightInput\" placeholder=\"default 1\" style=\"width:80px\"/>"
      ]
    },
    {
      "type": "input",
      "selector": "#sourceInput",
      "text": "source",
      "attributes": {
        "placeholder": "A"
      },
      "evidence": [
        "<input id=\"sourceInput\" style=\"width:60px\" placeholder=\"A\"/>"
      ]
    },
    {
      "type": "input",
      "selector": "#targetInput",
      "text": "target",
      "attributes": {
        "placeholder": "B"
      },
      "evidence": [
        "<input id=\"targetInput\" style=\"width:60px\" placeholder=\"B\"/>"
      ]
    },
    {
      "type": "textarea",
      "selector": "#jsonArea",
      "text": "Paste exported graph JSON here",
      "attributes": {},
      "evidence": [
        "<textarea id=\"jsonArea\" placeholder='Paste exported graph JSON here'></textarea>"
      ]
    }
  ],
  "extraction_summary": {
    "timestamp": "2023-10-01T00:00:00Z",
    "detected_components_count": 12,
    "detected_components": [
      {
        "type": "button",
        "selector": "#addNodeBtn"
      },
      {
        "type": "button",
        "selector": "#addEdgeBtn"
      },
      {
        "type": "button",
        "selector": "#delBtn"
      },
      {
        "type": "button",
        "selector": "#clearBtn"
      },
      {
        "type": "button",
        "selector": "#randomBtn"
      },
      {
        "type": "button",
        "selector": "#exportBtn"
      },
      {
        "type": "button",
        "selector": "#importBtn"
      },
      {
        "type": "button",
        "selector": "#toggleLabelsBtn"
      },
      {
        "type": "button",
        "selector": "#toggleWeightsBtn"
      },
      {
        "type": "button",
        "selector": "#shortestBtn"
      },
      {
        "type": "select",
        "selector": "#modeSelect"
      },
      {
        "type": "input",
        "selector": "#weightInput"
      },
      {
        "type": "input",
        "selector": "#sourceInput"
      },
      {
        "type": "input",
        "selector": "#targetInput"
      },
      {
        "type": "textarea",
        "selector": "#jsonArea"
      }
    ],
    "detected_event_handlers_count": 12,
    "detected_event_handlers": [
      "addNodeBtn.addEventListener('click', () => setMode(mode==='addNode' ? 'idle' : 'addNode'));",
      "addEdgeBtn.addEventListener('click', () => setMode(mode==='addEdge' ? 'idle' : 'addEdge'));",
      "delBtn.addEventListener('click', () => setMode(mode==='delete' ? 'idle' : 'delete'));",
      "clearBtn.addEventListener('click', () => { if (!confirm('Clear entire graph?')) return; state.nodes = []; state.edges = []; idCounters.node=0; idCounters.edge=0; selected = null; edgePending=null; render(); });",
      "randomBtn.addEventListener('click', () => { const n = Math.floor(Math.random()*6)+4; makeRandomGraph(n, Math.min(1, Math.random()*0.6+0.2)); });",
      "exportBtn.addEventListener('click', () => { const obj = {nodes: state.nodes, edges: state.edges, directed: state.directed}; jsonArea.value = JSON.stringify(obj, null, 2); });",
      "importBtn.addEventListener('click', () => { try { const obj = JSON.parse(jsonArea.value); if (!Array.isArray(obj.nodes) || !Array.isArray(obj.edges)) throw new Error('Invalid format'); state.nodes = obj.nodes.map(n=>({id:n.id,label:n.label,x:n.x,y:n.y})); state.edges = obj.edges.map(e=>({id:e.id,from:e.from,to:e.to,weight:e.weight||1})); state.directed = !!obj.directed; idCounters.node = (state.nodes.reduce((m,n)=>Math.max(m, parseInt(n.id.replace(/[^\n]/g,'' )||0)),0))+1; idCounters.edge = (state.edges.reduce((m,e)=>Math.max(m, parseInt(e.id.replace(/[^\n]/g,'' )||0)),0))+1; modeSelect.value = state.directed ? 'directed':'undirected'; render(); alert('Imported successfully'); } catch (err) { alert('Import failed: ' + err.message); }});",
      "toggleLabelsBtn.addEventListener('click', () => { state.showLabels = !state.showLabels; render(); });",
      "toggleWeightsBtn.addEventListener('click', () => { state.showWeights = !state.showWeights; render(); });",
      "shortestBtn.addEventListener('click', () => { const src = sourceInput.value.trim(); const dst = targetInput.value.trim(); if (!src || !dst) { alert('Enter source and target node labels (case-sensitive).'); return; } const nodeByLabel = {}; state.nodes.forEach(n=> nodeByLabel[n.label]=n); const s = nodeByLabel[src], t = nodeByLabel[dst]; if (!s || !t) { alert('Source or target node not found'); return; } const path = shortestPath(s.id, t.id); highlightedPath = path ? pathToEdgeIds(path) : []; render(); if (!path) alert('No path found'); });",
      "modeSelect.addEventListener('change', (e) => { state.directed = e.target.value === 'directed'; render(); });"
    ],
    "extracted_states_count": 4,
    "extracted_transitions_count": 8,
    "extraction_confidence": 1,
    "notes": []
  }
}