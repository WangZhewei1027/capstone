<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .array-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            gap: 10px;
            flex-wrap: wrap;
        }
        .array-element {
            width: 50px;
            height: 50px;
            background: #4CAF50;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .comparison {
            background: #FF9800;
        }
        .sorted {
            background: #2196F3;
        }
        .swapping {
            background: #f44336;
            transform: scale(1.1);
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        #startBtn {
            background: #4CAF50;
            color: white;
        }
        #resetBtn {
            background: #9E9E9E;
            color: white;
        }
        button:hover {
            opacity: 0.9;
        }
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        .info {
            margin: 20px 0;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 5px;
        }
        .step-info {
            font-weight: bold;
            color: #666;
            text-align: center;
            margin: 10px 0;
            min-height: 24px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bubble Sort Visualization</h1>
        
        <div class="info">
            <p><strong>How Bubble Sort works:</strong></p>
            <ul>
                <li>Repeatedly steps through the list</li>
                <li>Compares adjacent elements and swaps them if they are in the wrong order</li>
                <li>The pass through the list is repeated until no swaps are needed</li>
                <li>Called "bubble" sort because larger elements "bubble" to the top</li>
            </ul>
        </div>

        <div class="step-info" id="stepInfo">Click "Start Sorting" to begin</div>
        
        <div class="array-container" id="arrayContainer"></div>
        
        <div class="controls">
            <button id="startBtn" onclick="startSorting()">Start Sorting</button>
            <button id="resetBtn" onclick="resetArray()">Reset Array</button>
        </div>
    </div>

    <script>
        let array = [];
        let isSorting = false;
        let currentStep = 0;
        let animations = [];

        function initializeArray() {
            array = [64, 34, 25, 12, 22, 11, 90, 5];
            renderArray();
        }

        function renderArray() {
            const container = document.getElementById('arrayContainer');
            container.innerHTML = '';
            
            array.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'array-element';
                element.textContent = value;
                element.id = `element-${index}`;
                container.appendChild(element);
            });
        }

        function bubbleSort() {
            animations = [];
            const arr = [...array];
            const n = arr.length;
            
            for (let i = 0; i < n - 1; i++) {
                for (let j = 0; j < n - i - 1; j++) {
                    // Record comparison
                    animations.push({
                        type: 'compare',
                        indices: [j, j + 1],
                        step: `Comparing ${arr[j]} and ${arr[j + 1]}`
                    });
                    
                    if (arr[j] > arr[j + 1]) {
                        // Record swap
                        animations.push({
                            type: 'swap',
                            indices: [j, j + 1],
                            step: `Swapping ${arr[j]} and ${arr[j + 1]}`
                        });
                        
                        // Perform swap
                        [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
                    }
                }
                // Record that this element is now in sorted position
                animations.push({
                    type: 'sorted',
                    index: n - i - 1,
                    step: `Element ${arr[n - i - 1]} is now in its final position`
                });
            }
            
            // Mark all elements as sorted at the end
            animations.push({
                type: 'complete',
                step: 'Sorting completed!'
            });
        }

        function animateStep() {
            if (currentStep >= animations.length) {
                isSorting = false;
                document.getElementById('startBtn').disabled = false;
                return;
            }

            const animation = animations[currentStep];
            const stepInfo = document.getElementById('stepInfo');
            stepInfo.textContent = animation.step;

            // Reset all elements to default state
            document.querySelectorAll('.array-element').forEach(el => {
                el.classList.remove('comparison', 'swapping', 'sorted');
            });

            switch (animation.type) {
                case 'compare':
                    animation.indices.forEach(index => {
                        document.getElementById(`element-${index}`).classList.add('comparison');
                    });
                    break;
                    
                case 'swap':
                    animation.indices.forEach(index => {
                        document.getElementById(`element-${index}`).classList.add('swapping');
                    });
                    
                    // Actually swap the values in the displayed array
                    const [i, j] = animation.indices;
                    [array[i], array[j]] = [array[j], array[i]];
                    setTimeout(() => renderArray(), 300);
                    break;
                    
                case 'sorted':
                    document.getElementById(`element-${animation.index}`).classList.add('sorted');
                    break;
                    
                case 'complete':
                    document.querySelectorAll('.array-element').forEach(el => {
                        el.classList.add('sorted');
                    });
                    break;
            }

            currentStep++;
            setTimeout(animateStep, 600);
        }

        function startSorting() {
            if (isSorting) return;
            
            isSorting = true;
            document.getElementById('startBtn').disabled = true;
            currentStep = 0;
            
            bubbleSort();
            animateStep();
        }

        function resetArray() {
            if (isSorting) return;
            
            initializeArray();
            document.getElementById('stepInfo').textContent = 'Array reset. Click "Start Sorting" to begin';
            document.querySelectorAll('.array-element').forEach(el => {
                el.classList.remove('comparison', 'swapping', 'sorted');
            });
        }

        // Initialize
        window.onload = initializeArray;
    </script>
</body>
</html>