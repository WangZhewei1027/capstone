<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hash Table Implementation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        input, button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            border: none;
        }
        button:hover {
            background-color: #0056b3;
        }
        .hash-table {
            border: 2px solid #333;
            padding: 10px;
            margin-top: 20px;
            min-height: 200px;
        }
        .bucket {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #007bff;
        }
        .entry {
            margin: 2px 0;
            padding: 3px 8px;
            background-color: #e9ecef;
            border-radius: 3px;
        }
        .key {
            font-weight: bold;
            color: #007bff;
        }
        .collision {
            border-left-color: #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hash Table Implementation</h1>
        
        <div class="controls">
            <input type="text" id="keyInput" placeholder="Enter key" value="apple">
            <input type="text" id="valueInput" placeholder="Enter value" value="red">
            <button onclick="insertValue()">Insert</button>
            <input type="text" id="getKeyInput" placeholder="Key to retrieve" value="apple">
            <button onclick="getValue()">Get Value</button>
            <input type="text" id="deleteKeyInput" placeholder="Key to delete" value="apple">
            <button onclick="deleteValue()">Delete</button>
            <button onclick="clearTable()">Clear All</button>
        </div>

        <div class="controls">
            <button onclick="showHashFunction()">Show Hash Function</button>
            <button onclick="runDemo()">Run Demo</button>
        </div>

        <div id="output"></div>
        
        <div class="hash-table" id="hashTable">
            <strong>Hash Table Structure:</strong>
            <div id="tableContents">Table is empty</div>
        </div>
    </div>

    <script>
        class HashTable {
            constructor(size = 10) {
                this.size = size;
                this.buckets = Array(size).fill().map(() => []);
                this.count = 0;
            }

            // Simple hash function
            hash(key) {
                let hash = 0;
                for (let i = 0; i < key.length; i++) {
                    hash = (hash << 5) - hash + key.charCodeAt(i);
                    hash |= 0; // Convert to 32-bit integer
                }
                return Math.abs(hash) % this.size;
            }

            // Insert key-value pair
            insert(key, value) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                
                // Check if key already exists
                for (let i = 0; i < bucket.length; i++) {
                    if (bucket[i].key === key) {
                        bucket[i].value = value; // Update existing key
                        return index;
                    }
                }
                
                // Add new entry
                bucket.push({ key, value });
                this.count++;
                return index;
            }

            // Get value by key
            get(key) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                
                for (let i = 0; i < bucket.length; i++) {
                    if (bucket[i].key === key) {
                        return bucket[i].value;
                    }
                }
                return null; // Key not found
            }

            // Delete key-value pair
            delete(key) {
                const index = this.hash(key);
                const bucket = this.buckets[index];
                
                for (let i = 0; i < bucket.length; i++) {
                    if (bucket[i].key === key) {
                        bucket.splice(i, 1);
                        this.count--;
                        return true;
                    }
                }
                return false; // Key not found
            }

            // Display table structure
            display() {
                let html = '';
                for (let i = 0; i < this.size; i++) {
                    const bucket = this.buckets[i];
                    const hasCollision = bucket.length > 1;
                    html += `<div class="bucket ${hasCollision ? 'collision' : ''}">`;
                    html += `<strong>Bucket ${i}:</strong> `;
                    
                    if (bucket.length === 0) {
                        html += '<em>Empty</em>';
                    } else {
                        bucket.forEach(entry => {
                            html += `<div class="entry"><span class="key">${entry.key}</span>: ${entry.value}</div>`;
                        });
                    }
                    html += '</div>';
                }
                return html;
            }
        }

        // Create hash table instance
        const hashTable = new HashTable();

        function updateDisplay() {
            document.getElementById('tableContents').innerHTML = hashTable.display();
            document.getElementById('output').innerHTML = 
                `<p>Entries: ${hashTable.count}/${hashTable.size} (Load factor: ${(hashTable.count/hashTable.size).toFixed(2)})</p>`;
        }

        function insertValue() {
            const key = document.getElementById('keyInput').value.trim();
            const value = document.getElementById('valueInput').value.trim();
            
            if (!key) {
                alert('Please enter a key');
                return;
            }
            
            const index = hashTable.insert(key, value);
            updateDisplay();
            document.getElementById('output').innerHTML += 
                `<p>Inserted "${key}": "${value}" at bucket ${index}</p>`;
        }

        function getValue() {
            const key = document.getElementById('getKeyInput').value.trim();
            const value = hashTable.get(key);
            
            if (value !== null) {
                document.getElementById('output').innerHTML = 
                    `<p>Value for "${key}": "${value}"</p>`;
            } else {
                document.getElementById('output').innerHTML = 
                    `<p>Key "${key}" not found</p>`;
            }
        }

        function deleteValue() {
            const key = document.getElementById('deleteKeyInput').value.trim();
            const success = hashTable.delete(key);
            
            if (success) {
                updateDisplay();
                document.getElementById('output').innerHTML = 
                    `<p>Deleted key "${key}"</p>`;
            } else {
                document.getElementById('output').innerHTML = 
                    `<p>Key "${key}" not found</p>`;
            }
        }

        function clearTable() {
            hashTable.buckets = Array(hashTable.size).fill().map(() => []);
            hashTable.count = 0;
            updateDisplay();
            document.getElementById('output').innerHTML = '<p>Hash table cleared</p>';
        }

        function showHashFunction() {
            const testKeys = ['apple', 'banana', 'cherry', 'date'];
            let output = '<h3>Hash Function Demonstration:</h3>';
            
            testKeys.forEach(key => {
                const hash = hashTable.hash(key);
                output += `<p>"${key}" â†’ hash: ${hash} (bucket ${hash})</p>`;
            });
            
            document.getElementById('output').innerHTML = output;
        }

        function runDemo() {
            clearTable();
            document.getElementById('output').innerHTML = '<h3>Running Demo...</h3>';
            
            const demoData = [
                ['apple', 'red'],
                ['banana', 'yellow'],
                ['cherry', 'red'],
                ['date', 'brown'],
                ['elderberry', 'purple'],
                ['fig', 'purple'],
                ['grape', 'green']
            ];
            
            let delay = 0;
            demoData.forEach(([key, value], index) => {
                setTimeout(() => {
                    const bucketIndex = hashTable.insert(key, value);
                    updateDisplay();
                    document.getElementById('output').innerHTML += 
                        `<p>Inserted "${key}": "${value}" at bucket ${bucketIndex}</p>`;
                    
                    if (index === demoData.length - 1) {
                        document.getElementById('output').innerHTML += 
                            '<p><strong>Demo completed!</strong> Notice how different keys may hash to the same bucket (collisions).</p>';
                    }
                }, delay);
                delay += 800;
            });
        }

        // Initialize display
        updateDisplay();
    </script>
</body>
</html>