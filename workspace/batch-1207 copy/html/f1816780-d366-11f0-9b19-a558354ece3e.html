<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Counting Sort Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .input-section {
            margin-bottom: 20px;
        }
        input[type="text"] {
            width: 300px;
            padding: 8px;
            margin-right: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .visualization {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        .step {
            margin-bottom: 20px;
            padding: 10px;
            border-left: 4px solid #4CAF50;
            background-color: white;
        }
        .array-container {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .array-element {
            padding: 8px 12px;
            background-color: #e0e0e0;
            border-radius: 4px;
            text-align: center;
            min-width: 40px;
        }
        .array-element.highlight {
            background-color: #4CAF50;
            color: white;
        }
        .counting-array {
            display: flex;
            gap: 5px;
            margin: 10px 0;
        }
        .count-element {
            padding: 6px 10px;
            background-color: #2196F3;
            color: white;
            border-radius: 4px;
            text-align: center;
            min-width: 30px;
        }
        .explanation {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Counting Sort Visualization</h1>
        
        <div class="input-section">
            <input type="text" id="inputArray" placeholder="Enter numbers separated by commas (e.g., 4,2,2,8,3,3,1)" value="4,2,2,8,3,3,1">
            <button onclick="startCountingSort()">Sort</button>
            <button onclick="generateRandomArray()">Generate Random Array</button>
        </div>

        <div id="output" class="visualization">
            <p>Enter an array of numbers and click "Sort" to see the counting sort algorithm in action.</p>
        </div>
    </div>

    <script>
        function startCountingSort() {
            const input = document.getElementById('inputArray').value;
            const array = input.split(',').map(Number).filter(n => !isNaN(n));
            
            if (array.length === 0) {
                alert('Please enter valid numbers separated by commas.');
                return;
            }
            
            if (array.some(n => n < 0)) {
                alert('Counting sort only works with non-negative integers.');
                return;
            }
            
            visualizeCountingSort(array);
        }

        function generateRandomArray() {
            const length = Math.floor(Math.random() * 10) + 5; // 5-14 elements
            const maxValue = 9;
            const array = Array.from({length}, () => Math.floor(Math.random() * (maxValue + 1)));
            document.getElementById('inputArray').value = array.join(',');
            visualizeCountingSort(array);
        }

        function visualizeCountingSort(array) {
            const output = document.getElementById('output');
            output.innerHTML = '';
            
            // Step 1: Find the maximum value
            const max = Math.max(...array);
            
            let step1 = document.createElement('div');
            step1.className = 'step';
            step1.innerHTML = `<h3>Step 1: Find Maximum Value</h3>
                <p>Array: [${array.join(', ')}]</p>
                <p>Maximum value: ${max}</p>`;
            output.appendChild(step1);

            // Step 2: Create counting array
            let countArray = Array(max + 1).fill(0);
            
            let step2 = document.createElement('div');
            step2.className = 'step';
            step2.innerHTML = `<h3>Step 2: Create Counting Array</h3>
                <p>Counting array size: ${max + 1} (0 to ${max})</p>
                <div class="counting-array" id="countArrayInit"></div>`;
            output.appendChild(step2);
            
            const countArrayInit = document.getElementById('countArrayInit');
            for (let i = 0; i <= max; i++) {
                const element = document.createElement('div');
                element.className = 'count-element';
                element.innerHTML = `${i}: 0`;
                countArrayInit.appendChild(element);
            }

            // Step 3: Count occurrences
            let step3 = document.createElement('div');
            step3.className = 'step';
            step3.innerHTML = `<h3>Step 3: Count Occurrences</h3>
                <p>Counting how many times each number appears in the array...</p>
                <div class="array-container" id="countStep"></div>`;
            output.appendChild(step3);

            const countStep = document.getElementById('countStep');
            setTimeout(() => {
                for (let i = 0; i < array.length; i++) {
                    setTimeout(() => {
                        const value = array[i];
                        countArray[value]++;
                        
                        // Update visualization
                        countStep.innerHTML = '';
                        for (let j = 0; j <= max; j++) {
                            const element = document.createElement('div');
                            element.className = 'count-element';
                            if (j === value) {
                                element.style.backgroundColor = '#4CAF50';
                            }
                            element.innerHTML = `${j}: ${countArray[j]}`;
                            countStep.appendChild(element);
                        }
                        
                        const explanation = document.createElement('div');
                        explanation.className = 'explanation';
                        explanation.innerHTML = `Found ${value}, increasing count at index ${value} to ${countArray[value]}`;
                        countStep.appendChild(explanation);
                    }, i * 800);
                }
            }, 500);

            // Step 4: Cumulative count
            setTimeout(() => {
                let step4 = document.createElement('div');
                step4.className = 'step';
                step4.innerHTML = `<h3>Step 4: Cumulative Count</h3>
                    <p>Converting counts to cumulative counts (each element contains number of elements â‰¤ index)...</p>
                    <div class="counting-array" id="cumulativeStep"></div>`;
                output.appendChild(step4);

                const cumulativeStep = document.getElementById('cumulativeStep');
                
                setTimeout(() => {
                    for (let i = 1; i <= max; i++) {
                        setTimeout(() => {
                            countArray[i] += countArray[i - 1];
                            
                            // Update visualization
                            cumulativeStep.innerHTML = '';
                            for (let j = 0; j <= max; j++) {
                                const element = document.createElement('div');
                                element.className = 'count-element';
                                if (j <= i) {
                                    element.style.backgroundColor = '#FF9800';
                                }
                                element.innerHTML = `${j}: ${countArray[j]}`;
                                cumulativeStep.appendChild(element);
                            }
                            
                            const explanation = document.createElement('div');
                            explanation.className = 'explanation';
                            explanation.innerHTML = `Index ${i}: ${countArray[i]} (${countArray[i] - countArray[i-1]} + ${countArray[i-1]})`;
                            cumulativeStep.appendChild(explanation);
                        }, i * 800);
                    }
                }, 500);
            }, array.length * 800 + 1000);

            // Step 5: Build sorted array
            setTimeout(() => {
                let step5 = document.createElement('div');
                step5.className = 'step';
                step5.innerHTML = `<h3>Step 5: Build Sorted Array</h3>
                    <p>Placing elements in their correct positions...</p>
                    <div class="array-container" id="sortedStep"></div>`;
                output.appendChild(step5);

                const sortedStep = document.getElementById('sortedStep');
                const sortedArray = Array(array.length);
                
                setTimeout(() => {
                    for (let i = array.length - 1; i >= 0; i--) {
                        setTimeout(() => {
                            const value = array[i];
                            const position = countArray[value] - 1;
                            sortedArray[position] = value;
                            countArray[value]--;
                            
                            // Update visualization
                            sortedStep.innerHTML = '';
                            for (let j = 0; j < array.length; j++) {
                                const element = document.createElement('div');
                                element.className = 'array-element';
                                if (j === position) {
                                    element.className = 'array-element highlight';
                                    element.innerHTML = `${sortedArray[j]} (from index ${i})`;
                                } else if (sortedArray[j] !== undefined) {
                                    element.innerHTML = sortedArray[j];
                                } else {
                                    element.innerHTML = '_';
                                    element.style.backgroundColor = '#f0f0f0';
                                }
                                sortedStep.appendChild(element);
                            }
                            
                            const explanation = document.createElement('div');
                            explanation.className = 'explanation';
                            explanation.innerHTML = `Placed ${value} from original index ${i} to position ${position}`;
                            sortedStep.appendChild(explanation);
                        }, (array.length - 1 - i) * 1000);
                    }
                }, 500);

                // Final result
                setTimeout(() => {
                    let finalStep = document.createElement('div');
                    finalStep.className = 'step';
                    finalStep.innerHTML = `<h3>Final Result</h3>
                        <p>Original array: [${array.join(', ')}]</p>
                        <p>Sorted array: [${sortedArray.join(', ')}]</p>
                        <div class="array-container">${sortedArray.map(num => 
                            `<div class="array-element highlight">${num}</div>`
                        ).join('')}</div>`;
                    output.appendChild(finalStep);
                    
                    // Scroll to bottom
                    finalStep.scrollIntoView({ behavior: 'smooth' });
                }, array.length * 1000 + 1000);
            }, (array.length + max) * 800 + 2000);
        }

        // Initialize with example
        window.onload = function() {
            visualizeCountingSort([4, 2, 2, 8, 3, 3, 1]);
        };
    </script>
</body>
</html>