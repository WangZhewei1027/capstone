<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Knapsack Problem Demo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 1em;
    background: #f0f0f0;
  }
  h1 {
    text-align: center;
  }
  #input-area, #output-area {
    background: white;
    padding: 15px;
    border-radius: 8px;
    max-width: 700px;
    margin: auto;
    box-shadow: 0 0 10px #ccc;
  }
  label {
    display: block;
    margin-top: 0.75em;
  }
  textarea {
    width: 100%;
    height: 100px;
    font-family: monospace;
  }
  input[type=number] {
    width: 6em;
    margin-left: 1em;
  }
  button {
    margin-top: 1em;
    padding: 0.5em 1.2em;
    font-size: 1em;
    cursor: pointer;
  }
  #result {
    margin-top: 1em;
  }
  table {
    border-collapse: collapse;
    margin-top: 0.5em;
    width: 100%;
  }
  th, td {
    border: 1px solid #aaa;
    padding: 0.3em 0.6em;
    text-align: center;
  }
  th {
    background-color:#ddd;
  }
  .item-list {
    margin-top: 0.5em;
  }
  .item-list span {
    display: inline-block;
    margin-right: 1em;
    background: #eaeaea;
    padding: 0.3em 0.6em;
    border-radius: 4px;
  }
  .footer {
    margin-top: 2em;
    font-size: 0.85em;
    text-align: center;
    color: #555;
  }
</style>
</head>
<body>

<h1>0/1 Knapsack Problem Solver</h1>

<div id="input-area" role="main">
  <label for="items-input">
    Enter items (one per line) as: <code>value weight</code><br />
    Example:<br />
    60 10<br />
    100 20<br />
    120 30
  </label>
  <textarea id="items-input" aria-describedby="items-desc" placeholder="60 10&#10;100 20&#10;120 30"></textarea>
  <label for="capacity-input">
    Enter knapsack capacity: 
    <input type="number" id="capacity-input" min="1" value="50" />
  </label>
  <button id="solve-btn">Solve Knapsack</button>

  <div id="error-msg" role="alert" style="color: darkred; margin-top: 1em;"></div>
</div>

<div id="output-area" aria-live="polite" aria-atomic="true" style="display:none;">
  <h2>Result:</h2>
  <div id="result"></div>
</div>

<script>
(() => {
  const itemsInput = document.getElementById('items-input');
  const capacityInput = document.getElementById('capacity-input');
  const solveBtn = document.getElementById('solve-btn');
  const resultDiv = document.getElementById('result');
  const outputArea = document.getElementById('output-area');
  const errorMsg = document.getElementById('error-msg');

  // Parse input string into array of {value, weight}
  function parseItems(input) {
    const lines = input.trim().split('\n');
    const items = [];
    for(let i=0; i<lines.length; i++){
      let line = lines[i].trim();
      if(line === "") continue;
      const parts = line.split(/\s+/);
      if(parts.length !== 2) return {error: `Line ${i+1} invalid format; expect: value weight`};
      let value = Number(parts[0]);
      let weight = Number(parts[1]);
      if(isNaN(value) || isNaN(weight) || value < 0 || weight <= 0) {
        return {error: `Line ${i+1} has invalid value or weight (value >= 0, weight > 0 required)` };
      }
      items.push({value, weight});
    }
    if(items.length === 0) return {error: "No valid items found."};
    return {items};
  }

  // Solve 0/1 knapsack with DP - returns {maxValue, takenIndices}
  function knapsack(items, capacity) {
    const n = items.length;
    // dp[i][w] = max value using first i items with capacity w
    let dp = Array(n+1).fill(null).map(_=>Array(capacity+1).fill(0));

    for(let i=1; i<=n; i++) {
      const {value, weight} = items[i-1];
      for(let w=0; w<=capacity; w++) {
        if(weight <= w) {
          dp[i][w] = Math.max(dp[i-1][w], dp[i-1][w-weight] + value);
        } else {
          dp[i][w] = dp[i-1][w];
        }
      }
    }

    // Backtrack to find taken items
    let w = capacity;
    const takenIndices = [];
    for(let i=n; i>0; i--) {
      if(dp[i][w] !== dp[i-1][w]) {
        takenIndices.push(i-1);
        w -= items[i-1].weight;
      }
    }
    takenIndices.reverse();
    return {maxValue: dp[n][capacity], takenIndices, dpTable: dp};
  }

  // Render result nicely
  function renderResult(items, capacity, solution) {
    const {maxValue, takenIndices, dpTable} = solution;
    let html = `<p><strong>Knapsack capacity:</strong> ${capacity}</p>`;
    html += `<p><strong>Number of items:</strong> ${items.length}</p>`;
    html += `<p><strong>Maximum total value achievable:</strong> ${maxValue}</p>`;

    if(takenIndices.length === 0){
      html += `<p><em>No items can be taken with the given capacity.</em></p>`;
    } else {
      html += `<p><strong>Items taken (index starting at 1):</strong></p>`;
      html += `<div class="item-list">`;
      for(let idx of takenIndices) {
        html += `<span>Item ${idx+1} &mdash; value: ${items[idx].value}, weight: ${items[idx].weight}</span>`;
      }
      html += `</div>`;
    }

    // Show dynamic programming table for educational purposes (optional)
    html += `<h3>DP Table (rows = items, columns = capacity from 0 to ${capacity})</h3>`;
    html += `<div style="overflow:auto; max-height:300px; border:1px solid #ccc; background:#fff;">`;
    html += `<table aria-label="Dynamic programming table for knapsack">`;
    // Header row: capacity capacities
    html += `<thead><tr><th>i \\ w</th>`;
    for(let w=0; w<=capacity; w++) {
      html += `<th>${w}</th>`;
    }
    html += `</tr></thead>`;
    // Rows with item index
    html += `<tbody>`;
    for(let i=0; i<=items.length; i++){
      html += `<tr>`;
      if(i===0) {
        html += `<th>0 (no items)</th>`;
      } else {
        html += `<th>${i}</th>`;
      }
      for(let w=0; w<=capacity; w++){
        let val = dpTable[i][w];
        // Highlight the max value at last row
        let highlight = (i === items.length && w === capacity) ? 'style="background:#d4edda; font-weight:bold;"' : '';
        html += `<td ${highlight}>${val}</td>`;
      }
      html += `</tr>`;
    }
    html += `</tbody></table></div>`;

    return html;
  }

  solveBtn.addEventListener('click', () => {
    errorMsg.textContent = '';
    outputArea.style.display = 'none';
    resultDiv.innerHTML = '';
    const capacityVal = Number(capacityInput.value);
    if(!Number.isInteger(capacityVal) || capacityVal <= 0) {
      errorMsg.textContent = "Capacity must be a positive integer.";
      return;
    }
    const parseResult = parseItems(itemsInput.value);
    if(parseResult.error) {
      errorMsg.textContent = parseResult.error;
      return;
    }
    const items = parseResult.items;

    // Use DP knapsack solver
    const solution = knapsack(items, capacityVal);

    resultDiv.innerHTML = renderResult(items, capacityVal, solution);
    outputArea.style.display = 'block';
  });

  // Pre-fill example items
  itemsInput.value = `60 10
100 20
120 30`;
})();
</script>

<div class="footer">
  Knapsack problem solver - 0/1 knapsack with dynamic programming<br />
  Enter items as "<em>value weight</em>", one per line, and specify knapsack capacity, then click Solve.
</div>

</body>
</html>