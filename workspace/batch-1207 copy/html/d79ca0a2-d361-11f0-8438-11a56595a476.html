<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Insertion Sort Visualization</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 30px;
    background: #f5f5f5;
    text-align: center;
  }
  h1 {
    color: #333;
  }
  #arrayContainer {
    margin: 40px auto;
    display: flex;
    justify-content: center;
    align-items: flex-end;
    height: 250px;
    width: 90vw;
    max-width: 600px;
    border-bottom: 2px solid #444;
    position: relative;
  }
  .bar {
    margin: 0 2px;
    background-color: #6495ed;
    width: 20px;
    border-radius: 4px 4px 0 0;
    transition: background-color 0.3s;
    position: relative;
  }
  .bar span {
    position: absolute;
    top: -22px;
    width: 100%;
    font-size: 12px;
    color: #222;
    user-select: none;
  }
  .bar.current {
    background-color: #ff6f61;
  }
  .bar.compared {
    background-color: #f9a825;
  }
  .bar.sorted {
    background-color: #4caf50;
  }
  #controls {
    margin-bottom: 20px;
  }
  input[type="text"] {
    width: 260px;
    padding: 6px 8px;
    font-size: 16px;
    border-radius: 4px;
    border: 1px solid #ccc;
  }
  button {
    margin-left: 12px;
    padding: 8px 15px;
    font-size: 16px;
    border-radius: 4px;
    border: none;
    background-color: #6495ed;
    color: white;
    cursor: pointer;
    transition: background-color 0.25s;
  }
  button:hover:not(:disabled) {
    background-color: #4169e1;
  }
  button:disabled {
    background-color: #ccc;
    cursor: default;
  }
  #info {
    max-width: 600px;
    margin: 10px auto 0 auto;
    font-size: 14px;
    color: #555;
    line-height: 1.4;
  }
</style>
</head>
<body>
  <h1>Insertion Sort Visualization</h1>
  <div id="controls">
    <input id="inputArray" type="text" placeholder="Enter numbers separated by commas (e.g. 5,3,8,6,2)" />
    <button id="startButton">Start Sorting</button>
  </div>
  <div id="arrayContainer"></div>
  <div id="info">
    <p><b>Instructions:</b> Enter a list of numbers separated by commas and click "Start Sorting". Watch the step-by-step insertion sort process.</p>
  </div>

<script>
  const inputArray = document.getElementById('inputArray');
  const startButton = document.getElementById('startButton');
  const arrayContainer = document.getElementById('arrayContainer');

  let array = [];
  let bars = [];

  // Clear previous visualization
  function clearBars() {
    arrayContainer.innerHTML = '';
    bars = [];
  }

  // Draw array bars
  function drawArray(arr, currentIndex = -1, comparedIndex = -1, sortedUpto = -1) {
    clearBars();
    const maxVal = Math.max(...arr);
    arr.forEach((value, i) => {
      const bar = document.createElement('div');
      bar.classList.add('bar');
      // Height proportional to value
      const heightPercent = (value / maxVal) * 100;
      bar.style.height = 150 + heightPercent * 1.0 + 'px';
      // Show value above bar
      const label = document.createElement('span');
      label.textContent = value;
      bar.appendChild(label);

      // Color bars based on state
      if (i === currentIndex) {
        bar.classList.add('current');
      } else if (i === comparedIndex) {
        bar.classList.add('compared');
      } else if (i <= sortedUpto) {
        bar.classList.add('sorted');
      }
      arrayContainer.appendChild(bar);
      bars.push(bar);
    });
  }

  // Delay helper
  function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }


  // Insertion Sort with visualization
  async function insertionSortVisual(arr) {
    startButton.disabled = true;
    inputArray.disabled = true;

    drawArray(arr, 0, -1, -1);
    await sleep(800);

    for (let i = 1; i < arr.length; i++) {
      let key = arr[i];
      let j = i - 1;

      drawArray(arr, i, j, i - 1);
      await sleep(600);

      while (j >= 0 && arr[j] > key) {
        drawArray(arr, i, j, i - 1);
        await sleep(500);

        arr[j + 1] = arr[j];
        j--;

        drawArray(arr, j + 1, j, i - 1);
        await sleep(600);
      }
      arr[j + 1] = key;

      drawArray(arr, j + 1, -1, i);
      await sleep(700);
    }
    drawArray(arr, -1, -1, arr.length - 1);

    startButton.disabled = false;
    inputArray.disabled = false;
  }

  startButton.addEventListener('click', () => {
    const input = inputArray.value.trim();

    if (!input) {
      alert('Please enter a list of numbers separated by commas.');
      return;
    }

    // Parse input into an integer array
    const parsedArray = input.split(',')
      .map(item => item.trim())
      .filter(item => item !== '')
      .map(Number);

    if (parsedArray.some(isNaN)) {
      alert('Please make sure all inputs are valid numbers.');
      return;
    }
    if (parsedArray.length < 2) {
      alert('Please enter at least two numbers to sort.');
      return;
    }

    array = parsedArray;
    insertionSortVisual(array.slice());
  });

  // Initial example array
  function setExampleArray() {
    const example = [5, 3, 8, 6, 2, 7, 4, 1];
    inputArray.value = example.join(', ');
  }
  setExampleArray();

</script>
</body>
</html>