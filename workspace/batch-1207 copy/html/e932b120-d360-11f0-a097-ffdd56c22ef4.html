<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>JavaScript Set — Interactive Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#7dd3fc; --muted:#9aa6b2; --glass:rgba(255,255,255,0.03);
      color-scheme: dark;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071025 0%, #071628 40%, #0b1724 100%);font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; color:#e6eef6;}
    .wrap{max-width:1100px;margin:28px auto;padding:20px;}
    header{display:flex;gap:16px;align-items:center;margin-bottom:18px}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:360px 1fr;gap:16px}
    .card{background:var(--card);border-radius:10px;padding:14px;box-shadow:0 2px 10px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.02)}
    .controls{display:flex;flex-direction:column;gap:12px}
    label{font-size:13px;color:var(--muted)}
    input[type="text"]{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit;outline:none}
    .row{display:flex;gap:8px;align-items:center}
    button{background:linear-gradient(180deg,rgba(125,211,252,0.12), rgba(125,211,252,0.06));border:1px solid rgba(125,211,252,0.12);color:var(--accent);padding:8px 10px;border-radius:8px;cursor:pointer}
    button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
    .sets-display{display:flex;gap:12px;flex-wrap:wrap}
    .set-box{min-width:140px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:8px;padding:10px;border:1px solid rgba(255,255,255,0.03)}
    .set-title{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .elements{display:flex;flex-wrap:wrap;gap:6px}
    .chip{background:rgba(255,255,255,0.02);padding:6px 8px;border-radius:999px;font-size:13px;border:1px solid rgba(255,255,255,0.03)}
    .muted{color:var(--muted);font-size:13px}
    .ops{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}
    .venn{margin-top:12px;height:220px}
    svg{width:100%;height:100%}
    .legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .small{font-size:12px;color:var(--muted)}
    .code{background:#071826;border-radius:6px;padding:8px;font-family:monospace;font-size:13px;color:#bfefff;white-space:pre-wrap}
    footer{margin-top:18px;color:var(--muted);font-size:12px}
    .result{margin-top:8px}
    .power-list{max-height:140px;overflow:auto;padding:6px;border-radius:8px;border:1px solid rgba(255,255,255,0.02);background:rgba(255,255,255,0.01)}
    input[type="checkbox"]{transform:scale(1.05);margin-right:6px}
    .flex-between{display:flex;justify-content:space-between;align-items:center}
    a.source{color:var(--accent);text-decoration:none;font-size:13px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>JavaScript Set — Interactive Demo</h1>
        <p class="lead">Create two sets (A and B), add values, and visualize set operations: union, intersection, difference, symmetric difference, subset testing, and power set. Also shows how JS Set uses reference equality for objects.</p>
      </div>
    </header>

    <div class="grid">
      <div class="card">
        <div class="controls">
          <div>
            <label>Parse input as JSON when possible? <span class="small">(numbers, booleans, arrays, objects)</span></label><br>
            <input id="parseJSON" type="checkbox" checked /> <span class="small">Enable parsing</span>
          </div>

          <div>
            <label>Add values (comma separated allowed)</label>
            <div class="row" style="margin-top:6px">
              <input id="valueInput" type="text" placeholder='e.g. 1, "two", {"x":1}, true' />
              <button id="toA">Add to A</button>
              <button id="toB" class="secondary">Add to B</button>
            </div>
            <div class="row" style="margin-top:6px">
              <button id="delA" class="secondary">Remove from A</button>
              <button id="delB" class="secondary">Remove from B</button>
              <button id="clearA" class="secondary">Clear A</button>
              <button id="clearB" class="secondary">Clear B</button>
            </div>
          </div>

          <div>
            <label>Operations</label>
            <div class="ops">
              <button id="union">Union (A ∪ B)</button>
              <button id="intersection">Intersection (A ∩ B)</button>
              <button id="diffAB" class="secondary">A \\ B</button>
              <button id="diffBA" class="secondary">B \\ A</button>
              <button id="symDiff" class="secondary">Symmetric Diff</button>
              <button id="isSubset" class="secondary">Is A ⊆ B?</button>
              <button id="isSuperset" class="secondary">Is A ⊇ B?</button>
              <button id="toArray" class="secondary">To Array & Map Example</button>
              <button id="powerSet" class="secondary">Power Set (A)</button>
            </div>
            <div class="result small" id="opResult"></div>
          </div>

          <div>
            <label>Object reference demo</label>
            <div class="row" style="margin-top:6px">
              <button id="objDemo" class="secondary">Add two identical-looking objects</button>
              <span class="small muted">Shows that two separate objects with same content are distinct in Set (reference equality)</span>
            </div>
          </div>

        </div>
      </div>

      <div class="card">
        <div class="sets-display">
          <div class="set-box" id="boxA">
            <div class="set-title"><strong>Set A</strong><span class="muted" id="sizeA">size: 0</span></div>
            <div class="elements" id="elementsA"></div>
          </div>

          <div class="set-box" id="boxB">
            <div class="set-title"><strong>Set B</strong><span class="muted" id="sizeB">size: 0</span></div>
            <div class="elements" id="elementsB"></div>
          </div>

          <div class="set-box" style="flex:1">
            <div class="set-title"><strong>Result</strong><span class="muted" id="sizeR">—</span></div>
            <div id="resultArea" class="elements"></div>
            <div class="legend">
              <div class="small muted">Tip: click chips to remove that exact item from its set.</div>
            </div>
            <div id="vennWrap" class="venn"></div>
          </div>
        </div>

        <div style="margin-top:12px">
          <div class="flex-between">
            <div class="small muted">Power set output (click a row to copy):</div>
            <div class="small muted">Note: power set grows exponentially — only computed for |A| ≤ 12</div>
          </div>
          <div id="powerOutput" class="power-list" style="margin-top:8px"></div>
        </div>

        <div style="margin-top:12px">
          <div class="small muted">Quick code example (native JS Set operations):</div>
          <div class="code" style="margin-top:8px">
const union = (A,B) =&gt; new Set([...A, ...B]);
const intersection = (A,B) =&gt; new Set([...A].filter(x =&gt; B.has(x)));
const difference = (A,B) =&gt; new Set([...A].filter(x =&gt; !B.has(x)));
const isSubset = (A,B) =&gt; [...A].every(x =&gt; B.has(x));
          </div>
        </div>
      </div>
    </div>

    <footer>
      Built for learning — this demo uses ES6 Set and simple UI. Try numbers, strings, booleans, arrays and objects (enable/disable JSON parsing). Objects are compared by reference, not by structural equality.
    </footer>
  </div>

  <script>
    // Core sets
    const A = new Set();
    const B = new Set();

    // DOM
    const valueInput = document.getElementById('valueInput');
    const parseCheckbox = document.getElementById('parseJSON');
    const elementsA = document.getElementById('elementsA');
    const elementsB = document.getElementById('elementsB');
    const sizeA = document.getElementById('sizeA');
    const sizeB = document.getElementById('sizeB');
    const resultArea = document.getElementById('resultArea');
    const sizeR = document.getElementById('sizeR');
    const opResult = document.getElementById('opResult');
    const vennWrap = document.getElementById('vennWrap');
    const powerOutput = document.getElementById('powerOutput');

    // Helpers
    function tryParseToken(token){
      token = token.trim();
      if(!token) return null;
      if(!parseCheckbox.checked) return token;
      try{
        // If user typed unquoted plain word like hello, JSON.parse would fail.
        // Try to parse numbers/booleans/null (numeric-like or true/false/null)
        if(/^[-+]?\d+(\.\d+)?$/.test(token) || /^(true|false|null)$/.test(token)) {
          return JSON.parse(token);
        }
        // If token looks like JSON object/array or a quoted string, try parse:
        if((token.startsWith('{') && token.endsWith('}')) || (token.startsWith('[') && token.endsWith(']')) || (token.startsWith('"') && token.endsWith('"')) || (token.startsWith("'") && token.endsWith("'"))) {
          try {
            // replace single quotes with double for simple objects like {'x':1}
            const safe = token.replace(/'/g, '"');
            return JSON.parse(safe);
          } catch(e){
            return token;
          }
        }
        // Otherwise return as string (user likely wanted a plain string)
        return token;
      }catch(e){
        return token;
      }
    }

    function parseInputToValues(raw){
      if(!raw) return [];
      // split on commas but allow simple JSON with commas inside if wrapped in {...} or [...]
      // Simple approach: if contains braces/brackets, try direct JSON parse (single value)
      const trimmed = raw.trim();
      if((trimmed.startsWith('{') && trimmed.endsWith('}')) || (trimmed.startsWith('[') && trimmed.endsWith(']'))) {
        try {
          return [JSON.parse(trimmed)];
        } catch(e){ /* fall through to comma split */ }
      }
      // Split by top-level commas (naive)
      const parts = raw.split(',').map(s=>s.trim()).filter(s=>s.length>0);
      return parts.map(tryParseToken);
    }

    function repr(v){
      // Human readable chip label
      if(typeof v === 'string') return v.length>50 ? JSON.stringify(v).slice(0,47)+'…' : v;
      try{
        return JSON.stringify(v);
      }catch(e){
        return String(v);
      }
    }

    function addToSet(set, values){
      values.forEach(v => set.add(v));
      renderAll();
    }
    function removeFromSet(set, values){
      values.forEach(v => set.delete(v));
      renderAll();
    }
    function clearSet(set){
      set.clear();
      renderAll();
    }

    function makeChip(value, onClick){
      const span = document.createElement('span');
      span.className = 'chip';
      span.textContent = repr(value);
      span.title = 'click to remove from its set';
      span.onclick = onClick;
      return span;
    }

    function renderSet(set, container, onRemove){
      container.innerHTML = '';
      for(const v of set){
        const chip = makeChip(v, ()=>{ onRemove(v); });
        container.appendChild(chip);
      }
    }

    function renderAll(){
      renderSet(A, elementsA, (v)=>{ A.delete(v); renderAll(); });
      renderSet(B, elementsB, (v)=>{ B.delete(v); renderAll(); });
      sizeA.textContent = 'size: ' + A.size;
      sizeB.textContent = 'size: ' + B.size;
      // default result area shows union
      showVenn();
      // clear op result (to avoid confusion)
      opResult.textContent = '';
      powerOutput.innerHTML = '';
    }

    // Basic set ops
    const ops = {
      union: (X,Y) => new Set([...X, ...Y]),
      intersection: (X,Y) => new Set([...X].filter(x => Y.has(x))),
      difference: (X,Y) => new Set([...X].filter(x => !Y.has(x))),
      symmetric: (X,Y) => {
        const u = ops.union(X,Y);
        const i = ops.intersection(X,Y);
        return new Set([...u].filter(x => !i.has(x)));
      },
      isSubset: (X,Y) => [...X].every(x => Y.has(x)),
      isSuperset: (X,Y) => [...Y].every(x => X.has(x)),
    };

    // UI event bindings
    document.getElementById('toA').addEventListener('click', ()=>{
      const vals = parseInputToValues(valueInput.value);
      addToSet(A, vals);
      valueInput.value = '';
    });
    document.getElementById('toB').addEventListener('click', ()=>{
      const vals = parseInputToValues(valueInput.value);
      addToSet(B, vals);
      valueInput.value = '';
    });
    document.getElementById('delA').addEventListener('click', ()=>{
      const vals = parseInputToValues(valueInput.value);
      removeFromSet(A, vals);
      valueInput.value = '';
    });
    document.getElementById('delB').addEventListener('click', ()=>{
      const vals = parseInputToValues(valueInput.value);
      removeFromSet(B, vals);
      valueInput.value = '';
    });
    document.getElementById('clearA').addEventListener('click', ()=>{ clearSet(A); });
    document.getElementById('clearB').addEventListener('click', ()=>{ clearSet(B); });

    document.getElementById('union').addEventListener('click', ()=>{
      const r = ops.union(A,B);
      showResultSet(r, 'A ∪ B', '#a7f3d0');
    });
    document.getElementById('intersection').addEventListener('click', ()=>{
      const r = ops.intersection(A,B);
      showResultSet(r, 'A ∩ B', '#fce7f3');
    });
    document.getElementById('diffAB').addEventListener('click', ()=>{
      const r = ops.difference(A,B);
      showResultSet(r, 'A \\ B', '#fde68a');
    });
    document.getElementById('diffBA').addEventListener('click', ()=>{
      const r = ops.difference(B,A);
      showResultSet(r, 'B \\ A', '#fde68a');
    });
    document.getElementById('symDiff').addEventListener('click', ()=>{
      const r = ops.symmetric(A,B);
      showResultSet(r, 'Symmetric Difference', '#fbcfe8');
    });
    document.getElementById('isSubset').addEventListener('click', ()=>{
      const res = ops.isSubset(A,B);
      opResult.textContent = res ? 'Yes — A is a subset of B' : 'No — A is not a subset of B';
    });
    document.getElementById('isSuperset').addEventListener('click', ()=>{
      const res = ops.isSuperset(A,B);
      opResult.textContent = res ? 'Yes — A is a superset of B' : 'No — A is not a superset of B';
    });

    document.getElementById('toArray').addEventListener('click', ()=>{
      // example: map values to strings and show array
      const arr = [...A].map(x => `(${typeof x}) ${repr(x)}`);
      opResult.textContent = 'A as array mapped to strings: [' + arr.join(', ') + ']';
    });

    document.getElementById('powerSet').addEventListener('click', ()=>{
      // compute power set of A
      if(A.size > 12){
        opResult.textContent = 'Set A too large for power set (limit is 12 elements).';
        return;
      }
      const subsets = powerSet(A);
      powerOutput.innerHTML = '';
      subsets.forEach((s, idx) => {
        const row = document.createElement('div');
        row.style.padding = '6px';
        row.style.borderBottom = '1px dashed rgba(255,255,255,0.02)';
        row.style.cursor = 'pointer';
        row.title = 'Click to copy';
        row.textContent = [...s].map(repr).join(', ') || '∅';
        row.addEventListener('click', ()=> {
          navigator.clipboard?.writeText(row.textContent || '');
          row.style.background = 'rgba(125,211,252,0.06)';
          setTimeout(()=>row.style.background = 'transparent', 400);
        });
        powerOutput.appendChild(row);
      });
      opResult.textContent = `Power set of A computed — ${subsets.length} subsets. Click any row to copy.`;
    });

    document.getElementById('objDemo').addEventListener('click', ()=>{
      // two distinct objects with same content
      const o1 = {x:1};
      const o2 = {x:1};
      addToSet(A, [o1, o2]);
      opResult.textContent = 'Added two objects with same content to A. They are distinct entries because JS Set compares by reference.';
    });

    // Utility: show a set as result area & venn update
    function showResultSet(setObj, label, color){
      resultArea.innerHTML = '';
      for(const v of setObj){
        const chip = document.createElement('span');
        chip.className = 'chip';
        chip.textContent = repr(v);
        chip.style.borderColor = 'rgba(255,255,255,0.02)';
        resultArea.appendChild(chip);
      }
      sizeR.textContent = 'size: ' + setObj.size + ' — ' + label;
      opResult.textContent = '';
      showVenn(); // keep venn in sync
    }

    // Power set generator
    function powerSet(setObj){
      const arr = [...setObj];
      const n = arr.length;
      const out = [];
      for(let mask=0; mask < (1<<n); mask++){
        const s = new Set();
        for(let i=0;i<n;i++){
          if(mask & (1<<i)) s.add(arr[i]);
        }
        out.push(s);
      }
      return out;
    }

    // Venn diagram: compute left-only, intersection, right-only (uses repr to group by value equality with Set)
    function showVenn(){
      // we need to group by JS Set membership
      const onlyA = [...A].filter(x => !B.has(x));
      const inter = [...A].filter(x => B.has(x));
      const onlyB = [...B].filter(x => !A.has(x));

      // build an SVG Venn with text chips positioned in three areas
      const svgNS = 'http://www.w3.org/2000/svg';
      vennWrap.innerHTML = '';
      const svg = document.createElementNS(svgNS,'svg');
      svg.setAttribute('viewBox','0 0 600 220');
      // circles
      const c1 = document.createElementNS(svgNS,'ellipse');
      c1.setAttribute('cx',220); c1.setAttribute('cy',110); c1.setAttribute('rx',180); c1.setAttribute('ry',90);
      c1.setAttribute('fill','rgba(125,211,252,0.06)');
      c1.setAttribute('stroke','rgba(125,211,252,0.12)');
      const c2 = document.createElementNS(svgNS,'ellipse');
      c2.setAttribute('cx',380); c2.setAttribute('cy',110); c2.setAttribute('rx',180); c2.setAttribute('ry',90);
      c2.setAttribute('fill','rgba(250,204,21,0.03)');
      c2.setAttribute('stroke','rgba(250,204,21,0.08)');

      svg.appendChild(c1); svg.appendChild(c2);

      // helper to add text blocks
      function addTextBlock(x,y,items,fill){
        const g = document.createElementNS(svgNS,'g');
        let yy = y;
        items.forEach(it=>{
          const rect = document.createElementNS(svgNS,'rect');
          rect.setAttribute('x', x-3); rect.setAttribute('y', yy-14);
          rect.setAttribute('rx',6); rect.setAttribute('ry',6);
          rect.setAttribute('width', Math.min(300, String(repr(it)).length*8 + 18));
          rect.setAttribute('height',18);
          rect.setAttribute('fill','rgba(255,255,255,0.02)');
          rect.setAttribute('stroke','rgba(255,255,255,0.03)');
          const t = document.createElementNS(svgNS,'text');
          t.setAttribute('x', x+6); t.setAttribute('y', yy);
          t.setAttribute('fill','#cfeefe'); t.setAttribute('font-size',12);
          t.textContent = repr(it);
          // click to remove from its original set
          t.style.cursor = 'pointer';
          t.addEventListener('click', ()=> {
            if(A.has(it) && !B.has(it)) { A.delete(it); }
            else if(B.has(it) && !A.has(it)) { B.delete(it); }
            else { // in intersection: remove from A by default
              A.delete(it);
            }
            renderAll();
          });
          g.appendChild(rect); g.appendChild(t);
          yy += 20;
        });
        svg.appendChild(g);
      }

      // left-only block
      addTextBlock(100, 50, onlyA);
      // intersection
      addTextBlock(260, 50, inter);
      // right-only
      addTextBlock(420, 50, onlyB);

      vennWrap.appendChild(svg);

      // Update result area by default to union
      const union = ops.union(A,B);
      showResultSet(union, 'A ∪ B');
    }

    // Initial render
    renderAll();

    // Small convenience: allow pressing Enter to add to A
    valueInput.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter') {
        document.getElementById('toA').click();
      }
    });

    // Expose small console for debugging (optional)
    window._demo = {A,B,ops};
  </script>
</body>
</html>