<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Selection Sort Visualizer</title>
<style>
  :root{
    --bg:#0f1724;
    --card:#0b1220;
    --accent:#2563eb;
    --muted:#94a3b8;
    --bar-bg:#111827;
    --text:#e6eef8;
  }
  html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  body{background:linear-gradient(180deg,#071023 0%, #071023 60%, #041022 100%);color:var(--text);display:flex;flex-direction:column;align-items:center;padding:18px;box-sizing:border-box;}
  .app{width:100%;max-width:1100px;}
  header{display:flex;align-items:center;gap:16px;margin-bottom:14px;}
  h1{font-size:20px;margin:0;}
  .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
  button, input[type="range"], select{background:var(--card);color:var(--text);border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:8px;cursor:pointer;}
  button:active{transform:translateY(1px);}
  .panel{background:rgba(255,255,255,0.03);border-radius:12px;padding:12px;margin-bottom:14px;display:flex;gap:14px;align-items:center;justify-content:space-between;}
  .left, .right{display:flex;gap:12px;align-items:center;flex-wrap:wrap;}
  .small{font-size:13px;color:var(--muted);}
  .board{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:12px;min-height:360px;display:flex;flex-direction:column;gap:14px;}
  .bars-container{height:260px;background:var(--bar-bg);border-radius:10px;padding:12px;display:flex;align-items:end;gap:6px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);}
  .bar{flex:1 0 auto;display:flex;flex-direction:column;align-items:center;justify-content:flex-end;gap:6px;transition:all 300ms ease;}
  .bar .rect{width:100%;background:linear-gradient(180deg,#60a5fa,#1d4ed8);border-radius:6px;display:flex;align-items:flex-end;justify-content:center;color:rgba(255,255,255,0.9);font-size:12px;padding-top:6px;box-sizing:border-box;transition:height 300ms ease, transform 200ms;}
  .bar .label{font-size:11px;color:var(--muted);margin-top:6px;}
  /* Highlights */
  .bar.current .rect{background:linear-gradient(180deg,#fb923c,#f97316); box-shadow:0 4px 14px rgba(249,115,22,0.15); transform:translateY(-6px);}
  .bar.compare .rect{background:linear-gradient(180deg,#a78bfa,#7c3aed); box-shadow:0 4px 14px rgba(124,58,237,0.12); transform:translateY(-4px);}
  .bar.min .rect{background:linear-gradient(180deg,#ef4444,#dc2626); box-shadow:0 6px 18px rgba(220,38,38,0.14); transform:translateY(-8px);}
  .bar.sorted .rect{background:linear-gradient(180deg,#86efac,#16a34a); box-shadow:0 4px 14px rgba(16,185,129,0.12);}
  .stats{display:flex;gap:12px;align-items:center;}
  .stat{background:rgba(255,255,255,0.02);padding:8px 10px;border-radius:8px;font-size:13px;}
  .pseudocode{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;font-family:monospace;font-size:13px;white-space:pre;line-height:1.5;}
  .footer{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-top:12px;}
  .inputs{display:flex;gap:8px;align-items:center;}
  input[type="text"]{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--text);padding:8px 10px;border-radius:8px;width:220px;}
  .help{font-size:13px;color:var(--muted);max-width:480px;}
  .controls .danger{background:#7f1d1d;}
  .small-muted{font-size:12px;color:var(--muted);}
  @media (max-width:720px){
    .board{padding:10px;}
    .bars-container{height:190px;}
  }
</style>
</head>
<body>
  <div class="app" role="application" aria-label="Selection Sort Visualizer">
    <header>
      <h1>Selection Sort Visualizer</h1>
      <div class="small-muted">Step-by-step demonstration with controls</div>
    </header>

    <div class="panel">
      <div class="left controls">
        <button id="generateBtn" title="Generate a random array">Generate Random</button>
        <label class="small">Size
          <input id="sizeRange" type="range" min="4" max="30" value="12" />
        </label>
        <label class="small">Speed
          <input id="speedRange" type="range" min="50" max="1200" step="10" value="400" />
        </label>
        <button id="startBtn">Start</button>
        <button id="stepBtn">Step</button>
        <button id="pauseBtn">Pause</button>
        <button id="resetBtn" class="danger">Reset</button>
      </div>

      <div class="right">
        <div class="stats">
          <div class="stat">Comparisons: <span id="compCount">0</span></div>
          <div class="stat">Swaps: <span id="swapCount">0</span></div>
          <div class="stat">i: <span id="currentI">-</span></div>
          <div class="stat">min: <span id="currentMin">-</span></div>
        </div>
      </div>
    </div>

    <div class="board" aria-live="polite">
      <div class="bars-container" id="bars"></div>

      <div style="display:flex;gap:14px;align-items:flex-start;flex-wrap:wrap;">
        <div style="flex:1 1 380px;">
          <div class="pseudocode" id="pseudocode">
selectionSort(A)
  for i = 0 to A.length - 2
    min = i
    for j = i+1 to A.length -1
      if A[j] < A[min]
        min = j
    swap A[i] and A[min]
          </div>
        </div>

        <div style="width:320px;">
          <div style="display:flex;flex-direction:column;gap:8px;">
            <div style="display:flex;gap:8px;">
              <input id="customInput" type="text" placeholder="e.g. 5,2,9,1,6" aria-label="Custom array input" />
              <button id="setArrayBtn">Set</button>
            </div>
            <div style="display:flex;gap:8px;">
              <button id="randomizeBtn">Shuffle</button>
              <button id="reverseBtn">Reverse</button>
            </div>
            <div class="help">
              How it works: Selection sort repeatedly finds the minimum element from the unsorted portion and swaps it with the first unsorted element. Time complexity: O(n^2). It uses constant extra space.
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="small-muted">Visual legend: orange = current i, purple = comparing j, red = current min, green = sorted</div>
      <div class="small-muted">Tip: Use Step to advance one action, Start for autoplay.</div>
    </div>
  </div>

<script>
/*
Selection Sort Visualizer
Single-file demo. Controls:
- Generate random array
- Size slider
- Speed slider (delay between auto steps)
- Start (autoplay), Step (single step), Pause, Reset
- Custom array input, Shuffle, Reverse
Features:
- Highlights: current i (orange), comparing j (purple), min (red), sorted (green)
- Counts comparisons and swaps
*/

// DOM references
const barsContainer = document.getElementById('bars');
const generateBtn = document.getElementById('generateBtn');
const sizeRange = document.getElementById('sizeRange');
const speedRange = document.getElementById('speedRange');
const startBtn = document.getElementById('startBtn');
const stepBtn = document.getElementById('stepBtn');
const pauseBtn = document.getElementById('pauseBtn');
const resetBtn = document.getElementById('resetBtn');
const compCountEl = document.getElementById('compCount');
const swapCountEl = document.getElementById('swapCount');
const currentIE = document.getElementById('currentI');
const currentMinE = document.getElementById('currentMin');
const customInput = document.getElementById('customInput');
const setArrayBtn = document.getElementById('setArrayBtn');
const randomizeBtn = document.getElementById('randomizeBtn');
const reverseBtn = document.getElementById('reverseBtn');

let array = [];
let bars = [];
let gen = null;         // generator for algorithm actions
let running = false;    // autoplay mode
let paused = true;      // paused flag (when running true, paused false)
let delay = parseInt(speedRange.value);
let comparisons = 0;
let swaps = 0;
let sortedUntil = -1;   // index up to which sorted
let animating = false;  // avoid concurrent animations

function randInt(min, max){ return Math.floor(Math.random()*(max-min+1))+min; }

function createRandomArray(n){
  const arr = [];
  // create range 10..100 for bars height
  for(let i=0;i<n;i++){
    arr.push(randInt(10,100));
  }
  return arr;
}

function renderArray(arr){
  barsContainer.innerHTML = '';
  bars = [];
  const n = arr.length;
  for(let i=0;i<n;i++){
    const barWrap = document.createElement('div');
    barWrap.className = 'bar';
    barWrap.dataset.index = i;
    barWrap.setAttribute('role','img');
    barWrap.setAttribute('aria-label',`Value ${arr[i]}`);
    const rect = document.createElement('div');
    rect.className = 'rect';
    rect.style.height = arr[i] + '%';
    rect.textContent = arr[i];
    const label = document.createElement('div');
    label.className = 'label';
    label.textContent = i;
    barWrap.appendChild(rect);
    barWrap.appendChild(label);
    barsContainer.appendChild(barWrap);
    bars.push(barWrap);
  }
}

function resetState(){
  if (running) running = false;
  gen = null;
  paused = true;
  comparisons = 0;
  swaps = 0;
  sortedUntil = -1;
  animating = false;
  updateStats();
  updateIndicesDisplay();
  // clear highlights
  bars.forEach(b=>{ b.className = 'bar'; });
}

function updateStats(){
  compCountEl.textContent = comparisons;
  swapCountEl.textContent = swaps;
}

function updateIndicesDisplay(i = '-', min = '-'){
  currentIE.textContent = (i === null ? '-' : i);
  currentMinE.textContent = (min === null ? '-' : min);
}

// generator that yields action objects describing each step
function* selectionSortGenerator(arr){
  const n = arr.length;
  // for i = 0 to n-2
  for(let i=0;i<n-1;i++){
    let min = i;
    yield {type:'setI', i};
    // inner loop
    for(let j=i+1;j<n;j++){
      yield {type:'compare', i, j, min};
      if (arr[j] < arr[min]){
        min = j;
        yield {type:'newMin', i, min};
      }
    }
    // swap if needed
    if (min !== i){
      // swap in array
      const tmp = arr[i];
      arr[i] = arr[min];
      arr[min] = tmp;
      yield {type:'swap', i, min};
    } else {
      yield {type:'noSwap', i, min};
    }
    // mark i as sorted
    yield {type:'sorted', index:i};
  }
  // final element is also sorted
  yield {type:'sorted', index:n-1};
  yield {type:'done'};
}

// Visual helpers
function clearAllHighlights(){
  bars.forEach(b=> b.className = 'bar');
}

function highlightCurrentI(i){
  clearAllHighlights();
  if (i != null && bars[i]) bars[i].classList.add('current');
}

function highlightCompare(j){
  if (j != null && bars[j]) bars[j].classList.add('compare');
}

function highlightMin(min){
  if (min != null && bars[min]) bars[min].classList.add('min');
}

function markSorted(index){
  if (bars[index]){
    const b = bars[index];
    b.className = 'bar sorted';
  }
}

// swap bars visually by swapping heights and labels texts
function animateSwap(i, j){
  return new Promise(resolve=>{
    const bi = bars[i];
    const bj = bars[j];
    if (!bi || !bj){ resolve(); return; }
    const ri = bi.querySelector('.rect');
    const rj = bj.querySelector('.rect');
    // animate transform
    bi.style.transition = 'transform 300ms ease';
    bj.style.transition = 'transform 300ms ease';
    bi.style.zIndex = 5;
    bj.style.zIndex = 5;
    bi.style.transform = 'translateY(-10px)';
    bj.style.transform = 'translateY(-10px)';
    setTimeout(()=>{
      // swap heights and inner text
      const hi = ri.style.height;
      const hj = rj.style.height;
      const texti = ri.textContent;
      const textj = rj.textContent;
      ri.style.height = hj;
      rj.style.height = hi;
      ri.textContent = textj;
      rj.textContent = texti;
      // reset transforms
      bi.style.transform = '';
      bj.style.transform = '';
      setTimeout(()=>{
        bi.style.zIndex = '';
        bj.style.zIndex = '';
        bi.style.transition = '';
        bj.style.transition = '';
        resolve();
      }, 260);
    }, 260);
  });
}

// process the next step from generator
async function processNext(){
  if (!gen) return;
  if (animating) return;
  const step = gen.next();
  if (step.done) {
    running = false;
    paused = true;
    return;
  }
  const action = step.value;
  switch(action.type){
    case 'setI':
      sortedUntil = action.i - 1;
      clearAllHighlights();
      highlightCurrentI(action.i);
      updateIndicesDisplay(action.i, '-');
      break;
    case 'compare':
      // highlight comparison j and current i and current min
      clearAllHighlights();
      highlightCurrentI(action.i);
      highlightCompare(action.j);
      highlightMin(action.min);
      comparisons++;
      updateStats();
      updateIndicesDisplay(action.i, action.min);
      break;
    case 'newMin':
      clearAllHighlights();
      highlightCurrentI(action.i);
      highlightMin(action.min);
      highlightCompare(null);
      updateIndicesDisplay(action.i, action.min);
      break;
    case 'swap':
      clearAllHighlights();
      highlightCurrentI(action.i);
      highlightMin(action.min);
      swaps++;
      updateStats();
      // animate swap visuals
      animating = true;
      await animateSwap(action.i, action.min);
      // After swap we should also swap the bar DOM labels to keep indices aligned visually:
      // Instead of reordering DOM nodes (which would change data-index), we keep positions but swapped heights already.
      // Marking: nothing else
      animating = false;
      break;
    case 'noSwap':
      // no visual swap, just pause briefly so user can see
      clearAllHighlights();
      highlightCurrentI(action.i);
      highlightMin(action.min);
      break;
    case 'sorted':
      markSorted(action.index);
      // clear min/compare highlights
      // show i/min as '-' if index was last
      updateIndicesDisplay('-', '-');
      break;
    case 'done':
      clearAllHighlights();
      for(let k=0;k<bars.length;k++) markSorted(k);
      updateIndicesDisplay('-', '-');
      running = false;
      paused = true;
      return;
    default:
      break;
  }
  // if autoplay running -> wait delay then proceed
  if (running && !paused){
    await sleep(delay);
    // If paused/resetted mid-wait, check flags
    if (!running || paused) return;
    return processNext();
  }
}

// utility sleep
function sleep(ms){ return new Promise(resolve => setTimeout(resolve, ms)); }

// Initialize default array
function init(){
  array = createRandomArray(parseInt(sizeRange.value));
  renderArray(array.slice());
  resetState();
}

generateBtn.addEventListener('click', ()=>{
  array = createRandomArray(parseInt(sizeRange.value));
  renderArray(array.slice());
  resetState();
});

// size change regenerates
sizeRange.addEventListener('input', ()=>{
  array = createRandomArray(parseInt(sizeRange.value));
  renderArray(array.slice());
  resetState();
});

// speed change
speedRange.addEventListener('input', ()=>{
  delay = parseInt(speedRange.value);
});

// Start autoplay
startBtn.addEventListener('click', ()=>{
  if (!gen){
    // use a copy of array for algorithm so UI heights reflect the array state as algorithm updates are applied
    gen = selectionSortGenerator(array); // this generator will modify the array parameter by swapping
  }
  if (!running){
    running = true;
    paused = false;
    processNext();
  } else {
    // if already running but paused, resume
    paused = false;
    processNext();
  }
});

// Step: advance a single yielded action
stepBtn.addEventListener('click', async ()=>{
  if (!gen){
    gen = selectionSortGenerator(array);
  }
  // if currently autoplaying, pause it and then step
  running = false;
  paused = true;
  // One step
  await processNext();
});

// Pause
pauseBtn.addEventListener('click', ()=>{
  running = false;
  paused = true;
});

// Reset: stop algorithm and re-render original array (unsorted)
resetBtn.addEventListener('click', ()=>{
  running = false;
  paused = true;
  gen = null;
  // re-render using current array (but array might have been mutated by generator)
  // For simplicity, generate a fresh random array of same size if current array isn't from user; otherwise we keep current array but un-sortedness cannot be restored.
  // We'll re-generate a new random array of the same size to reset visualization.
  array = createRandomArray(parseInt(sizeRange.value));
  renderArray(array.slice());
  resetState();
});

// Set custom array
setArrayBtn.addEventListener('click', ()=>{
  const val = customInput.value.trim();
  if (!val) return;
  // parse numbers separated by commas or spaces
  const parts = val.split(/[\s,]+/).filter(Boolean);
  const nums = [];
  for(const p of parts){
    const n = Number(p);
    if (Number.isFinite(n)) nums.push(Math.max(1, Math.min(100, Math.round(n))));
  }
  if (nums.length === 0) return;
  // if too many, clip
  const maxN = 50;
  if (nums.length > maxN) nums.length = maxN;
  array = nums;
  // update size slider to match
  sizeRange.value = Math.max(4, Math.min(30, array.length));
  renderArray(array.slice());
  resetState();
});

// Shuffle current array
randomizeBtn.addEventListener('click', ()=>{
  // Fisher-Yates shuffle
  for(let i=array.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  renderArray(array.slice());
  resetState();
});

// Reverse array
reverseBtn.addEventListener('click', ()=>{
  array.reverse();
  renderArray(array.slice());
  resetState();
});

// Keyboard shortcuts
document.addEventListener('keydown', (e)=>{
  if (e.key === ' ') {
    e.preventDefault();
    // toggle start/pause
    if (running && !paused){
      running = false; paused = true;
    } else {
      if (!gen) gen = selectionSortGenerator(array);
      running = true; paused = false; processNext();
    }
  } else if (e.key === 'ArrowRight') {
    e.preventDefault();
    // step
    if (!gen) gen = selectionSortGenerator(array);
    running = false; paused = true; processNext();
  }
});

// Initialize on load
init();

// Accessibility: announce actions (simple)
function announce(message){
  // Using aria-live region would be ideal; for simplicity update document title briefly
  document.title = 'Selection Sort Visualizer â€” ' + message;
  setTimeout(()=>{ document.title = 'Selection Sort Visualizer'; }, 1600);
}
</script>
</body>
</html>