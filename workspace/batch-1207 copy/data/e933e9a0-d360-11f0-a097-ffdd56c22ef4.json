{
  "id": "e933e9a0-d360-11f0-a097-ffdd56c22ef4",
  "timestamp": "2025-12-07T11:39:23.034Z",
  "model": "gpt-5-mini",
  "status": "success",
  "question": "Counting Sort",
  "answer": {
    "role": "assistant",
    "content": "<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <title>Counting Sort Visualizer</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\" />\n  <style>\n    :root{\n      --bg:#0f1724;\n      --panel:#0b1220;\n      --accent:#06b6d4;\n      --muted:#94a3b8;\n      --success:#10b981;\n      --danger:#ef4444;\n      --card:#071126;\n      --glass: rgba(255,255,255,0.03);\n    }\n    html,body{\n      height:100%;\n      margin:0;\n      background: linear-gradient(180deg,var(--bg),#061024);\n      color:#e6eef6;\n      font-family:Inter,ui-sans-serif,system-ui,-apple-system,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial;\n      -webkit-font-smoothing:antialiased;\n      -moz-osx-font-smoothing:grayscale;\n      padding:16px;\n      box-sizing:border-box;\n    }\n    .app{\n      max-width:1200px;\n      margin:0 auto;\n    }\n    header{\n      display:flex;\n      align-items:center;\n      gap:16px;\n      margin-bottom:12px;\n    }\n    h1{\n      font-size:20px;\n      margin:0;\n    }\n    .controls{\n      display:flex;\n      gap:12px;\n      flex-wrap:wrap;\n      margin-bottom:12px;\n      align-items:center;\n    }\n    .panel{\n      background:linear-gradient(180deg,var(--panel),#081223);\n      border-radius:10px;\n      padding:12px;\n      box-shadow:0 4px 18px rgba(2,6,23,0.6);\n      margin-bottom:12px;\n    }\n    .row{\n      display:flex;\n      gap:12px;\n      align-items:center;\n    }\n    label{font-size:13px;color:var(--muted)}\n    input[type=\"text\"]{\n      padding:8px 10px;\n      border-radius:8px;\n      border:1px solid rgba(255,255,255,0.06);\n      background:var(--card);\n      color:inherit;\n      min-width:260px;\n    }\n    button{\n      padding:8px 12px;\n      border-radius:8px;\n      border:0;\n      background:var(--accent);\n      color:#042027;\n      cursor:pointer;\n      font-weight:600;\n    }\n    button.secondary{\n      background:transparent;\n      color:var(--muted);\n      border:1px solid rgba(255,255,255,0.04);\n    }\n    button.danger{\n      background:var(--danger);\n      color:white;\n    }\n    .small{\n      padding:6px 8px;\n      font-size:13px;\n    }\n    .flex{\n      display:flex;\n      gap:12px;\n      align-items:center;\n    }\n    .viz{\n      display:flex;\n      gap:16px;\n      align-items:flex-end;\n      justify-content:space-between;\n      margin-top:12px;\n    }\n    .area{\n      flex:1;\n      min-height:160px;\n      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));\n      border-radius:8px;\n      padding:12px;\n      display:flex;\n      flex-direction:column;\n      gap:8px;\n    }\n    .title{\n      font-size:13px;\n      color:var(--muted);\n      display:flex;\n      justify-content:space-between;\n      align-items:center;\n      gap:12px;\n    }\n    .bars{\n      display:flex;\n      gap:6px;\n      align-items:end;\n      height:120px;\n      padding:8px;\n      overflow:auto;\n    }\n    .bar{\n      width:28px;\n      display:flex;\n      align-items:end;\n      justify-content:center;\n      flex-direction:column;\n      gap:6px;\n      transition:transform 220ms ease, background 220ms ease;\n      padding-bottom:4px;\n    }\n    .bar .blk{\n      width:100%;\n      border-radius:6px 6px 4px 4px;\n      background:linear-gradient(180deg,#60a5fa,#2563eb);\n      height:40px;\n      display:flex;\n      align-items:center;\n      justify-content:center;\n      color:#02102a;\n      font-weight:700;\n      font-size:12px;\n    }\n    .bar .val{\n      font-size:12px;\n      color:var(--muted);\n      text-align:center;\n      margin-top:6px;\n    }\n    .bar.highlight .blk{\n      background:linear-gradient(180deg,#06b6d4,#0891b2);\n      transform:translateY(-6px) scale(1.1);\n      box-shadow:0 10px 24px rgba(6,182,212,0.12);\n    }\n    .bar.placing .blk{\n      background:linear-gradient(180deg,#34d399,#10b981);\n      transform:translateY(-6px) scale(1.05);\n      box-shadow:0 10px 24px rgba(16,185,129,0.12);\n    }\n    .counts{\n      display:flex;\n      gap:6px;\n      align-items:end;\n      height:80px;\n      padding:8px;\n      overflow:auto;\n    }\n    .count{\n      width:36px;\n      display:flex;\n      align-items:center;\n      justify-content:center;\n      flex-direction:column;\n      gap:6px;\n    }\n    .count .cell{\n      min-height:22px;\n      border-radius:6px;\n      background:rgba(255,255,255,0.03);\n      padding:6px;\n      font-size:13px;\n      color:var(--muted);\n      width:100%;\n      text-align:center;\n    }\n    .count .cell.highlight{\n      background:linear-gradient(180deg,#fbbf24,#f97316);\n      color:#02100a;\n      font-weight:700;\n      transform:translateY(-4px);\n      box-shadow:0 8px 18px rgba(249,115,22,0.12);\n    }\n    .count .label{\n      font-size:12px;\n      color:var(--muted);\n    }\n    .outbar{\n      width:36px;\n      display:flex;\n      align-items:center;\n      justify-content:center;\n      flex-direction:column;\n      gap:6px;\n    }\n    .outbar .cell{\n      min-height:28px;\n      border-radius:6px;\n      background:rgba(255,255,255,0.02);\n      padding:6px;\n      width:100%;\n      text-align:center;\n      color:var(--muted);\n      font-weight:700;\n    }\n    .outbar .cell.filled{\n      background:linear-gradient(180deg,#a78bfa,#7c3aed);\n      color:#fff;\n      box-shadow:0 10px 24px rgba(124,58,237,0.09);\n    }\n    .desc{\n      font-size:13px;\n      color:var(--muted);\n      margin-top:8px;\n      line-height:1.4;\n      min-height:44px;\n    }\n    .footer{\n      display:flex;\n      gap:12px;\n      align-items:center;\n      justify-content:space-between;\n      margin-top:12px;\n      color:var(--muted);\n      font-size:13px;\n    }\n    input[type=\"range\"]{width:160px}\n    .toggle{\n      display:flex;\n      align-items:center;\n      gap:8px;\n      background:transparent;\n      color:var(--muted);\n    }\n    .legend{\n      display:flex;\n      gap:12px;\n      align-items:center;\n      color:var(--muted);\n      font-size:13px;\n    }\n    .chip{\n      display:flex;\n      gap:8px;\n      align-items:center;\n      padding:6px 8px;\n      background:var(--glass);\n      border-radius:8px;\n      color:var(--muted);\n      font-size:13px;\n    }\n    .chip .swatch{\n      width:12px;\n      height:12px;\n      border-radius:3px;\n    }\n    .sw-count{background:#f97316}\n    .sw-input{background:#06b6d4}\n    .sw-output{background:#7c3aed}\n    pre{\n      white-space:pre-wrap;\n      font-family:ui-monospace,SFMono-Regular,Menlo,monospace;\n      background:rgba(255,255,255,0.02);\n      padding:8px;\n      border-radius:8px;\n      color:#cbd5e1;\n      font-size:13px;\n      margin:0;\n    }\n    @media (max-width:880px){\n      .viz{flex-direction:column}\n      .bars{height:100px}\n    }\n  </style>\n</head>\n<body>\n  <div class=\"app\">\n    <header>\n      <h1>Counting Sort — Visualizer & Interactive Demo</h1>\n    </header>\n\n    <div class=\"panel controls\">\n      <div class=\"row\" style=\"flex-wrap:wrap;gap:8px;\">\n        <label>Array (comma-separated integers):</label>\n        <input id=\"arrayInput\" type=\"text\" placeholder=\"e.g. 3,6,4,1,3,4,1,4\" />\n        <button id=\"setArr\" class=\"small\">Set Array</button>\n        <button id=\"randArr\" class=\"small secondary\">Random</button>\n        <label style=\"margin-left:8px;\">Max value (domain 0..k):</label>\n        <input id=\"maxVal\" type=\"number\" min=\"0\" max=\"200\" value=\"6\" style=\"width:80px;padding:6px;border-radius:8px;background:var(--card);border:1px solid rgba(255,255,255,0.04);color:inherit;\" />\n        <label class=\"toggle\"><input id=\"stableChk\" type=\"checkbox\" checked/> Stable</label>\n      </div>\n\n      <div style=\"display:flex;gap:12px;margin-top:10px;align-items:center;\">\n        <button id=\"playBtn\">Play</button>\n        <button id=\"pauseBtn\" class=\"small secondary\">Pause</button>\n        <button id=\"stepF\" class=\"small\">Step →</button>\n        <button id=\"stepB\" class=\"small secondary\">← Back</button>\n        <button id=\"resetBtn\" class=\"small danger\">Reset</button>\n\n        <div style=\"margin-left:8px;\">\n          <label style=\"font-size:13px;color:var(--muted);\">Speed:</label>\n          <input id=\"speed\" type=\"range\" min=\"50\" max=\"1200\" step=\"50\" value=\"500\" />\n        </div>\n      </div>\n    </div>\n\n    <div class=\"viz\">\n      <div class=\"area panel\" style=\"flex:1.3\">\n        <div class=\"title\">\n          <div>Input Array</div>\n          <div style=\"color:var(--muted);font-size:13px;\">Elements processed are highlighted</div>\n        </div>\n        <div class=\"bars\" id=\"inputBars\" aria-hidden=\"true\"></div>\n        <div class=\"desc\" id=\"descInput\">Enter an array and click \"Set Array\" or \"Random\", then Play to visualize Counting Sort. Stable = maintain order of equal keys.</div>\n      </div>\n\n      <div class=\"area panel\" style=\"flex:0.9\">\n        <div class=\"title\">\n          <div>Counts / Cumulative</div>\n          <div style=\"color:var(--muted);font-size:13px;\">Index → count</div>\n        </div>\n        <div class=\"counts\" id=\"countsArea\"></div>\n        <div class=\"desc\" id=\"descCounts\">Counts are initialized to zero. While counting, we increment counts[value]. Then we (optionally) convert to cumulative counts for stable placement.</div>\n      </div>\n\n      <div class=\"area panel\" style=\"flex:1\">\n        <div class=\"title\">\n          <div>Output Array</div>\n          <div style=\"color:var(--muted);font-size:13px;\">Result will be filled during placement</div>\n        </div>\n        <div class=\"bars\" id=\"outputBars\" style=\"height:120px\"></div>\n        <div class=\"desc\" id=\"descOut\">The sorted output is progressively built. For a stable algorithm we place from right→left using cumulative counts to get positions.</div>\n      </div>\n    </div>\n\n    <div class=\"panel\" style=\"display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap;\">\n      <div style=\"flex:1;min-width:320px;\">\n        <div style=\"font-size:13px;color:var(--muted);margin-bottom:6px;\">Legend</div>\n        <div class=\"legend\">\n          <div class=\"chip\"><span class=\"swatch sw-input\"></span> Input element</div>\n          <div class=\"chip\"><span class=\"swatch sw-count\"></span> Count / cumulative update</div>\n          <div class=\"chip\"><span class=\"swatch sw-output\"></span> Output placement</div>\n        </div>\n        <div style=\"height:8px\"></div>\n        <div style=\"font-size:13px;color:var(--muted);\">Algorithm (conceptual):</div>\n        <pre>\n1) Count occurrences: for x in A: count[x]++\n2) Convert counts to positions (cumulative): for i=1..k: count[i]+=count[i-1]\n3) Place elements into output:\n   - Stable: for i = n-1 downto 0: out[--count[A[i]]] = A[i]\n   - Unstable: for v = 0..k: output next count[v] copies of v\n        </pre>\n      </div>\n\n      <div style=\"flex:1;min-width:260px;\">\n        <div style=\"font-size:13px;color:var(--muted);margin-bottom:6px;\">Current Step Info</div>\n        <div style=\"padding:8px;background:rgba(255,255,255,0.02);border-radius:8px;\">\n          <div id=\"stepTitle\" style=\"font-weight:700;color:#fff\">Idle</div>\n          <div id=\"stepDetail\" style=\"color:var(--muted);margin-top:6px\">No steps yet. Configure array and press Play.</div>\n        </div>\n        <div style=\"height:12px\"></div>\n        <div style=\"font-size:13px;color:var(--muted);margin-bottom:6px;\">Pseudocode</div>\n        <pre id=\"pseudocode\">\nfunction countingSort(A, k):\n  count = [0..k] // zeros\n  for x in A:\n    count[x]++\n  for i in 1..k:\n    count[i] += count[i-1]\n  output = [size A]\n  for i from len(A)-1 downto 0:\n    output[--count[A[i]]] = A[i]   // stable placement\n  return output\n        </pre>\n      </div>\n    </div>\n\n    <div class=\"footer\">\n      <div>Array length: <span id=\"lenInfo\">0</span> • Max value domain k: <span id=\"kInfo\">0</span></div>\n      <div style=\"color:var(--muted)\">Tip: Keep k (max) reasonably small for clear visualization. Values must be integers in 0..k.</div>\n    </div>\n  </div>\n\n<script>\n(function(){\n  // Elements\n  const arrayInput = document.getElementById('arrayInput');\n  const setArrBtn = document.getElementById('setArr');\n  const randArrBtn = document.getElementById('randArr');\n  const maxValInput = document.getElementById('maxVal');\n  const stableChk = document.getElementById('stableChk');\n\n  const playBtn = document.getElementById('playBtn');\n  const pauseBtn = document.getElementById('pauseBtn');\n  const stepF = document.getElementById('stepF');\n  const stepB = document.getElementById('stepB');\n  const resetBtn = document.getElementById('resetBtn');\n  const speedInput = document.getElementById('speed');\n\n  const inputBars = document.getElementById('inputBars');\n  const countsArea = document.getElementById('countsArea');\n  const outputBars = document.getElementById('outputBars');\n\n  const descInput = document.getElementById('descInput');\n  const descCounts = document.getElementById('descCounts');\n  const descOut = document.getElementById('descOut');\n\n  const stepTitle = document.getElementById('stepTitle');\n  const stepDetail = document.getElementById('stepDetail');\n\n  const lenInfo = document.getElementById('lenInfo');\n  const kInfo = document.getElementById('kInfo');\n\n  // State\n  let A = [];\n  let k = parseInt(maxValInput.value,10) || 6;\n  let snapshots = [];\n  let current = 0;\n  let playing = false;\n  let timer = null;\n  let speed = parseInt(speedInput.value,10) || 500;\n\n  // Utilities\n  function clamp(v,min,max){return Math.max(min,Math.min(max,v))}\n  function copyArr(a){return a.slice()}\n  function renderArraysFromSnapshot(snap){\n    // Input Bars\n    inputBars.innerHTML = '';\n    (snap.input || A).forEach((v,idx)=>{\n      const b = document.createElement('div');\n      b.className = 'bar' + ((snap.phase==='counting' && snap.processedIndex===idx) ? ' highlight' : (snap.phase==='placing' && snap.processedIndex===idx ? ' placing' : ''));\n      b.style.width = (Math.max(28, Math.min(80, 360/(A.length||1)))) + 'px';\n      const blk = document.createElement('div');\n      blk.className = 'blk';\n      blk.textContent = v;\n      const val = document.createElement('div');\n      val.className = 'val';\n      val.textContent = idx;\n      b.appendChild(blk);\n      b.appendChild(val);\n      inputBars.appendChild(b);\n    });\n\n    // Counts\n    countsArea.innerHTML = '';\n    (snap.counts || []).forEach((c,idx)=>{\n      const cc = document.createElement('div');\n      cc.className = 'count';\n      const cell = document.createElement('div');\n      cell.className = 'cell' + ((snap.countsHighlight===idx) ? ' highlight' : '');\n      cell.textContent = c;\n      const label = document.createElement('div');\n      label.className = 'label';\n      label.textContent = idx;\n      cc.appendChild(cell);\n      cc.appendChild(label);\n      countsArea.appendChild(cc);\n    });\n\n    // Output\n    outputBars.innerHTML = '';\n    (snap.output || Array((A||[]).length).fill(null)).forEach((v,idx)=>{\n      const o = document.createElement('div');\n      o.className = 'outbar';\n      const cell = document.createElement('div');\n      cell.className = 'cell' + ((v!==null && v!==undefined) ? ' filled' : '');\n      if(snap.placedPos === idx && snap.phase==='placing'){\n        // highlight recently placed\n        cell.style.boxShadow = '0 8px 22px rgba(124,58,237,0.12)';\n        cell.style.transform = 'translateY(-6px)';\n      }\n      cell.textContent = (v!==null && v!==undefined) ? v : '';\n      const label = document.createElement('div');\n      label.className = 'label';\n      label.textContent = idx;\n      o.appendChild(cell);\n      o.appendChild(label);\n      outputBars.appendChild(o);\n    });\n\n    // Update info texts\n    let title = '';\n    let detail = '';\n    switch(snap.phase){\n      case 'init':\n        title = 'Initialized';\n        detail = 'Counts initialized to zeros. Ready to begin.';\n        break;\n      case 'counting':\n        title = `Counting: processed index ${snap.processedIndex}`;\n        detail = `Read A[${snap.processedIndex}] = ${snap.readValue}. Increment counts[${snap.readValue}] → ${snap.counts[snap.readValue]}.`;\n        break;\n      case 'cumulative':\n        title = `Cumulative: updating index ${snap.countsHighlight}`;\n        detail = `Set counts[${snap.countsHighlight}] = counts[${snap.countsHighlight}] + counts[${snap.countsHighlight-1}] → ${snap.counts[snap.countsHighlight]}`;\n        break;\n      case 'placing':\n        title = `Placing element from A[${snap.processedIndex}]`;\n        detail = snap.placementStable ? `Stable placement: out[${snap.placedPos}] = ${snap.readValue} (decremented position)` : `Unstable: placed ${snap.readValue} at out[${snap.placedPos}]`;\n        break;\n      case 'placing-loop':\n        title = `Placing values for v=${snap.placingValue}`;\n        detail = `Filling ${snap.remaining} copies of ${snap.placingValue} into next positions starting at index ${snap.nextPos}.`;\n        break;\n      case 'done':\n        title = 'Finished';\n        detail = 'Sorting complete. Output is fully filled.';\n        break;\n      default:\n        title = snap.phase || 'Step';\n        detail = snap.info || '';\n    }\n    stepTitle.textContent = title;\n    stepDetail.textContent = detail;\n\n    lenInfo.textContent = A.length;\n    kInfo.textContent = k;\n  }\n\n  // Snapshot builder\n  function buildSnapshots(arr, maxK, stable){\n    const snaps = [];\n    const n = arr.length;\n    const Acopy = copyArr(arr);\n    let counts = Array(maxK+1).fill(0);\n\n    // initial\n    snaps.push({\n      phase:'init',\n      input: copyArr(Acopy),\n      counts: copyArr(counts),\n      countsHighlight: null,\n      processedIndex: null,\n      output: Array(n).fill(null)\n    });\n\n    // Counting phase\n    for(let i=0;i<n;i++){\n      const v = Acopy[i];\n      if(v<0 || v>maxK || !Number.isInteger(v)){\n        // invalid value - create a special snapshot and abort\n        snaps.push({\n          phase:'error',\n          input: copyArr(Acopy),\n          counts: copyArr(counts),\n          info: `Value ${v} out of range 0..${maxK}`,\n          processedIndex: i,\n          output: Array(n).fill(null)\n        });\n        return snaps;\n      }\n      counts[v]++;\n      snaps.push({\n        phase:'counting',\n        input: copyArr(Acopy),\n        counts: copyArr(counts),\n        countsHighlight: v,\n        processedIndex: i,\n        readValue: v,\n        output: Array(n).fill(null)\n      });\n    }\n\n    // Cumulative\n    if(n>0){\n      for(let i=1;i<=maxK;i++){\n        counts[i] = counts[i] + counts[i-1];\n        snaps.push({\n          phase:'cumulative',\n          input: copyArr(Acopy),\n          counts: copyArr(counts),\n          countsHighlight: i,\n          processedIndex: null,\n          output: Array(n).fill(null)\n        });\n      }\n    }\n\n    // Placement\n    let output = Array(n).fill(null);\n    if(stable){\n      // stable: iterate i from n-1 downto 0, place at --counts[val]\n      for(let i=n-1;i>=0;i--){\n        const v = Acopy[i];\n        counts[v] = counts[v] - 1;\n        const pos = counts[v];\n        output[pos] = v;\n        snaps.push({\n          phase:'placing',\n          input: copyArr(Acopy),\n          counts: copyArr(counts),\n          processedIndex: i,\n          readValue: v,\n          placedPos: pos,\n          placementStable: true,\n          output: copyArr(output)\n        });\n      }\n    } else {\n      // unstable: iterate values 0..k, place countsOriginal[v] times sequentially\n      // But counts currently are cumulative; convert to original counts\n      // To avoid losing original counts, reconstruct from cumulative: originalCount[v] = counts[v] - counts[v-1] (with counts[-1]=0)\n      const origCounts = Array(maxK+1).fill(0);\n      for(let v=0;v<=maxK;v++){\n        origCounts[v] = counts[v] - (v>0?counts[v-1]:0);\n      }\n      let nextPos = 0;\n      for(let v=0;v<=maxK;v++){\n        let times = origCounts[v];\n        for(let t=0;t<times;t++){\n          output[nextPos] = v;\n          snaps.push({\n            phase:'placing-loop',\n            input: copyArr(Acopy),\n            counts: copyArr(counts),\n            placingValue: v,\n            remaining: times - t - 1,\n            nextPos: nextPos,\n            placedPos: nextPos,\n            output: copyArr(output)\n          });\n          nextPos++;\n        }\n      }\n    }\n\n    snaps.push({\n      phase:'done',\n      input: copyArr(Acopy),\n      counts: copyArr(counts),\n      countsHighlight: null,\n      processedIndex: null,\n      output: copyArr(output)\n    });\n\n    return snaps;\n  }\n\n  // Playback controls\n  function goto(idx){\n    idx = clamp(idx, 0, snapshots.length-1);\n    current = idx;\n    renderArraysFromSnapshot(snapshots[current]);\n  }\n\n  function play(){\n    if(!snapshots || snapshots.length===0) return;\n    if(playing) return;\n    playing = true;\n    const step = ()=>{\n      if(!playing) return;\n      if(current < snapshots.length-1){\n        current++;\n        renderArraysFromSnapshot(snapshots[current]);\n        timer = setTimeout(step, speed);\n      } else {\n        playing = false;\n      }\n    };\n    // if at end, go to start\n    if(current >= snapshots.length-1){\n      current = -1;\n    }\n    step();\n  }\n\n  function pause(){\n    playing = false;\n    if(timer) clearTimeout(timer);\n    timer = null;\n  }\n\n  function stepForward(){\n    pause();\n    if(current < snapshots.length-1){\n      current++;\n      renderArraysFromSnapshot(snapshots[current]);\n    }\n  }\n\n  function stepBackward(){\n    pause();\n    if(current > 0){\n      current--;\n      renderArraysFromSnapshot(snapshots[current]);\n    }\n  }\n\n  function reset(){\n    pause();\n    snapshots = buildSnapshots(A,k,stableChk.checked);\n    current = 0;\n    renderArraysFromSnapshot(snapshots[0]);\n  }\n\n  // Events\n  setArrBtn.addEventListener('click', ()=>{\n    const raw = arrayInput.value.trim();\n    if(!raw){\n      alert('Please enter a comma-separated list of integers.');\n      return;\n    }\n    const parts = raw.split(',').map(s=>s.trim()).filter(s=>s.length>0);\n    const parsed = [];\n    for(let p of parts){\n      const num = Number(p);\n      if(!Number.isFinite(num) || !Number.isInteger(num)){\n        alert('All values must be integers. Found: ' + p);\n        return;\n      }\n      parsed.push(num);\n    }\n    A = parsed;\n    k = parseInt(maxValInput.value,10) || Math.max(...A,0);\n    if(k < Math.max(...A)) {\n      if(!confirm(`Given max k=${k} is smaller than some array values (max in array = ${Math.max(...A)}). Increase k to ${Math.max(...A)}?`)){\n        return;\n      } else {\n        k = Math.max(...A);\n        maxValInput.value = k;\n      }\n    }\n    snapshots = buildSnapshots(A,k,stableChk.checked);\n    current = 0;\n    renderArraysFromSnapshot(snapshots[0]);\n  });\n\n  randArrBtn.addEventListener('click', ()=>{\n    const maxk = parseInt(maxValInput.value,10) || 6;\n    const size = Math.min(28, Math.max(3, Math.floor(5 + Math.random()*12)));\n    A = Array.from({length:size}, ()=> Math.floor(Math.random()*(maxk+1)));\n    arrayInput.value = A.join(',');\n    snapshots = buildSnapshots(A,maxk,stableChk.checked);\n    current = 0;\n    k = maxk;\n    renderArraysFromSnapshot(snapshots[0]);\n  });\n\n  playBtn.addEventListener('click', ()=>{\n    if(!snapshots || snapshots.length===0){\n      snapshots = buildSnapshots(A,k,stableChk.checked);\n      current = 0;\n      renderArraysFromSnapshot(snapshots[0]);\n    }\n    play();\n  });\n\n  pauseBtn.addEventListener('click', ()=>{\n    pause();\n  });\n\n  stepF.addEventListener('click', stepForward);\n  stepB.addEventListener('click', stepBackward);\n  resetBtn.addEventListener('click', ()=>{\n    // clear everything\n    pause();\n    A = [];\n    arrayInput.value = '';\n    snapshots = [];\n    current = 0;\n    inputBars.innerHTML = '';\n    countsArea.innerHTML = '';\n    outputBars.innerHTML = '';\n    stepTitle.textContent = 'Idle';\n    stepDetail.textContent = 'No steps yet. Configure array and press Play.';\n    lenInfo.textContent = '0';\n    kInfo.textContent = maxValInput.value;\n  });\n\n  speedInput.addEventListener('input', ()=>{\n    speed = parseInt(speedInput.value,10);\n  });\n\n  maxValInput.addEventListener('change', ()=>{\n    k = parseInt(maxValInput.value,10) || 0;\n    k = Math.max(0,k);\n    maxValInput.value = k;\n  });\n\n  stableChk.addEventListener('change', ()=>{\n    // rebuild with new stable option\n    if(A.length>0){\n      snapshots = buildSnapshots(A,k,stableChk.checked);\n      current = 0;\n      renderArraysFromSnapshot(snapshots[0]);\n    }\n  });\n\n  // Initialize with sample\n  A = [3,6,4,1,3,4,1,4];\n  arrayInput.value = A.join(',');\n  k = 6;\n  maxValInput.value = k;\n  snapshots = buildSnapshots(A,k,stableChk.checked);\n  renderArraysFromSnapshot(snapshots[0]);\n\n  // Keyboard shortcuts\n  window.addEventListener('keydown',(e)=>{\n    if(e.key===' '){\n      e.preventDefault();\n      if(playing) pause(); else play();\n    } else if(e.key === 'ArrowRight'){\n      stepForward();\n    } else if(e.key === 'ArrowLeft'){\n      stepBackward();\n    }\n  });\n\n})();\n</script>\n</body>\n</html>"
  },
  "messages": [
    {
      "role": "system",
      "content": "Generate a single HTML file with JavaScript demonstrating the user-given concept. Only respond in a single HTML file."
    },
    {
      "role": "user",
      "content": "Counting Sort"
    }
  ],
  "topic": "Counting Sort",
  "hasFSM": true,
  "hasTest": true,
  "evaluation": {
    "score": null,
    "notes": ""
  }
}